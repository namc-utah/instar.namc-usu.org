{"version":3,"sources":["../../src/index.ts","../../src/types.ts","../../src/schema.graphql.ts","../../src/lookups.graphql.ts","../../src/api.ts","../../src/util.ts","../../../src/hooks/useHostedAuth.ts","data/api/MockApi.ts","data/api/Api.ts","config.ts","data/api/GraphApi.ts","data/selectors/selectors.ts","lib/taxonomy.ts","data/selectors/invalidate.ts","data/calls/addProjectSamples.ts","data/calls/createOrganization.ts","data/calls/createOrganizationWithUser.ts","data/calls/createProject.ts","data/calls/createSampleSubmission.ts","data/calls/deleteOrganism.ts","data/calls/deleteOrganization.ts","data/calls/deleteProject.ts","data/calls/fetchBoxes.ts","data/calls/fetchBoxDetailById.ts","data/calls/fetchBoxSamplesByBoxId.ts","data/calls/fetchBoxTaxaByBoxId.ts","data/calls/fetchLatestSubmissionByBoxId.ts","data/calls/fetchLookups.ts","data/calls/fetchMinimalSamplesByIds.ts","data/calls/fetchMinimalSamplesByOrganizationId.ts","data/calls/fetchMinimalSamplesByTaxonId.ts","data/calls/fetchMinimalSamplesByUsStateId.ts","data/calls/fetchModels.ts","data/calls/fetchMyUser.ts","lib/deNull.ts","data/calls/fetchOrganizationById.ts","data/calls/fetchOrganizations.ts","data/calls/fetchPredictors.ts","data/calls/fetchProjects.ts","data/calls/fetchProjectSamplesByProjectId.ts","data/calls/fetchSampleById.ts","data/calls/fetchSites.ts","data/calls/fetchSiteDetailById.ts","data/calls/fetchSitesByBoxId.ts","data/calls/fetchSitesByProjectId.ts","data/calls/fetchSitesPage.ts","data/calls/fetchSorterUsers.ts","data/calls/fetchTaxa.ts","data/calls/fetchTranslations.ts","data/calls/fetchUserBoxes.ts","data/calls/fetchUserById.ts","data/calls/fetchUsers.ts","data/calls/fetchUsStateAtCoordinates.ts","data/calls/reconcileBoxTaxonomy.ts","data/calls/removeProjectSamples.ts","data/calls/startSort.ts","data/calls/startTaxonomyIdentification.ts","data/calls/stopSort.ts","data/calls/stopTaxonomyIdentification.ts","data/calls/updateBox.ts","data/calls/updateLabSort.ts","data/calls/updateOrganization.ts","data/calls/updateProject.ts","data/calls/updateUser.ts","data/calls/updateUserRoles.ts","data/calls/upsertOrganism.ts","components/DataGrid/DataGrid.tsx","lib/formats/formats.ts","components/Filters/FilterChips.tsx","components/DataGrid/columnDef.tsx","components/withTooltip/withTooltip.tsx","components/DataGrid/renderers.tsx","lib/pluralize.ts","components/DataGrid/accessories.tsx","components/BoxesListing/columnDefs.ts","components/ReadOnlyField/ReadOnlyField.tsx","components/SelectField/SelectField.tsx","components/Chip/Chip.tsx","components/TextField/TextField.tsx","components/TextFilterField/TextFilterField.tsx","components/TextFilterField/useTextFilterField.ts","lib/useDebounce.ts","components/withSuspense/withSuspense.tsx","components/BoxesListing/Fallback.tsx","components/BoxesListing/PrivilegedBoxesListing.tsx","components/BoxesListing/CustomerBoxesListing.tsx","components/BoxesListing/BoxesListing.connect.tsx","components/CheckboxField/CheckboxField.tsx","components/AutocompleteField/AutocompleteField.tsx","components/SamplesDataGrid/columnDefs.ts","components/SitesMap/calculateFit.ts","components/SitesMap/useSitesMapController.tsx","components/SitesMap/styles/index.ts","components/SitesMap/styles/basicThumb.png","components/SitesMap/styles/satThumb.jpg","components/SitesMap/styles/topoThumb.png","components/SitesListing/SitesListing.tsx","components/SitesMap/StyleControl.tsx","components/SitesMap/SitesMap.tsx","components/SitesListing/SiteDetailPanel.tsx","components/SitesListing/PinMarker.tsx","components/LinearProgress/LinearProgress.tsx","components/SitesListing/Fallback.tsx","data/util.ts","components/SamplesDataGrid/SamplesDataGrid.tsx","components/BoxDetail/BoxSamples.tsx","components/AppNotifications/useNotifications.tsx","lib/useUpdatableState.ts","components/BoxDetail/componentController.ts","components/AccordionPanel/AccordionPanel.tsx","components/Title/Title.tsx","components/ProgressField/ProgressField.tsx","components/BoxDetail/SortingProgressField.tsx","components/BoxDetail/IdentificationProgressField.tsx","components/AutocompleteArrayField/AutocompleteArrayField.tsx","components/ModelsField/ModelsField.tsx","components/SitesMap/SitesMapPreview.tsx","components/BoxDetail/BoxSitesMapPreview.tsx","components/Menu/Menu.tsx","components/BoxDetail/BoxDetail.tsx","components/BoxDetail/BoxDetail.connect.tsx","components/BoxDetail/Fallback.tsx","components/SampleOverview/SampleOverview.tsx","components/SampleOverview/SampleOverview.connect.tsx","components/SampleOverview/Fallback.tsx","components/SampleInfoPanel/SampleInfoPanel.tsx","components/NumberField/NumberField.tsx","components/SampleSorting/ToggleEditModeButton.tsx","components/SampleSorting/componentController.ts","components/SampleSorting/SampleSorting.tsx","components/SampleSorting/SampleSorting.connect.tsx","components/SampleSorting/Fallback.tsx","components/Badge/Badge.tsx","components/TaxonomyField/util.tsx","components/TaxonomyField/TaxonomyField.tsx","components/TaxonomyField/TaxonomySelectField.tsx","components/SampleTaxonomyIdentification/componentController.ts","components/SampleTaxonomyIdentification/columnDefs.ts","components/ConfirmDialog/ConfigDialog.tsx","components/SampleTaxonomyIdentification/TimeEntryDialog.tsx","components/SampleTaxonomyIdentification/ToggleEditModeButton.tsx","components/SampleTaxonomyIdentification/renderers.tsx","components/SampleTaxonomyIdentification/Fallback.tsx","components/SampleTaxonomyIdentification/SampleTaxonomyIdentification.tsx","components/SampleTaxonomyIdentification/SampleTaxonomyIdentification.connect.tsx","components/QuickNavigateField/QuickNavigateField.tsx","lib/environment.ts","components/AppHeader/AppHeader.tsx","components/SideNavBar/UserName.tsx","components/SideNavBar/SideNavBar.tsx","components/SideNavBar/SideNavBar.connect.tsx","components/AppHeader/AppHeader.connect.tsx","components/ErrorBoundary/ErrorBoundary.tsx","components/ModelsListing/columnDefs.ts","components/ModelsListing/ModelsListing.tsx","components/PredictorsListing/columnDefs.ts","components/PredictorsListing/PredictorsListing.tsx","lib/submissions/processing/cellProcessors.ts","lib/submissions/processing/sampleProcessors.ts","lib/submissions/schema/templateSchema.ts","components/CustomerSubmission/CustomerSubmission.tsx","lib/submissions/processing/processParsedSample.ts","lib/submissions/processing/excel.ts","lib/submissions/components/PreparationPage.tsx","lib/submissions/components/FinishedPage.tsx","lib/submissions/components/helpers.tsx","lib/submissions/components/ChainOfCustodyForm.tsx","components/CustomerSubmission/columnDefs.ts","components/CustomerSubmission/UploadFileBox.tsx","components/CustomerSubmission/Fallback.tsx","components/CustomerSubmission/StepPage.tsx","components/ProjectsListing/columnDefs.ts","components/ProjectsListing/ProjectsListing.tsx","components/TranslationsListing/columnDefs.ts","components/TranslationsListing/TranslationsListing.tsx","components/ChainOfCustody/ChainOfCustody.tsx","components/ChainOfCustody/ChainOfCustody.connect.tsx","components/ChainOfCustody/Fallback.tsx","components/FullScreenWait/FullScreenWait.tsx","components/UserDetail/RolesField.tsx","components/UserDetail/UserDetail.tsx","components/UserDetail/Fallback.tsx","components/UserDetail/UserDetail.connect.tsx","components/UsersListing/columnDefs.ts","components/UsersListing/UsersListing.tsx","components/UsersListing/Fallback.tsx","components/DateField/DateField.tsx","components/ProjectDetail/CriterionFields.tsx","components/ProjectDetail/ModifyProjectSamples.tsx","lib/excel/downloadWorkbook.ts","components/ProjectDetail/ProjectSamples.tsx","lib/excel/createSingleTableWorkbook.ts","components/ProjectDetail/ProjectSitesMapPreview.tsx","components/ConfirmationDialog/ConfirmationDialog.tsx","components/ProjectDetail/ProjectDetail.tsx","components/ProjectDetail/ProjectDetail.connect.tsx","components/ProjectDetail/Fallback.tsx","components/BoxTaxonomy/downloadBoxTaxaReport.ts","components/BoxTaxonomy/BoxTaxonomySelectField.tsx","components/BoxTaxonomy/BoxTaxonomy.tsx","components/BoxTaxonomy/columnDefs.ts","components/BoxTaxonomy/BoxTaxonomy.connect.tsx","components/BoxTaxonomy/Fallback.tsx","components/AppRouter/AppRouter.tsx","components/AppRouter/ConfirmNavigateAway.tsx","App.tsx","App.connect.tsx","reportWebVitals.ts","index.tsx"],"names":["a","newState","error","Hub","nextRequestNumber","requestNumber","String","MockApi","responders","responseDelay","Map","setResponders","clear","addResponders","forEach","queryOrMutation","responder","set","setResponseDelay","ms","wait","Promise","resolve","window","setTimeout","signOut","log","debug","query","variables","loc","source","body","get","response","queryAllPages","dataProperty","mutation","level","message","context","this","ApiError","Error","apiState","atom","key","default","dangerouslyAllowMutability","useApi","useRecoilValue","domain","process","REACT_APP_DOMAIN","endpoints","graphql","appDefaults","redirectUrl","URL","endsWith","location","origin","publicUrl","BOX_STATE_ID","GraphApi","auth","send","getCurrentToken","jwt","api","apiCall","TIMEOUT_SECONDS","data","errors","errorMessagesString","map","join","offset","allRecords","lastData","records","undefined","nextOffset","push","withDescendantIds","taxa","highestLevelRankOrder","reduce","highest","levelRankOrder","Math","max","result","taxon","currentLevel","childTaxons","filter","parentId","id","descendantIds","acc","refreshOnState","atomFamily","refreshOn","family","useInvalidate","useRecoilCallback","v","useDeferredInvalidate","calls","useRef","current","invalidate","useEffect","useCallback","addProjectSamplesMutation","gql","addProjectSamples","params","createOrganizationMutation","createOrganization","organization","organizationName","name","organizationTypeId","typeId","restOrganization","createOrganizationWithUserMutation","createOrganizationWithUser","user","createUser","createProjectMutation","createProject","project","projectName","restProject","createSampleSubmissionMutation","createSampleSubmission","submission","JSON","stringify","deleteOrganismMutation","deleteOrganism","organism","organismId","deleteOrganizationMutation","deleteOrganization","organizationId","deleteProjectMutation","deleteProject","projectId","fetchBoxesQuery","transformBox","boxId","receivedDate","boxReceivedDate","submittedByName","submittedBy","identificationComplete","idComplete","rest","fetchBoxes","boxes","sortBy","reverse","fetchBoxDetailByIdQuery","fetchBoxDetailById","boxInfo","customerName","customer","restBoxInfo","fetchBoxSamplesByBoxIdQuery","transformSourceSample","sample","sampleId","type","sampleType","method","sampleMethod","identifierName","idErName","identificationStartDate","idStartDate","identificationEndDate","idEndDate","restSample","fetchBoxSamplesByBoxId","samples","fetchBoxTaxaByBoxIdQuery","fetchBoxTaxaByBoxId","boxTaxa","taxonomyId","scientificName","taxonomistCounts","fetchLatestSubmissionByBoxIdQuery1","fetchLatestSubmissionByBoxIdQuery2","fetchLatestSubmissionByBoxId","data1","organizationPhone","phone","latestSubmission","version","versionId","submissionId","submitterId","submitter","firstName","lastName","submitterEmail","email","submitterPhone","createdDate","updatedDate","data2","submissionData","submitterName","templateVersion","appVersion","Array","isArray","fetchLookupsQuery","fetchLookups","lookups","taxaLevels","lifeStages","noteTypes","boxStates","sampleMethods","sampleTypes","towTypeNames","towTypes","effortTypes","designTypes","geo","habitats","ecosystems","waterbodyTypes","usStates","states","countries","entity","organizationTypes","roles","nameExtractor","sampleMethodNames","sampleTypeNames","effortTypeNames","designTypeNames","habitatNames","ecosystemNames","waterBodyTypeNames","fetchMinimalSamplesByIdsQuery","transformMinimalSample","sampleDate","fetchMinimalSamplesByOrganizationIdQuery","fetchMinimalSamplesByOrganizationId","fetchMinimalSamplesByTaxonIdQuery","fetchMinimalSamplesByTaxonId","taxonId","fetchMinimalSamplesByUsStateIdQuery","fetchMinimalSamplesByUsStateId","usStateId","fetchModelsQuery","fetchModels","models","modelId","modelName","typeName","modelTypeName","fetchMyUserQuery","fetchMyUser","myProfile","permissions","fullName","deNull","defaults","copy","Object","entries","fetchOrganizationByIdQuery","fetchOrganizationById","organizationsById","entityId","address1","address2","city","usState","country","zipCode","userCount","fetchOrganizationsQuery","fetchOrganizations","organizations","fetchPredictorsQuery","fetchPredictors","predictors","predictorId","predictorName","predictorType","fetchProjectsQuery","fetchProjects","projects","contactName","fetchProjectSamplesByProjectIdQuery","fetchProjectSamplesByProjectId","fetchSampleByIdQuery","fetchSampleById","organisms","sampleTaxa","identificationUserId","idErId","boxState","noteTypeIds","noteTypeId","transformSite","siteId","siteName","fetchSiteDetailByIdQuery","fetchSitesByBoxIdQuery","fetchSitesByBoxId","sites","fetchSitesByProjectIdQuery","fetchSitesByProjectId","fetchSitesPageQuery","fetchSitesPage","limit","mapSites","fetchSorterUsersQuery","fetchSorterUsers","sorters","fetchTaxaQuery","fetchTaxa","taxonomy","levelId","levelName","parentTaxonomyId","synonymsJson","synonyms","isTargetEffort","parse","fetchTranslationsQuery","fetchTranslations","translations","translationId","translationName","fetchUserBoxesQuery","fetchUserBoxes","userBoxes","fetchUserByIdQuery","fetchUserById","userId","roleIds","fetchUsersQuery","fetchUsers","users","fetchUsStateAtCoordinatesQuery","fetchUsStateAtCoordinates","getUSState","reconcileBoxTaxonomyMutation","reconcileBoxTaxonomy","taxReconciliation","removeProjectSamplesMutation","removeProjectSamples","startSortMutation","startSort","labStartSort","startTaxonomyIdentificationMutation","startTaxonomyIdentification","taxIdentificationStart","stopSortMutation","stopSort","labStopSort","stopTaxonomyIdentificationMutation","stopTaxonomyIdentification","time","taxIdentificationStop","updateBoxMutation","updateBox","boxUpdate","setBoxInfo","updateLabSortMutation","updateLabSort","sortTime","count","sorterCount","labSort","updateOrganizationMutation","updateOrganization","updateProjectMutation","updateProject","updateUserMutation","updateUser","isSelf","restUser","updateUserRolesMutation","updateUserRoles","upsertOrganismMutation","upsertOrganism","lifeStageId","createSampleTaxaInfo","selectTaxa","selector","all","selectLookups","find","rankOrder","selectLifeStages","selectNoteTypes","selectBoxStates","selectUsStates","selectRoles","selectSystemAdminRoleLevel","constSelector","selectUsCountryId","usCountryId","selectDefaultOrganizationTypeId","defaultOrganizationTypeId","organizationType","selectSampleById","selectorFamily","selectSorterUsers","selectHasUser","selectMyUser","virtual","myUser","affiliationId","hasPermission","resource","grantAction","explicitPermission","includes","implicitPermission","replace","selectBoxes","selectUserBoxes","selectBoxById","selectPredictors","selectBoxSamplesByBoxId","selectOrganizations","nameCount","countBy","selectOrganizationById","selectModels","selectProjects","selectTranslations","selectUsers","latitude","longitude","selectUserById","selectLatestSubmissionByBoxId","selectSitesByBoxId","selectProjectById","selectProjectSamplesByProjectId","selectSitesByProjectId","selectBoxTaxaByBoxId","selectMinimalSamplesByUsStateId","selectMinimalSamplesByTaxonId","selectMinimalSamplesByOrganizationId","selectNull","DataGrid","rows","columnDefs","onSelectedRowsChanged","onGridApisReady","gridOptions","rowIdProperty","restProps","useState","grid","setGrid","refreshCells","refreshHeader","memoizedGridOptions","useMemo","suppressCellSelection","defaultColDef","sortable","resizable","suppressMovable","className","css","width","height","rowData","immutableData","onSelectionChanged","getSelectedRows","animateRows","containerStyle","getRowNodeId","onGridReady","columnApi","dayjs","extend","utc","timezone","CHIP_COLOR","formatNumber","value","toLocaleString","formatUtcDateTimeToAppDate","utcDateTime","match","substring","length","tz","format","comparator","labelComparator","valueA","valueB","labelA","label","labelB","columnDef","colDef","cellRenderer","valueFormatter","filterTooltip","restColDef","cellRendererParams","valueLabels","withTooltip","content","tooltip","disabled","Tooltip","title","renderers","LinkRenderer","onClick","ProgressRenderer","percent","floor","position","background","top","textAlign","CheckRenderer","display","alignItems","FilterableTextRenderer","onFilter","right","IconButton","pluralize","qty","word","isOne","DataGridRecordCount","descriptor","total","visible","fontSize","privilegedColumnDefs","headerName","field","flex","minWidth","customerColumnDefs","ReadOnlyField","gridArea","displayValue","shrink","padding","lineHeight","letterSpacing","SelectField","onChange","readOnly","options","valueLabel","option","FormControl","sx","color","InputLabel","Select","newValue","target","size","MenuItem","fontStyle","Chip","chipColor","textColor","onDelete","backgroundColor","variant","NoneChip","FilterChips","filters","joinLabel","noneNode","flexWrap","gap","index","Fragment","opacity","TextField","inputRef","maxLength","inputProps","combinedInputProps","TextFilterField","hotkeys","ownRef","effectiveRef","useHotkeys","e","preventDefault","stopPropagation","focus","useTextFilterField","state","text","setText","input","delayMs","debounceTimerRef","debounced","setDebounced","setDebouncedImmediately","clearTimeout","useDebounce","rawFilterText","setRawFilterText","filterText","trim","withSuspense","Component","Fallback","WrappedComponent","props","fallback","displayName","flexDirection","Skeleton","ANY_BOX_STATE","boxStateNameFilterState","textFilterState","addedFiltersState","PrivilegedBoxesListing","navigate","useNavigate","useRecoilState","boxStateNameFilter","setBoxStateNameFilter","textFilter","setTextFilter","textFilterDebounced","clearTextFilter","addedFilters","setAddedFilters","filterFn","box","targetBoxId","Number","toLowerCase","filterId","customerId","boxDetail","boxStateOptions","isActive","NAMCResource","submissions","GrantAction","createAny","marginLeft","boxSubmission","minHeight","marginTop","frameworkComponents","CustomerBoxesListing","forms","submissionCount","chainOfCustodyForm","CustomerConnector","PrivilegedConnector","BoxesListing","readAny","CheckboxField","FormControlLabel","control","Checkbox","checked","EditableAutocompleteField","isClearable","foundValue","getOptionLabel","getOptionDisabled","renderInput","event","selected","disableClearable","SuspensedEditableAutocompleteField","optionsSelector","mismatchedPropsErrorMessage","AutocompleteField","isFixedType","isSelectorType","foundValueLabel","samplesColumnDefs","samplesDownloadColumns","header","calculateFit","points","maxZoom","MAX_ZOOM","updatedViewport","WebMercatorViewport","allPointsLngLat","updatedBounds","LngLatBounds","pointLngLat","sw","getSouthWest","ne","getNorthEast","fitBounds","lng","lat","zoom","DEFAULT_VIEWPORT","SITES_LAYER_ID","useSitesMapController","initialViewport","onSitesClick","viewport","setViewport","hoverInfo","setHoverInfo","sitesData","features","site","geometry","coordinates","properties","fitSites","targetSites","calculatedViewport","transition","transitionInterpolator","FlyToInterpolator","transitionDuration","vp","centerSite","isViewportReady","handleClick","feature","layer","handleHover","mouseEvent","srcEvent","x","offsetX","y","offsetY","node","justifyContent","whiteSpace","smartFitAll","mapStyles","basic","createNewStyle","basicStylesJson","sat","satStylesJson","topo","topoStylesJson","mapStylesThumbs","rawStyle","sources","layers","rawSources","rawLayers","glyphs","sprite","sourceLookup","keys","sKey","newId","rawLayer","newLyr","toString","sitesLayerJson","ALL_SITES_STATUS","styleKeys","tooltips","StyleThumb","styleKey","src","cursor","border","borderRadius","margin","StyleControl","isOpen","setIsOpen","SpeedDial","ariaLabel","hidden","FabProps","icon","direction","open","onOpen","onClose","SpeedDialAction","tooltipTitle","REACT_APP_MAPBOX_TOKEN","mapStyleKeyAtom","SitesMap","controller","children","minimal","mapStyleKey","setMapStyleKey","mapStyle","onViewportChange","mapboxApiAccessToken","onHover","interactiveLayerIds","style","showCompass","left","pointerEvents","transform","paddingTop","bottom","SiteDetailPanel","transitionMs","maxWidth","overflow","boxSizing","paddingLeft","fontWeight","gridTemplateColumns","gridTemplateRows","gridTemplateAreas","abbreviation","sampleCount","system","ecosystem","waterbodyType","waterbodyName","PinMarker","xmlns","xmlnsXlink","viewBox","xmlSpace","fill","d","cx","cy","r","LinearProgress","timeoutRef","setIsActive","ANY_US_STATE","selectUsStateOptions","sitesListingSourceAtom","usStateFilterIdAtom","textFilterAtom","useSetSitesListingSource","setSitesListingSource","useSetRecoilState","setUsStateFilter","sitesListingSource","allSitesStatusAtom","unfetched","allSitesAtom","sparseSitesDetailAtom","SitesListing","setState","siteIdUnsanitized","usStateOptions","usStateIdFilter","setUsStateIdFilter","resetTextFilter","allSitesStatus","setAllSitesStatus","allSites","setAllSites","sparseSitesDetail","setSparseSitesDetail","sourceSites","setSourceSites","detailPanelSite","setDetailPanelSite","accumulateAllSites","fetchCall","pageSize","onPage","accumulateItems","from","to","min","then","useAccumulateApiItems","incoming","existing","uniqBy","getBoxSitesByBoxId","snapshot","getPromise","getProjectSitesByProjectId","fetching","Infinity","fetched","siteDetail","siteInfo","waterbodyCode","fetchSiteDetailById","isFetching","selectedSite","identity","usStateAbbreviation","filteredSites","targetSite","warn","isInitialFitted","setIsInitalFitted","zIndex","SamplesDataGrid","sampleOverview","sortEndDate","sortStartDate","sorterName","sortState","identificationState","BoxSamples","boxSamples","useNotifications","useSnackbar","enqueueSnackbar","closeSnackbar","closeAction","info","deferMs","timeout","autoHideDuration","action","persist","useUpdatableState","initialState","deps","instance","isFirstRender","updateState","updater","produce","getInitialState","values","boxStateId","measurements","midges","description","alias","modelIds","editMode","isDirty","AccordionPanel","locked","summary","actions","expanded","marginBottom","expandIcon","Title","Subtitle","ProgressField","doneCount","totalCount","roValue","SortingProgressField","boxSample","IdentificationProgressField","SelectedOptionChip","AutocompleteArrayField","valueArray","selectedOptions","multiple","disablePortal","InputLabelProps","renderTags","renderedOptions","getTagProps","ModelsField","SitesMapPreview","sitesSelector","BoxSitesMapPreview","Divider","Menu","items","React","anchorEl","setAnchorEl","handleMenuClose","currentTarget","startIcon","item","selectOrganizationOptions","selectBoxStateOptions","isExpandedState","BoxDetail","notifications","setFieldValue","fieldName","draft","assign","startEdit","stopEdit","cancel","useComponentController","isPanelExpanded","setIsPanelExpanded","isStopped","isEditing","isSaving","boxTaxonomy","updateAny","processingCompleteDate","taxaQa","sorterQa","multiline","minRows","sortComplete","SampleOverview","taxonomyStatus","sorterId","sampleSorting","sampleTaxonomyIdentification","GridInfoField","SampleInfoPanel","isExpanded","setIsExpanded","alignSelf","NumberField","precision","textValue","numberValue","toFixed","ToggleEditModeButton","canStopOwn","canStopOther","isStartedByOther","labSplitPercent","sortDate","elutriation","persistence","getFieldErrors","some","LAB_SPLIT_PERCENT_PRECISION","SampleSorting","sorterUsersProp","sorterUsers","resultSorterUsers","sorterUser","deferredInvalidate","reset","labSplit","round","saveSort","updatedSample","todayDate","toISOString","sorterOptions","canSort","sorting","updateOwn","isLabManager","canSave","Badge","badgeColor","HighlightedText","highlightText","part","highlight","Group","group","labels","borderBottom","Option","inputValue","synonymArea","synonym","slice","ListItem","ActionButton","isDefault","Button","filterOptions","filterableName","TaxonomyField","onAddOrganism","onAddFilter","isOptionsPresented","Autocomplete","attributes","defaultAction","onKeyDown","blur","renderOption","optionProps","gridGap","canAdd","canFilter","onInputChange","clearOnEscape","autoHighlight","noOptionsText","groupBy","status","renderGroup","TaxonomySelectField","isOptionEqualToValue","generateRowId","uniqueId","organismFilters","scrollToRowId","reducer","payload","rowId","fields","existingFilter","organismFilter","singleValueSetter","updateOrganism","organismsColumnDefs","hide","nodeA","nodeB","editable","cellEditor","valueSetter","cellClassRules","lifeStageRankOrder","cellEditorParams","precisionAllowed","colId","comments","pinned","ConfirmDialog","onConfirm","confirmButtonLabel","handleClose","Dialog","DialogTitle","DialogContent","DialogActions","TimeEntryDialog","disableEscapeKeyDown","DialogBody","setTime","hasErrors","handleConfirm","canLeave","NumberEditor","forwardRef","ref","oldValue","canEdit","negativeAllowed","setValue","useImperativeHandle","getValue","isCancelBeforeStart","isCancelAfterEnd","isPopup","newNumber","LifeStageEditor","allowedLifeStages","done","setDone","unshift","LifeStageRenderer","NumberRenderer","TaxonRenderer","NotesAndCommentsRenderer","noteType","marginRight","NotesAndCommentsEditor","oldNoteTypeIds","oldComments","setNoteTypeIds","setComments","fontFamily","ActionsRenderer","organismRow","setDeletionCandidateOrganism","splitCount","bigRareCount","canDuplicate","canDelete","duplicateOrganism","createFilter","PersistenceRenderer","path","stopEditingWhenCellsLoseFocus","SampleTaxonomyIdentification","upsertOrganismIfSavable","dispatch","useReducer","createOrganism","newOrganism","deleteFilter","finishTaxonomyIdentification","setScrollToRowId","deletionCanddateOrganism","gridApis","setGridApis","setColumnVisible","ensureNodeVisible","getTaxonById","organismFilterTaxons","filterTaxonIds","filteredOrganisms","activeLifeStages","taxonName","usedLifeStageIds","taxonOptions","organismTaxonIds","added","available","taxonOption","canIdentify","every","QuickNavigateField","InputProps","trimmedValue","placeholder","isStagingApi","isLocalhost","hostname","AppHeader","openNavigation","hasUser","document","conditionalVisibility","visibility","Connector","UserName","CenteredDiv","Links","links","readOwn","noop","metrics","billing","individuals","times","i","SideNavBar","anchor","profile","href","rel","isNavigationOpenState","setIsNavigationOpen","ErrorBoundary","hasError","modelsColumnDefs","ModelsListing","predictorsColumnDefs","PredictorsListing","isRequired","cell","KnownError","isNumber","isWholeNumber","config","trunc","isNumberBetween","isPositiveNumber","isInList","listName","lists","list","isAcceptableDate","MIN_DATE","Date","isBefore","toShortDateString","divideBy100","setLiteralValue","processor","isSamplePostProcessor","split","separator","fieldName1","fieldName2","fieldValue","part1","part2","isAcceptableLatitudeAndLongitude","rowNumber","problems","setRowNumber","setSampleNumber","sampleNumber","setTemplateVersion","STEP","acceptedTemplateVersions","lookupsWsName","everyCellProcessors","schemasByWsName","ALL","sampleIndex","Benthic","visitId","jarCount","fieldSplit","ecosystemHabitat","sampleDesign","sampleEffortStandardization","areaTime","callback","columnNumber","isRequiredIf","samplerType","meshSize","nhdType","nhdId","notes","fishSpecies","fishLength","fishMass","Zooplankton","netArea","towLength","towType","Drift","duration","velocity","selectLists","samplerTypes","ecosystemHabitats","ecosystemName","habitatName","nhdTypes","processParsedSample","sourceSample","schema","columnKeys","allPromises","findIndex","columnKey","problem","isCellProcessor","processFile","wb","promises","lookupsWs","worksheets","ws","definedNames","model","ranges","range","getCell","getNamedCellValues","firstDataRowNumber","FirstDataRow","TemplateVersion","eachSheet","wsName","getRow","sheetSchema","universalSchema","eachRow","row","sampleProblems","eachCell","includeEmpty","processors","processorFn","err","processedResult","finalProblems","styles","PreparationPage","onDownloadTemplate","FinishedPage","onGoToBoxes","onGoToChainOfCustody","Document","EmptyCell","Table","borders","borderCollapse","PageBreak","pageBreakAfter","Line","longDate","date","shortDate","ChainOfCustodyForm","problemsColumnDefs","valueGetter","col","letters","columnNumberToLetters","UploadFileBox","processingToken","processingStatus","filename","useDropzone","onDrop","acceptedFiles","handleError","processResult","emptyProcessResult","errorMessage","file","reader","FileReader","thisProcessingToken","lastProcessingStatus","onerror","onload","lastFilename","buffer","ArrayBuffer","Excel","Workbook","xlsx","load","readAsArrayBuffer","accept","getRootProps","getInputProps","isDragActive","isPerforming","borderRight","paddingRight","StepPage","active","TEMPLATE_URL","stepTitles","getProblemRowId","idDict","nextId","selectUserOptions","expandJsonState","MessageBlock","CustomerSubmission","expandJson","setExpandJson","countryId","downloadTemplateLinkRef","existingOrganizationId","organizationMode","prepare","activeStep","setActiveStep","handleSubmit","newOrganizationId","createdOrganizationId","newBoxId","finished","canSubmit","hasFatalProblem","hasOnlyRowProblems","hasNoSamples","uploadAttentionMessage","canChangeUser","canChangeOrganization","stepTitle","s","review","upload","download","click","component","FormLabel","RadioGroup","_","Radio","th","td","onGoToBoxDetail","projectsColumnDefs","ProjectsListing","projectDetail","owner","projectCreate","translationsColumnDefs","TranslationsListing","ChainOfCustody","autoPrint","print","FullScreenWait","CircularProgress","RolesField","hideRoleLevel","hiddenIds","hiddenValue","uniq","UserDetail","userPhone","deleteOldOrganization","operatorUser","systemAdminRoleLevel","canUpdateOwnUser","canUpdateAnyUser","isNewUser","isOtherSystemAdmin","roleId","isEditable","isEditingUserFields","isEditingOrganizationFields","isShowingAdminOnlyControls","isShowingDeleteOldOrganization","onSave","isAffiliationChanged","lastValues","MyUserDetail","NewUserDetail","usersColumnDefs","UsersListing","userDetail","role","DateField","selectBoxOptions","optionLabel","chipLabel","selectProjectOptions","selectTypeOptions","typeNames","selectMethodOptions","methodNames","methodName","CriterionAutocomplete","BoxCriterionField","UsStateCriterionField","OrganizationCriterionField","ProjectCriterionField","thisProjectId","allProjectOptions","TaxonomyCriterionField","t","SampleIdsCriterionField","isFocused","setIsFocused","setValueFromText","onFocus","onBlur","maxRows","TypeCriterionField","MethodCriterionField","minimalSamplesByIdAtom","ModifyProjectSamples","initialMode","onOperatingChange","onSamplesAdded","onSamplesRemoved","thisProjectName","initialSamples","boxCriterion","setBoxCriteron","usStateCriterion","setUsStateCriterion","taxonCriteria","setTaxonCriteria","organizationCriterion","setOrganizationCriterion","projectCriterion","setProjectCriterion","sampleIdsCriterion","setSampleIdsCriterion","fromDate","setFromDate","toDate","setToDate","typeCriterion","setTypeCriterion","methodCriterion","setMethodCriterion","thisProjectSamples","setThisProjectSamples","candidateSamples","setCandidateSamples","resultsMessage","setResultsMessage","displayFilters","setDisplayFilters","isOperating","setIsOperating","mode","setMode","isAddMode","minimalSamplesById","setMinimalSamplesById","getSamplesByBoxId","catch","getSamplesByProjectId","getSamplesByUsStateId","getSamplesByTaxonId","getSamplesByOrganizationId","handleAdd","targetIds","sampleIds","splice","handleRemove","criteriaFilters","thisProjectFilters","sourcePromises","cancelled","usefulPromises","fetchIds","needId","fetchPromise","fetchMinimalSamplesByIds","newOrderedSamplePromises","fetchId","resolvedSamplesOrUndefineds","isAddModeWithoutSource","thisProjectSampleIds","filteredSamples","operableCount","firstSource","intersectionBy","matchedCount","isBothDatesError","ToggleButtonGroup","newMode","exclusive","ToggleButton","downloadWorkbook","workbook","writeBuffer","blob","Blob","saveAs","ProjectSamples","canModify","modifyMode","setModifyMode","handleCloseModify","columns","addWorksheet","addRows","column","columnValues","lengths","views","xSplit","ySplit","activeCell","createSingleTableWorkbook","fullWidth","ProjectSitesMapPreview","ConfirmationDialog","cancelLabel","confirmLabel","userOptions","labelCount","ProjectDetail","isNewProject","contactId","isPrivate","isConfirmDeleteOpen","setIsConfirmDeleteOpen","isDeleting","handleSave","projectInput","handleDelete","TAXONOMIST_COLUMNS","columnConfig","downloadBoxTaxaReport","taxonomistNames","record","updatedColumnConfig","tableHeaderRowNumber","addTable","headerRow","theme","showRowStripes","filterButton","BoxTaxonomySelectField","skeleton","BoxTaxonomy","taxaLoadable","useRecoilValueLoadable","fromTaxonomyId","setFromTaxonomyId","toTaxonomyId","setToTaxonomyId","isWorking","setIsWorking","isConfirmOpen","setIsConfirmOpen","setTaxa","hasTaxa","toPromise","isSameIdError","boxTaxonIds","addedTaxonOptions","availableTaxonOptions","fromBoxTaxon","toTaxon","toBoxTaxon","handleReconcile","makeBoxTaxonomyColumnDefs","canReconcileTaxa","cancelNotification","makeNavigateFn","history","openNewWindowTo","home","navigateState","url","isFormPath","pathname","AppRouter","setNavigate","useHistory","formLayout","setFormLayout","listen","exact","render","isNew","ConfirmNavigateAway","listener","returnValue","addEventListener","removeEventListener","when","setApi","apiInstance","App","AppAuthConnect","authInfo","setAuthInfo","isAppPreLoading","setIsAppPreLoading","useHostedAuth","authCheck","authResp","authVals","region","userPoolId","userPool","userPoolWebClientId","clientId","mandatorySignIn","oauth","scope","redirectSignIn","redirectSignOut","responseType","isAuthenticated","isAuthComplete","signIn","reportWebVitals","onPerfEntry","Function","getCLS","getFID","getFCP","getLCP","getTTFB","mapboxgl","workerClass","require","requestedLogLevel","REACT_APP_LOGLEVEL","setLevel","ReactDOM","StrictMode","getElementById"],"mappings":"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","file":"static/js/main.fbaa4524.chunk.js","sourcesContent":["export { default as useHostedAuth } from './hooks/useHostedAuth';\n//# sourceMappingURL=index.js.map","\"use strict\";\nvar __createBinding = (this && this.__createBinding) || (Object.create ? (function(o, m, k, k2) {\n    if (k2 === undefined) k2 = k;\n    Object.defineProperty(o, k2, { enumerable: true, get: function() { return m[k]; } });\n}) : (function(o, m, k, k2) {\n    if (k2 === undefined) k2 = k;\n    o[k2] = m[k];\n}));\nvar __exportStar = (this && this.__exportStar) || function(m, exports) {\n    for (var p in m) if (p !== \"default\" && !Object.prototype.hasOwnProperty.call(exports, p)) __createBinding(exports, m, p);\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.NAMCResource = exports.GrantAction = void 0;\n__exportStar(require(\"./lookupTypes\"), exports);\nvar GrantAction;\n(function (GrantAction) {\n    GrantAction[\"createAny\"] = \"createAny\";\n    GrantAction[\"createOwn\"] = \"createOwn\";\n    GrantAction[\"readAny\"] = \"readAny\";\n    GrantAction[\"readOwn\"] = \"readOwn\";\n    GrantAction[\"updateAny\"] = \"updateAny\";\n    GrantAction[\"updateOwn\"] = \"updateOwn\";\n    GrantAction[\"deleteAny\"] = \"deleteAny\";\n    GrantAction[\"deleteOwn\"] = \"deleteOwn\";\n})(GrantAction = exports.GrantAction || (exports.GrantAction = {}));\nvar NAMCResource;\n(function (NAMCResource) {\n    NAMCResource[\"billing\"] = \"billing\";\n    NAMCResource[\"boxes\"] = \"boxes\";\n    NAMCResource[\"communications\"] = \"communications\";\n    NAMCResource[\"individualRoles\"] = \"individual_roles\";\n    NAMCResource[\"individuals\"] = \"individuals\";\n    NAMCResource[\"metrics\"] = \"metrics\";\n    NAMCResource[\"models\"] = \"models\";\n    NAMCResource[\"organisms\"] = \"organisms\";\n    NAMCResource[\"organizations\"] = \"organizations\";\n    NAMCResource[\"projects\"] = \"projects\";\n    NAMCResource[\"qaqc\"] = \"qaqc\";\n    NAMCResource[\"samples\"] = \"samples\";\n    NAMCResource[\"sites\"] = \"sites\";\n    NAMCResource[\"submissions\"] = \"submissions\";\n    NAMCResource[\"taxonomy\"] = \"taxonomy\";\n    NAMCResource[\"translations\"] = \"translations\";\n    NAMCResource[\"sorting\"] = \"sorting\";\n})(NAMCResource = exports.NAMCResource || (exports.NAMCResource = {}));\n//# sourceMappingURL=types.js.map","\"use strict\";\nvar __makeTemplateObject = (this && this.__makeTemplateObject) || function (cooked, raw) {\n    if (Object.defineProperty) { Object.defineProperty(cooked, \"raw\", { value: raw }); } else { cooked.raw = raw; }\n    return cooked;\n};\nvar __importDefault = (this && this.__importDefault) || function (mod) {\n    return (mod && mod.__esModule) ? mod : { \"default\": mod };\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.queryLimits = void 0;\nvar graphql_tag_1 = __importDefault(require(\"graphql-tag\"));\nvar lookups_graphql_1 = __importDefault(require(\"./lookups.graphql\"));\nexports.queryLimits = {\n    samples: 1000,\n    sites: 1000,\n    boxes: 1000,\n    projects: 1000,\n    taxonomy: 1000,\n    predictors: 500,\n    models: 500,\n    organizations: 500,\n    sitePredictorValues: 500,\n    modelResults: 500,\n    translations: 500,\n    metrics: 1000,\n    mapSites: 10000,\n};\nvar entityFields = \"\\n        entityId: Int\\n        parentId: Int\\n        \\\"Street address line 1.\\\"\\n        address1: String\\n\\n        \\\"Street address line 2.\\\"\\n        address2: String\\n\\n        \\\"City.\\\"\\n        city: String\\n\\n        \\\"US State. Null for international organizations.\\\"\\n        usState: String\\n\\n        \\\"Country.\\\"\\n        country: String\\n\\n        \\\"Postal code.\\\"\\n        zipCode: String\\n\\n        \\\"Telephone number with area code. Format (xxx) xxx-xxxx\\\"\\n        phone: String\\n\\n        \\\"Fax number. Format (xxx) xxx-xxxx\\\"\\n        fax: String\\n\\n        \\\"Organization's website URL. Includes the http:// or https:// prefix.\\\"\\n        website: String\\n\\n        \\\"Miscellaneous information about the organization.\\\"\\n        notes: String\\n\\n        \\\"Miscellaneous information about stored as [JSON](https://namc-utah.github.io/namc-bug-db/API/metadata.html). Typically used during scripting and automated processes.\\\"\\n        metadata: String\\n\\n        \\\"Date and time that the organization was added to the database.\\\"\\n        createdDate: String\\n\\n        \\\"Date and time that the organization was last updated in the database.\\\"\\n        updatedDate: String\\n\";\nvar typeDefs = (0, graphql_tag_1.default)(templateObject_1 || (templateObject_1 = __makeTemplateObject([\"\\n\\n    scalar JSONObject\\n\\n    schema {\\n        query: Query\\n        mutation: Mutation\\n    }\\n\\n    # enum LogLevel {\\n    #   DEBUG\\n    #   ERROR\\n    #   INFO\\n    #   WARN\\n    # }\\n\\n    type Query {\\n        # Get a project and associated metadata\\n        auth: AuthParams\\n\\n        lookups: Lookups\\n\\n        submissionData(submissionId: Int): JSONObject\\n\\n        # disabled for now.\\n        # log(level: LogLevel, message: String, context: JSONObject): Boolean\\n\\n        \\\"API endpoint that calls entity.fn_organization_search\\\"\\n        organizations(limit: Int = \", \", offset: Int = 0): PaginatedOrganizations\\n        organizationsById(limit: Int = \", \", offset: Int = 0, ids: [Int]): PaginatedOrganizations\\n\\n        user(id: Int!): Individual\\n        users(limit: Int = \", \", offset: Int = 0): PaginatedIndividuals\\n\\n        # user(userId: Int): Individual\\n\\n        ####################################################################################################################################################################################\\n        # Geo queries\\n\\n        \\\"Detailed information about a single site. Includes the point location and upstream catchment geometries as [GeoJSON](https://namc-utah.github.io/namc-bug-db/API/geojson.html).\\\"\\n        siteInfo(siteId: Int!): SiteInfo\\n\\n        \\\"Detailed information about a single model, including the number of predictors associated with the model.\\\"\\n        modelInfo(modelId: Int!): ModelInfo\\n\\n        \\\"List of all model conditions (e.g. good, fair, poor) for a particular model\\\"\\n        modelConditions(modelId: Int!, limit: Int = \", \", offset: Int = 0): PaginatedModelConditions\\n\\n        ####################################################################################################################################################################################\\n        # Sample queries\\n\\n        \\\"Detailed information about a single box, including information about the customer and number of samples associated with the box.\\\"\\n        boxInfo(boxId: Int!): BoxInfo\\n\\n        \\\"\\\"\\\"\\n        The samples API endpoint returns a set of samples that satisfty one of the mandatory arguments.\\n\\n        The samples API endpoint returns a set of samples that satisfty one of the mandatory arguments. You can request all samples associated with one or more boxes, or all samples belonging to a particular customer or project.\\n\\n        Note that samples associated with completed boxes should have the same sample ID in the new database as they had in the Pilot database. However, any samples associated with boxes that were incomplete at the time of the data migration are assigned new sample IDs in the new database; they will not match those in either BugLab or Pilot.\\n        \\n        **You must provide exactly one of the arguments**, either a list of sample IDs, box IDs, entity IDs, site IDs, a polygon or a point and distance.\\n        You will get an error if you fail to provide at least one of these arguments!\\n        You also can't provide multiple arguments (i.e. both sample IDs and box IDs).\\n        And finally, you can't provide an empty list of IDs.\\n        \\\"\\\"\\\"\\n        samples(limit: Int = \", \", offset: Int = 0 , \\n        \\n            \\\"List of integer sample IDs.\\\"\\n            sampleIds: [Int], \\n            \\n            \\\"List of integer box IDs. Returns all samples associated with the specified box(es).\\\"\\n            boxId: Int,\\n            \\n            \\\"List of integer project IDs. Returns all samples associated with the specified project(s).\\\"\\n            projectId: Int,\\n\\n            entityId: Int, \\n            taxonomyId: Int, \\n            usStateId: Int\\n        \\n        ): PaginatedSamples\\n        \\\"\\\"\\\"\\n        Summary information for all sites, including location coordinates and number of samples.\\n        Use the siteInfo query to get more detailed information about a single site, including the catchment as a [GeoJSON](https://namc-utah.github.io/namc-bug-db/API/geojson.html) polygon.\\n        \\n        The sites returned in this query are the official NAMC sites. If you want the actual locations of sites at which\\n        samples were collected then use the samples API endpoint and the customerLocation fields. \\n        \\\"\\\"\\\"\\n        sites(limit: Int = \", \", offset: Int = 0, \\n        \\n            \\\"Two letter abbreviation of the US State. Returns all sites within the state.\\\"\\n            usState: [String],\\n            \\n            \\\"List of integer sample IDs. Returns the list of sites for the sample(s).\\\"\\n            sampleIds: [Int],\\n            \\n            \\\"List of integer Box IDs. Returns the sites at which samples within the box(es) were collected.\\\"\\n            boxIds: [Int],\\n            \\n            \\\"List of integer project IDs. Returns the sites at which samples within the project(s) were collected.\\\"\\n            projectIds: [Int],\\n            \\n            \\\"List of integer customer IDs. Returns all samples belonging to the customer(s). Note that customer organizations are hierarchical. If you provide the customer ID for the BLM you will get back all samples for the entire BLM (i.e. all states and all field offices). If you provide the customer ID for the Colorado BLM you will get back all samples belonging to field offices within the state of Colorado.\\\"\\n            entityIds: [Int],\\n            \\n            \\\"List of integer site IDs. Returns the specified sites.\\\"\\n            siteIds: [Int], \\n            \\n            \\\"[GeoJSON](https://namc-utah.github.io/namc-bug-db/API/geojson.html) polygon. Returns all sites within the polygon.\\\"\\n            polygon: String,\\n            \\n            \\\"Point defined as latitude and longitude in decimal degrees) and distance (meters). Returns all sites within the specified distance of the point.\\\"\\n            pointDistance: QueryDistance\\n        \\n        ): PaginatedSites\\n        \\n        \\\"\\\"\\\"\\n        The boxes API endpoint returns a set of boxes that satisfty one of the mandatory arguments.\\n        You can request boxes by specifying a list of box IDs, or by specifying a list of customers.\\n\\n        Note that Box IDs are retained from the old NAMC database.\\n        A box with a specific ID in either the BugLab or Pilot database should have the same ID in the new database.\\n        \\\"\\\"\\\"\\n        boxes(limit: Int = \", \", offset: Int = 0,\\n        \\n            \\\"List of integer box IDs. Returns the specified box(es).\\\"\\n            boxIds: [Int],\\n            \\n            \\\"List of integer customer IDs. Returns all boxes belonging to the customer(s). Note that customer organizations are hierarchical. If you provide the customer ID for the BLM you will get back all samples for the entire BLM (i.e. all states and all field offices). If you provide the customer ID for the Colorado BLM you will get back all samples belonging to field offices within the state of Colorado.\\\"\\n            entityIds: [Int]\\n        \\n        ): PaginatedBoxes\\n\\n        userBoxes(limit: Int = \", \", offset: Int = 0): PaginatedBoxes\\n\\n        \\\"\\\"\\\"\\n        The projects API endpoint returns a set of all projects in the database.\\n        Projects are intended to be flexible containers that make it easy to work with custom collections of samples.\\n        API users can create projects, add and remove samples to a project.\\n        Each sample can be associated with multiple projects. \\n        \\\"\\\"\\\"\\n        projects(limit: Int = \", \", offset: Int = 0): PaginatedProjects\\n\\n        \\\"\\\"\\\"\\n        List of all predictors in the system.\\n        Includes summary information about how many models rely on each predictor.\\n        \\\"\\\"\\\"\\n        predictors(limit: Int = \", \", offset: Int = 0,\\n        \\n            \\\"Optional integer model ID. Returns only predictors associated with this model.\\\"\\n            modelId: Int\\n        \\n        ): PaginatedPredictors\\n\\n        \\\"\\\"\\\"\\n        List of all models in the system.\\n        Includes summary information about how many predictors are used by the model\\n        as well as the translation that is be required.\\n\\n        Use the modelInfo API endpoint for more detailed information about a specific model, including its model extent polygon.\\n        \\\"\\\"\\\"\\n        models(limit: Int = \", \", offset: Int = 0): PaginatedModels\\n\\n        \\\"\\\"\\\"\\n        List of predictor values at a single site.\\n        Site predictors are non-temporal.\\n        The value applies to all samples collected at the specific site.\\n\\n        See samplePredictors for temporal predictors that vary by the sample date.\\n        \\\"\\\"\\\"\\n        sitePredictorValues(\\n            \\n            \\\"Mandatory site ID for which predictor values are required.\\\"\\n            siteId: Int!,\\n            \\n            limit: Int = \", \", offset: Int = 0\\n        \\n        ): PaginatedSitePredictorValues\\n\\n        \\\"\\\"\\\"\\n        List of all predictor values for a single sample.\\n        This includes both temporal and non-temporal predictors as well as their calculation status (current, missing, expired).\\n        \\\"\\\"\\\"\\n        samplePredictorValues(\\n            \\n            \\\"Mandatory integer Sample ID for which sample predictor values are required.\\\"\\n            sampleId: Int!\\n        ): PaginatedSamplePredictorValue\\n\\n        \\\"\\\"\\\"\\n        Returns all model results for the specified sample(s).\\n        Model results refer to the outputs of running one of the O2E, MMI or physical models (temperature, phosphoros, water quality).\\n        \\\"\\\"\\\"\\n        modelResults(limit: Int = \", \", offset: Int = 0,\\n        \\n            \\\"Mndatory list of integer sample IDs for which to return model results.\\\"\\n            sampleIds: [Int]!\\n        \\n        ): PaginatedModelResult\\n\\n        ####################################################################################################################################################################################\\n        # Taxonomy queries\\n\\n        \\\"\\\"\\\"\\n        List of all taxa in the system.\\n        Includes information about each level of the taxonomic hierarchy above each taxa.\\n        \\\"\\\"\\\"\\n        taxonomy(limit: Int = \", \", offset: Int = 0,\\n        \\n            \\\"\\\"\\\"\\n            Optional search term to filter the taxa returned.\\n            SQL wildcards are permited.\\n            i.e. to find taxa starting with Clor use 'Clor%'.\\n            To search for clor anywhere in the name of a taxa uses '%clor%'.\\n            An asterix can also be used to wildcard a single character.\\n\\n            Search terms are case insensitive.\\n            \\\"\\\"\\\"\\n            searchTerm: String\\n        \\n            taxonomyIds: [Int]\\n\\n        ): PaginatedTaxonomies\\n\\n        \\\"\\\"\\\"\\n        List of all taxonomic attributes (e.g. clinger, swimmer, HBI) in the system.\\n\\n        Use the taxaAttributes endpoint if you want the attribute values for a specific taxon.\\n        \\\"\\\"\\\"\\n        attributes(limit: Int = \", \", offset: Int = 0): PaginatedAttributes\\n\\n        \\\"\\\"\\\"\\n        List of all attribute values for a single taxon.\\n\\n        Use the taxonomy API endpoint to discover the taxonomy ID for a particular taxon.\\n        \\\"\\\"\\\"\\n        taxaAttributes(\\n            \\n            \\\"\\\"\\\"\\n            Mandatory integer taxonomy ID for which attributes are required.\\n            \\n            Use the taxonomy API endpoint to discover the taxonomy ID for a particular taxon.\\n            \\\"\\\"\\\"\\n            taxonomyId: Int, limit: Int = \", \", offset: Int = 0): PaginatedAttributeValues\\n  \\n        \\\"\\\"\\\"\\n        List all the taxa within a specific translation (OTU)\\n\\n        The taxa associated with a translation are only those taxa at which organism counts are rolled.\\n        In other words a translation in the database does not store every taxa included in an OTU,\\n        only those taxa at which counts are roll up to.\\n\\n        For example, an OTU might include many species, genus and families that all roll up to a single \\n        order. In the database, the translation is defined with only a single taxon, that of the order.\\n        Any taxa below this order are automatically rolled up to this order during processing.\\n\\n        See the [online documentation on translations](https://namc-utah.github.io/namc-bug-db/translations.html) for more information.\\n        \\\"\\\"\\\"\\n        translationTaxa(limit: Int = \", \", offset: Int = 0, \\n        \\n            \\\"\\\"\\\"\\n            Mandatory integer translation ID for which you require taxa.\\n\\n            Use the translations API endpoint to discover the database IDs for each translation.\\n            \\\"\\\"\\\"\\n            translationId: Int!\\n        \\n        ): PaginatedTranslationTaxa\\n       \\n        \\\"\\\"\\\"\\n        List of all translations (OUT) in the system.\\n        Translations have replaced OTUs in the new database.\\n     \\n        See the [online documentation on translations](https://namc-utah.github.io/namc-bug-db/translations.html) for more information.\\n        \\\"\\\"\\\"\\n        translations(limit: Int = \", \", offset: Int = 0): PaginatedTranslations\\n\\n        ####################################################################################################################################################################################\\n        # Sample side table queries\\n\\n        \\\"List of all plankton samples in the system.\\\"\\n        planktonSamples(limit: Int = \", \", offset: Int = 0): PaginatedPlankton\\n\\n        \\\"List of all drift samples in the system.\\\"\\n        driftSamples(limit: Int = \", \", offset: Int = 0): PaginatedDrift\\n\\n        \\\"List of all fish samples in the system.\\\"\\n        fishSamples(limit: Int = \", \", offset: Int = 0): PaginatedFish\\n\\n        \\\"List of all mass samples in the system.\\\"\\n        massSamples(limit: Int = \", \", offset: Int = 0): PaginatedMass\\n\\n        # \\\"List all fish diet samples in the system\\\"\\n        # fishDiet(limit: Int = \", \", offset: Int = 0, sampleIds: [Int]): PaginatedFishDiet\\n\\n        ####################################################################################################################################################################################\\n        # Sample Taxa queries\\n        \\n\\n        sampleTaxaAttributes(limit: Int = \", \", offset: Int = 0, \\n          \\\"List of integer sample IDs.\\\"\\n          sampleIds: [Int], \\n\\n          \\\"List of integer box IDs. Returns all samples associated with the specified box(es).\\\"\\n          boxIds: [Int],\\n\\n          \\\"List of integer project IDs. Returns all samples associated with the specified project(s).\\\"\\n          projectIds: [Int],\\n\\n          \\\"List of integer customer IDs. Returns all samples belonging to the customer(s). Note that customer organizations are hierarchical. If you provide the customer ID for the BLM you will get back all samples for the entire BLM (i.e. all states and all field offices). If you provide the customer ID for the Colorado BLM you will get back all samples belonging to field offices within the state of Colorado.\\\"\\n          entityIds: [Int],\\n\\n          \\\"List of integer site IDs. Returns all samples collected at the site(s).\\\"\\n          siteIds: [Int],\\n\\n          \\\"[GeoJSON](https://namc-utah.github.io/namc-bug-db/API/geojson.html) polygon. Returns all samples collected at sites within the polygon.\\\"\\n          polygon: String,\\n\\n          \\\"Point defined as latitude and longitude in decimal degrees) and distance (meters). Returns all samples collected within the specified distance of the point.\\\"\\n          pointDistance: QueryDistance\\n\\n        ): PaginatedSampleTaxaAttribute\\n\\n        \\\"\\\"\\\"\\n        Sample organisms summed by taxonomy, life stage and bug size. This is a more detailed query that provides\\n        access to the raw organism counts.\\n        \\n        Raw organism counts are summed by laboratory taxon, bug size and lifestage. No conversion to abundance is applied.\\n        \\\"\\\"\\\"\\n        sampleTaxa(\\n            \\n            \\\"Mandatory integer sample ID\\\"\\n            sampleIds: [Int],\\n\\n            boxId: Int,\\n\\n            projectId: Int,\\n            \\n            limit: Int = \", \", \\n            \\n            offset: Int = 0\\n        ): PaginatedSampleTaxaInfo\\n        \\\"\\\"\\\"\\n        Sample organisms converted to a translation (OTU).\\n\\n        This query first converts each organism to an abundance using lab and field splits and then rolls\\n        up the abundance to those taxa present in the translation.\\n        Any organism that does not rollup to a taxon present in the specified translation is omitted.\\n\\n        See the [online documentation on translations](https://namc-utah.github.io/namc-bug-db/translations.html) for more information.      \\n        \\\"\\\"\\\"\\n        sampleTaxaTranslation(\\n            \\n            \\\"Mandatory integer sample ID\\\"\\n            sampleIds: [Int],\\n\\n            boxId: Int,\\n\\n            projectId: Int,\\n\\n            \\\"Mandatory translation (OTU) ID. Use the translations API endpoint to obtain the database IDs for each translation.\\\"\\n            translationId: Int!\\n            limit: Int = \", \", \\n            offset: Int = 0\\n        ): PaginatedSampleTaxaTranslated\\n\\n        \\\"\\\"\\\"\\n        Sample organisms converted to the translation (OTU) and then rarefied to the specified fixed count.\\n\\n        organism are first grouped by laboratory taxa (ignoring bug size, life sage and big rare count) and then\\n        converted to abundance. Taxa are then converted to the specified translation (OTU) rolling up to the next\\n        highest taxa present in the translation. Organisms that don't roll up to a taxa present in the translation\\n        are omitted.\\n        \\n        The abundances are expanded to create one record for each organism, from which random\\n        selections are made until the fixed count is achieved. If the total number of organisms is less than the \\n        fixed count then all records are returned. Finally the selected records are re-grouped by translation\\n        taxa, summing the abundances.\\n        \\\"\\\"\\\"\\n        sampleTaxaTranslationRarefied(\\n            sampleIds: [Int],\\n\\n            \\\"Mandatory integer sample ID\\\"\\n            boxId: Int,\\n\\n            projectId: Int,\\n            \\n            \\\"Mandatory translation (OTU) ID. Use the translations query to obtain the database IDs for each translations.\\\"\\n            translationId: Int!,\\n            \\n            \\\"The total count of organisms to be returned (across all taxa). The actual total might be less if the sample contains fewer organisms than the specified fixed count.\\\"\\n            fixedCount:Int!\\n\\n            limit: Int = \", \", \\n            offset: Int = 0\\n        \\n        ):PaginatedSampleTaxaTranslated\\n\\n        sampleTaxaUnambiguous(\\n            sampleIds: [Int],\\n\\n            \\\"Mandatory integer sample ID\\\"\\n            boxId: Int,\\n\\n            projectId: Int,\\n            \\n            limit: Int = \", \", \\n            offset: Int = 0\\n        \\n        ):PaginatedSampleTaxa\\n\\n        ####################################################################################################################################################################################\\n        # Metric queries\\n\\n        \\\"\\\"\\\"\\n        Returns a list of all metrics defined in the system. \\n        \\\"\\\"\\\"\\n        metrics(limit: Int = \", \", offset: Int = 0): PaginatedMetrics\\n\\n        \\\"\\\"\\\"\\n        Calculates active metrics for the sample using the specified translation and fixed count.\\n        Note that the values returned are not stored in the database. They are calculated anew with each API\\n        request. Metrics that depend on rarefaction will be different with each subsequent request.\\n\\n        Metrics can be calculated for a list of samples, boxes or projects. You must provide one of these\\n        lists or an error is returned. You cannot provide more than one list (e.g. a list of samples and a list of projects).\\n        The list provided cannot be empty.\\n\\n        Use the projects and translations (OTU) API endpoints to determine the database IDs for these arguments.\\n        \\\"\\\"\\\"\\n        # sampleMetrics(\\n            \\n        #     \\\"List of integer sample IDs\\\"\\n        #     sampleIds: [Int],\\n            \\n        #     \\\"List of integer box IDs. All boxes associated with the box(es) are returned.\\\"\\n        #     boxIds: [Int],\\n            \\n        #     \\\"List of integer project IDs. All samples associated with the project(s) are returnded.\\\"\\n        #     projectIds: [Int],\\n            \\n        #     \\\"Mandatory integer translation (OTU) ID\\\"\\n        #     translationId: Int!,\\n            \\n        #     \\\"Mandatory total number of organisms to be used by those metrics that use rarefaction.\\\"\\n        #     fixedCount: Int!\\n        # ): PaginatedMetricResult\\n\\n        # Query for populating the sites map UI\\n        mapSites(limit: Int = \", \", offset: Int = 0): PaginatedMapSites\\n\\n        sampleMetrics(limit: Int = \", \", offset: Int = 0\\n          sampleIds: [Int]\\n          projectId: Int,\\n          boxId: Int,\\n          translationId: Int!,\\n          fixedCount: Int!,\\n        ): PaginatedMetricResult\\n\\n        boxTaxa(limit: Int = \", \", offset: Int = 0,\\n          boxId: Int!\\n        ): PaginatedBoxTaxa\\n\\n        # Retrieve the currently logged in user's account information and permissions\\n        myProfile: Profile\\n\\n        # Retrieve a list of users that can perform sort operations\\n        sorters: [SortingUser]\\n\\n        getUSState(longitude: Float!, latitude: Float!): USState\\n    }\\n\\n    # this schema allows the following mutation:\\n    type Mutation {\\n        \\n        \\\"\\\"\\\"\\n        Store a non-temporal predictor value for a specific site. Non-temporal predictors do not vary over time. There is a\\n        single value per site.\\n\\n        See setSamplePredictorValue if you want to store a temporal predictor value associated with a particular sample.\\n        \\\"\\\"\\\"\\n        setSitePredictorValue(\\n            \\n            \\\"Mandatory Integer site ID\\\"\\n            siteId: Int!,\\n            \\n            \\\"Mandatory predictor ID. See predictors endpoint to identify the ID for a predictor.\\\"\\n            predictorId: Int!, \\n            \\n            \\\"Mandatory site predictor value. The value should be a floating point value represented as a string.\\\"\\n            value:String!\\n            \\n        ): Int\\n\\n        \\\"\\\"\\\"\\n        Store a temporal predictor value for a specific sample. Temporal predictors vary over time and correspond to the sample date of a sample.\\n\\n        This endpoint returns the number of rows saved to the database. 1 indicates sucess, 0 indicates something went wrong and the value cannot be stored.\\n        \\n        See setSitePredictorValue if you want to store a temporal predictor value associated with a particular site.\\n        \\\"\\\"\\\"\\n        setSamplePredictorValue(\\n            \\n            \\\"Mandatory integer sample ID\\\"\\n            sampleId: Int!,\\n            \\n            \\\"Mandatory predictor ID. See predictors endpoint to identify the ID for a particular predictor.\\\"\\n            predictorId: Int!,\\n            \\n            \\\"The predictor value should be a single floating point value represented as a string.\\\"\\n            value: String!\\n        \\n        ): Int\\n\\n        \\\"\\\"\\\"\\n        Store the upstream catchment polygon for a specific site.\\n        The catchment polygon must be a valid, non-empty \\n        [GeoJSON](https://namc-utah.github.io/namc-bug-db/API/geojson.html) polygon that partially or entirely intersects with the United States.\\n     \\n        This endpoint returns the number of rows saved to the database. 1 indicates sucess, 0 indicates something went wrong and the value cannot be stored.\\n        \\\"\\\"\\\"\\n        setSiteCatchment(\\n            \\n            \\\"ID that uniquely identifies the site\\\"\\n            siteId: Int!,\\n            \\n            \\\" [GeoJSON](https://namc-utah.github.io/namc-bug-db/API/geojson.html) polygon that partially or entirely intersects with the United States.\\\"\\n            catchment: String!\\n        \\n        ): Int\\n\\n        \\\"\\\"\\\"\\n        Create a new translation (OTU). The name is mandatory and cannot be an empty string. The description is optional.\\n\\n        The translation name must also be unique across the entire database. Use the translations endpoint to see a list\\n        of all existing translations in the database.\\n\\n        After creating the translation, use the setTranslationTaxa endpoint to associate taxa with this translation.\\n\\n        This endpoint returns the database ID assigned to the new translation.\\n        \\\"\\\"\\\"\\n        createTranslation(\\n            \\n            \\\"Name for the new translation. Cannot be empty and must be unique across all translations in the database.\\\"\\n            translationName: String!,\\n            \\n            \\\"Optional descriptive information about the translation.\\\"\\n            description: String\\n        \\n        ): Int\\n\\n        \\\"\\\"\\\"\\n        Add or update a taxa associated with a translation (OTU)\\n\\n        See information on [translations](https://namc-utah.github.io/namc-bug-db/translations.html) for which taxa\\n        to add to a translation.\\n\\n        If the specified taxa already exists within a translation, this endpoint will update it's alias and isFinal\\n        status. If the taxa does not already exist within the translation it will be added.\\n\\n        This endpoint returns the number of rows saved to the database. 1 indicates sucess, 0 indicates something went wrong and the value cannot be stored.\\n        \\\"\\\"\\\"\\n        setTranslationTaxa(\\n            \\n            \\\"Unique identifier of the translation (OTU). Use the translations endpoint to determine the ID associated with each translation.\\\"\\n            translationId: Int!, \\n            \\n            \\\"Unique identifier of the taxon being stored in the translation. Use the taxonomy endpoint to determine the IDs for individual taxa.\\\"\\n            taxonomyId: Int!, \\n            \\n            \\\"\\\"\\\"\\n            Optional name that should be used to identify the taxon within the translation.\\n            If this alias is left blank then the official NAMC scientific name is used for the taxon within the translation.\\n            \\\"\\\"\\\"\\n            alias:String,\\n            \\n            \\\"\\\"\\\"Identifies if the taxon is part of the final set used to calibrate the model associated with the translation (OTU).\\n            When isFinal is False it indicates that the taxon is part of the larger, initial list used to develop the model\\n            but not part of the final calibration set of taxa.\\\"\\\"\\\"\\n            isFinal: Boolean\\n        ): Int\\n\\n        \\\"\\\"\\\"\\n        Permanently remove a taxon from a translation.\\n\\n        The definition of the taxon remains in the database. It is merely it's association with the translation that is removed.\\n\\n        This endpoint returns the number of rows saved to the database. 1 indicates sucess, 0 indicates something went wrong and the change cannot be performed. \\n        \\\"\\\"\\\"\\n        deleteTranslationTaxa(\\n            \\n            \\\"Unique identifier of the translation (OTU). Use the translations endpoint to determine the ID associated with each translation.\\\"\\n            translationId: Int!,\\n            \\n            \\\"Unique identifier of the taxon being stored in the translation. Use the taxonomy endpoint to determine the IDs for individual taxa.\\\"\\n            taxonomyId: Int!\\n        ): Int\\n  \\n        \\\"\\\"\\\"\\n        Update information related to a specific taxon. Change its scientific name, move its level or change its parent taxon.\\n\\n        See the taxonomy endpoint to determine the unique taxonomy ID for a specific taxon.\\n\\n        See createTaxonomy endpoint for adding new taxa.\\n\\n        This endpoint returns the number of rows saved to the database. 1 indicates sucess, 0 indicates something went wrong and the change cannot be performed. \\n        \\\"\\\"\\\"\\n        setTaxonomy(taxonomyId: Int!, scientificName: String!, levelId: Int!, parentId: Int!, author: String, year:String, notes: String, metadata:String): Int\\n\\n        \\\"\\\"\\\"\\n        The createProject API endpoint creates a new project in the database.\\n        Projects are intended to be flexible containers that make it easy to work with custom collections of samples.\\n        API users can add and remove samples to a project. Each sample can be associated with multiple projects. \\n\\n        New projects are created with no associated samples.\\n        You must call the [add samples]({{ site.baseurl}}/API/Projects/addProjectSamples.html) API endpoint before the project is useful.\\n       \\n        This endpoint returns the database ID associated with the new project, for use in other endpoints.\\n        \\\"\\\"\\\"\\n        createProject(project: ProjectInput!): Int\\n\\n        updateProject(id: Int!, project: ProjectInput!): Int\\n\\n        \\\"\\\"\\\"\\n        This API endpoint associates samples with a project. The project must already exist and have been created using the [createProject]({{site.baseurl}}/API/Projects/createProject.html) API end point.\\n\\n        Only existing samples can be associated with a project (i.e. this endpoint does not create new samples). Each sample can be associated with multiple projects.  \\n\\n        If the sample is already associated with the project then no action is taken.\\n\\n        This endpoint returns the number of rows saved to the database. 0 indicates something went wrong and the change cannot be performed.   \\n        \\\"\\\"\\\"\\n        addProjectSamples(\\n            \\n            \\\"Project ID of a project that already exists in the system. Use the projects query to determine the ID of an existing project.\\\"\\n            projectId: Int!,\\n\\n            \\\"List of sample IDs to be associated with the project.\\\"\\n            sampleIds: [Int]\\n        \\n        ): Int\\n\\n        \\\"\\\"\\\"\\n        This endpoint associates all samples that are part of the specified boses to the project.\\n        Any samples that are already associated with a project are unaffected.\\n       \\n        This endpoint returns the number of rows saved to the database. 0 indicates something went wrong and the change cannot be performed.   \\n        \\\"\\\"\\\"\\n        addProjectBoxes(projectId: Int!, boxIds: [Int]): Int\\n        \\n        \\\"\\\"\\\"\\n        Removes the specified sample(s) from the project. The samples and all their\\n        associated data remain in the database and are unaffected. The only change\\n        is to disassociate the sample from the project.\\n        \\\"\\\"\\\"\\n        removeProjectSamples(\\n            \\n            \\\"Project ID from which the samples are to be removed.\\\"\\n            projectId: Int!,\\n            \\n            \\\"List of samples to be removed from the project. Any samples in the argument list that are not part of the project are ignored.\\\"\\n            sampleIds:[Int]\\n        \\n        ): Int\\n\\n        \\\"\\\"\\\"\\n        Permanently deletes a project from the system. It does not alter or affect any of the \\n        samples that are associated with the project.\\n        \\\"\\\"\\\"\\n        deleteProject(\\n            \\n            \\\"ID of the project to be deleted.\\\"\\n            projectId: Int!\\n            \\n        ): Int\\n\\n\\n        createTaxonomy(\\n          \\\"The name of the taxa identified with the laboratory.\\\"\\n          scientificName: String\\n\\n          \\\"The taxonomic level of the taxa identified within the laboratory.\\\"\\n          levelId: Int\\n\\n          \\\"The taxonomic level of the taxa identified within the laboratory.\\\"\\n          levelName: String\\n\\n          \\\"Database ID of the parent of this taxon in the NAMC taxonomic hierarchy.\\\"\\n          parentId: Int\\n\\n        ): Int\\n\\n        deleteTaxonomy(\\n          taxonomyId: Int!\\n        ): Int\\n\\n        taxIdentificationStart(\\n          \\\"Database ID that uniquely identifies the sample.\\\"\\n          sampleId: Int!\\n        ): Int\\n        taxIdentificationStop(\\n          \\\"Database ID that uniquely identifies the sample.\\\"\\n          sampleId: Int!, \\n          \\\"the time it took to perform the identification (in decimal hours)\\\"\\n          time: Float!\\n        ): Int\\n\\n        taxReconciliation(\\n            \\\"Reconcile taxa within a box\\\"\\n            boxId: Int!\\n\\n            \\\"Database ID of the taxon being changed.\\\"\\n            fromTaxonomyId: Int!\\n\\n            \\\"Database ID of the new taxon being assigned.\\\"\\n            toTaxonomyId: Int!\\n        ): Int\\n\\n\\n        labSort(\\n          \\\"Database ID that uniquely identifies the sample.\\\"\\n          sampleId: Int!,\\n          \\\"the database ID of the logged in user who performed the sort.\\\"\\n          sorterId: Int!,\\n          \\\"Proportion of the sample, in percent, that was split and then retained for sorting.\\\"\\n          labSplit: Float!,\\n          \\\"the integer number of organisms found in the sample\\\"\\n          count: Int!, \\n          \\\"Boolean whether or not alcohol was used during sorting\\\"\\n          elutriation: Boolean!,\\n          \\\"the time it took to perform the sort (in decimal hours)\\\"\\n          time: Float!\\n        ): Int\\n\\n        labStartSort(\\n          \\\"Database ID that uniquely identifies the sample.\\\"\\n          sampleId: Int!\\n        ): Int\\n\\n        labStopSort(\\n          \\\"Database ID that uniquely identifies the sample.\\\"\\n          sampleId: Int!\\n        ): Int\\n\\n        createSampleTaxaInfo(\\n          \\\"Database ID that uniquely identifies the sample.\\\"\\n          sampleId: Int!,\\n          taxonomyId: Int!,\\n          lifeStageId: Int!,\\n          bugSize: Float,\\n          splitCount: Int!,\\n          bigRareCount: Int,\\n          comments: String,\\n          noteTypeIds: [Int]\\n        ): Int\\n        \\n        deleteOrganism(\\n          organismId: Int!\\n        ): Int\\n\\n        createSampleSubmission(\\n          submitterId: Int, \\n          customerId: Int, \\n          data: JSONObject\\n        ): Int\\n\\n        setBoxInfo(\\n          boxId: Int!,\\n          boxStateId: Int!,\\n          customerId: Int!,\\n          alias: String,\\n          description: String,\\n          measurements: Boolean!,\\n          midges: Boolean!,\\n          models: [Int]\\n        ): Int\\n\\n\\n        # Create an organization. Returns organizationId\\n        createOrganization(organization: OrganizationInput!): Int\\n        # Updates an organization.\\n        updateOrganization(id: Int!, organization: OrganizationInput!): Int\\n        # Updates an organization. Returns rows affected\\n        deleteOrganization(id: Int!): Int\\n        # Create a user. Returns the userId\\n        createUser(user: IndividualInput!, organization: OrganizationInput!): Int\\n        # Update a user. Returns the userId\\n        updateUser(id: Int!, user: IndividualInput!): Int\\n        # Change a user's roles. returns entity Id\\n        updateUserRoles(userId: Int!, roleIds: [Int]!): Int\\n        \\n        rarefyBox(boxId: Int!): Int\\n\\n        rarefyProject(projectId: Int!): Int\\n\\n    } # MUTATION_END\\n\\n    input QueryDistance {\\n\\n        \\\"Latitude of the point, in decimal degrees.\\\"\\n        latitude: Float!\\n\\n        \\\"Longitude of the point in decimal degrees\\\"\\n        longitude: Float!\\n\\n        \\\"Distance from the point in meters.\\\"\\n        distance: Float!\\n    }\\n\\n    input OrganizationInput {\\n      organizationName: String,\\n      organizationTypeId: Int,\\n      address1: String,\\n      address2: String,\\n      city: String,\\n      usStateId: Int,\\n      countryId: Int,\\n      zipCode: String,\\n      phone: String\\n    }\\n\\n    input ProjectInput {\\n\\n        \\\"The name for the project must be unique across all projects in the system. It cannot be an empty string.\\\"\\n        projectName: String!,\\n\\n        \\\"Currently not used, this field is intended to distinguish private projects that can only be seen by the person who created them, from public projects that are visible to all users.\\\"\\n        isPrivate: Boolean!,\\n\\n        \\\"Optional descriptive information about the project purpose, background etc.\\\"\\n        description: String, \\n\\n        \\\"[JSON](https://namc-utah.github.io/namc-bug-db/API/json.html)|No|Optional data that can be useful for scripting and other automated processes.\\\"\\n        metadata: String, \\n\\n        \\\"Optional database ID of the individual who creates the project.\\\"\\n        contactId: Int!\\n\\n        \\\"Array of model IDs that are to be applied to the project\\\"\\n        modelIds: [Int]!\\n    }\\n\\n    input IndividualInput {\\n      firstName: String,\\n      lastName: String,\\n      phone: String,\\n      affiliationId: Int\\n    }\\n\\n    type AuthParams {\\n        loggedIn: Boolean\\n        userPool: String\\n        clientId: String\\n        region: String\\n        domain: String\\n    }\\n\\n    type Sample {  \\n\\n        \\\"Database ID that uniquely identifies the sample.\\\"        \\n        sampleId: Int\\n\\n        \\\"Database ID that unique identifies the box.\\\"\\n        boxId: Int\\n\\n        \\\"The customer that submitted the sample\\\"\\n        customerName: String\\n\\n        \\\"The abbreviated name of the customer that submitted the sample.\\\"\\n        customerAbbreviation: String\\n\\n        \\\"The name of the individual that submitted the sample.\\\"\\n        submittedBy: String\\n\\n        \\\"The current state of the box to which the sample belongs.\\\"\\n        boxState: String\\n\\n        measurements: Boolean\\n\\n        \\\"Database ID of the site where the sample was collected.\\\"\\n        siteId: Int\\n\\n        \\\"The unique name assigned to the site by NAMC.\\\"\\n        siteName: String\\n\\n        \\\"The abbreivation of the US state where the sample was collected.\\\"\\n        usState: String\\n\\n        \\\"[GeoJSON](https://namc-utah.github.io/namc-bug-db/API/geojson.html) of the site associated with the sample.\\\"\\n        siteLocation: String\\n\\n        \\\"NAMC site longitude in decimal degrees.\\\"\\n        siteLongitude: Float\\n\\n        \\\"NAMC site latitude in decimal degrees.\\\"\\n        siteLatitude: Float\\n\\n        \\\"Cmbination of the site name and sample date used for repeat visits.\\\"\\n        visitId: String\\n\\n        \\\"The site identifier provided by the customer at submission.\\\"\\n        customerSiteCode: String\\n\\n        \\\"The date that the sample was collected.\\\"\\n        sampleDate: String\\n\\n        \\\"The time that the sample was collected.\\\"\\n        sampleTime: String\\n\\n        \\\"The sample type (e.g. benthic, drift, fish diet).\\\"\\n        sampleType: String\\n\\n        \\\"The method used to collect the sample (e.g. Hess net, Surber net, Dissected Gut)\\\"\\n        sampleMethod: String\\n\\n        \\\"The habitat sampled (e.g. benthos, pelagic, pool, reachwide, stomach)\\\"\\n        habitat: String\\n\\n        \\\"Customer description of the sampled location.\\\"\\n        sampleLocation: String\\n\\n        \\\"Longitude (in decimal degrees) of the customer sampled location.\\\"\\n        sampleLongitude: Float\\n\\n        \\\"Latitude (in decimal degrees) of the customer sampled location.\\\"\\n        sampleLatitude: Float\\n\\n        \\\"Area sampled in meters squared.\\\"\\n        area: Float\\n\\n        \\\"Proportion of the sample that was retained for laboratory processing as a ratio (0-1).\\\"\\n        fieldSplit: Float\\n\\n        \\\"Customer notes collected in the field.\\\"\\n        fieldNotes: String\\n\\n        \\\"Proporation of the sample processed in the laboratory as ratio (0-1).\\\"\\n        labSplit: Float\\n\\n        \\\"Number of jars used to transport the sample.\\\"\\n        jarCount: Int\\n\\n        \\\"TODO\\\"\\n        qualitative: Boolean\\n\\n        \\\"Laboratory notes pertaining to the sample.\\\"\\n        labNotes: String\\n\\n        \\\"Mesh size in microns.\\\"\\n        mesh: Int\\n\\n        sorterId: Int\\n        sorterName: String\\n        sorterCount: Int\\n        elutriation: Boolean\\n        sortTime: Float\\n        sortStartDate: String\\n        sortEndDate: String\\n\\n        idErId: Int\\n        idErName: String\\n        idTime: Float\\n        idStartDate: String\\n        idEndDate: String\\n\\n        \\\"Date time that the sample record was created in the database.\\\"\\n        createdDate: String\\n\\n        \\\"Date time of the last change to the sample record.\\\"\\n        updatedDate: String\\n\\n        \\\"Date time of the last change to the date sampled field. This is used to determine the status of temporal predictors for the sample.\\\"\\n        sampleDateChanged: String\\n\\n        \\\"For quality assurance samples, this refers to the original sample being quality controlled.\\\"\\n        qaSampleId: Int\\n\\n        \\\"\\\"\\\"\\n        Miscellaneous information about stored as [JSON](https://namc-utah.github.io/namc-bug-db/API/metadata.html).\\n        Typically these values are used during scripting and automated processes.\\n        They also include some legacy information about the sample from the previous NAMC database.\\n        \\\"\\\"\\\"\\n        metadata: String\\n    }\\n\\n    type Site {\\n\\n        \\\"Database ID that uniquely identifies the site.\\\"\\n        siteId: Int\\n\\n        \\\"Unique name assigned to the site by NAMC\\\"\\n        siteName: String\\n\\n        \\\"System in which the site occurs (e.g. lake, pond, reservoir, spring, wetland).\\\"\\n        system: String\\n\\n        \\\"Ecosystem in which the site occurs (e.g. lotic, lentic, either)\\\"\\n        ecosystem: String\\n\\n        \\\"Longitude of the site in decimal degrees.\\\"\\n        longitude: Float\\n\\n        \\\"Latitude of the site in decimal degrees.\\\"\\n        latitude: Float\\n\\n        \\\"US state in which the site occurs.\\\"\\n        usState: String\\n\\n        \\\"US state ID in which the site occurs.\\\"\\n        usStateId: Int\\n\\n        \\\"Defines the dataset type of the waterbodyCode (e.g. NHDPlus, NHDPlusHR)\\\"\\n        waterbodyType: String\\n\\n        \\\"External identifier for the waterbody on which the site occurs (e.g. NHDPlusID for NHDPlusHR or COMID for NHDPlus)\\\"\\n        waterbodyCode: String\\n\\n        \\\"Name of the waterbody on which the site occurs.\\\"\\n        waterbodyName: String\\n\\n        \\\"Date and time that the site was added to the database.\\\"\\n        createdDate: String\\n\\n        \\\"Date and time that the site was last updated in the database.\\\"\\n        updatedDate: String\\n\\n        \\\"True if the site has a catchment polygon defined. Use the siteInfo API endpoint to retrieve the catchment polygon.\\\"\\n        hasCatchment: Boolean\\n    }\\n\\n\\\"\\\"\\\"\\nDetailed information about a single NAMC site.\\n\\nThis query includes the point and catchment geometries for the site.\\nIt also includes the number of samples available at a particular site.\\n\\nMore succinct information is available for all sites using the\\nsites API endpoint.\\n\\\"\\\"\\\"\\n    type SiteInfo {\\n        \\n        \\\"Unique database generated integer that uniquely identifies each site\\\"\\n        siteId: Int\\n\\n        \\\"Unique text identifier for each site\\\"\\n        siteName: String\\n        \\n        \\\"The ecological system (e.g. lake, pond, reservoir) in which the site is located.\\\"\\n        system: String\\n\\n        \\\"The ecosystem in which the site is located.\\\"\\n        ecosystem: String\\n\\n        \\\"[GeoJSON](https://namc-utah.github.io/namc-bug-db/API/geojson.html) point location of the site in [EPSG:4326](https://epsg.io/4326) spatial reference.\\\"\\n        location: String\\n\\n        \\\"Longtidue of the site location in decimal degrees.\\\"\\n        longitude: Float\\n\\n        \\\"Latitude of the site location in decimal degrees.\\\"\\n        latitude: Float\\n\\n        \\\"US State in which the site is located.\\\"\\n        usState: String\\n\\n        \\\"US State ID in which the site is located.\\\"\\n        usStateId: Int\\n\\n        \\\"\\\"\\\"\\n        If the site has a waterbody code, then the waterbody type identifies the system that\\n        this identifier pertains to. The waterbody type might be NHDPlus 1:100,000 or \\n        NHDPlusHR 1:24,000 etc.\\n        \\\"\\\"\\\"\\n        waterbodyType: String\\n\\n        \\\"\\\"\\\"\\n        The identifier of the waterbody on which this site occurs. Can be null. If a \\n        waterbody code exists, then the waterbodyType can be used to determine which\\n        system the code belongs to, such as NHDPlus or NHDPlusHR.\\n        \\\"\\\"\\\"\\n        waterbodyCode: String\\n\\n        \\\"The string name of the waterbody on which the site occurs. Typicall this is the stream name.\\\"\\n        waterbodyName: String\\n\\n        \\\"The latest date and time that either the site location (point) or catchment (polygon) were changed.\\\"\\n        geographyChanged: String\\n\\n        \\\"The system generated date and time that the site record was created in the database.\\\"\\n        createdDate: String\\n\\n        \\\"The system generated date and time that the site record was last changed in the database.\\\"\\n        updatedDate: String\\n\\n        \\\"[GeoJSON](https://namc-utah.github.io/namc-bug-db/API/geojson.html) polygon of the upstream area that drains into this site in [EPSG:4326](https://epsg.io/4326) spatial reference.\\\"\\n        catchment: String\\n\\n        \\\"The number of samples that are available for this site.\\\"\\n        sampleCount: Int\\n    }\\n\\n    \\\"\\\"\\\"\\\"\\n    Raw summary of organisms for a single sample. The data are returned with their original\\n    laboratory taxonomic identification.\\n    \\\"\\\"\\\"\\n    type SampleTaxa {\\n\\n        \\\"Database ID of the sample.\\\"\\n        sampleId: Int\\n\\n        \\\"The taxon identified within the laboratory.\\\"\\n        taxonomyId: Int\\n\\n        \\\"The name of the taxa identified with the laboratory.\\\"\\n        scientificName: String\\n\\n        \\\"The taxonomic level of the taxa identified within the laboratory.\\\"\\n        levelId: Int\\n\\n        \\\"The taxonomic level of the taxa identified within the laboratory.\\\"\\n        levelName: String\\n\\n        \\\"Abundance for the specified taxa and lifestage. Raw organism count adjusted by lab and field splits.\\\"\\n        splitCount: Int\\n    }    \\n    type SampleTaxaTranslated {\\n\\n        \\\"Database ID of the sample.\\\"\\n        sampleId: Int\\n\\n        \\\"The taxon identified within the laboratory.\\\"\\n        taxonomyId: Int\\n\\n        \\\"The name of the taxa identified with the laboratory.\\\"\\n        scientificName: String\\n\\n        \\\"The taxonomic level of the taxa identified within the laboratory.\\\"\\n        levelId: Int\\n\\n        \\\"The taxonomic level of the taxa identified within the laboratory.\\\"\\n        levelName: String\\n\\n        otuName: String\\n\\n        \\\"Abundance for the specified taxa and lifestage. Raw organism count adjusted by lab and field splits.\\\"\\n        splitCount: Int\\n    }\\n    type SampleTaxaAttribute {\\n\\n        \\\"Database ID of the sample.\\\"\\n        sampleId: Int\\n\\n        \\\"The taxon identified within the laboratory.\\\"\\n        taxonomyId: Int\\n\\n        \\\"The name of the taxa identified with the laboratory.\\\"\\n        scientificName: String\\n\\n        \\\"Database ID that uniquely identifies the attribute definition.\\\"\\n        attributeId: Int\\n\\n        \\\"Attribute name, unique across all attributes in the database.\\\"\\n        attributeName: String\\n\\n        \\\"Attribute value, always stored as a string.\\\"\\n        attributeValue: String\\n    }\\n\\n    type SampleTaxaInfo {\\n\\n        \\\"Organism ID uniquely identifying the taxon, life stage, split count and bug size\\\"\\n        organismId: Int\\n\\n        \\\"Database ID of the sample.\\\"\\n        sampleId: Int\\n\\n        \\\"Current state of the box to which this sample is associated.\\\"\\n        boxState: String\\n\\n       \\\"The taxon identified within the laboratory.\\\"\\n        taxonomyId: Int\\n\\n        \\\"The name of the taxa identified with the laboratory.\\\"      \\n        scientificName: String\\n\\n        \\\"The taxonomic level of the taxa identified within the laboratory.\\\"\\n        levelId: Int\\n\\n        \\\"The taxonomic level of the taxa identified within the laboratory.\\\"   \\n        levelName: String\\n\\n        \\\"Phylum of the taxa\\\"\\n        phylum: String\\n\\n        \\\"Class of the taxa\\\"\\n        class: String\\n\\n        \\\"Order of the taxa\\\"\\n        order: String\\n\\n        \\\"Family of the taxa\\\"\\n        family: String\\n\\n        \\\"Subfamily of the taxa\\\"\\n        subFamily: String\\n\\n        \\\"Genus of the taxa\\\"\\n        genus: String\\n\\n        \\\"Species of the taxa\\\"\\n        species: String\\n        \\n        \\\"Database ID of the organism(s) life stage (e.g. lavae, pupae).\\\"\\n        lifeStageId: Int\\n\\n        \\\"Life stage of the organism(s) (e.g. lavae, pupae).\\\"\\n        lifeStage: String\\n\\n        \\\"Abbreviated life stage of the organism(s) (e.g. lavae, pupae).\\\"\\n        lifeStageAbbreviation: String\\n\\n        \\\"Organism length measured in millimeters (if measurements were collected).\\\"\\n        bugSize: Float\\n\\n        \\\"Raw organism count recorded in the laboratory.\\\"\\n        splitCount: Int\\n        \\n        \\\"Proporation of the sample processed in the laboratory as ratio (0-1).\\\"\\n        labSplit: Float\\n\\n        \\\"Proportion of the sample that was retained for laboratory processing as a ratio (0-1).\\\"\\n        fieldSplit: Float\\n\\n        \\\"The raw count corrected for lab and field split.\\\"\\n        correctedCount: Float\\n        \\n        \\\"The count of big rare organisms collected in the laboratory.\\\"\\n        bigRareCount: Int\\n\\n        \\\"Comma separated list of the notes recorded during lab processing.\\\"\\n        notes: String\\n\\n        noteTypeIds: [Int]\\n\\n        \\\"Free text comments about the organism record\\\"\\n        comments: String\\n    }\\n\\n    type BoxInfo {\\n\\n        \\\"Database ID that uniquely identifies the box.\\\"\\n        boxId:                  Int\\n\\n        \\\"Database ID that uniquely identifies the customer that submitted the box.\\\"\\n        customerId:             Int\\n\\n        customer: Organization\\n\\n        \\\"Database ID that uniquely identifies the person that submitted the box.\\\"\\n        submitterId:            Int\\n\\n        \\\"Name of the person that submitted the box.\\\"\\n        submittedBy:            String\\n\\n        \\\"Database ID that identifies the current state of the box (e.g. waiting, hold, active, complete).\\\"\\n        boxStateId:             Int\\n\\n        \\\"Current state of the box (e.g. waiting, hold, active, complete).\\\"\\n        boxState:               String\\n\\n        \\\"Date that the box was received.\\\"\\n        boxReceivedDate:        String\\n\\n        \\\"Date that box processing was completed.\\\"\\n        processingCompleteDate: String\\n        \\n        \\\"Anticipated date that box processing will be complete.\\\"\\n        projectedCompleteDate:  String\\n\\n        \\\"Shorthand name for referring to the box\\\"\\n        alias: String\\n\\n        \\\"Calculated number of samples associated with the box.\\\"\\n        sampleCount:            Int\\n\\n        \\\"Descriptive information about the box.\\\"\\n        description:            String\\n\\n        \\\"Miscellaneous information about stored as [JSON](https://namc-utah.github.io/namc-bug-db/API/metadata.html). Typically used during scripting and automated processes.\\\"\\n        metadata:               String\\n\\n        \\\"True if bug sizes are to be recorded when processing the box samples.\\\"\\n        measurements:           Boolean\\n\\n        \\\"True if midges are to be collected and sent out for processing at a different laboratory\\\"\\n        midges:                 Boolean\\n\\n        modelIds:               [Int]\\n\\n        \\\"True if this box is for quality assurance purposes.\\\"\\n        sorterQa:               Boolean\\n\\n        \\\"True if this box is for quality assurance purposes.\\\"\\n        taxaQa:                 Boolean\\n\\n        \\\"Number of samples for which sorting is complete\\\"\\n        sortCompleteCount:      Int\\n\\n        \\\"Proportion of samples in this box that have been sorted\\\"\\n        sortComplete:           Float\\n\\n        \\\"Number of samples for which identification is complete\\\"\\n        idCompleteCount:        Int\\n\\n        \\\"Proportion of samples in this box for which taxonomic identification is complete\\\"\\n        idComplete:             Float\\n\\n        \\\"Date and time that the box was added to the system.\\\"\\n        createdDate:            String\\n\\n        \\\"Date and time that the box information was last updated.\\\"\\n        updatedDate:            String\\n\\n        latestSubmission: SubmissionVersion\\n\\n        submissions: [SubmissionVersion]\\n\\n        submissionCount: Int\\n    }\\n    \\n\\n    type SamplePredictorValue {\\n\\n        \\\"Database ID that uniquely identifies the predictor.\\\"\\n        predictorId:                 Int\\n\\n        \\\"Predictor abbreviated name (unique across all predictors).\\\"\\n        abbreviation:                 String\\n\\n        \\\"Name of the R script/function used to calculate predictor values.\\\"\\n        calculationScript:           String\\n\\n        \\\"\\\"\\\"\\n        True indicates sample predictors where values vary by sample date.\\n        False indicates site predictors that possess a single value for the site and that do not vary by sample date.\\n        \\\"\\\"\\\"\\n        isTemporal:                  Boolean\\n\\n        \\\"Miscellaneous information about stored as [JSON](https://namc-utah.github.io/namc-bug-db/API/metadata.html). Typically used during scripting and automated processes.\\\"\\n        predictorMetadata:           String\\n\\n        \\\"Floating point predictor value returned in string format.\\\"\\n        predictorValue:              String\\n\\n        \\\"Date and time that the predictor value was last changed.\\\"\\n        predictorValueUpdatedDate: String\\n\\n        \\\"\\\"\\\"\\n        Predictor value status:\\n        Missing indicates that the predictor value has never been calculated.\\n        Expired indicates that the predictor value requires recalculation because either the sample date has changed or the site location has changed.\\n        Valid indicates that the predictor value exists and does not require recalculation.\\n        \\\"\\\"\\\"\\n        status:                       String\\n}\\n\\ntype PlanktonSample {\\n\\n    \\\"Database ID that uniquely identifies the sample.\\\"\\n    sampleId:        Int\\n\\n    \\\"Diameter of the sampled area in metres.\\\"\\n    diameter:        Float\\n\\n    \\\"TODO\\\"\\n    subSampleCount:  Int\\n\\n    \\\"Tow lenth in metres\\\"\\n    towLength:       Float\\n\\n    \\\"volume of material in metres cubed.\\\"\\n    volume:          Float\\n\\n    \\\"Aliquot in milliliters\\\"\\n    aliquot:         Float\\n\\n    \\\"Size interval in millimeters\\\"\\n    sizeInterval:    Float\\n\\n    \\\"The two type (e.g. vertical, horizontal)\\\"\\n    towType:         String\\n\\n    \\\"Date and time that the plankton sample was last updated.\\\"\\n    updatedDate:     String\\n}\\n\\ntype DriftSample {\\n\\n    \\\"Database ID that uniquely identifies the sample.\\\"\\n    sampleId:    Int\\n\\n    \\\"Area of the net in meters squared.\\\"\\n    netArea:     Float\\n\\n    \\\"Duration that the net was in the water, recorded in hours.\\\"\\n    netDuration: Float\\n\\n    \\\"Stream depth measured in meters.\\\"\\n    streamDepth: Float\\n\\n    \\\"Net depth measurement in meters.\\\"\\n    netDepth:    Float\\n\\n    \\\"Net velocity in meters per second.\\\"\\n    netVelocity: Float\\n\\n    \\\"Date and time that the plankton sample was last updated.\\\"\\n    updatedDate: String\\n}\\n\\ntype FishSample {\\n\\n    \\\"Database ID that uniquely identifies the sample.\\\"\\n    sampleId: Int\\n\\n    \\\"Database ID identifying the fish taxon.\\\"\\n    taxonomyId: Int\\n\\n    \\\"Scientific name of the fish taxon.\\\"\\n    scientificName: String\\n\\n    \\\"Database ID identifying the taxonomic level of the fish.\\\"\\n    levelId: Int\\n\\n    \\\"Name of the taxonomic level of the fish.\\\"\\n    levelName: String\\n\\n    \\\"Length of the fish in TODO.\\\"\\n    fishLength: Float\\n\\n    \\\"Mass of the fish in grams.\\\"\\n    fishMass: Float\\n\\n    \\\"Date and time that the plankton sample was last updated.\\\"\\n    updatedDate: String\\n}\\n\\ntype MassSample {\\n \\n    \\\"Database ID that uniquely identifies the sample.\\\"\\n    sampleId: Int\\n\\n    \\\"Database ID that uniquely identifies the mass type\\\"\\n    typeId: Int\\n\\n    \\\"Abbreviated name of the mass type (e.g. FPOM, CPOM, Total)\\\"\\n    typeAbbreviation: String\\n\\n    \\\"Full name of the mass type collected (e.g. Fine Particulate Matter, Total)\\\"\\n    typeName: String\\n\\n    \\\"Database that uniquely identifies the method used to collected the mass measurement\\\"\\n    methodId: Int\\n\\n    \\\"Abbreviated name of the method used to collect the mass measurement (e.g. AFDM, Dried, Blotted)\\\"\\n    methodAbbreviation: String\\n\\n    \\\"Full name of the method used to collect the mass measurement (e.g. Ash Free Dried Matter, Dried, Blotted)\\\"\\n    methodName: String\\n\\n    \\\"Measurement mass in grams.\\\"\\n    mass: Float\\n\\n    \\\"Date and time that the plankton sample was last updated.\\\"\\n    updatedDate: String\\n}\\n\\ntype ModelResult {\\n\\n    \\\"Database ID that uniquely identifies the sample.\\\"   \\n    sampleId: Int\\n\\n    \\\"Database ID that uniquely identifies the site at which the sample was collected.\\\"\\n    siteId:      Int\\n\\n    \\\"Name of the site at which the sample was collected.\\\"\\n    siteName:    String\\n\\n    \\\"Database ID that uniquely identifies the model to which the result pertains.\\\"\\n    modelId:     Int\\n\\n    \\\"Full name of the model to which the result pertains.\\\"\\n    modelName: String\\n\\n    \\\"Version of the model that was used to generate the result (e.g. 1.2.3).\\\"\\n    modelVersion: String\\n\\n    \\\"The model result value.\\\"\\n    modelResult: Float\\n\\n    \\\"The model condition obtained by the model result. See the modelConditions API endpoint for all possible conditions for a specific model.\\\"\\n    condition: String\\n\\n    \\\"Fixed count used for rarefaction during model calculation.\\\"\\n    fixCount: Int\\n\\n    \\\"Miscellaneous notes provided by the analyst that performed the model calculation.\\\"\\n    notes: String\\n\\n    \\\"Miscellaneous information about stored as [JSON](https://namc-utah.github.io/namc-bug-db/API/metadata.html). Typically used during scripting and automated processes.\\\"\\n    metadata: String\\n\\n    \\\"Date and time that the model result was added to the database.\\\"\\n    createdDate: String\\n\\n    \\\"Date and time that the model result was last updated in the database.\\\"\\n    updatedDate: String\\n}\\n\\n# type FishDiet {\\n#     sampleId:            Int\\n#     sampleDate:          String\\n#     siteId:              Int\\n#     siteName:            String\\n#     fishWeight:          Float\\n#     fishLength:          Float\\n#     fishTaxonomyId:     Int\\n#     fishScientificName: String\\n#     notes:                String\\n#     metadata:             String\\n#     organicWeight:       Float\\n#     inorganicWeight:     Float\\n#     otherWeight:         Float\\n#     createdDate:         String\\n#     updatedDate:         String\\n#     taxonomyId:          Int\\n#     scientificName:      String\\n#     lifeStageId:        Int\\n#     lifeStage: String\\n#     count:                Float\\n#     weight:               Float\\n# }\\n\\n\\n    #  type Individual {\\n    #     entityId: Int\\n    #     firstName: String\\n    #     lastName: String\\n    #     initials: String\\n    #     affilitationId: Int\\n    #     affiliation: String\\n    #     email: String\\n    #     title: String\\n    #     address1: String\\n    #     address2: String\\n    #     city: String\\n    #     stateName: String\\n    #     countryName: String\\n    #     zipCode: String\\n    #     phone: String\\n    #     fax: String\\n    # }\\n\\n    type Box {\\n        boxId: Int\\n        customerId: Int\\n        customerName: String\\n        sampleCount: Int\\n        submitterId: Int\\n        submittedBy: String\\n        boxStateId: Int\\n        boxState: String\\n        alias: String\\n        boxReceivedDate: String\\n        processingCompleteDate: String\\n        projectedCompleteDate: String\\n        measurements: Boolean\\n        midges: Boolean\\n        sortComplete: Float\\n        idComplete: Float\\n        createdDate: String\\n        # These come from other queries\\n        submissionCount: Int\\n    }\\n\\n    type Project {\\n\\n        \\\"Database ID that uniquely identifies the project.\\\"\\n        projectId: Int\\n\\n        \\\"Unique name for the project.\\\"\\n        projectName: String\\n\\n        \\\"Not currently used. All projects are currently public and visible to all users.\\\"\\n        isPrivate: Boolean\\n\\n        \\\"Database ID of the person who created the project.\\\"\\n        contactId: Int\\n        \\n        \\\"Full name of the person who created the project.\\\"\\n        contactName: String\\n\\n        \\\"Miscellaneous information about the project.\\\"\\n        description: String\\n\\n        \\\"Number of samples currently associated with a project.\\\"\\n        sampleCount: Int\\n\\n        modelIds: [Int]!\\n\\n        \\\"Date and time that the project was created.\\\"\\n        createdDate: String\\n\\n        \\\"Date and time that the basic project information was last updated. This does not reflect the addition or removal of samples.\\\"\\n        updatedDate: String\\n    }\\n\\n    type Taxonomy {\\n\\n        \\\"Database ID that uniquely identifies the taxon.\\\"\\n        taxonomyId: Int\\n\\n        \\\"Current NAMC laboratory scientic name for the taxon. Scientific names are unique across all taxa.\\\"\\n        scientificName: String\\n\\n        \\\"Database ID that identifies the taxonomic level of the taxon.\\\"\\n        levelId: Int\\n\\n        \\\"Taxonomic level of the taxon.\\\"\\n        levelName: String\\n\\n        synonyms: String\\n\\n        \\\"True if the taxon is at or below the level of effort required by the lab (e.g. genus or species). Or False for taxa above that level.\\\"\\n        isTargetEffort: Boolean\\n        \\n        \\\"Database ID of the parent of this taxon in the NAMC taxonomic hierarchy.\\\"\\n        parentTaxonomyId: Int\\n\\n        \\\"Scientific name of the parent of this taxon in the NAMC taxonomic hierarchy.\\\"\\n        parentScientificName: String\\n\\n        \\\"Database ID of the taxonomic level of the parent in the NAMC taxonomic hierarchy.\\\"\\n        parentLevelId: Int\\n\\n        \\\"Taxonomic level of the parent of this taxon in the NAMC taxonomic hierarchy.\\\"\\n        parentLevelName: String\\n\\n        \\\"Miscellaneous notes about the taxon.\\\"\\n        notes: String\\n\\n        \\\"Miscellaneous information about stored as [JSON](https://namc-utah.github.io/namc-bug-db/API/metadata.html). Typically used during scripting and automated processes.\\\"\\n        metadata: String\\n\\n        \\\"Date and time that this taxon was added to the database.\\\"\\n        createdDate: String\\n\\n        \\\"Date and time that this taxon was last updated in the database.\\\"\\n        updatedDate: String\\n    }\\n\\n\\n    type Model {\\n\\n        \\\"Database ID that uniquely identifies the model.\\\"\\n        modelId: Int\\n\\n        \\\"Full name of the model, unique across all models.\\\"\\n        modelName: String\\n\\n        \\\"Abbreviated name of the model, unique across all models.\\\"\\n        abbreviation: String\\n\\n        \\\"True indicates that the model is in active use. False indicates a deprecated model.\\\"\\n        isActive: Boolean\\n\\n        \\\"Miscellaneous information about the model.\\\"\\n        description: String\\n\\n        \\\"Number of predictors currently associated with the model. Use the predictors API endpoint for a list of the predictors associated with each model.\\\"\\n        predictorCount: Int\\n\\n        \\\"Identifies the type of model\\\"\\n        modelTypeId: Int\\n\\n        \\\"Model type name\\\"\\n        modelTypeName: String\\n\\n        \\\"Number of organizations that are rarefied and passed to the model\\\"\\n        fixedCount: Int\\n\\n        \\\"Identifies the translation (OTU) used by the model\\\"\\n        translationId: Int\\n\\n        \\\"Translation used to run the model\\\"\\n        translationName: String\\n    }\\n\\n    type ModelInfo {\\n        \\\"Database ID that uniquely identifies the model.\\\"\\n        modelId: Int\\n\\n        \\\"Full name of the model, unique across all models.\\\"\\n        modelName: String\\n\\n        \\\"Abbreviated name of the model, unique across all models.\\\"\\n        abbreviation: String\\n\\n        \\\"Model type (e.g. OE, MMI, hybrid, measurement).\\\"\\n        modelType: String\\n\\n        \\\"Model type abbreviation\\\"\\n        modelTypeAbbreviation: String\\n\\n        \\\"Database ID identifying the translation (OTU) used by the model.\\\"\\n        translationId: Int\\n\\n        \\\"Name of the translation (OTU) used by the model.\\\"\\n        translation: String\\n\\n        \\\"Description of the geographic extent to which the model applies.\\\"\\n        extentDescription: String\\n\\n        \\\"Platform on which the model runs (e.g. R, MS Access).\\\"\\n        platform: String\\n\\n        \\\"Number of reference sites used to build the model.\\\"\\n        referenceSites: Int\\n\\n        \\\"TODO\\\"\\n        groupCount: Int\\n\\n        \\\"Minimum organisms required to run the model.\\\"\\n        minimumCount: Int\\n\\n        \\\"TODO\\\"\\n        oeMean: Float\\n\\n        \\\"TODO\\\"\\n        oeStdev: Float\\n\\n        \\\"TODO\\\"\\n        taxonomicEffort: String\\n\\n        \\\"True indicates the model is in active use. False indicates a deprecated model.\\\"\\n        isActive: Boolean\\n\\n        \\\"Fixed total number of organisms used to run the model.\\\"\\n        fixedCount: Int\\n\\n        \\\"Units of the model result.\\\"\\n        units: String\\n\\n        \\\"Miscellaneous information about the model.\\\"\\n        description: String\\n\\n        \\\"Miscellaneous information about stored as [JSON](https://namc-utah.github.io/namc-bug-db/API/metadata.html). Typically used during scripting and automated processes.\\\"\\n        metadata: String\\n\\n        \\\"Number of predictors currently associated with the model.\\\"\\n        predictorCount: Int\\n\\n        \\\"Date and time that the model was added to the database.\\\"\\n        createdDate: String\\n\\n        \\\"Date and time that the model was last updated in the database.\\\"\\n        updatedDate: String\\n\\n        \\\"The polygon, in [GeoJSON](https://namc-utah.github.io/namc-bug-db/API/geojson.html) format, that defines the geographic extent that the model applies to.\\\"\\n        extent: String\\n    }\\n\\n    type ModelCondition {\\n\\n        \\\"Database ID that uniquely identifies the model.\\\"\\n        modelId: Int\\n\\n        \\\"Database ID that uniquely identifies the condition for the specified model.\\\"\\n        conditionId: Int\\n\\n        \\\"Name of the condition. Must be unique across all conditions for a single model.\\\"\\n        condition: String\\n\\n        \\\"Display text for the model condition.\\\"\\n        displayText: String\\n\\n        \\\"Standardized text for the model condition\\\"\\n        standardDisplayText: String\\n\\n        \\\"Miscellaneous information about the model condition.\\\"\\n        description: String\\n    }\\n\\n    type Metric {\\n\\n        \\\"Database ID that uniquely identifies the metric.\\\"\\n        metricId: Int\\n\\n        \\\"Unique metrics name.\\\"\\n        metricName: String\\n\\n        \\\"Metric abbreviation\\\"\\n        abbreviation: String\\n\\n        \\\"Display name for the metric used in reports. If null, then the metricName is used instead.\\\"\\n        displayText: String\\n\\n        \\\"Database ID of the group in which the metric appears in reports.\\\"\\n        metricGroupId: Int\\n\\n        \\\"Name of the group in which the metric appears in reports.\\\"\\n        metricGroupName: String\\n\\n        \\\"Name of the database stored procedure that calculates the metric value.\\\"\\n        codeFunction: String\\n\\n        \\\"Whether the metric involves filtering by taxonomy, attribute or no filtering.\\\"\\n        filtering: String\\n        \\n        \\\"True indicates that the metric requires rarefied data. False indicates that the metric uses raw laboratory organism counts.\\\"\\n        isStandardized: Boolean\\n\\n        \\\"The direction that indicates an improvement in conditions (e.g. Increases, Decreases, Increase or Decrease, Variable).\\\"\\n        perturbDirection: String\\n\\n        \\\"Miscellaneous information about the metric.\\\"\\n        description: String\\n\\n        \\\"Date and time that the metric definition was added to the database.\\\"\\n        createdDate: String\\n\\n        \\\"Date and time that the metric definition was last updated in the database.\\\"\\n        updatedDate: String\\n    }\\n\\n    \\\"\\\"\\\"\\n    The value of a non-temporal predictor for a particular site.\\n    \\\"\\\"\\\"\\n    type SitePredictorValue {\\n\\n        \\\"Database ID that uniquely identifies the predictor.\\\"\\n        predictorId: Int\\n\\n        \\\"Predictor name, unique across all predictors.\\\"\\n        predictorName: String\\n\\n        \\\"The unique shorthand abbreviation for the predictor.\\\"\\n        abbreviation: String\\n\\n        \\\"Miscellaneous information about the predictor.\\\"\\n        description: String\\n\\n        \\\"The predictor type (e.g. metrics, atmosphere, geology, anthro).\\\"\\n        predictorType: String\\n\\n        \\\"\\\"\\\"\\n        The predictor value for this site. The value is always a string, even\\n        if it represents an integer or floating point value.\\n        \\\"\\\"\\\"\\n        predictorValue: String\\n\\n        \\\"Date and time that the predictor value was added to the database.\\\"\\n        createdDate: String\\n\\n        \\\"Date and time that the predictor value was last updated.\\\"\\n        updatedDate: String\\n\\n        \\\"Optional name of the R function that performs the calculation for this predictor.\\\"\\n        calculationScript: String\\n    }\\n\\n    \\\"\\\"\\\"\\n    Information about a predictor.\\n\\n    Each predictor can be associated with multiple models. Predictors can also\\n    be temporal, in which their values are associated with a particular sample,\\n    or they can be non-temporal, in which case their values are associated with\\n    sites.\\n    \\\"\\\"\\\"\\n    type Predictor {\\n\\n        \\\"Database ID that uniquely identifies the predictor.\\\"\\n        predictorId: Int\\n\\n        \\\"Predictor name, unique across all predictors in the system.\\\"\\n        predictorName: String\\n\\n        \\\"Abbreviated predictor name, unique across all predictors in the system.\\\"\\n        abbreviation: String\\n\\n        \\\"Units in which the predictor values are stored.\\\"\\n        units: String\\n\\n       \\\"Predictor type (e.g. metrics, atmosphere, geology, anthro).\\\"\\n        predictorType: String\\n\\n        \\\"\\\"\\\"\\n        Boolean representing whether the predictor varies over time or whether\\n        there is just a single value for the site. True indicates that the predictor\\n        is temporal and values are stored for each sample. False indicates that there\\n        is only one predictor value for each site.\\n        \\\"\\\"\\\"\\n        isTemporal: Boolean\\n\\n        \\\"Miscellaneous information about the predictor.\\\"\\n        description: String\\n\\n        \\\"Miscellaneous information about stored as [JSON](https://namc-utah.github.io/namc-bug-db/API/metadata.html). Typically used during scripting and automated processes.\\\"\\n        metadata: String\\n\\n        \\\"The number of models that currently use the predictor\\\"\\n        modelCount: Int\\n\\n        \\\"Date and time that the predictor was added to the database.\\\"\\n        createdDate: String\\n\\n        \\\"Date and time that the predictor was last updated in the database.\\\"\\n        updatedDate: String\\n\\n        \\\"Optional name of the R function that performs the calculation for this predictor.\\\"\\n        calculationScript: String\\n\\n        \\\"Source information about the predictor.\\\"\\n        source: String\\n    }\\n\\n    type Translation {\\n\\n        \\\"Database ID that uniquely identifies the translation (OTU).\\\"\\n        translationId: Int\\n\\n        \\\"Translation (OTU) name, unique across all translations in the system.\\\"\\n        translationName: String\\n\\n        \\\"Miscellaneous information about the translation.\\\"\\n        description: String\\n\\n        \\\"True indicates that the translation is in active use. False indicates that the translation has been deprecated.\\\"\\n        isActive: Boolean\\n\\n        \\\"Current number of taxa associated with the translation. See [translation](https://namc-utah.github.io/namc-bug-db/Technical_Reference/translations.html) for more information.\\\"\\n        taxaCount: Int\\n\\n        \\\"Date and time that the translation was added to the database.\\\"\\n        createdDate: String\\n\\n        \\\"Date and time that the translation was last updated in the database.\\\"\\n        updatedDate: String\\n    }\\n\\n    type TranslationTaxa {\\n\\n        \\\"Database ID of the translation (OTU) that this taxon appears in.\\\"\\n        translationId: Int\\n\\n        \\\"Name of the translation (OTU) that this taxon appears in.\\\"\\n        translationName: String\\n\\n        \\\"Database ID of the taxon that appears in the translation.\\\"\\n        taxonomyId: Int\\n\\n        \\\"Database ID of the taxonomic level for the taxon.\\\"\\n        levelId: Int\\n\\n        \\\"Taxonomic level of the taxon in the NAMC taxonomic hierarchy.\\\"\\n        levelName: String\\n\\n        \\\"NAMC scientific name for the taxon. This is the current scientific name used by taxonomists in the NAMC laboratory.\\\"\\n        originalScientificName: String\\n\\n        \\\"\\\"\\\"\\n        The name used for the taxon within the translation (OTU).\\n        This might be the same as the NAMC scientific name, or it might be an alias, specific to the OTU.\\n        \\\"\\\"\\\"\\n        translationScientificName: String\\n\\n        \\\"\\\"\\\"\\n        True indicates that the taxon is part of the final set of taxa used to calibrate the model.\\n        False indicates that the taxon was part of the larger set initially identified during model development.\\n        \\\"\\\"\\\"\\n        isFinal: Boolean\\n    }\\n\\n    type Attribute {\\n\\n        \\\"Database ID that uniquely identifies the attribute definition.\\\"\\n        attributeId: Int\\n\\n        \\\"Attribute name, unique across all attributes in the database.\\\"\\n        attributeName: String\\n\\n        \\\"TODO (they are all Unknown in the SLQ file) Attribute type (e.g. )\\\"\\n        attributeType: String\\n\\n        \\\"Display label used for the attribute in reports\\\"\\n        label: String\\n\\n        \\\"Miscellaneous information about the attribute.\\\"\\n        description: String\\n\\n        \\\"Miscellaneous information about stored as [JSON](https://namc-utah.github.io/namc-bug-db/API/metadata.html). Typically used during scripting and automated processes.\\\"\\n        metadata: String\\n\\n        \\\"Date and time that the attribute was added to the database.\\\"\\n        createdDate: String\\n\\n        \\\"Date and time that the attribute was last updated in the database.\\\"\\n        updatedDate: String\\n    }\\n\\n    type AttributeValue {\\n\\n        \\\"Database ID of the taxon to which this attribute value applies.\\\"\\n        taxonomyId: Int\\n\\n        \\\"Current scientific name for the taxon to which this attribute value applies.\\\"\\n        scientificName: String\\n\\n        \\\"Database ID of the taxonomic level for the taxon.\\\"\\n        levelId:  Int\\n\\n        \\\"Taxonomic level of the taxon to which this attribute value applies.\\\"\\n        levelName:  String\\n\\n        \\\"Attribute name.\\\"\\n        attributeName: String\\n\\n        \\\"Attribute type TODO (currently all Unknown)\\\"\\n        attributeType: String\\n\\n        \\\"Display label name for the attribute.\\\"\\n        label: String\\n\\n        \\\"Attribute value, always stored as a string.\\\"\\n        attributeValue: String\\n    }\\n\\n    type MetricResult  {\\n\\n        \\\"Database ID that identifies the sample.\\\"\\n        sampleId:    Int\\n\\n        \\\"Database ID that identifies the metric group for organizing metrics in reports.\\\"\\n        metricGroupId:     Int\\n\\n        \\\"Metric group name used for organizing metrics in reports.\\\"\\n        metricGroupName:   String\\n\\n        \\\"Database ID that identifies the metric.\\\"\\n        metricId:    Int\\n\\n        \\\"Metric name.\\\"\\n        metricName:  String\\n\\n        \\\"Shortened metric abbreviation\\\"\\n        metricAbbreviation: String\\n\\n        \\\"Metric value, always represented as a string.\\\"\\n        metricValue: String\\n  }\\n  # TODO: Eventually this should implement Entity but check for R problems firs\\n  # type Organization implements Entity{\\n  type Organization {\\n\\n        \\\"Database ID that uniquely identifies the organization.\\\"\\n        entityId: Int\\n\\n        \\\"Organization name, unique across all organizations in the database.\\\"\\n        organizationName: String\\n\\n        \\\"Organization Type (e.g. federal, tribe, university, other, private, state, international).\\\"\\n        organizationType: String\\n\\n        \\\"Organization Type Id.\\\"\\n        organizationTypeId: Int\\n\\n        \\\"Entity ID of the parent organization.\\\"\\n        parentEntityId: Int\\n\\n        \\\"True if the organization is a laboratory.\\\"\\n        isLab: Boolean\\n\\n        \\\"Street address line 1.\\\"\\n        address1: String\\n\\n        \\\"Street address line 2.\\\"\\n        address2: String\\n\\n        \\\"City.\\\"\\n        city: String\\n\\n        \\\"US State. Null for international organizations.\\\"\\n        usState: String\\n\\n        \\\"Country.\\\"\\n        country: String\\n\\n        usStateId: Int\\n        countryId: Int\\n\\n        \\\"Postal code.\\\"\\n        zipCode: String\\n\\n        \\\"Telephone number with area code. Format (xxx) xxx-xxxx\\\"\\n        phone: String\\n\\n        \\\"Fax number. Format (xxx) xxx-xxxx\\\"\\n        fax: String\\n\\n        \\\"Organization's website URL. Includes the http:// or https:// prefix.\\\"\\n        website: String\\n\\n        \\\"Miscellaneous information about the organization.\\\"\\n        notes: String\\n\\n        \\\"Miscellaneous information about stored as [JSON](https://namc-utah.github.io/namc-bug-db/API/metadata.html). Typically used during scripting and automated processes.\\\"\\n        metadata: String\\n\\n        \\\"Date and time that the organization was added to the database.\\\"\\n        createdDate: String\\n\\n        \\\"Date and time that the organization was last updated in the database.\\\"\\n        updatedDate: String\\n\\n        userCount: Int\\n    }\\n\\n\\n    # Pagination Types\\n  \\n    type PaginatedModels {\\n        records: [Model]\\n        nextOffset: Int\\n    }\\n    type PaginatedSites {\\n        records: [Site]\\n        nextOffset: Int\\n    }\\n    type PaginatedSamples {\\n        records: [Sample]\\n        nextOffset: Int\\n    }\\n\\n    type PaginatedBoxes {\\n        records: [Box]\\n        nextOffset: Int\\n    }\\n    type PaginatedProjects {\\n        records: [Project]\\n        nextOffset: Int\\n    }\\n    type PaginatedTaxonomies {\\n        records: [Taxonomy]\\n        nextOffset: Int\\n    }\\n\\n    type PaginatedPredictors {\\n        records: [Predictor]\\n        nextOffset: Int\\n    }\\n    type PaginatedSitePredictorValues {\\n        records: [SitePredictorValue]\\n        nextOffset: Int\\n    }\\n\\n    type PaginatedSamplePredictorValue {\\n        records: [SamplePredictorValue]\\n        nextOffset: Int\\n    }\\n\\n    type PaginatedTranslations {\\n        records: [Translation]\\n        nextOffset: Int\\n    }\\n\\n    type PaginatedTranslationTaxa {\\n        records: [TranslationTaxa]\\n        nextOffset: Int\\n    }\\n\\n    type PaginatedSampleTaxa {\\n        records: [SampleTaxa]\\n        nextOffset: Int\\n    }\\n\\n    type PaginatedSampleTaxaTranslated {\\n        records: [SampleTaxaTranslated]\\n        nextOffset: Int\\n    }\\n\\n    type PaginatedSampleTaxaInfo {\\n        records: [SampleTaxaInfo]\\n        nextOffset: Int\\n    }\\n\\n    type PaginatedSampleTaxaAttribute {\\n        records: [SampleTaxaAttribute]\\n        nextOffset: Int\\n    }    \\n\\n    type PaginatedPlankton {\\n        records: [PlanktonSample]\\n        nextOffset: Int\\n    }\\n\\n    type PaginatedDrift {\\n        records: [DriftSample]\\n        nextOffset: Int\\n    }\\n\\n    type PaginatedFish {\\n        records: [FishSample]\\n        nextOffset: Int\\n    }\\n\\n    type PaginatedMass {\\n        records: [MassSample]\\n        nextOffset: Int\\n    }\\n\\n    type PaginatedAttributes {\\n        records: [Attribute]\\n        nextOffset: Int\\n    }\\n\\n    type PaginatedAttributeValues {\\n        records: [AttributeValue]\\n        nextOffset: Int\\n    }\\n\\n    type PaginatedModelConditions {\\n        records: [ModelCondition]\\n        nextOffset: Int\\n    }\\n\\n    type PaginatedMetrics {\\n        records: [Metric]\\n        nextOffset: Int\\n    }\\n\\n    type PaginatedMetricResult {\\n        records: [MetricResult]\\n        nextOffset: Int\\n    }\\n\\n    type PaginatedModelResult {\\n        records: [ModelResult]\\n        nextOffset: Int\\n    }\\n\\n    # type PaginatedFishDiet {\\n    #     records: [FishDiet]\\n    #     nextOffset: Int\\n    # }\\n\\n    type PaginatedOrganizations {\\n        records: [Organization]\\n        nextOffset: Int\\n    }\\n\\n    type PaginatedIndividuals {\\n        records: [Individual]\\n        nextOffset: Int\\n    }\\n\\n    type PaginatedBoxTaxa {\\n        records: [BoxTaxa]\\n        nextOffset: Int\\n    }\\n\\n    type PaginatedMapSites {\\n      records: [MapSite]\\n      nextOffset: Int\\n    }\\n\\n  \\n    interface Entity {\\n      \", \"\\n    }\\n\\n    type Individual implements Entity{\\n      id: Int!\\n      firstName: String!\\n      lastName: String!\\n      initials: String\\n      email: String\\n      title: String\\n      affiliationId: Int\\n      \", \"\\n      organizationName: String\\n      roleIds: [Int]\\n    }\\n\\n    type SampleSubmitter {\\n      id: Int!\\n      firstName: String!\\n      lastName: String!\\n      initials: String\\n      email: String\\n      title: String\\n      \\\"Telephone number with area code. Format (xxx) xxx-xxxx\\\"\\n      phone: String\\n    }\\n\\n    # A user is like an individual but we're leaving that type alone for now\\n    type Profile implements Entity {\\n      id: Int!\\n      firstName: String!\\n      lastName: String!\\n      initials: String\\n      email: String\\n      title: String\\n      affiliationId: Int\\n      \", \"\\n      organizationName: String\\n      roleIds: [Int]\\n      permissions: JSONObject\\n    }\\n\\n    type SortingUser {\\n      id: Int!\\n      firstName: String!\\n      lastName: String!\\n      title: String\\n      organizationName: String\\n    }\\n\\n    type BoxTaxa {\\n      order: String\\n      family: String\\n      taxonomyId: Int\\n      scientificName: String\\n      taxonomistCounts: JSONObject\\n      sampleCount: Int\\n      totalCount: Int\\n    }\\n\\n    type SubmissionVersion {\\n      boxId: Int\\n      versionId: Int\\n      submissionId: Int\\n      submitterId: Int\\n      submitter: SampleSubmitter\\n      createdDate: String\\n      updatedDate: String\\n    }\\n\\n    type USState {\\n      id: Int!\\n      name: String!\\n      abbreviation: String!\\n    }\\n\\n    type MapSite {\\n        \\n        \\\"Unique database generated integer that uniquely identifies each site\\\"\\n        siteId: Int\\n\\n        \\\"Unique text identifier for each site\\\"\\n        siteName: String\\n        \\n        \\\"Longtidue of the site location in decimal degrees.\\\"\\n        longitude: Float\\n\\n        \\\"Latitude of the site location in decimal degrees.\\\"\\n        latitude: Float\\n\\n        \\\"US State in which the site is located.\\\"\\n        usStateId: Int\\n    }\\n\\n    \", \"\\n\"], [\"\\n\\n    scalar JSONObject\\n\\n    schema {\\n        query: Query\\n        mutation: Mutation\\n    }\\n\\n    # enum LogLevel {\\n    #   DEBUG\\n    #   ERROR\\n    #   INFO\\n    #   WARN\\n    # }\\n\\n    type Query {\\n        # Get a project and associated metadata\\n        auth: AuthParams\\n\\n        lookups: Lookups\\n\\n        submissionData(submissionId: Int): JSONObject\\n\\n        # disabled for now.\\n        # log(level: LogLevel, message: String, context: JSONObject): Boolean\\n\\n        \\\"API endpoint that calls entity.fn_organization_search\\\"\\n        organizations(limit: Int = \", \", offset: Int = 0): PaginatedOrganizations\\n        organizationsById(limit: Int = \", \", offset: Int = 0, ids: [Int]): PaginatedOrganizations\\n\\n        user(id: Int!): Individual\\n        users(limit: Int = \", \", offset: Int = 0): PaginatedIndividuals\\n\\n        # user(userId: Int): Individual\\n\\n        ####################################################################################################################################################################################\\n        # Geo queries\\n\\n        \\\"Detailed information about a single site. Includes the point location and upstream catchment geometries as [GeoJSON](https://namc-utah.github.io/namc-bug-db/API/geojson.html).\\\"\\n        siteInfo(siteId: Int!): SiteInfo\\n\\n        \\\"Detailed information about a single model, including the number of predictors associated with the model.\\\"\\n        modelInfo(modelId: Int!): ModelInfo\\n\\n        \\\"List of all model conditions (e.g. good, fair, poor) for a particular model\\\"\\n        modelConditions(modelId: Int!, limit: Int = \", \", offset: Int = 0): PaginatedModelConditions\\n\\n        ####################################################################################################################################################################################\\n        # Sample queries\\n\\n        \\\"Detailed information about a single box, including information about the customer and number of samples associated with the box.\\\"\\n        boxInfo(boxId: Int!): BoxInfo\\n\\n        \\\"\\\"\\\"\\n        The samples API endpoint returns a set of samples that satisfty one of the mandatory arguments.\\n\\n        The samples API endpoint returns a set of samples that satisfty one of the mandatory arguments. You can request all samples associated with one or more boxes, or all samples belonging to a particular customer or project.\\n\\n        Note that samples associated with completed boxes should have the same sample ID in the new database as they had in the Pilot database. However, any samples associated with boxes that were incomplete at the time of the data migration are assigned new sample IDs in the new database; they will not match those in either BugLab or Pilot.\\n        \\n        **You must provide exactly one of the arguments**, either a list of sample IDs, box IDs, entity IDs, site IDs, a polygon or a point and distance.\\n        You will get an error if you fail to provide at least one of these arguments!\\n        You also can't provide multiple arguments (i.e. both sample IDs and box IDs).\\n        And finally, you can't provide an empty list of IDs.\\n        \\\"\\\"\\\"\\n        samples(limit: Int = \", \", offset: Int = 0 , \\n        \\n            \\\"List of integer sample IDs.\\\"\\n            sampleIds: [Int], \\n            \\n            \\\"List of integer box IDs. Returns all samples associated with the specified box(es).\\\"\\n            boxId: Int,\\n            \\n            \\\"List of integer project IDs. Returns all samples associated with the specified project(s).\\\"\\n            projectId: Int,\\n\\n            entityId: Int, \\n            taxonomyId: Int, \\n            usStateId: Int\\n        \\n        ): PaginatedSamples\\n        \\\"\\\"\\\"\\n        Summary information for all sites, including location coordinates and number of samples.\\n        Use the siteInfo query to get more detailed information about a single site, including the catchment as a [GeoJSON](https://namc-utah.github.io/namc-bug-db/API/geojson.html) polygon.\\n        \\n        The sites returned in this query are the official NAMC sites. If you want the actual locations of sites at which\\n        samples were collected then use the samples API endpoint and the customerLocation fields. \\n        \\\"\\\"\\\"\\n        sites(limit: Int = \", \", offset: Int = 0, \\n        \\n            \\\"Two letter abbreviation of the US State. Returns all sites within the state.\\\"\\n            usState: [String],\\n            \\n            \\\"List of integer sample IDs. Returns the list of sites for the sample(s).\\\"\\n            sampleIds: [Int],\\n            \\n            \\\"List of integer Box IDs. Returns the sites at which samples within the box(es) were collected.\\\"\\n            boxIds: [Int],\\n            \\n            \\\"List of integer project IDs. Returns the sites at which samples within the project(s) were collected.\\\"\\n            projectIds: [Int],\\n            \\n            \\\"List of integer customer IDs. Returns all samples belonging to the customer(s). Note that customer organizations are hierarchical. If you provide the customer ID for the BLM you will get back all samples for the entire BLM (i.e. all states and all field offices). If you provide the customer ID for the Colorado BLM you will get back all samples belonging to field offices within the state of Colorado.\\\"\\n            entityIds: [Int],\\n            \\n            \\\"List of integer site IDs. Returns the specified sites.\\\"\\n            siteIds: [Int], \\n            \\n            \\\"[GeoJSON](https://namc-utah.github.io/namc-bug-db/API/geojson.html) polygon. Returns all sites within the polygon.\\\"\\n            polygon: String,\\n            \\n            \\\"Point defined as latitude and longitude in decimal degrees) and distance (meters). Returns all sites within the specified distance of the point.\\\"\\n            pointDistance: QueryDistance\\n        \\n        ): PaginatedSites\\n        \\n        \\\"\\\"\\\"\\n        The boxes API endpoint returns a set of boxes that satisfty one of the mandatory arguments.\\n        You can request boxes by specifying a list of box IDs, or by specifying a list of customers.\\n\\n        Note that Box IDs are retained from the old NAMC database.\\n        A box with a specific ID in either the BugLab or Pilot database should have the same ID in the new database.\\n        \\\"\\\"\\\"\\n        boxes(limit: Int = \", \", offset: Int = 0,\\n        \\n            \\\"List of integer box IDs. Returns the specified box(es).\\\"\\n            boxIds: [Int],\\n            \\n            \\\"List of integer customer IDs. Returns all boxes belonging to the customer(s). Note that customer organizations are hierarchical. If you provide the customer ID for the BLM you will get back all samples for the entire BLM (i.e. all states and all field offices). If you provide the customer ID for the Colorado BLM you will get back all samples belonging to field offices within the state of Colorado.\\\"\\n            entityIds: [Int]\\n        \\n        ): PaginatedBoxes\\n\\n        userBoxes(limit: Int = \", \", offset: Int = 0): PaginatedBoxes\\n\\n        \\\"\\\"\\\"\\n        The projects API endpoint returns a set of all projects in the database.\\n        Projects are intended to be flexible containers that make it easy to work with custom collections of samples.\\n        API users can create projects, add and remove samples to a project.\\n        Each sample can be associated with multiple projects. \\n        \\\"\\\"\\\"\\n        projects(limit: Int = \", \", offset: Int = 0): PaginatedProjects\\n\\n        \\\"\\\"\\\"\\n        List of all predictors in the system.\\n        Includes summary information about how many models rely on each predictor.\\n        \\\"\\\"\\\"\\n        predictors(limit: Int = \", \", offset: Int = 0,\\n        \\n            \\\"Optional integer model ID. Returns only predictors associated with this model.\\\"\\n            modelId: Int\\n        \\n        ): PaginatedPredictors\\n\\n        \\\"\\\"\\\"\\n        List of all models in the system.\\n        Includes summary information about how many predictors are used by the model\\n        as well as the translation that is be required.\\n\\n        Use the modelInfo API endpoint for more detailed information about a specific model, including its model extent polygon.\\n        \\\"\\\"\\\"\\n        models(limit: Int = \", \", offset: Int = 0): PaginatedModels\\n\\n        \\\"\\\"\\\"\\n        List of predictor values at a single site.\\n        Site predictors are non-temporal.\\n        The value applies to all samples collected at the specific site.\\n\\n        See samplePredictors for temporal predictors that vary by the sample date.\\n        \\\"\\\"\\\"\\n        sitePredictorValues(\\n            \\n            \\\"Mandatory site ID for which predictor values are required.\\\"\\n            siteId: Int!,\\n            \\n            limit: Int = \", \", offset: Int = 0\\n        \\n        ): PaginatedSitePredictorValues\\n\\n        \\\"\\\"\\\"\\n        List of all predictor values for a single sample.\\n        This includes both temporal and non-temporal predictors as well as their calculation status (current, missing, expired).\\n        \\\"\\\"\\\"\\n        samplePredictorValues(\\n            \\n            \\\"Mandatory integer Sample ID for which sample predictor values are required.\\\"\\n            sampleId: Int!\\n        ): PaginatedSamplePredictorValue\\n\\n        \\\"\\\"\\\"\\n        Returns all model results for the specified sample(s).\\n        Model results refer to the outputs of running one of the O2E, MMI or physical models (temperature, phosphoros, water quality).\\n        \\\"\\\"\\\"\\n        modelResults(limit: Int = \", \", offset: Int = 0,\\n        \\n            \\\"Mndatory list of integer sample IDs for which to return model results.\\\"\\n            sampleIds: [Int]!\\n        \\n        ): PaginatedModelResult\\n\\n        ####################################################################################################################################################################################\\n        # Taxonomy queries\\n\\n        \\\"\\\"\\\"\\n        List of all taxa in the system.\\n        Includes information about each level of the taxonomic hierarchy above each taxa.\\n        \\\"\\\"\\\"\\n        taxonomy(limit: Int = \", \", offset: Int = 0,\\n        \\n            \\\"\\\"\\\"\\n            Optional search term to filter the taxa returned.\\n            SQL wildcards are permited.\\n            i.e. to find taxa starting with Clor use 'Clor%'.\\n            To search for clor anywhere in the name of a taxa uses '%clor%'.\\n            An asterix can also be used to wildcard a single character.\\n\\n            Search terms are case insensitive.\\n            \\\"\\\"\\\"\\n            searchTerm: String\\n        \\n            taxonomyIds: [Int]\\n\\n        ): PaginatedTaxonomies\\n\\n        \\\"\\\"\\\"\\n        List of all taxonomic attributes (e.g. clinger, swimmer, HBI) in the system.\\n\\n        Use the taxaAttributes endpoint if you want the attribute values for a specific taxon.\\n        \\\"\\\"\\\"\\n        attributes(limit: Int = \", \", offset: Int = 0): PaginatedAttributes\\n\\n        \\\"\\\"\\\"\\n        List of all attribute values for a single taxon.\\n\\n        Use the taxonomy API endpoint to discover the taxonomy ID for a particular taxon.\\n        \\\"\\\"\\\"\\n        taxaAttributes(\\n            \\n            \\\"\\\"\\\"\\n            Mandatory integer taxonomy ID for which attributes are required.\\n            \\n            Use the taxonomy API endpoint to discover the taxonomy ID for a particular taxon.\\n            \\\"\\\"\\\"\\n            taxonomyId: Int, limit: Int = \", \", offset: Int = 0): PaginatedAttributeValues\\n  \\n        \\\"\\\"\\\"\\n        List all the taxa within a specific translation (OTU)\\n\\n        The taxa associated with a translation are only those taxa at which organism counts are rolled.\\n        In other words a translation in the database does not store every taxa included in an OTU,\\n        only those taxa at which counts are roll up to.\\n\\n        For example, an OTU might include many species, genus and families that all roll up to a single \\n        order. In the database, the translation is defined with only a single taxon, that of the order.\\n        Any taxa below this order are automatically rolled up to this order during processing.\\n\\n        See the [online documentation on translations](https://namc-utah.github.io/namc-bug-db/translations.html) for more information.\\n        \\\"\\\"\\\"\\n        translationTaxa(limit: Int = \", \", offset: Int = 0, \\n        \\n            \\\"\\\"\\\"\\n            Mandatory integer translation ID for which you require taxa.\\n\\n            Use the translations API endpoint to discover the database IDs for each translation.\\n            \\\"\\\"\\\"\\n            translationId: Int!\\n        \\n        ): PaginatedTranslationTaxa\\n       \\n        \\\"\\\"\\\"\\n        List of all translations (OUT) in the system.\\n        Translations have replaced OTUs in the new database.\\n     \\n        See the [online documentation on translations](https://namc-utah.github.io/namc-bug-db/translations.html) for more information.\\n        \\\"\\\"\\\"\\n        translations(limit: Int = \", \", offset: Int = 0): PaginatedTranslations\\n\\n        ####################################################################################################################################################################################\\n        # Sample side table queries\\n\\n        \\\"List of all plankton samples in the system.\\\"\\n        planktonSamples(limit: Int = \", \", offset: Int = 0): PaginatedPlankton\\n\\n        \\\"List of all drift samples in the system.\\\"\\n        driftSamples(limit: Int = \", \", offset: Int = 0): PaginatedDrift\\n\\n        \\\"List of all fish samples in the system.\\\"\\n        fishSamples(limit: Int = \", \", offset: Int = 0): PaginatedFish\\n\\n        \\\"List of all mass samples in the system.\\\"\\n        massSamples(limit: Int = \", \", offset: Int = 0): PaginatedMass\\n\\n        # \\\"List all fish diet samples in the system\\\"\\n        # fishDiet(limit: Int = \", \", offset: Int = 0, sampleIds: [Int]): PaginatedFishDiet\\n\\n        ####################################################################################################################################################################################\\n        # Sample Taxa queries\\n        \\n\\n        sampleTaxaAttributes(limit: Int = \", \", offset: Int = 0, \\n          \\\"List of integer sample IDs.\\\"\\n          sampleIds: [Int], \\n\\n          \\\"List of integer box IDs. Returns all samples associated with the specified box(es).\\\"\\n          boxIds: [Int],\\n\\n          \\\"List of integer project IDs. Returns all samples associated with the specified project(s).\\\"\\n          projectIds: [Int],\\n\\n          \\\"List of integer customer IDs. Returns all samples belonging to the customer(s). Note that customer organizations are hierarchical. If you provide the customer ID for the BLM you will get back all samples for the entire BLM (i.e. all states and all field offices). If you provide the customer ID for the Colorado BLM you will get back all samples belonging to field offices within the state of Colorado.\\\"\\n          entityIds: [Int],\\n\\n          \\\"List of integer site IDs. Returns all samples collected at the site(s).\\\"\\n          siteIds: [Int],\\n\\n          \\\"[GeoJSON](https://namc-utah.github.io/namc-bug-db/API/geojson.html) polygon. Returns all samples collected at sites within the polygon.\\\"\\n          polygon: String,\\n\\n          \\\"Point defined as latitude and longitude in decimal degrees) and distance (meters). Returns all samples collected within the specified distance of the point.\\\"\\n          pointDistance: QueryDistance\\n\\n        ): PaginatedSampleTaxaAttribute\\n\\n        \\\"\\\"\\\"\\n        Sample organisms summed by taxonomy, life stage and bug size. This is a more detailed query that provides\\n        access to the raw organism counts.\\n        \\n        Raw organism counts are summed by laboratory taxon, bug size and lifestage. No conversion to abundance is applied.\\n        \\\"\\\"\\\"\\n        sampleTaxa(\\n            \\n            \\\"Mandatory integer sample ID\\\"\\n            sampleIds: [Int],\\n\\n            boxId: Int,\\n\\n            projectId: Int,\\n            \\n            limit: Int = \", \", \\n            \\n            offset: Int = 0\\n        ): PaginatedSampleTaxaInfo\\n        \\\"\\\"\\\"\\n        Sample organisms converted to a translation (OTU).\\n\\n        This query first converts each organism to an abundance using lab and field splits and then rolls\\n        up the abundance to those taxa present in the translation.\\n        Any organism that does not rollup to a taxon present in the specified translation is omitted.\\n\\n        See the [online documentation on translations](https://namc-utah.github.io/namc-bug-db/translations.html) for more information.      \\n        \\\"\\\"\\\"\\n        sampleTaxaTranslation(\\n            \\n            \\\"Mandatory integer sample ID\\\"\\n            sampleIds: [Int],\\n\\n            boxId: Int,\\n\\n            projectId: Int,\\n\\n            \\\"Mandatory translation (OTU) ID. Use the translations API endpoint to obtain the database IDs for each translation.\\\"\\n            translationId: Int!\\n            limit: Int = \", \", \\n            offset: Int = 0\\n        ): PaginatedSampleTaxaTranslated\\n\\n        \\\"\\\"\\\"\\n        Sample organisms converted to the translation (OTU) and then rarefied to the specified fixed count.\\n\\n        organism are first grouped by laboratory taxa (ignoring bug size, life sage and big rare count) and then\\n        converted to abundance. Taxa are then converted to the specified translation (OTU) rolling up to the next\\n        highest taxa present in the translation. Organisms that don't roll up to a taxa present in the translation\\n        are omitted.\\n        \\n        The abundances are expanded to create one record for each organism, from which random\\n        selections are made until the fixed count is achieved. If the total number of organisms is less than the \\n        fixed count then all records are returned. Finally the selected records are re-grouped by translation\\n        taxa, summing the abundances.\\n        \\\"\\\"\\\"\\n        sampleTaxaTranslationRarefied(\\n            sampleIds: [Int],\\n\\n            \\\"Mandatory integer sample ID\\\"\\n            boxId: Int,\\n\\n            projectId: Int,\\n            \\n            \\\"Mandatory translation (OTU) ID. Use the translations query to obtain the database IDs for each translations.\\\"\\n            translationId: Int!,\\n            \\n            \\\"The total count of organisms to be returned (across all taxa). The actual total might be less if the sample contains fewer organisms than the specified fixed count.\\\"\\n            fixedCount:Int!\\n\\n            limit: Int = \", \", \\n            offset: Int = 0\\n        \\n        ):PaginatedSampleTaxaTranslated\\n\\n        sampleTaxaUnambiguous(\\n            sampleIds: [Int],\\n\\n            \\\"Mandatory integer sample ID\\\"\\n            boxId: Int,\\n\\n            projectId: Int,\\n            \\n            limit: Int = \", \", \\n            offset: Int = 0\\n        \\n        ):PaginatedSampleTaxa\\n\\n        ####################################################################################################################################################################################\\n        # Metric queries\\n\\n        \\\"\\\"\\\"\\n        Returns a list of all metrics defined in the system. \\n        \\\"\\\"\\\"\\n        metrics(limit: Int = \", \", offset: Int = 0): PaginatedMetrics\\n\\n        \\\"\\\"\\\"\\n        Calculates active metrics for the sample using the specified translation and fixed count.\\n        Note that the values returned are not stored in the database. They are calculated anew with each API\\n        request. Metrics that depend on rarefaction will be different with each subsequent request.\\n\\n        Metrics can be calculated for a list of samples, boxes or projects. You must provide one of these\\n        lists or an error is returned. You cannot provide more than one list (e.g. a list of samples and a list of projects).\\n        The list provided cannot be empty.\\n\\n        Use the projects and translations (OTU) API endpoints to determine the database IDs for these arguments.\\n        \\\"\\\"\\\"\\n        # sampleMetrics(\\n            \\n        #     \\\"List of integer sample IDs\\\"\\n        #     sampleIds: [Int],\\n            \\n        #     \\\"List of integer box IDs. All boxes associated with the box(es) are returned.\\\"\\n        #     boxIds: [Int],\\n            \\n        #     \\\"List of integer project IDs. All samples associated with the project(s) are returnded.\\\"\\n        #     projectIds: [Int],\\n            \\n        #     \\\"Mandatory integer translation (OTU) ID\\\"\\n        #     translationId: Int!,\\n            \\n        #     \\\"Mandatory total number of organisms to be used by those metrics that use rarefaction.\\\"\\n        #     fixedCount: Int!\\n        # ): PaginatedMetricResult\\n\\n        # Query for populating the sites map UI\\n        mapSites(limit: Int = \", \", offset: Int = 0): PaginatedMapSites\\n\\n        sampleMetrics(limit: Int = \", \", offset: Int = 0\\n          sampleIds: [Int]\\n          projectId: Int,\\n          boxId: Int,\\n          translationId: Int!,\\n          fixedCount: Int!,\\n        ): PaginatedMetricResult\\n\\n        boxTaxa(limit: Int = \", \", offset: Int = 0,\\n          boxId: Int!\\n        ): PaginatedBoxTaxa\\n\\n        # Retrieve the currently logged in user's account information and permissions\\n        myProfile: Profile\\n\\n        # Retrieve a list of users that can perform sort operations\\n        sorters: [SortingUser]\\n\\n        getUSState(longitude: Float!, latitude: Float!): USState\\n    }\\n\\n    # this schema allows the following mutation:\\n    type Mutation {\\n        \\n        \\\"\\\"\\\"\\n        Store a non-temporal predictor value for a specific site. Non-temporal predictors do not vary over time. There is a\\n        single value per site.\\n\\n        See setSamplePredictorValue if you want to store a temporal predictor value associated with a particular sample.\\n        \\\"\\\"\\\"\\n        setSitePredictorValue(\\n            \\n            \\\"Mandatory Integer site ID\\\"\\n            siteId: Int!,\\n            \\n            \\\"Mandatory predictor ID. See predictors endpoint to identify the ID for a predictor.\\\"\\n            predictorId: Int!, \\n            \\n            \\\"Mandatory site predictor value. The value should be a floating point value represented as a string.\\\"\\n            value:String!\\n            \\n        ): Int\\n\\n        \\\"\\\"\\\"\\n        Store a temporal predictor value for a specific sample. Temporal predictors vary over time and correspond to the sample date of a sample.\\n\\n        This endpoint returns the number of rows saved to the database. 1 indicates sucess, 0 indicates something went wrong and the value cannot be stored.\\n        \\n        See setSitePredictorValue if you want to store a temporal predictor value associated with a particular site.\\n        \\\"\\\"\\\"\\n        setSamplePredictorValue(\\n            \\n            \\\"Mandatory integer sample ID\\\"\\n            sampleId: Int!,\\n            \\n            \\\"Mandatory predictor ID. See predictors endpoint to identify the ID for a particular predictor.\\\"\\n            predictorId: Int!,\\n            \\n            \\\"The predictor value should be a single floating point value represented as a string.\\\"\\n            value: String!\\n        \\n        ): Int\\n\\n        \\\"\\\"\\\"\\n        Store the upstream catchment polygon for a specific site.\\n        The catchment polygon must be a valid, non-empty \\n        [GeoJSON](https://namc-utah.github.io/namc-bug-db/API/geojson.html) polygon that partially or entirely intersects with the United States.\\n     \\n        This endpoint returns the number of rows saved to the database. 1 indicates sucess, 0 indicates something went wrong and the value cannot be stored.\\n        \\\"\\\"\\\"\\n        setSiteCatchment(\\n            \\n            \\\"ID that uniquely identifies the site\\\"\\n            siteId: Int!,\\n            \\n            \\\" [GeoJSON](https://namc-utah.github.io/namc-bug-db/API/geojson.html) polygon that partially or entirely intersects with the United States.\\\"\\n            catchment: String!\\n        \\n        ): Int\\n\\n        \\\"\\\"\\\"\\n        Create a new translation (OTU). The name is mandatory and cannot be an empty string. The description is optional.\\n\\n        The translation name must also be unique across the entire database. Use the translations endpoint to see a list\\n        of all existing translations in the database.\\n\\n        After creating the translation, use the setTranslationTaxa endpoint to associate taxa with this translation.\\n\\n        This endpoint returns the database ID assigned to the new translation.\\n        \\\"\\\"\\\"\\n        createTranslation(\\n            \\n            \\\"Name for the new translation. Cannot be empty and must be unique across all translations in the database.\\\"\\n            translationName: String!,\\n            \\n            \\\"Optional descriptive information about the translation.\\\"\\n            description: String\\n        \\n        ): Int\\n\\n        \\\"\\\"\\\"\\n        Add or update a taxa associated with a translation (OTU)\\n\\n        See information on [translations](https://namc-utah.github.io/namc-bug-db/translations.html) for which taxa\\n        to add to a translation.\\n\\n        If the specified taxa already exists within a translation, this endpoint will update it's alias and isFinal\\n        status. If the taxa does not already exist within the translation it will be added.\\n\\n        This endpoint returns the number of rows saved to the database. 1 indicates sucess, 0 indicates something went wrong and the value cannot be stored.\\n        \\\"\\\"\\\"\\n        setTranslationTaxa(\\n            \\n            \\\"Unique identifier of the translation (OTU). Use the translations endpoint to determine the ID associated with each translation.\\\"\\n            translationId: Int!, \\n            \\n            \\\"Unique identifier of the taxon being stored in the translation. Use the taxonomy endpoint to determine the IDs for individual taxa.\\\"\\n            taxonomyId: Int!, \\n            \\n            \\\"\\\"\\\"\\n            Optional name that should be used to identify the taxon within the translation.\\n            If this alias is left blank then the official NAMC scientific name is used for the taxon within the translation.\\n            \\\"\\\"\\\"\\n            alias:String,\\n            \\n            \\\"\\\"\\\"Identifies if the taxon is part of the final set used to calibrate the model associated with the translation (OTU).\\n            When isFinal is False it indicates that the taxon is part of the larger, initial list used to develop the model\\n            but not part of the final calibration set of taxa.\\\"\\\"\\\"\\n            isFinal: Boolean\\n        ): Int\\n\\n        \\\"\\\"\\\"\\n        Permanently remove a taxon from a translation.\\n\\n        The definition of the taxon remains in the database. It is merely it's association with the translation that is removed.\\n\\n        This endpoint returns the number of rows saved to the database. 1 indicates sucess, 0 indicates something went wrong and the change cannot be performed. \\n        \\\"\\\"\\\"\\n        deleteTranslationTaxa(\\n            \\n            \\\"Unique identifier of the translation (OTU). Use the translations endpoint to determine the ID associated with each translation.\\\"\\n            translationId: Int!,\\n            \\n            \\\"Unique identifier of the taxon being stored in the translation. Use the taxonomy endpoint to determine the IDs for individual taxa.\\\"\\n            taxonomyId: Int!\\n        ): Int\\n  \\n        \\\"\\\"\\\"\\n        Update information related to a specific taxon. Change its scientific name, move its level or change its parent taxon.\\n\\n        See the taxonomy endpoint to determine the unique taxonomy ID for a specific taxon.\\n\\n        See createTaxonomy endpoint for adding new taxa.\\n\\n        This endpoint returns the number of rows saved to the database. 1 indicates sucess, 0 indicates something went wrong and the change cannot be performed. \\n        \\\"\\\"\\\"\\n        setTaxonomy(taxonomyId: Int!, scientificName: String!, levelId: Int!, parentId: Int!, author: String, year:String, notes: String, metadata:String): Int\\n\\n        \\\"\\\"\\\"\\n        The createProject API endpoint creates a new project in the database.\\n        Projects are intended to be flexible containers that make it easy to work with custom collections of samples.\\n        API users can add and remove samples to a project. Each sample can be associated with multiple projects. \\n\\n        New projects are created with no associated samples.\\n        You must call the [add samples]({{ site.baseurl}}/API/Projects/addProjectSamples.html) API endpoint before the project is useful.\\n       \\n        This endpoint returns the database ID associated with the new project, for use in other endpoints.\\n        \\\"\\\"\\\"\\n        createProject(project: ProjectInput!): Int\\n\\n        updateProject(id: Int!, project: ProjectInput!): Int\\n\\n        \\\"\\\"\\\"\\n        This API endpoint associates samples with a project. The project must already exist and have been created using the [createProject]({{site.baseurl}}/API/Projects/createProject.html) API end point.\\n\\n        Only existing samples can be associated with a project (i.e. this endpoint does not create new samples). Each sample can be associated with multiple projects.  \\n\\n        If the sample is already associated with the project then no action is taken.\\n\\n        This endpoint returns the number of rows saved to the database. 0 indicates something went wrong and the change cannot be performed.   \\n        \\\"\\\"\\\"\\n        addProjectSamples(\\n            \\n            \\\"Project ID of a project that already exists in the system. Use the projects query to determine the ID of an existing project.\\\"\\n            projectId: Int!,\\n\\n            \\\"List of sample IDs to be associated with the project.\\\"\\n            sampleIds: [Int]\\n        \\n        ): Int\\n\\n        \\\"\\\"\\\"\\n        This endpoint associates all samples that are part of the specified boses to the project.\\n        Any samples that are already associated with a project are unaffected.\\n       \\n        This endpoint returns the number of rows saved to the database. 0 indicates something went wrong and the change cannot be performed.   \\n        \\\"\\\"\\\"\\n        addProjectBoxes(projectId: Int!, boxIds: [Int]): Int\\n        \\n        \\\"\\\"\\\"\\n        Removes the specified sample(s) from the project. The samples and all their\\n        associated data remain in the database and are unaffected. The only change\\n        is to disassociate the sample from the project.\\n        \\\"\\\"\\\"\\n        removeProjectSamples(\\n            \\n            \\\"Project ID from which the samples are to be removed.\\\"\\n            projectId: Int!,\\n            \\n            \\\"List of samples to be removed from the project. Any samples in the argument list that are not part of the project are ignored.\\\"\\n            sampleIds:[Int]\\n        \\n        ): Int\\n\\n        \\\"\\\"\\\"\\n        Permanently deletes a project from the system. It does not alter or affect any of the \\n        samples that are associated with the project.\\n        \\\"\\\"\\\"\\n        deleteProject(\\n            \\n            \\\"ID of the project to be deleted.\\\"\\n            projectId: Int!\\n            \\n        ): Int\\n\\n\\n        createTaxonomy(\\n          \\\"The name of the taxa identified with the laboratory.\\\"\\n          scientificName: String\\n\\n          \\\"The taxonomic level of the taxa identified within the laboratory.\\\"\\n          levelId: Int\\n\\n          \\\"The taxonomic level of the taxa identified within the laboratory.\\\"\\n          levelName: String\\n\\n          \\\"Database ID of the parent of this taxon in the NAMC taxonomic hierarchy.\\\"\\n          parentId: Int\\n\\n        ): Int\\n\\n        deleteTaxonomy(\\n          taxonomyId: Int!\\n        ): Int\\n\\n        taxIdentificationStart(\\n          \\\"Database ID that uniquely identifies the sample.\\\"\\n          sampleId: Int!\\n        ): Int\\n        taxIdentificationStop(\\n          \\\"Database ID that uniquely identifies the sample.\\\"\\n          sampleId: Int!, \\n          \\\"the time it took to perform the identification (in decimal hours)\\\"\\n          time: Float!\\n        ): Int\\n\\n        taxReconciliation(\\n            \\\"Reconcile taxa within a box\\\"\\n            boxId: Int!\\n\\n            \\\"Database ID of the taxon being changed.\\\"\\n            fromTaxonomyId: Int!\\n\\n            \\\"Database ID of the new taxon being assigned.\\\"\\n            toTaxonomyId: Int!\\n        ): Int\\n\\n\\n        labSort(\\n          \\\"Database ID that uniquely identifies the sample.\\\"\\n          sampleId: Int!,\\n          \\\"the database ID of the logged in user who performed the sort.\\\"\\n          sorterId: Int!,\\n          \\\"Proportion of the sample, in percent, that was split and then retained for sorting.\\\"\\n          labSplit: Float!,\\n          \\\"the integer number of organisms found in the sample\\\"\\n          count: Int!, \\n          \\\"Boolean whether or not alcohol was used during sorting\\\"\\n          elutriation: Boolean!,\\n          \\\"the time it took to perform the sort (in decimal hours)\\\"\\n          time: Float!\\n        ): Int\\n\\n        labStartSort(\\n          \\\"Database ID that uniquely identifies the sample.\\\"\\n          sampleId: Int!\\n        ): Int\\n\\n        labStopSort(\\n          \\\"Database ID that uniquely identifies the sample.\\\"\\n          sampleId: Int!\\n        ): Int\\n\\n        createSampleTaxaInfo(\\n          \\\"Database ID that uniquely identifies the sample.\\\"\\n          sampleId: Int!,\\n          taxonomyId: Int!,\\n          lifeStageId: Int!,\\n          bugSize: Float,\\n          splitCount: Int!,\\n          bigRareCount: Int,\\n          comments: String,\\n          noteTypeIds: [Int]\\n        ): Int\\n        \\n        deleteOrganism(\\n          organismId: Int!\\n        ): Int\\n\\n        createSampleSubmission(\\n          submitterId: Int, \\n          customerId: Int, \\n          data: JSONObject\\n        ): Int\\n\\n        setBoxInfo(\\n          boxId: Int!,\\n          boxStateId: Int!,\\n          customerId: Int!,\\n          alias: String,\\n          description: String,\\n          measurements: Boolean!,\\n          midges: Boolean!,\\n          models: [Int]\\n        ): Int\\n\\n\\n        # Create an organization. Returns organizationId\\n        createOrganization(organization: OrganizationInput!): Int\\n        # Updates an organization.\\n        updateOrganization(id: Int!, organization: OrganizationInput!): Int\\n        # Updates an organization. Returns rows affected\\n        deleteOrganization(id: Int!): Int\\n        # Create a user. Returns the userId\\n        createUser(user: IndividualInput!, organization: OrganizationInput!): Int\\n        # Update a user. Returns the userId\\n        updateUser(id: Int!, user: IndividualInput!): Int\\n        # Change a user's roles. returns entity Id\\n        updateUserRoles(userId: Int!, roleIds: [Int]!): Int\\n        \\n        rarefyBox(boxId: Int!): Int\\n\\n        rarefyProject(projectId: Int!): Int\\n\\n    } # MUTATION_END\\n\\n    input QueryDistance {\\n\\n        \\\"Latitude of the point, in decimal degrees.\\\"\\n        latitude: Float!\\n\\n        \\\"Longitude of the point in decimal degrees\\\"\\n        longitude: Float!\\n\\n        \\\"Distance from the point in meters.\\\"\\n        distance: Float!\\n    }\\n\\n    input OrganizationInput {\\n      organizationName: String,\\n      organizationTypeId: Int,\\n      address1: String,\\n      address2: String,\\n      city: String,\\n      usStateId: Int,\\n      countryId: Int,\\n      zipCode: String,\\n      phone: String\\n    }\\n\\n    input ProjectInput {\\n\\n        \\\"The name for the project must be unique across all projects in the system. It cannot be an empty string.\\\"\\n        projectName: String!,\\n\\n        \\\"Currently not used, this field is intended to distinguish private projects that can only be seen by the person who created them, from public projects that are visible to all users.\\\"\\n        isPrivate: Boolean!,\\n\\n        \\\"Optional descriptive information about the project purpose, background etc.\\\"\\n        description: String, \\n\\n        \\\"[JSON](https://namc-utah.github.io/namc-bug-db/API/json.html)|No|Optional data that can be useful for scripting and other automated processes.\\\"\\n        metadata: String, \\n\\n        \\\"Optional database ID of the individual who creates the project.\\\"\\n        contactId: Int!\\n\\n        \\\"Array of model IDs that are to be applied to the project\\\"\\n        modelIds: [Int]!\\n    }\\n\\n    input IndividualInput {\\n      firstName: String,\\n      lastName: String,\\n      phone: String,\\n      affiliationId: Int\\n    }\\n\\n    type AuthParams {\\n        loggedIn: Boolean\\n        userPool: String\\n        clientId: String\\n        region: String\\n        domain: String\\n    }\\n\\n    type Sample {  \\n\\n        \\\"Database ID that uniquely identifies the sample.\\\"        \\n        sampleId: Int\\n\\n        \\\"Database ID that unique identifies the box.\\\"\\n        boxId: Int\\n\\n        \\\"The customer that submitted the sample\\\"\\n        customerName: String\\n\\n        \\\"The abbreviated name of the customer that submitted the sample.\\\"\\n        customerAbbreviation: String\\n\\n        \\\"The name of the individual that submitted the sample.\\\"\\n        submittedBy: String\\n\\n        \\\"The current state of the box to which the sample belongs.\\\"\\n        boxState: String\\n\\n        measurements: Boolean\\n\\n        \\\"Database ID of the site where the sample was collected.\\\"\\n        siteId: Int\\n\\n        \\\"The unique name assigned to the site by NAMC.\\\"\\n        siteName: String\\n\\n        \\\"The abbreivation of the US state where the sample was collected.\\\"\\n        usState: String\\n\\n        \\\"[GeoJSON](https://namc-utah.github.io/namc-bug-db/API/geojson.html) of the site associated with the sample.\\\"\\n        siteLocation: String\\n\\n        \\\"NAMC site longitude in decimal degrees.\\\"\\n        siteLongitude: Float\\n\\n        \\\"NAMC site latitude in decimal degrees.\\\"\\n        siteLatitude: Float\\n\\n        \\\"Cmbination of the site name and sample date used for repeat visits.\\\"\\n        visitId: String\\n\\n        \\\"The site identifier provided by the customer at submission.\\\"\\n        customerSiteCode: String\\n\\n        \\\"The date that the sample was collected.\\\"\\n        sampleDate: String\\n\\n        \\\"The time that the sample was collected.\\\"\\n        sampleTime: String\\n\\n        \\\"The sample type (e.g. benthic, drift, fish diet).\\\"\\n        sampleType: String\\n\\n        \\\"The method used to collect the sample (e.g. Hess net, Surber net, Dissected Gut)\\\"\\n        sampleMethod: String\\n\\n        \\\"The habitat sampled (e.g. benthos, pelagic, pool, reachwide, stomach)\\\"\\n        habitat: String\\n\\n        \\\"Customer description of the sampled location.\\\"\\n        sampleLocation: String\\n\\n        \\\"Longitude (in decimal degrees) of the customer sampled location.\\\"\\n        sampleLongitude: Float\\n\\n        \\\"Latitude (in decimal degrees) of the customer sampled location.\\\"\\n        sampleLatitude: Float\\n\\n        \\\"Area sampled in meters squared.\\\"\\n        area: Float\\n\\n        \\\"Proportion of the sample that was retained for laboratory processing as a ratio (0-1).\\\"\\n        fieldSplit: Float\\n\\n        \\\"Customer notes collected in the field.\\\"\\n        fieldNotes: String\\n\\n        \\\"Proporation of the sample processed in the laboratory as ratio (0-1).\\\"\\n        labSplit: Float\\n\\n        \\\"Number of jars used to transport the sample.\\\"\\n        jarCount: Int\\n\\n        \\\"TODO\\\"\\n        qualitative: Boolean\\n\\n        \\\"Laboratory notes pertaining to the sample.\\\"\\n        labNotes: String\\n\\n        \\\"Mesh size in microns.\\\"\\n        mesh: Int\\n\\n        sorterId: Int\\n        sorterName: String\\n        sorterCount: Int\\n        elutriation: Boolean\\n        sortTime: Float\\n        sortStartDate: String\\n        sortEndDate: String\\n\\n        idErId: Int\\n        idErName: String\\n        idTime: Float\\n        idStartDate: String\\n        idEndDate: String\\n\\n        \\\"Date time that the sample record was created in the database.\\\"\\n        createdDate: String\\n\\n        \\\"Date time of the last change to the sample record.\\\"\\n        updatedDate: String\\n\\n        \\\"Date time of the last change to the date sampled field. This is used to determine the status of temporal predictors for the sample.\\\"\\n        sampleDateChanged: String\\n\\n        \\\"For quality assurance samples, this refers to the original sample being quality controlled.\\\"\\n        qaSampleId: Int\\n\\n        \\\"\\\"\\\"\\n        Miscellaneous information about stored as [JSON](https://namc-utah.github.io/namc-bug-db/API/metadata.html).\\n        Typically these values are used during scripting and automated processes.\\n        They also include some legacy information about the sample from the previous NAMC database.\\n        \\\"\\\"\\\"\\n        metadata: String\\n    }\\n\\n    type Site {\\n\\n        \\\"Database ID that uniquely identifies the site.\\\"\\n        siteId: Int\\n\\n        \\\"Unique name assigned to the site by NAMC\\\"\\n        siteName: String\\n\\n        \\\"System in which the site occurs (e.g. lake, pond, reservoir, spring, wetland).\\\"\\n        system: String\\n\\n        \\\"Ecosystem in which the site occurs (e.g. lotic, lentic, either)\\\"\\n        ecosystem: String\\n\\n        \\\"Longitude of the site in decimal degrees.\\\"\\n        longitude: Float\\n\\n        \\\"Latitude of the site in decimal degrees.\\\"\\n        latitude: Float\\n\\n        \\\"US state in which the site occurs.\\\"\\n        usState: String\\n\\n        \\\"US state ID in which the site occurs.\\\"\\n        usStateId: Int\\n\\n        \\\"Defines the dataset type of the waterbodyCode (e.g. NHDPlus, NHDPlusHR)\\\"\\n        waterbodyType: String\\n\\n        \\\"External identifier for the waterbody on which the site occurs (e.g. NHDPlusID for NHDPlusHR or COMID for NHDPlus)\\\"\\n        waterbodyCode: String\\n\\n        \\\"Name of the waterbody on which the site occurs.\\\"\\n        waterbodyName: String\\n\\n        \\\"Date and time that the site was added to the database.\\\"\\n        createdDate: String\\n\\n        \\\"Date and time that the site was last updated in the database.\\\"\\n        updatedDate: String\\n\\n        \\\"True if the site has a catchment polygon defined. Use the siteInfo API endpoint to retrieve the catchment polygon.\\\"\\n        hasCatchment: Boolean\\n    }\\n\\n\\\"\\\"\\\"\\nDetailed information about a single NAMC site.\\n\\nThis query includes the point and catchment geometries for the site.\\nIt also includes the number of samples available at a particular site.\\n\\nMore succinct information is available for all sites using the\\nsites API endpoint.\\n\\\"\\\"\\\"\\n    type SiteInfo {\\n        \\n        \\\"Unique database generated integer that uniquely identifies each site\\\"\\n        siteId: Int\\n\\n        \\\"Unique text identifier for each site\\\"\\n        siteName: String\\n        \\n        \\\"The ecological system (e.g. lake, pond, reservoir) in which the site is located.\\\"\\n        system: String\\n\\n        \\\"The ecosystem in which the site is located.\\\"\\n        ecosystem: String\\n\\n        \\\"[GeoJSON](https://namc-utah.github.io/namc-bug-db/API/geojson.html) point location of the site in [EPSG:4326](https://epsg.io/4326) spatial reference.\\\"\\n        location: String\\n\\n        \\\"Longtidue of the site location in decimal degrees.\\\"\\n        longitude: Float\\n\\n        \\\"Latitude of the site location in decimal degrees.\\\"\\n        latitude: Float\\n\\n        \\\"US State in which the site is located.\\\"\\n        usState: String\\n\\n        \\\"US State ID in which the site is located.\\\"\\n        usStateId: Int\\n\\n        \\\"\\\"\\\"\\n        If the site has a waterbody code, then the waterbody type identifies the system that\\n        this identifier pertains to. The waterbody type might be NHDPlus 1:100,000 or \\n        NHDPlusHR 1:24,000 etc.\\n        \\\"\\\"\\\"\\n        waterbodyType: String\\n\\n        \\\"\\\"\\\"\\n        The identifier of the waterbody on which this site occurs. Can be null. If a \\n        waterbody code exists, then the waterbodyType can be used to determine which\\n        system the code belongs to, such as NHDPlus or NHDPlusHR.\\n        \\\"\\\"\\\"\\n        waterbodyCode: String\\n\\n        \\\"The string name of the waterbody on which the site occurs. Typicall this is the stream name.\\\"\\n        waterbodyName: String\\n\\n        \\\"The latest date and time that either the site location (point) or catchment (polygon) were changed.\\\"\\n        geographyChanged: String\\n\\n        \\\"The system generated date and time that the site record was created in the database.\\\"\\n        createdDate: String\\n\\n        \\\"The system generated date and time that the site record was last changed in the database.\\\"\\n        updatedDate: String\\n\\n        \\\"[GeoJSON](https://namc-utah.github.io/namc-bug-db/API/geojson.html) polygon of the upstream area that drains into this site in [EPSG:4326](https://epsg.io/4326) spatial reference.\\\"\\n        catchment: String\\n\\n        \\\"The number of samples that are available for this site.\\\"\\n        sampleCount: Int\\n    }\\n\\n    \\\"\\\"\\\"\\\"\\n    Raw summary of organisms for a single sample. The data are returned with their original\\n    laboratory taxonomic identification.\\n    \\\"\\\"\\\"\\n    type SampleTaxa {\\n\\n        \\\"Database ID of the sample.\\\"\\n        sampleId: Int\\n\\n        \\\"The taxon identified within the laboratory.\\\"\\n        taxonomyId: Int\\n\\n        \\\"The name of the taxa identified with the laboratory.\\\"\\n        scientificName: String\\n\\n        \\\"The taxonomic level of the taxa identified within the laboratory.\\\"\\n        levelId: Int\\n\\n        \\\"The taxonomic level of the taxa identified within the laboratory.\\\"\\n        levelName: String\\n\\n        \\\"Abundance for the specified taxa and lifestage. Raw organism count adjusted by lab and field splits.\\\"\\n        splitCount: Int\\n    }    \\n    type SampleTaxaTranslated {\\n\\n        \\\"Database ID of the sample.\\\"\\n        sampleId: Int\\n\\n        \\\"The taxon identified within the laboratory.\\\"\\n        taxonomyId: Int\\n\\n        \\\"The name of the taxa identified with the laboratory.\\\"\\n        scientificName: String\\n\\n        \\\"The taxonomic level of the taxa identified within the laboratory.\\\"\\n        levelId: Int\\n\\n        \\\"The taxonomic level of the taxa identified within the laboratory.\\\"\\n        levelName: String\\n\\n        otuName: String\\n\\n        \\\"Abundance for the specified taxa and lifestage. Raw organism count adjusted by lab and field splits.\\\"\\n        splitCount: Int\\n    }\\n    type SampleTaxaAttribute {\\n\\n        \\\"Database ID of the sample.\\\"\\n        sampleId: Int\\n\\n        \\\"The taxon identified within the laboratory.\\\"\\n        taxonomyId: Int\\n\\n        \\\"The name of the taxa identified with the laboratory.\\\"\\n        scientificName: String\\n\\n        \\\"Database ID that uniquely identifies the attribute definition.\\\"\\n        attributeId: Int\\n\\n        \\\"Attribute name, unique across all attributes in the database.\\\"\\n        attributeName: String\\n\\n        \\\"Attribute value, always stored as a string.\\\"\\n        attributeValue: String\\n    }\\n\\n    type SampleTaxaInfo {\\n\\n        \\\"Organism ID uniquely identifying the taxon, life stage, split count and bug size\\\"\\n        organismId: Int\\n\\n        \\\"Database ID of the sample.\\\"\\n        sampleId: Int\\n\\n        \\\"Current state of the box to which this sample is associated.\\\"\\n        boxState: String\\n\\n       \\\"The taxon identified within the laboratory.\\\"\\n        taxonomyId: Int\\n\\n        \\\"The name of the taxa identified with the laboratory.\\\"      \\n        scientificName: String\\n\\n        \\\"The taxonomic level of the taxa identified within the laboratory.\\\"\\n        levelId: Int\\n\\n        \\\"The taxonomic level of the taxa identified within the laboratory.\\\"   \\n        levelName: String\\n\\n        \\\"Phylum of the taxa\\\"\\n        phylum: String\\n\\n        \\\"Class of the taxa\\\"\\n        class: String\\n\\n        \\\"Order of the taxa\\\"\\n        order: String\\n\\n        \\\"Family of the taxa\\\"\\n        family: String\\n\\n        \\\"Subfamily of the taxa\\\"\\n        subFamily: String\\n\\n        \\\"Genus of the taxa\\\"\\n        genus: String\\n\\n        \\\"Species of the taxa\\\"\\n        species: String\\n        \\n        \\\"Database ID of the organism(s) life stage (e.g. lavae, pupae).\\\"\\n        lifeStageId: Int\\n\\n        \\\"Life stage of the organism(s) (e.g. lavae, pupae).\\\"\\n        lifeStage: String\\n\\n        \\\"Abbreviated life stage of the organism(s) (e.g. lavae, pupae).\\\"\\n        lifeStageAbbreviation: String\\n\\n        \\\"Organism length measured in millimeters (if measurements were collected).\\\"\\n        bugSize: Float\\n\\n        \\\"Raw organism count recorded in the laboratory.\\\"\\n        splitCount: Int\\n        \\n        \\\"Proporation of the sample processed in the laboratory as ratio (0-1).\\\"\\n        labSplit: Float\\n\\n        \\\"Proportion of the sample that was retained for laboratory processing as a ratio (0-1).\\\"\\n        fieldSplit: Float\\n\\n        \\\"The raw count corrected for lab and field split.\\\"\\n        correctedCount: Float\\n        \\n        \\\"The count of big rare organisms collected in the laboratory.\\\"\\n        bigRareCount: Int\\n\\n        \\\"Comma separated list of the notes recorded during lab processing.\\\"\\n        notes: String\\n\\n        noteTypeIds: [Int]\\n\\n        \\\"Free text comments about the organism record\\\"\\n        comments: String\\n    }\\n\\n    type BoxInfo {\\n\\n        \\\"Database ID that uniquely identifies the box.\\\"\\n        boxId:                  Int\\n\\n        \\\"Database ID that uniquely identifies the customer that submitted the box.\\\"\\n        customerId:             Int\\n\\n        customer: Organization\\n\\n        \\\"Database ID that uniquely identifies the person that submitted the box.\\\"\\n        submitterId:            Int\\n\\n        \\\"Name of the person that submitted the box.\\\"\\n        submittedBy:            String\\n\\n        \\\"Database ID that identifies the current state of the box (e.g. waiting, hold, active, complete).\\\"\\n        boxStateId:             Int\\n\\n        \\\"Current state of the box (e.g. waiting, hold, active, complete).\\\"\\n        boxState:               String\\n\\n        \\\"Date that the box was received.\\\"\\n        boxReceivedDate:        String\\n\\n        \\\"Date that box processing was completed.\\\"\\n        processingCompleteDate: String\\n        \\n        \\\"Anticipated date that box processing will be complete.\\\"\\n        projectedCompleteDate:  String\\n\\n        \\\"Shorthand name for referring to the box\\\"\\n        alias: String\\n\\n        \\\"Calculated number of samples associated with the box.\\\"\\n        sampleCount:            Int\\n\\n        \\\"Descriptive information about the box.\\\"\\n        description:            String\\n\\n        \\\"Miscellaneous information about stored as [JSON](https://namc-utah.github.io/namc-bug-db/API/metadata.html). Typically used during scripting and automated processes.\\\"\\n        metadata:               String\\n\\n        \\\"True if bug sizes are to be recorded when processing the box samples.\\\"\\n        measurements:           Boolean\\n\\n        \\\"True if midges are to be collected and sent out for processing at a different laboratory\\\"\\n        midges:                 Boolean\\n\\n        modelIds:               [Int]\\n\\n        \\\"True if this box is for quality assurance purposes.\\\"\\n        sorterQa:               Boolean\\n\\n        \\\"True if this box is for quality assurance purposes.\\\"\\n        taxaQa:                 Boolean\\n\\n        \\\"Number of samples for which sorting is complete\\\"\\n        sortCompleteCount:      Int\\n\\n        \\\"Proportion of samples in this box that have been sorted\\\"\\n        sortComplete:           Float\\n\\n        \\\"Number of samples for which identification is complete\\\"\\n        idCompleteCount:        Int\\n\\n        \\\"Proportion of samples in this box for which taxonomic identification is complete\\\"\\n        idComplete:             Float\\n\\n        \\\"Date and time that the box was added to the system.\\\"\\n        createdDate:            String\\n\\n        \\\"Date and time that the box information was last updated.\\\"\\n        updatedDate:            String\\n\\n        latestSubmission: SubmissionVersion\\n\\n        submissions: [SubmissionVersion]\\n\\n        submissionCount: Int\\n    }\\n    \\n\\n    type SamplePredictorValue {\\n\\n        \\\"Database ID that uniquely identifies the predictor.\\\"\\n        predictorId:                 Int\\n\\n        \\\"Predictor abbreviated name (unique across all predictors).\\\"\\n        abbreviation:                 String\\n\\n        \\\"Name of the R script/function used to calculate predictor values.\\\"\\n        calculationScript:           String\\n\\n        \\\"\\\"\\\"\\n        True indicates sample predictors where values vary by sample date.\\n        False indicates site predictors that possess a single value for the site and that do not vary by sample date.\\n        \\\"\\\"\\\"\\n        isTemporal:                  Boolean\\n\\n        \\\"Miscellaneous information about stored as [JSON](https://namc-utah.github.io/namc-bug-db/API/metadata.html). Typically used during scripting and automated processes.\\\"\\n        predictorMetadata:           String\\n\\n        \\\"Floating point predictor value returned in string format.\\\"\\n        predictorValue:              String\\n\\n        \\\"Date and time that the predictor value was last changed.\\\"\\n        predictorValueUpdatedDate: String\\n\\n        \\\"\\\"\\\"\\n        Predictor value status:\\n        Missing indicates that the predictor value has never been calculated.\\n        Expired indicates that the predictor value requires recalculation because either the sample date has changed or the site location has changed.\\n        Valid indicates that the predictor value exists and does not require recalculation.\\n        \\\"\\\"\\\"\\n        status:                       String\\n}\\n\\ntype PlanktonSample {\\n\\n    \\\"Database ID that uniquely identifies the sample.\\\"\\n    sampleId:        Int\\n\\n    \\\"Diameter of the sampled area in metres.\\\"\\n    diameter:        Float\\n\\n    \\\"TODO\\\"\\n    subSampleCount:  Int\\n\\n    \\\"Tow lenth in metres\\\"\\n    towLength:       Float\\n\\n    \\\"volume of material in metres cubed.\\\"\\n    volume:          Float\\n\\n    \\\"Aliquot in milliliters\\\"\\n    aliquot:         Float\\n\\n    \\\"Size interval in millimeters\\\"\\n    sizeInterval:    Float\\n\\n    \\\"The two type (e.g. vertical, horizontal)\\\"\\n    towType:         String\\n\\n    \\\"Date and time that the plankton sample was last updated.\\\"\\n    updatedDate:     String\\n}\\n\\ntype DriftSample {\\n\\n    \\\"Database ID that uniquely identifies the sample.\\\"\\n    sampleId:    Int\\n\\n    \\\"Area of the net in meters squared.\\\"\\n    netArea:     Float\\n\\n    \\\"Duration that the net was in the water, recorded in hours.\\\"\\n    netDuration: Float\\n\\n    \\\"Stream depth measured in meters.\\\"\\n    streamDepth: Float\\n\\n    \\\"Net depth measurement in meters.\\\"\\n    netDepth:    Float\\n\\n    \\\"Net velocity in meters per second.\\\"\\n    netVelocity: Float\\n\\n    \\\"Date and time that the plankton sample was last updated.\\\"\\n    updatedDate: String\\n}\\n\\ntype FishSample {\\n\\n    \\\"Database ID that uniquely identifies the sample.\\\"\\n    sampleId: Int\\n\\n    \\\"Database ID identifying the fish taxon.\\\"\\n    taxonomyId: Int\\n\\n    \\\"Scientific name of the fish taxon.\\\"\\n    scientificName: String\\n\\n    \\\"Database ID identifying the taxonomic level of the fish.\\\"\\n    levelId: Int\\n\\n    \\\"Name of the taxonomic level of the fish.\\\"\\n    levelName: String\\n\\n    \\\"Length of the fish in TODO.\\\"\\n    fishLength: Float\\n\\n    \\\"Mass of the fish in grams.\\\"\\n    fishMass: Float\\n\\n    \\\"Date and time that the plankton sample was last updated.\\\"\\n    updatedDate: String\\n}\\n\\ntype MassSample {\\n \\n    \\\"Database ID that uniquely identifies the sample.\\\"\\n    sampleId: Int\\n\\n    \\\"Database ID that uniquely identifies the mass type\\\"\\n    typeId: Int\\n\\n    \\\"Abbreviated name of the mass type (e.g. FPOM, CPOM, Total)\\\"\\n    typeAbbreviation: String\\n\\n    \\\"Full name of the mass type collected (e.g. Fine Particulate Matter, Total)\\\"\\n    typeName: String\\n\\n    \\\"Database that uniquely identifies the method used to collected the mass measurement\\\"\\n    methodId: Int\\n\\n    \\\"Abbreviated name of the method used to collect the mass measurement (e.g. AFDM, Dried, Blotted)\\\"\\n    methodAbbreviation: String\\n\\n    \\\"Full name of the method used to collect the mass measurement (e.g. Ash Free Dried Matter, Dried, Blotted)\\\"\\n    methodName: String\\n\\n    \\\"Measurement mass in grams.\\\"\\n    mass: Float\\n\\n    \\\"Date and time that the plankton sample was last updated.\\\"\\n    updatedDate: String\\n}\\n\\ntype ModelResult {\\n\\n    \\\"Database ID that uniquely identifies the sample.\\\"   \\n    sampleId: Int\\n\\n    \\\"Database ID that uniquely identifies the site at which the sample was collected.\\\"\\n    siteId:      Int\\n\\n    \\\"Name of the site at which the sample was collected.\\\"\\n    siteName:    String\\n\\n    \\\"Database ID that uniquely identifies the model to which the result pertains.\\\"\\n    modelId:     Int\\n\\n    \\\"Full name of the model to which the result pertains.\\\"\\n    modelName: String\\n\\n    \\\"Version of the model that was used to generate the result (e.g. 1.2.3).\\\"\\n    modelVersion: String\\n\\n    \\\"The model result value.\\\"\\n    modelResult: Float\\n\\n    \\\"The model condition obtained by the model result. See the modelConditions API endpoint for all possible conditions for a specific model.\\\"\\n    condition: String\\n\\n    \\\"Fixed count used for rarefaction during model calculation.\\\"\\n    fixCount: Int\\n\\n    \\\"Miscellaneous notes provided by the analyst that performed the model calculation.\\\"\\n    notes: String\\n\\n    \\\"Miscellaneous information about stored as [JSON](https://namc-utah.github.io/namc-bug-db/API/metadata.html). Typically used during scripting and automated processes.\\\"\\n    metadata: String\\n\\n    \\\"Date and time that the model result was added to the database.\\\"\\n    createdDate: String\\n\\n    \\\"Date and time that the model result was last updated in the database.\\\"\\n    updatedDate: String\\n}\\n\\n# type FishDiet {\\n#     sampleId:            Int\\n#     sampleDate:          String\\n#     siteId:              Int\\n#     siteName:            String\\n#     fishWeight:          Float\\n#     fishLength:          Float\\n#     fishTaxonomyId:     Int\\n#     fishScientificName: String\\n#     notes:                String\\n#     metadata:             String\\n#     organicWeight:       Float\\n#     inorganicWeight:     Float\\n#     otherWeight:         Float\\n#     createdDate:         String\\n#     updatedDate:         String\\n#     taxonomyId:          Int\\n#     scientificName:      String\\n#     lifeStageId:        Int\\n#     lifeStage: String\\n#     count:                Float\\n#     weight:               Float\\n# }\\n\\n\\n    #  type Individual {\\n    #     entityId: Int\\n    #     firstName: String\\n    #     lastName: String\\n    #     initials: String\\n    #     affilitationId: Int\\n    #     affiliation: String\\n    #     email: String\\n    #     title: String\\n    #     address1: String\\n    #     address2: String\\n    #     city: String\\n    #     stateName: String\\n    #     countryName: String\\n    #     zipCode: String\\n    #     phone: String\\n    #     fax: String\\n    # }\\n\\n    type Box {\\n        boxId: Int\\n        customerId: Int\\n        customerName: String\\n        sampleCount: Int\\n        submitterId: Int\\n        submittedBy: String\\n        boxStateId: Int\\n        boxState: String\\n        alias: String\\n        boxReceivedDate: String\\n        processingCompleteDate: String\\n        projectedCompleteDate: String\\n        measurements: Boolean\\n        midges: Boolean\\n        sortComplete: Float\\n        idComplete: Float\\n        createdDate: String\\n        # These come from other queries\\n        submissionCount: Int\\n    }\\n\\n    type Project {\\n\\n        \\\"Database ID that uniquely identifies the project.\\\"\\n        projectId: Int\\n\\n        \\\"Unique name for the project.\\\"\\n        projectName: String\\n\\n        \\\"Not currently used. All projects are currently public and visible to all users.\\\"\\n        isPrivate: Boolean\\n\\n        \\\"Database ID of the person who created the project.\\\"\\n        contactId: Int\\n        \\n        \\\"Full name of the person who created the project.\\\"\\n        contactName: String\\n\\n        \\\"Miscellaneous information about the project.\\\"\\n        description: String\\n\\n        \\\"Number of samples currently associated with a project.\\\"\\n        sampleCount: Int\\n\\n        modelIds: [Int]!\\n\\n        \\\"Date and time that the project was created.\\\"\\n        createdDate: String\\n\\n        \\\"Date and time that the basic project information was last updated. This does not reflect the addition or removal of samples.\\\"\\n        updatedDate: String\\n    }\\n\\n    type Taxonomy {\\n\\n        \\\"Database ID that uniquely identifies the taxon.\\\"\\n        taxonomyId: Int\\n\\n        \\\"Current NAMC laboratory scientic name for the taxon. Scientific names are unique across all taxa.\\\"\\n        scientificName: String\\n\\n        \\\"Database ID that identifies the taxonomic level of the taxon.\\\"\\n        levelId: Int\\n\\n        \\\"Taxonomic level of the taxon.\\\"\\n        levelName: String\\n\\n        synonyms: String\\n\\n        \\\"True if the taxon is at or below the level of effort required by the lab (e.g. genus or species). Or False for taxa above that level.\\\"\\n        isTargetEffort: Boolean\\n        \\n        \\\"Database ID of the parent of this taxon in the NAMC taxonomic hierarchy.\\\"\\n        parentTaxonomyId: Int\\n\\n        \\\"Scientific name of the parent of this taxon in the NAMC taxonomic hierarchy.\\\"\\n        parentScientificName: String\\n\\n        \\\"Database ID of the taxonomic level of the parent in the NAMC taxonomic hierarchy.\\\"\\n        parentLevelId: Int\\n\\n        \\\"Taxonomic level of the parent of this taxon in the NAMC taxonomic hierarchy.\\\"\\n        parentLevelName: String\\n\\n        \\\"Miscellaneous notes about the taxon.\\\"\\n        notes: String\\n\\n        \\\"Miscellaneous information about stored as [JSON](https://namc-utah.github.io/namc-bug-db/API/metadata.html). Typically used during scripting and automated processes.\\\"\\n        metadata: String\\n\\n        \\\"Date and time that this taxon was added to the database.\\\"\\n        createdDate: String\\n\\n        \\\"Date and time that this taxon was last updated in the database.\\\"\\n        updatedDate: String\\n    }\\n\\n\\n    type Model {\\n\\n        \\\"Database ID that uniquely identifies the model.\\\"\\n        modelId: Int\\n\\n        \\\"Full name of the model, unique across all models.\\\"\\n        modelName: String\\n\\n        \\\"Abbreviated name of the model, unique across all models.\\\"\\n        abbreviation: String\\n\\n        \\\"True indicates that the model is in active use. False indicates a deprecated model.\\\"\\n        isActive: Boolean\\n\\n        \\\"Miscellaneous information about the model.\\\"\\n        description: String\\n\\n        \\\"Number of predictors currently associated with the model. Use the predictors API endpoint for a list of the predictors associated with each model.\\\"\\n        predictorCount: Int\\n\\n        \\\"Identifies the type of model\\\"\\n        modelTypeId: Int\\n\\n        \\\"Model type name\\\"\\n        modelTypeName: String\\n\\n        \\\"Number of organizations that are rarefied and passed to the model\\\"\\n        fixedCount: Int\\n\\n        \\\"Identifies the translation (OTU) used by the model\\\"\\n        translationId: Int\\n\\n        \\\"Translation used to run the model\\\"\\n        translationName: String\\n    }\\n\\n    type ModelInfo {\\n        \\\"Database ID that uniquely identifies the model.\\\"\\n        modelId: Int\\n\\n        \\\"Full name of the model, unique across all models.\\\"\\n        modelName: String\\n\\n        \\\"Abbreviated name of the model, unique across all models.\\\"\\n        abbreviation: String\\n\\n        \\\"Model type (e.g. OE, MMI, hybrid, measurement).\\\"\\n        modelType: String\\n\\n        \\\"Model type abbreviation\\\"\\n        modelTypeAbbreviation: String\\n\\n        \\\"Database ID identifying the translation (OTU) used by the model.\\\"\\n        translationId: Int\\n\\n        \\\"Name of the translation (OTU) used by the model.\\\"\\n        translation: String\\n\\n        \\\"Description of the geographic extent to which the model applies.\\\"\\n        extentDescription: String\\n\\n        \\\"Platform on which the model runs (e.g. R, MS Access).\\\"\\n        platform: String\\n\\n        \\\"Number of reference sites used to build the model.\\\"\\n        referenceSites: Int\\n\\n        \\\"TODO\\\"\\n        groupCount: Int\\n\\n        \\\"Minimum organisms required to run the model.\\\"\\n        minimumCount: Int\\n\\n        \\\"TODO\\\"\\n        oeMean: Float\\n\\n        \\\"TODO\\\"\\n        oeStdev: Float\\n\\n        \\\"TODO\\\"\\n        taxonomicEffort: String\\n\\n        \\\"True indicates the model is in active use. False indicates a deprecated model.\\\"\\n        isActive: Boolean\\n\\n        \\\"Fixed total number of organisms used to run the model.\\\"\\n        fixedCount: Int\\n\\n        \\\"Units of the model result.\\\"\\n        units: String\\n\\n        \\\"Miscellaneous information about the model.\\\"\\n        description: String\\n\\n        \\\"Miscellaneous information about stored as [JSON](https://namc-utah.github.io/namc-bug-db/API/metadata.html). Typically used during scripting and automated processes.\\\"\\n        metadata: String\\n\\n        \\\"Number of predictors currently associated with the model.\\\"\\n        predictorCount: Int\\n\\n        \\\"Date and time that the model was added to the database.\\\"\\n        createdDate: String\\n\\n        \\\"Date and time that the model was last updated in the database.\\\"\\n        updatedDate: String\\n\\n        \\\"The polygon, in [GeoJSON](https://namc-utah.github.io/namc-bug-db/API/geojson.html) format, that defines the geographic extent that the model applies to.\\\"\\n        extent: String\\n    }\\n\\n    type ModelCondition {\\n\\n        \\\"Database ID that uniquely identifies the model.\\\"\\n        modelId: Int\\n\\n        \\\"Database ID that uniquely identifies the condition for the specified model.\\\"\\n        conditionId: Int\\n\\n        \\\"Name of the condition. Must be unique across all conditions for a single model.\\\"\\n        condition: String\\n\\n        \\\"Display text for the model condition.\\\"\\n        displayText: String\\n\\n        \\\"Standardized text for the model condition\\\"\\n        standardDisplayText: String\\n\\n        \\\"Miscellaneous information about the model condition.\\\"\\n        description: String\\n    }\\n\\n    type Metric {\\n\\n        \\\"Database ID that uniquely identifies the metric.\\\"\\n        metricId: Int\\n\\n        \\\"Unique metrics name.\\\"\\n        metricName: String\\n\\n        \\\"Metric abbreviation\\\"\\n        abbreviation: String\\n\\n        \\\"Display name for the metric used in reports. If null, then the metricName is used instead.\\\"\\n        displayText: String\\n\\n        \\\"Database ID of the group in which the metric appears in reports.\\\"\\n        metricGroupId: Int\\n\\n        \\\"Name of the group in which the metric appears in reports.\\\"\\n        metricGroupName: String\\n\\n        \\\"Name of the database stored procedure that calculates the metric value.\\\"\\n        codeFunction: String\\n\\n        \\\"Whether the metric involves filtering by taxonomy, attribute or no filtering.\\\"\\n        filtering: String\\n        \\n        \\\"True indicates that the metric requires rarefied data. False indicates that the metric uses raw laboratory organism counts.\\\"\\n        isStandardized: Boolean\\n\\n        \\\"The direction that indicates an improvement in conditions (e.g. Increases, Decreases, Increase or Decrease, Variable).\\\"\\n        perturbDirection: String\\n\\n        \\\"Miscellaneous information about the metric.\\\"\\n        description: String\\n\\n        \\\"Date and time that the metric definition was added to the database.\\\"\\n        createdDate: String\\n\\n        \\\"Date and time that the metric definition was last updated in the database.\\\"\\n        updatedDate: String\\n    }\\n\\n    \\\"\\\"\\\"\\n    The value of a non-temporal predictor for a particular site.\\n    \\\"\\\"\\\"\\n    type SitePredictorValue {\\n\\n        \\\"Database ID that uniquely identifies the predictor.\\\"\\n        predictorId: Int\\n\\n        \\\"Predictor name, unique across all predictors.\\\"\\n        predictorName: String\\n\\n        \\\"The unique shorthand abbreviation for the predictor.\\\"\\n        abbreviation: String\\n\\n        \\\"Miscellaneous information about the predictor.\\\"\\n        description: String\\n\\n        \\\"The predictor type (e.g. metrics, atmosphere, geology, anthro).\\\"\\n        predictorType: String\\n\\n        \\\"\\\"\\\"\\n        The predictor value for this site. The value is always a string, even\\n        if it represents an integer or floating point value.\\n        \\\"\\\"\\\"\\n        predictorValue: String\\n\\n        \\\"Date and time that the predictor value was added to the database.\\\"\\n        createdDate: String\\n\\n        \\\"Date and time that the predictor value was last updated.\\\"\\n        updatedDate: String\\n\\n        \\\"Optional name of the R function that performs the calculation for this predictor.\\\"\\n        calculationScript: String\\n    }\\n\\n    \\\"\\\"\\\"\\n    Information about a predictor.\\n\\n    Each predictor can be associated with multiple models. Predictors can also\\n    be temporal, in which their values are associated with a particular sample,\\n    or they can be non-temporal, in which case their values are associated with\\n    sites.\\n    \\\"\\\"\\\"\\n    type Predictor {\\n\\n        \\\"Database ID that uniquely identifies the predictor.\\\"\\n        predictorId: Int\\n\\n        \\\"Predictor name, unique across all predictors in the system.\\\"\\n        predictorName: String\\n\\n        \\\"Abbreviated predictor name, unique across all predictors in the system.\\\"\\n        abbreviation: String\\n\\n        \\\"Units in which the predictor values are stored.\\\"\\n        units: String\\n\\n       \\\"Predictor type (e.g. metrics, atmosphere, geology, anthro).\\\"\\n        predictorType: String\\n\\n        \\\"\\\"\\\"\\n        Boolean representing whether the predictor varies over time or whether\\n        there is just a single value for the site. True indicates that the predictor\\n        is temporal and values are stored for each sample. False indicates that there\\n        is only one predictor value for each site.\\n        \\\"\\\"\\\"\\n        isTemporal: Boolean\\n\\n        \\\"Miscellaneous information about the predictor.\\\"\\n        description: String\\n\\n        \\\"Miscellaneous information about stored as [JSON](https://namc-utah.github.io/namc-bug-db/API/metadata.html). Typically used during scripting and automated processes.\\\"\\n        metadata: String\\n\\n        \\\"The number of models that currently use the predictor\\\"\\n        modelCount: Int\\n\\n        \\\"Date and time that the predictor was added to the database.\\\"\\n        createdDate: String\\n\\n        \\\"Date and time that the predictor was last updated in the database.\\\"\\n        updatedDate: String\\n\\n        \\\"Optional name of the R function that performs the calculation for this predictor.\\\"\\n        calculationScript: String\\n\\n        \\\"Source information about the predictor.\\\"\\n        source: String\\n    }\\n\\n    type Translation {\\n\\n        \\\"Database ID that uniquely identifies the translation (OTU).\\\"\\n        translationId: Int\\n\\n        \\\"Translation (OTU) name, unique across all translations in the system.\\\"\\n        translationName: String\\n\\n        \\\"Miscellaneous information about the translation.\\\"\\n        description: String\\n\\n        \\\"True indicates that the translation is in active use. False indicates that the translation has been deprecated.\\\"\\n        isActive: Boolean\\n\\n        \\\"Current number of taxa associated with the translation. See [translation](https://namc-utah.github.io/namc-bug-db/Technical_Reference/translations.html) for more information.\\\"\\n        taxaCount: Int\\n\\n        \\\"Date and time that the translation was added to the database.\\\"\\n        createdDate: String\\n\\n        \\\"Date and time that the translation was last updated in the database.\\\"\\n        updatedDate: String\\n    }\\n\\n    type TranslationTaxa {\\n\\n        \\\"Database ID of the translation (OTU) that this taxon appears in.\\\"\\n        translationId: Int\\n\\n        \\\"Name of the translation (OTU) that this taxon appears in.\\\"\\n        translationName: String\\n\\n        \\\"Database ID of the taxon that appears in the translation.\\\"\\n        taxonomyId: Int\\n\\n        \\\"Database ID of the taxonomic level for the taxon.\\\"\\n        levelId: Int\\n\\n        \\\"Taxonomic level of the taxon in the NAMC taxonomic hierarchy.\\\"\\n        levelName: String\\n\\n        \\\"NAMC scientific name for the taxon. This is the current scientific name used by taxonomists in the NAMC laboratory.\\\"\\n        originalScientificName: String\\n\\n        \\\"\\\"\\\"\\n        The name used for the taxon within the translation (OTU).\\n        This might be the same as the NAMC scientific name, or it might be an alias, specific to the OTU.\\n        \\\"\\\"\\\"\\n        translationScientificName: String\\n\\n        \\\"\\\"\\\"\\n        True indicates that the taxon is part of the final set of taxa used to calibrate the model.\\n        False indicates that the taxon was part of the larger set initially identified during model development.\\n        \\\"\\\"\\\"\\n        isFinal: Boolean\\n    }\\n\\n    type Attribute {\\n\\n        \\\"Database ID that uniquely identifies the attribute definition.\\\"\\n        attributeId: Int\\n\\n        \\\"Attribute name, unique across all attributes in the database.\\\"\\n        attributeName: String\\n\\n        \\\"TODO (they are all Unknown in the SLQ file) Attribute type (e.g. )\\\"\\n        attributeType: String\\n\\n        \\\"Display label used for the attribute in reports\\\"\\n        label: String\\n\\n        \\\"Miscellaneous information about the attribute.\\\"\\n        description: String\\n\\n        \\\"Miscellaneous information about stored as [JSON](https://namc-utah.github.io/namc-bug-db/API/metadata.html). Typically used during scripting and automated processes.\\\"\\n        metadata: String\\n\\n        \\\"Date and time that the attribute was added to the database.\\\"\\n        createdDate: String\\n\\n        \\\"Date and time that the attribute was last updated in the database.\\\"\\n        updatedDate: String\\n    }\\n\\n    type AttributeValue {\\n\\n        \\\"Database ID of the taxon to which this attribute value applies.\\\"\\n        taxonomyId: Int\\n\\n        \\\"Current scientific name for the taxon to which this attribute value applies.\\\"\\n        scientificName: String\\n\\n        \\\"Database ID of the taxonomic level for the taxon.\\\"\\n        levelId:  Int\\n\\n        \\\"Taxonomic level of the taxon to which this attribute value applies.\\\"\\n        levelName:  String\\n\\n        \\\"Attribute name.\\\"\\n        attributeName: String\\n\\n        \\\"Attribute type TODO (currently all Unknown)\\\"\\n        attributeType: String\\n\\n        \\\"Display label name for the attribute.\\\"\\n        label: String\\n\\n        \\\"Attribute value, always stored as a string.\\\"\\n        attributeValue: String\\n    }\\n\\n    type MetricResult  {\\n\\n        \\\"Database ID that identifies the sample.\\\"\\n        sampleId:    Int\\n\\n        \\\"Database ID that identifies the metric group for organizing metrics in reports.\\\"\\n        metricGroupId:     Int\\n\\n        \\\"Metric group name used for organizing metrics in reports.\\\"\\n        metricGroupName:   String\\n\\n        \\\"Database ID that identifies the metric.\\\"\\n        metricId:    Int\\n\\n        \\\"Metric name.\\\"\\n        metricName:  String\\n\\n        \\\"Shortened metric abbreviation\\\"\\n        metricAbbreviation: String\\n\\n        \\\"Metric value, always represented as a string.\\\"\\n        metricValue: String\\n  }\\n  # TODO: Eventually this should implement Entity but check for R problems firs\\n  # type Organization implements Entity{\\n  type Organization {\\n\\n        \\\"Database ID that uniquely identifies the organization.\\\"\\n        entityId: Int\\n\\n        \\\"Organization name, unique across all organizations in the database.\\\"\\n        organizationName: String\\n\\n        \\\"Organization Type (e.g. federal, tribe, university, other, private, state, international).\\\"\\n        organizationType: String\\n\\n        \\\"Organization Type Id.\\\"\\n        organizationTypeId: Int\\n\\n        \\\"Entity ID of the parent organization.\\\"\\n        parentEntityId: Int\\n\\n        \\\"True if the organization is a laboratory.\\\"\\n        isLab: Boolean\\n\\n        \\\"Street address line 1.\\\"\\n        address1: String\\n\\n        \\\"Street address line 2.\\\"\\n        address2: String\\n\\n        \\\"City.\\\"\\n        city: String\\n\\n        \\\"US State. Null for international organizations.\\\"\\n        usState: String\\n\\n        \\\"Country.\\\"\\n        country: String\\n\\n        usStateId: Int\\n        countryId: Int\\n\\n        \\\"Postal code.\\\"\\n        zipCode: String\\n\\n        \\\"Telephone number with area code. Format (xxx) xxx-xxxx\\\"\\n        phone: String\\n\\n        \\\"Fax number. Format (xxx) xxx-xxxx\\\"\\n        fax: String\\n\\n        \\\"Organization's website URL. Includes the http:// or https:// prefix.\\\"\\n        website: String\\n\\n        \\\"Miscellaneous information about the organization.\\\"\\n        notes: String\\n\\n        \\\"Miscellaneous information about stored as [JSON](https://namc-utah.github.io/namc-bug-db/API/metadata.html). Typically used during scripting and automated processes.\\\"\\n        metadata: String\\n\\n        \\\"Date and time that the organization was added to the database.\\\"\\n        createdDate: String\\n\\n        \\\"Date and time that the organization was last updated in the database.\\\"\\n        updatedDate: String\\n\\n        userCount: Int\\n    }\\n\\n\\n    # Pagination Types\\n  \\n    type PaginatedModels {\\n        records: [Model]\\n        nextOffset: Int\\n    }\\n    type PaginatedSites {\\n        records: [Site]\\n        nextOffset: Int\\n    }\\n    type PaginatedSamples {\\n        records: [Sample]\\n        nextOffset: Int\\n    }\\n\\n    type PaginatedBoxes {\\n        records: [Box]\\n        nextOffset: Int\\n    }\\n    type PaginatedProjects {\\n        records: [Project]\\n        nextOffset: Int\\n    }\\n    type PaginatedTaxonomies {\\n        records: [Taxonomy]\\n        nextOffset: Int\\n    }\\n\\n    type PaginatedPredictors {\\n        records: [Predictor]\\n        nextOffset: Int\\n    }\\n    type PaginatedSitePredictorValues {\\n        records: [SitePredictorValue]\\n        nextOffset: Int\\n    }\\n\\n    type PaginatedSamplePredictorValue {\\n        records: [SamplePredictorValue]\\n        nextOffset: Int\\n    }\\n\\n    type PaginatedTranslations {\\n        records: [Translation]\\n        nextOffset: Int\\n    }\\n\\n    type PaginatedTranslationTaxa {\\n        records: [TranslationTaxa]\\n        nextOffset: Int\\n    }\\n\\n    type PaginatedSampleTaxa {\\n        records: [SampleTaxa]\\n        nextOffset: Int\\n    }\\n\\n    type PaginatedSampleTaxaTranslated {\\n        records: [SampleTaxaTranslated]\\n        nextOffset: Int\\n    }\\n\\n    type PaginatedSampleTaxaInfo {\\n        records: [SampleTaxaInfo]\\n        nextOffset: Int\\n    }\\n\\n    type PaginatedSampleTaxaAttribute {\\n        records: [SampleTaxaAttribute]\\n        nextOffset: Int\\n    }    \\n\\n    type PaginatedPlankton {\\n        records: [PlanktonSample]\\n        nextOffset: Int\\n    }\\n\\n    type PaginatedDrift {\\n        records: [DriftSample]\\n        nextOffset: Int\\n    }\\n\\n    type PaginatedFish {\\n        records: [FishSample]\\n        nextOffset: Int\\n    }\\n\\n    type PaginatedMass {\\n        records: [MassSample]\\n        nextOffset: Int\\n    }\\n\\n    type PaginatedAttributes {\\n        records: [Attribute]\\n        nextOffset: Int\\n    }\\n\\n    type PaginatedAttributeValues {\\n        records: [AttributeValue]\\n        nextOffset: Int\\n    }\\n\\n    type PaginatedModelConditions {\\n        records: [ModelCondition]\\n        nextOffset: Int\\n    }\\n\\n    type PaginatedMetrics {\\n        records: [Metric]\\n        nextOffset: Int\\n    }\\n\\n    type PaginatedMetricResult {\\n        records: [MetricResult]\\n        nextOffset: Int\\n    }\\n\\n    type PaginatedModelResult {\\n        records: [ModelResult]\\n        nextOffset: Int\\n    }\\n\\n    # type PaginatedFishDiet {\\n    #     records: [FishDiet]\\n    #     nextOffset: Int\\n    # }\\n\\n    type PaginatedOrganizations {\\n        records: [Organization]\\n        nextOffset: Int\\n    }\\n\\n    type PaginatedIndividuals {\\n        records: [Individual]\\n        nextOffset: Int\\n    }\\n\\n    type PaginatedBoxTaxa {\\n        records: [BoxTaxa]\\n        nextOffset: Int\\n    }\\n\\n    type PaginatedMapSites {\\n      records: [MapSite]\\n      nextOffset: Int\\n    }\\n\\n  \\n    interface Entity {\\n      \", \"\\n    }\\n\\n    type Individual implements Entity{\\n      id: Int!\\n      firstName: String!\\n      lastName: String!\\n      initials: String\\n      email: String\\n      title: String\\n      affiliationId: Int\\n      \", \"\\n      organizationName: String\\n      roleIds: [Int]\\n    }\\n\\n    type SampleSubmitter {\\n      id: Int!\\n      firstName: String!\\n      lastName: String!\\n      initials: String\\n      email: String\\n      title: String\\n      \\\"Telephone number with area code. Format (xxx) xxx-xxxx\\\"\\n      phone: String\\n    }\\n\\n    # A user is like an individual but we're leaving that type alone for now\\n    type Profile implements Entity {\\n      id: Int!\\n      firstName: String!\\n      lastName: String!\\n      initials: String\\n      email: String\\n      title: String\\n      affiliationId: Int\\n      \", \"\\n      organizationName: String\\n      roleIds: [Int]\\n      permissions: JSONObject\\n    }\\n\\n    type SortingUser {\\n      id: Int!\\n      firstName: String!\\n      lastName: String!\\n      title: String\\n      organizationName: String\\n    }\\n\\n    type BoxTaxa {\\n      order: String\\n      family: String\\n      taxonomyId: Int\\n      scientificName: String\\n      taxonomistCounts: JSONObject\\n      sampleCount: Int\\n      totalCount: Int\\n    }\\n\\n    type SubmissionVersion {\\n      boxId: Int\\n      versionId: Int\\n      submissionId: Int\\n      submitterId: Int\\n      submitter: SampleSubmitter\\n      createdDate: String\\n      updatedDate: String\\n    }\\n\\n    type USState {\\n      id: Int!\\n      name: String!\\n      abbreviation: String!\\n    }\\n\\n    type MapSite {\\n        \\n        \\\"Unique database generated integer that uniquely identifies each site\\\"\\n        siteId: Int\\n\\n        \\\"Unique text identifier for each site\\\"\\n        siteName: String\\n        \\n        \\\"Longtidue of the site location in decimal degrees.\\\"\\n        longitude: Float\\n\\n        \\\"Latitude of the site location in decimal degrees.\\\"\\n        latitude: Float\\n\\n        \\\"US State in which the site is located.\\\"\\n        usStateId: Int\\n    }\\n\\n    \", \"\\n\"])), exports.queryLimits.organizations, exports.queryLimits.organizations, exports.queryLimits.organizations, exports.queryLimits.metrics, exports.queryLimits.samples, exports.queryLimits.sites, exports.queryLimits.boxes, exports.queryLimits.boxes, exports.queryLimits.projects, exports.queryLimits.predictors, exports.queryLimits.models, exports.queryLimits.sitePredictorValues, exports.queryLimits.modelResults, exports.queryLimits.taxonomy, exports.queryLimits.taxonomy, exports.queryLimits.taxonomy, exports.queryLimits.taxonomy, exports.queryLimits.translations, exports.queryLimits.samples, exports.queryLimits.samples, exports.queryLimits.samples, exports.queryLimits.samples, exports.queryLimits.samples, exports.queryLimits.sites, exports.queryLimits.samples, exports.queryLimits.samples, exports.queryLimits.samples, exports.queryLimits.samples, exports.queryLimits.metrics, exports.queryLimits.mapSites, exports.queryLimits.metrics, exports.queryLimits.boxes, entityFields, entityFields, entityFields, lookups_graphql_1.default);\nexports.default = typeDefs;\nvar templateObject_1;\n//# sourceMappingURL=schema.graphql.js.map","\"use strict\";\nvar __makeTemplateObject = (this && this.__makeTemplateObject) || function (cooked, raw) {\n    if (Object.defineProperty) { Object.defineProperty(cooked, \"raw\", { value: raw }); } else { cooked.raw = raw; }\n    return cooked;\n};\nvar __importDefault = (this && this.__importDefault) || function (mod) {\n    return (mod && mod.__esModule) ? mod : { \"default\": mod };\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar graphql_tag_1 = __importDefault(require(\"graphql-tag\"));\nexports.default = (0, graphql_tag_1.default)(templateObject_1 || (templateObject_1 = __makeTemplateObject([\"\\n  type Lookups {\\n    geo: GeoLookups\\n    entity: EntityLookups\\n    taxa: TaxaLookups\\n    sample: SampleLookups\\n    metric: MetricLookups\\n    billing: BillingLookups\\n  }\\n\\n  ##########################################\\n  # Sample Lookups\\n  ##########################################\\n\\n  type GeoLookups {\\n    countries: JSONObject\\n    states: JSONObject\\n    landUses: JSONObject\\n    ecosystems: JSONObject\\n    habitats: JSONObject\\n    units: JSONObject\\n    systems: JSONObject\\n    waterbodyTypes: JSONObject\\n    predictorTypes: JSONObject\\n    modelTypes: JSONObject\\n    taxonomicEffort: JSONObject\\n  }\\n\\n  type TaxaLookups {\\n    taxaLevels: JSONObject\\n    lifeStages: JSONObject\\n    attributeTypes: JSONObject\\n  }\\n\\n  ##########################################\\n  # Sample Lookups\\n  ##########################################\\n  type EntityLookups {\\n    organizationTypes: JSONObject\\n    roles: JSONObject\\n  }\\n  ##########################################\\n  # Sample Lookups\\n  ##########################################\\n  type SampleLookups {\\n    sampleMethods: JSONObject\\n    sampleTypes: JSONObject\\n    designTypes: JSONObject\\n    effortTypes: JSONObject\\n    boxStates: JSONObject\\n    massMethods: JSONObject\\n    massTypes: JSONObject\\n    noteTypes: JSONObject\\n    assetTypes: JSONObject\\n    towTypes: JSONObject\\n  }\\n\\n  ##########################################\\n  # Metric Lookups\\n  ##########################################\\n  type MetricLookups {\\n    metricGroups: JSONObject\\n    calculations: JSONObject\\n    perturbationDirections: JSONObject\\n    metricCalculationTypes: JSONObject\\n  }\\n\\n  ##########################################\\n  # Billing Lookups\\n  ##########################################\\n  type BillingLookups {\\n    lineItemTypes: JSONObject\\n    agreementTypes: JSONObject\\n  }\\n\"], [\"\\n  type Lookups {\\n    geo: GeoLookups\\n    entity: EntityLookups\\n    taxa: TaxaLookups\\n    sample: SampleLookups\\n    metric: MetricLookups\\n    billing: BillingLookups\\n  }\\n\\n  ##########################################\\n  # Sample Lookups\\n  ##########################################\\n\\n  type GeoLookups {\\n    countries: JSONObject\\n    states: JSONObject\\n    landUses: JSONObject\\n    ecosystems: JSONObject\\n    habitats: JSONObject\\n    units: JSONObject\\n    systems: JSONObject\\n    waterbodyTypes: JSONObject\\n    predictorTypes: JSONObject\\n    modelTypes: JSONObject\\n    taxonomicEffort: JSONObject\\n  }\\n\\n  type TaxaLookups {\\n    taxaLevels: JSONObject\\n    lifeStages: JSONObject\\n    attributeTypes: JSONObject\\n  }\\n\\n  ##########################################\\n  # Sample Lookups\\n  ##########################################\\n  type EntityLookups {\\n    organizationTypes: JSONObject\\n    roles: JSONObject\\n  }\\n  ##########################################\\n  # Sample Lookups\\n  ##########################################\\n  type SampleLookups {\\n    sampleMethods: JSONObject\\n    sampleTypes: JSONObject\\n    designTypes: JSONObject\\n    effortTypes: JSONObject\\n    boxStates: JSONObject\\n    massMethods: JSONObject\\n    massTypes: JSONObject\\n    noteTypes: JSONObject\\n    assetTypes: JSONObject\\n    towTypes: JSONObject\\n  }\\n\\n  ##########################################\\n  # Metric Lookups\\n  ##########################################\\n  type MetricLookups {\\n    metricGroups: JSONObject\\n    calculations: JSONObject\\n    perturbationDirections: JSONObject\\n    metricCalculationTypes: JSONObject\\n  }\\n\\n  ##########################################\\n  # Billing Lookups\\n  ##########################################\\n  type BillingLookups {\\n    lineItemTypes: JSONObject\\n    agreementTypes: JSONObject\\n  }\\n\"])));\nvar templateObject_1;\n//# sourceMappingURL=lookups.graphql.js.map","\"use strict\";\nvar __makeTemplateObject = (this && this.__makeTemplateObject) || function (cooked, raw) {\n    if (Object.defineProperty) { Object.defineProperty(cooked, \"raw\", { value: raw }); } else { cooked.raw = raw; }\n    return cooked;\n};\nvar __importDefault = (this && this.__importDefault) || function (mod) {\n    return (mod && mod.__esModule) ? mod : { \"default\": mod };\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.metrics = exports.authCheck = exports.apiCall = void 0;\nvar axios_1 = __importDefault(require(\"axios\"));\nvar graphql_1 = require(\"graphql\");\nvar graphql_tag_1 = __importDefault(require(\"graphql-tag\"));\nvar loglevel_1 = __importDefault(require(\"loglevel\"));\nvar apiCall = function (url, jwt, query, variables, timeout) {\n    var start = Date.now();\n    return (0, axios_1.default)({\n        url: url,\n        method: 'post',\n        timeout: timeout,\n        headers: {\n            Authorization: jwt ? \"Bearer \".concat(jwt) : 'Bearer NONE',\n        },\n        data: {\n            query: (0, graphql_1.print)(query),\n            variables: variables,\n        },\n    })\n        .then(function (_a) {\n        var axiosData = _a.data;\n        var time = (Date.now() - start) / 1000;\n        if (time > 10)\n            loglevel_1.default.warn(\"Query took \".concat(time.toFixed(1), \" seconds. \").concat((0, graphql_1.print)(query).replace(/\\n/g, '').slice(0, 50), \" \").concat(JSON.stringify(variables)));\n        return axiosData;\n    })\n        .catch(function (err) {\n        if (err.response && err.response.status === 404) {\n            throw new Error(\"API Url not found: \".concat(url));\n        }\n        else if (err.code && err.code === 'ECONNREFUSED') {\n            throw new Error(\"Connection refused. Could not contact: '\".concat(url, \"'\"));\n        }\n        else {\n            loglevel_1.default.error('apiCall Error', { url: url, jwt: jwt, query: (0, graphql_1.print)(query), variables: variables, err: err });\n            throw err;\n        }\n    });\n};\nexports.apiCall = apiCall;\nfunction authCheck(url, jwt, timeout) {\n    return (0, exports.apiCall)(url, jwt, (0, graphql_tag_1.default)(templateObject_1 || (templateObject_1 = __makeTemplateObject([\"\\n      query AuthCall {\\n        auth {\\n          loggedIn\\n          userPool\\n          clientId\\n          region\\n          domain\\n        }\\n      }\\n    \"], [\"\\n      query AuthCall {\\n        auth {\\n          loggedIn\\n          userPool\\n          clientId\\n          region\\n          domain\\n        }\\n      }\\n    \"]))), {}, timeout);\n}\nexports.authCheck = authCheck;\nfunction metrics(url, jwt, limit, offset, timeout) {\n    return (0, exports.apiCall)(url, jwt, (0, graphql_tag_1.default)(templateObject_2 || (templateObject_2 = __makeTemplateObject([\"\\n      query getMetrics($limit: Int, $offset: Int) {\\n        metrics(limit: $limit, offset: $offset) {\\n          records {\\n            metricId\\n            metricName\\n            displayText\\n            metricGroupId\\n            metricGroupName\\n            codeFunction\\n            isStandardized\\n            perturbDirection\\n            description\\n            createdDate\\n            updatedDate\\n            updatedDate\\n          }\\n        }\\n      }\\n    \"], [\"\\n      query getMetrics($limit: Int, $offset: Int) {\\n        metrics(limit: $limit, offset: $offset) {\\n          records {\\n            metricId\\n            metricName\\n            displayText\\n            metricGroupId\\n            metricGroupName\\n            codeFunction\\n            isStandardized\\n            perturbDirection\\n            description\\n            createdDate\\n            updatedDate\\n            updatedDate\\n          }\\n        }\\n      }\\n    \"]))), { limit: limit, offset: offset }, timeout);\n}\nexports.metrics = metrics;\nvar templateObject_1, templateObject_2;\n//# sourceMappingURL=api.js.map","\"use strict\";\nvar __assign = (this && this.__assign) || function () {\n    __assign = Object.assign || function(t) {\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\n            s = arguments[i];\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p))\n                t[p] = s[p];\n        }\n        return t;\n    };\n    return __assign.apply(this, arguments);\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.snake2camel = exports.camel2snake = void 0;\nvar change_case_1 = require(\"change-case\");\nvar camel2snake = function (inobj) {\n    return Object.keys(inobj).reduce(function (acc, key) {\n        var _a;\n        return (__assign(__assign({}, acc), (_a = {}, _a[(0, change_case_1.snakeCase)(key)] = inobj[key], _a)));\n    }, {});\n};\nexports.camel2snake = camel2snake;\nvar snake2camel = function (inobj) {\n    return Object.keys(inobj).reduce(function (acc, key) {\n        var _a;\n        return (__assign(__assign({}, acc), (_a = {}, _a[(0, change_case_1.camelCase)(key)] = inobj[key], _a)));\n    }, {});\n};\nexports.snake2camel = snake2camel;\n//# sourceMappingURL=util.js.map","var __assign = (this && this.__assign) || function () {\n    __assign = Object.assign || function(t) {\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\n            s = arguments[i];\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p))\n                t[p] = s[p];\n        }\n        return t;\n    };\n    return __assign.apply(this, arguments);\n};\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nvar __generator = (this && this.__generator) || function (thisArg, body) {\n    var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;\n    return g = { next: verb(0), \"throw\": verb(1), \"return\": verb(2) }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function() { return this; }), g;\n    function verb(n) { return function (v) { return step([n, v]); }; }\n    function step(op) {\n        if (f) throw new TypeError(\"Generator is already executing.\");\n        while (_) try {\n            if (f = 1, y && (t = op[0] & 2 ? y[\"return\"] : op[0] ? y[\"throw\"] || ((t = y[\"return\"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;\n            if (y = 0, t) op = [op[0] & 2, t.value];\n            switch (op[0]) {\n                case 0: case 1: t = op; break;\n                case 4: _.label++; return { value: op[1], done: false };\n                case 5: _.label++; y = op[1]; op = [0]; continue;\n                case 7: op = _.ops.pop(); _.trys.pop(); continue;\n                default:\n                    if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }\n                    if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }\n                    if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }\n                    if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }\n                    if (t[2]) _.ops.pop();\n                    _.trys.pop(); continue;\n            }\n            op = body.call(thisArg, _);\n        } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }\n        if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };\n    }\n};\nimport { useCallback, useLayoutEffect, useState, useRef } from 'react';\nimport Amplify, { Auth, Hub } from 'aws-amplify';\nimport log from 'loglevel';\nimport _ from 'lodash';\nvar useHostedAuth = function (config, forceSignin, verbose) {\n    var _a = useState({\n        isAuthenticated: false,\n        isAuthComplete: false,\n        error: null,\n        user: null,\n    }), loginState = _a[0], setLoginState = _a[1];\n    var stateRef = useRef();\n    stateRef.current = loginState;\n    var signIn = useCallback(function () {\n        return Auth.federatedSignIn().catch(function (error) {\n            setLoginState({ error: error, user: null, isAuthenticated: false, isAuthComplete: true });\n        });\n    }, []);\n    var refreshState = useCallback(function () {\n        return Auth.currentSession()\n            .then(function (user) {\n            var _a;\n            var newState = { error: null, user: user, isAuthenticated: true, isAuthComplete: true };\n            if (!_.isEqual((_a = stateRef.current) === null || _a === void 0 ? void 0 : _a.user, newState.user)) {\n                if (verbose)\n                    log.debug('useHosted::refreshState::setLoginState::RESULT', {\n                        stateRef: stateRef.current,\n                        newState: newState,\n                    });\n                setLoginState(newState);\n            }\n            return user;\n        })\n            .catch(function (err) {\n            var error = err;\n            if (err === 'not authenticated') {\n                error = null;\n            }\n            else if (err === 'No current user') {\n                error = null;\n            }\n            else {\n                log.error('useHosted::refreshState::ERROR', err);\n            }\n            setLoginState({ error: error, user: null, isAuthenticated: false, isAuthComplete: true });\n            if (forceSignin)\n                signIn();\n        });\n    }, [verbose, forceSignin, signIn]);\n    var getCurrentToken = useCallback(function () { return __awaiter(void 0, void 0, void 0, function () {\n        var currSession;\n        return __generator(this, function (_a) {\n            switch (_a.label) {\n                case 0: return [4, refreshState()];\n                case 1:\n                    currSession = _a.sent();\n                    try {\n                        if (currSession.accessToken.jwtToken.length > 0) {\n                            return [2, currSession && currSession.accessToken ? currSession.accessToken.jwtToken : ''];\n                        }\n                        else {\n                            throw new Error('Failed to get current token');\n                        }\n                    }\n                    catch (_b) {\n                        throw new Error('Failed to get current token');\n                    }\n                    return [2];\n            }\n        });\n    }); }, [refreshState]);\n    var signOut = useCallback(function () {\n        return Auth.signOut()\n            .then(function () {\n            setLoginState({ error: null, user: null, isAuthenticated: false, isAuthComplete: true });\n        })\n            .catch(function (error) {\n            log.error('useHosted::signOut::ERROR', error);\n            setLoginState({ error: error, user: null, isAuthenticated: false, isAuthComplete: true });\n        });\n    }, []);\n    useLayoutEffect(function () {\n        if (!config)\n            return;\n        Amplify.configure(config);\n        if (verbose) {\n            Amplify.Logger.LOG_LEVEL = 'DEBUG';\n        }\n        refreshState();\n        var handler = function (_a) {\n            var payload = _a.payload;\n            switch (payload.event) {\n                case 'configured':\n                    break;\n                case 'signIn':\n                    log.debug('signIn', payload);\n                    break;\n                case 'signIn_failure':\n                    break;\n                case 'signOut':\n                    break;\n                default:\n                    break;\n            }\n        };\n        Hub.listen('auth', handler);\n        return function () {\n            Hub.remove('auth', handler);\n        };\n    }, [config, refreshState]);\n    return __assign(__assign({}, loginState), { signIn: signIn, getCurrentToken: getCurrentToken, signOut: signOut });\n};\nexport default useHostedAuth;\n//# sourceMappingURL=useHostedAuth.js.map","import { ASTNode } from 'graphql'\nimport log from 'loglevel'\n\nimport { Api, LogLevel } from './Api'\n\n// eslint-disable-next-line @typescript-eslint/no-explicit-any\nexport type MockResponderTuples = [ASTNode, (...args: any[]) => unknown][]\n\nconst nextRequestNumber = (() => {\n  let requestNumber = 1\n  return () => String(requestNumber++)\n})()\n\nexport class MockApi implements Api {\n  responseDelay = 0\n  // eslint-disable-next-line @typescript-eslint/no-explicit-any\n  responders = new Map<ASTNode, (...args: any[]) => unknown>()\n\n  constructor(responders?: MockResponderTuples) {\n    if (responders) this.setResponders(responders)\n  }\n\n  setResponders = (responders: MockResponderTuples): void => {\n    this.responders.clear()\n    this.addResponders(responders)\n  }\n\n  addResponders = (responders: MockResponderTuples): void => {\n    responders.forEach(([queryOrMutation, responder]) => {\n      this.responders.set(queryOrMutation, responder)\n    })\n  }\n\n  setResponseDelay = (ms: number): void => {\n    this.responseDelay = ms\n  }\n\n  wait = async (): Promise<void> => {\n    return new Promise((resolve) => {\n      window.setTimeout(resolve, this.responseDelay)\n    })\n  }\n\n  signOut = (): void => {\n    log.debug('MockApi signOut')\n  }\n\n  query = async <T>(query: ASTNode, variables?: { [key: string]: unknown }): Promise<T> => {\n    const requestNumber = nextRequestNumber()\n    log.debug(\n      `%cMockApi query #${requestNumber}`,\n      'color: black; background: lightgreen',\n      query.loc?.source.body,\n      variables\n    )\n    const responder = this.responders.get(query)\n    await this.wait()\n    if (responder) {\n      const response = responder(variables)\n      log.debug(`%cMockApi responded to query #${requestNumber}`, 'color: black; background: #0cb700', response)\n      return response as T\n    }\n    return new Promise(() => {\n      log.debug(`%cMockApi not responding to query #${requestNumber}`, 'color: black; background: lightgray')\n    })\n  }\n\n  queryAllPages = async <T>(\n    query: ASTNode,\n    variables: { [key: string]: unknown },\n    // eslint-disable-next-line @typescript-eslint/no-unused-vars\n    { dataProperty }: { dataProperty: string }\n  ): Promise<T> => {\n    const requestNumber = nextRequestNumber()\n    log.debug(\n      `%cMockApi queryAllPages #${requestNumber}`,\n      'color: black; background: lightgreen',\n      query.loc?.source.body,\n      variables\n    )\n    const responder = this.responders.get(query)\n    await this.wait()\n    if (responder) {\n      const response = responder(variables)\n      log.debug(`%cMockApi responded to queryAllPages #${requestNumber}`, 'color: black; background: #0cb700', response)\n      return response as T\n    }\n    return new Promise(() => {\n      log.debug(`%cMockApi not responding to queryAllPages #${requestNumber}`, 'color: black; background: lightgray')\n    })\n  }\n\n  mutation = async <T>(query: ASTNode, variables?: { [key: string]: unknown }): Promise<T> => {\n    const requestNumber = nextRequestNumber()\n    log.debug(\n      `%cMockApi mutation #${requestNumber}`,\n      'color: black; background: #ffd17a',\n      query.loc?.source.body,\n      variables\n    )\n    const responder = this.responders.get(query)\n    await this.wait()\n    if (responder) {\n      const response = responder(variables)\n      log.debug(`%cMockApi responded to mutation #${requestNumber}`, 'color: black; background: orange', response)\n      return response as T\n    }\n    return new Promise(() => {\n      log.debug(`%cMockApi not responding to mutation #${requestNumber}`, 'color: black; background: lightgray')\n    })\n  }\n\n  log = async (level: LogLevel, message: string, context: Record<string, unknown>): Promise<void> => {\n    log.debug(`%cMockApi log ${level}`, 'color: black; background: #ff70ee', message, context)\n  }\n}\n","import { ASTNode } from 'graphql'\nimport { atom, useRecoilValue } from 'recoil'\n// import log from 'loglevel'\n\nimport { MockApi } from './MockApi'\n\nexport type LogLevel = 'DEBUG' | 'ERROR' | 'INFO' | 'WARN'\n\nexport class ApiError extends Error {\n  constructor(message: string) {\n    super()\n    this.message = message\n  }\n\n  toString(): string {\n    return this.message\n  }\n}\n\nexport interface Api {\n  signOut: () => void\n  query: <T>(query: ASTNode, variables?: Record<string, unknown>) => Promise<T>\n  queryAllPages: <T>(\n    query: ASTNode,\n    variables: Record<string, unknown>,\n    options: { dataProperty: string }\n  ) => Promise<T>\n  mutation: <T>(query: ASTNode, variables?: Record<string, unknown>) => Promise<T>\n  log: (level: LogLevel, message: string, context: Record<string, unknown>) => void\n}\n\nexport const apiState = atom({\n  key: 'apiState',\n  default: new MockApi() as Api,\n  dangerouslyAllowMutability: true,\n})\n\nexport const useApi = (): Api => useRecoilValue(apiState)\n","import log from 'loglevel'\n\nlet domain = process.env.REACT_APP_DOMAIN\nif (process.env.NODE_ENV && process.env.NODE_ENV === 'development') {\n  domain = 'localhost'\n  // basename = ''\n}\nlog.debug('config: ', { domain })\n\nexport const endpoints = {\n  graphql: `${process.env.REACT_APP_GRAPHQL}` as string,\n}\n\n/**\n * Here are the App defaults we might want to change\n */\nexport const appDefaults = {\n  apiTimeout: 20000, // ms timeout for API Queries\n}\n\nexport const redirectUrl = new URL(\n  process.env.PUBLIC_URL.endsWith('/') ? process.env.PUBLIC_URL : process.env.PUBLIC_URL + '/',\n  window.location.origin\n)\n\nlog.debug('RedirectUrl', { redirectUrl, publicUrl: process.env.PUBLIC_URL })\n","import { api } from '@namcbugdb/common'\nimport { ASTNode } from 'graphql'\nimport { UseHostedReturn } from '@namcbugdb/react-common'\nimport log from 'loglevel'\n\nimport { endpoints } from '../../config'\nimport { Api, ApiError, LogLevel } from './Api'\n\nconst TIMEOUT_SECONDS = 30\n\nconst nextRequestNumber = (() => {\n  let requestNumber = 1\n  return () => String(requestNumber++)\n})()\n\nexport class GraphApi implements Api {\n  auth: UseHostedReturn\n  signOut: () => void\n\n  constructor(auth: UseHostedReturn, signOut: () => void) {\n    this.auth = auth\n    this.signOut = signOut\n  }\n\n  send = async <T>(query: ASTNode, variables?: { [key: string]: unknown }): Promise<T> => {\n    const jwt = await this.auth.getCurrentToken()\n    const response = await api.apiCall<T>(endpoints.graphql as string, jwt, query, variables, TIMEOUT_SECONDS * 1000)\n    const { data, errors } = response\n    if (errors || !data) {\n      const errorMessagesString = errors?.map((error) => error.message).join(';') ?? 'unknown error or missing data'\n      log.error(errorMessagesString, errors)\n      // this.log('ERROR', `api`, {}) // TODO: enable with data once logging service implemented\n      if (errors && errors[0]?.message === 'Authentication Error') this.signOut()\n      throw new ApiError(errorMessagesString)\n    }\n    return data\n  }\n\n  queryAllPages = async <QueryT>(\n    query: ASTNode,\n    variables: { [key: string]: unknown },\n    { dataProperty }: { dataProperty: string }\n  ): Promise<QueryT> => {\n    let offset: number | null | undefined = 0\n    // eslint-disable-next-line @typescript-eslint/no-explicit-any\n    const allRecords: any = [] // type is the type of record\n\n    while (offset !== null) {\n      const lastData = await this.query<QueryT>(query, { ...variables, offset })\n      const { records, nextOffset } = lastData[dataProperty]\n      if (nextOffset === undefined)\n        throw new ApiError('queryAllPages was called without the query returning nextOffset.')\n      allRecords.push(...records)\n      offset = nextOffset\n      if (!offset) return { ...lastData, [dataProperty]: { records: allRecords } }\n    }\n\n    throw new Error() // unreachable code; this is just to satisfy TS\n  }\n\n  query = async <T>(query: ASTNode, variables?: { [key: string]: unknown }): Promise<T> => {\n    const requestNumber = nextRequestNumber()\n    log.debug(\n      `%cGraphApi query #${requestNumber}`,\n      'color: black; background: lightgreen',\n      query.loc?.source.body,\n      variables\n    )\n    const response = await this.send<T>(query, variables)\n    log.debug(`%cGraphApi response #${requestNumber}`, 'color: black; background: #0cb700', response)\n    return response\n  }\n\n  mutation = async <T>(query: ASTNode, variables?: { [key: string]: unknown }): Promise<T> => {\n    const requestNumber = nextRequestNumber()\n    log.debug(\n      `%cGraphApi mutation #${requestNumber}`,\n      'color: black; background: #ffd17a',\n      query.loc?.source.body,\n      variables\n    )\n\n    try {\n      const response = await this.send<T>(query, variables)\n      log.debug(`%cGraphApi response #${requestNumber}`, 'color: black; background: orange', response)\n      return response\n    } catch (err) {\n      log.debug(\n        `%cGraphApi response #${requestNumber}%c %cERROR`,\n        'color: black; background: orange',\n        'background: transpaarent',\n        'color: white; background: red'\n      )\n      throw err\n    }\n  }\n\n  // eslint-disable-next-line @typescript-eslint/no-unused-vars\n  log = async (level: LogLevel, message: string, context: Record<string, unknown>): Promise<void> => {\n    // not implemented (logging service TBD)\n  }\n}\n","import { countBy, sortBy } from 'lodash'\nimport { constSelector, selector, selectorFamily } from 'recoil'\nimport { EntityLookups, GeoLookups, GrantAction, NAMCResource } from '@namcbugdb/common'\n// import log from 'loglevel'\n\nimport { apiState } from '../api'\nimport { withDescendantIds } from '../../lib/taxonomy'\nimport { refreshOn } from './invalidate'\n\nimport {\n  Box,\n  BoxState,\n  BoxTaxon,\n  LifeStage,\n  MinimalSample,\n  Model,\n  MyUser,\n  NoteType,\n  Organization,\n  Predictor,\n  Project,\n  Role,\n  Sample,\n  Site,\n  SourceSample,\n  Submission,\n  TaxaLevel,\n  Taxon,\n  Translation,\n  User,\n  UsState,\n} from '../../types'\n\nimport {\n  fetchBoxDetailById,\n  fetchBoxes,\n  fetchBoxSamplesByBoxId,\n  fetchBoxTaxaByBoxId,\n  fetchLatestSubmissionByBoxId,\n  fetchLookups,\n  fetchMinimalSamplesByOrganizationId,\n  fetchMinimalSamplesByTaxonId,\n  fetchMinimalSamplesByUsStateId,\n  fetchModels,\n  fetchMyUser,\n  fetchOrganizationById,\n  fetchOrganizations,\n  fetchPredictors,\n  fetchProjects,\n  fetchProjectSamplesByProjectId,\n  fetchSampleById,\n  fetchSitesByBoxId,\n  fetchSitesByProjectId,\n  fetchSorterUsers,\n  fetchTaxa,\n  fetchTranslations,\n  fetchUserBoxes,\n  fetchUserById,\n  fetchUsers,\n  fetchUsStateAtCoordinates,\n} from '../calls'\n\nexport const selectTaxa = selector<Taxon[]>({\n  key: 'taxa',\n  get: async ({ get }) => {\n    const api = get(apiState)\n\n    const [taxaLevels, taxa] = await Promise.all([get(selectLookups).taxaLevels, fetchTaxa(api)()])\n\n    return withDescendantIds(\n      taxa.map((taxon) => ({\n        ...taxon,\n        levelRankOrder: taxaLevels.find(({ id }) => id === taxon.levelId)?.rankOrder ?? -1,\n      }))\n    )\n  },\n})\n\nexport const selectLookups = selector<{\n  taxaLevels: TaxaLevel[]\n  lifeStages: LifeStage[]\n  noteTypes: NoteType[]\n  boxStates: BoxState[]\n  sampleMethodNames: string[]\n  sampleTypeNames: string[]\n  towTypeNames: string[]\n  designTypeNames: string[]\n  effortTypeNames: string[]\n  habitatNames: string[]\n  ecosystemNames: string[]\n  waterBodyTypeNames: string[]\n  usStates: UsState[]\n  countries: GeoLookups['countries']\n  organizationTypes: EntityLookups['organizationTypes']\n  roles: Role[]\n}>({\n  key: 'lookups',\n  get: async ({ get }) => {\n    const api = get(apiState)\n    return fetchLookups(api)()\n  },\n})\n\nexport const selectLifeStages = selector<LifeStage[]>({\n  key: 'selectors/lifeStages',\n  get: async ({ get }) => get(selectLookups).lifeStages,\n})\n\nexport const selectNoteTypes = selector<NoteType[]>({\n  key: 'selectors/noteTypes',\n  get: async ({ get }) => get(selectLookups).noteTypes,\n})\n\nexport const selectBoxStates = selector<BoxState[]>({\n  key: 'selectors/boxStates',\n  get: async ({ get }) => get(selectLookups).boxStates,\n})\n\nexport enum BOX_STATE_ID {\n  // acceptable hardcoding: https://github.com/namc-utah/namc-bug-db/issues/449#issuecomment-1007606364\n  pending = 1,\n  active = 5,\n}\n\nexport const selectUsStates = selector<UsState[]>({\n  key: 'selectors/selectUsStates',\n  get: async ({ get }) => {\n    const usStates = get(selectLookups).usStates\n    return sortBy(usStates, 'abbreviation')\n  },\n})\n\nexport const selectRoles = selector<Role[]>({\n  key: 'selectors/selectRoles',\n  get: async ({ get }) => get(selectLookups).roles,\n})\n\nexport const selectSystemAdminRoleLevel = constSelector<number>(0)\n\nexport const selectUsCountryId = selector<number>({\n  key: 'selectors/selectUsCountryId',\n  get: async ({ get }) => {\n    const countries = get(selectLookups).countries\n    const usCountryId = countries.find((country) => country.name === 'United States')?.id\n    if (!usCountryId) throw new Error('failed to determine United States country ID')\n    return usCountryId\n  },\n})\n\nexport const selectDefaultOrganizationTypeId = selector<number>({\n  key: 'selectors/selectDefaultOrganizationTypeId',\n  get: async ({ get }) => {\n    const organizationTypes = get(selectLookups).organizationTypes\n    const defaultOrganizationTypeId = organizationTypes.find(\n      (organizationType) => organizationType.name === 'Other' // TODO: should this be \"unknown\"?\n    )?.id\n    if (!defaultOrganizationTypeId) throw new Error('failed to determine default organization type')\n    return defaultOrganizationTypeId\n  },\n})\n\nexport const selectSampleById = selectorFamily<Sample | null, number>({\n  key: 'selectors/selectSampleById',\n  get:\n    (id) =>\n    async ({ get }) => {\n      get(refreshOn('samples'))\n\n      const api = get(apiState)\n      return fetchSampleById(api)(id)\n    },\n})\n\nexport const selectSorterUsers = selector<User[]>({\n  key: 'selectors/sorterUsers',\n  get: async ({ get }) => {\n    get(refreshOn('users'))\n\n    const api = get(apiState)\n    return fetchSorterUsers(api)()\n  },\n})\n\nexport const selectHasUser = selector<boolean>({\n  key: 'selectors/selectHasUser',\n  get: async ({ get }) => {\n    const user = get(selectMyUser)\n    return !user.virtual\n  },\n})\n\nexport const selectMyUser = selector<MyUser>({\n  key: 'selectors/selectMyUser',\n  get: async ({ get }) => {\n    get(refreshOn('myUser'))\n\n    const api = get(apiState)\n    const myUser = await fetchMyUser(api)()\n\n    if (!myUser)\n      return {\n        id: -1,\n        affiliationId: -1,\n        email: '',\n        phone: '',\n        firstName: '',\n        lastName: '',\n        fullName: 'New User',\n        hasPermission: () => false,\n        organizationName: '',\n        virtual: true,\n        roleIds: [],\n      }\n\n    const hasPermission = (resource: NAMCResource, grantAction: GrantAction) => {\n      const explicitPermission = !!myUser.permissions[grantAction]?.includes(resource)\n      const implicitPermission = !!myUser.permissions[grantAction.replace('Own', 'Any')]?.includes(resource) // if I have Any, implicitly have Own\n      return explicitPermission || implicitPermission\n    }\n    return { ...myUser, hasPermission }\n  },\n})\n\nexport const selectBoxes = selector<Box[]>({\n  key: 'selectors/boxes',\n  get: async ({ get }) => {\n    get(refreshOn('boxes'))\n    get(refreshOn('boxSamples'))\n\n    const api = get(apiState)\n    return fetchBoxes(api)()\n  },\n})\n\nexport const selectUserBoxes = selector<Box[]>({\n  key: 'selectors/selectUserBoxes',\n  get: async ({ get }) => {\n    get(refreshOn('boxes'))\n\n    const api = get(apiState)\n    return fetchUserBoxes(api)()\n  },\n})\n\nexport const selectBoxById = selectorFamily<Box | null, number>({\n  key: 'selectors/boxById',\n  get:\n    (id) =>\n    async ({ get }) => {\n      get(refreshOn('boxes'))\n\n      const api = get(apiState)\n      return fetchBoxDetailById(api)(id)\n    },\n})\n\nexport const selectPredictors = selector<Predictor[]>({\n  key: 'selectors/predictors',\n  get: async ({ get }) => {\n    const api = get(apiState)\n    return fetchPredictors(api)()\n  },\n})\n\nexport const selectBoxSamplesByBoxId = selectorFamily<SourceSample[], number>({\n  key: 'selectors/boxSamplesByBoxId',\n  get:\n    (id) =>\n    async ({ get }) => {\n      get(refreshOn('samples'))\n      get(refreshOn('boxSamples'))\n\n      const api = get(apiState)\n      return fetchBoxSamplesByBoxId(api)(id)\n    },\n})\n\nexport const selectOrganizations = selector<Organization[]>({\n  key: 'selectors/organizations',\n  get: async ({ get }) => {\n    get(refreshOn('organizations'))\n\n    const api = get(apiState)\n    const organizations = await fetchOrganizations(api)()\n    const nameCount = countBy(organizations, 'name')\n    return organizations.map(({ id, name, ...rest }) => ({\n      id,\n      name: nameCount[name] > 1 ? `${name} [${id}]` : name,\n      ...rest,\n    }))\n  },\n})\n\nexport const selectOrganizationById = selectorFamily<Organization | null, number>({\n  key: 'selectors/selectOrganizationById',\n  get:\n    (id) =>\n    async ({ get }) => {\n      get(refreshOn('organizations'))\n\n      const api = get(apiState)\n      return fetchOrganizationById(api)(id)\n    },\n})\n\nexport const selectModels = selector<Model[]>({\n  key: 'selectors/models',\n  get: async ({ get }) => {\n    const api = get(apiState)\n    return fetchModels(api)()\n  },\n})\n\nexport const selectProjects = selector<Project[]>({\n  key: 'selectors/projects',\n  get: async ({ get }) => {\n    get(refreshOn('projects'))\n    get(refreshOn('projectSamples'))\n\n    const api = get(apiState)\n    return fetchProjects(api)()\n  },\n})\n\nexport const selectTranslations = selector<Translation[]>({\n  key: 'selectors/translations',\n  get: async ({ get }) => {\n    const api = get(apiState)\n    return fetchTranslations(api)()\n  },\n})\n\nexport const selectUsStateAtCoordinates = selectorFamily<UsState | null, { latitude: number; longitude: number }>({\n  key: 'selectors/selectUsStateAtCoordinates',\n  get:\n    ({ latitude, longitude }) =>\n    async ({ get }) => {\n      const api = get(apiState)\n      return fetchUsStateAtCoordinates(api)({ latitude, longitude })\n    },\n})\n\nexport const selectUsers = selector<User[]>({\n  key: 'selectors/selectUsers',\n  get: async ({ get }) => {\n    get(refreshOn('users'))\n\n    const api = get(apiState)\n    return fetchUsers(api)()\n  },\n})\n\nexport const selectUserById = selectorFamily<User | null, number>({\n  key: 'selectors/selectUserById',\n  get:\n    (id) =>\n    async ({ get }) => {\n      get(refreshOn('users'))\n\n      const api = get(apiState)\n      return fetchUserById(api)(id)\n    },\n})\n\nexport const selectLatestSubmissionByBoxId = selectorFamily<Submission | null, number>({\n  key: 'selectors/selectLatestSubmissionByBoxId',\n  get:\n    (id) =>\n    async ({ get }) => {\n      get(refreshOn('boxes'))\n\n      const api = get(apiState)\n      return fetchLatestSubmissionByBoxId(api)(id)\n    },\n})\n\nexport const selectSitesByBoxId = selectorFamily<Site[], number>({\n  key: 'selectSitesByBoxId',\n  get:\n    (id) =>\n    async ({ get }) => {\n      get(refreshOn('sites'))\n      get(refreshOn('boxSamples'))\n\n      const api = get(apiState)\n      return fetchSitesByBoxId(api)(id)\n    },\n})\n\nexport const selectProjectById = selectorFamily<Project | null, number>({\n  key: 'selectors/selectProjectById',\n  get:\n    (id) =>\n    async ({ get }) => {\n      const projects = get(selectProjects)\n\n      return projects.find((project) => project.id === id) ?? null\n    },\n})\n\nexport const selectProjectSamplesByProjectId = selectorFamily<SourceSample[], number>({\n  key: 'selectors/selectProjectSamplesByProjectId',\n  get:\n    (id) =>\n    async ({ get }) => {\n      get(refreshOn('samples'))\n      get(refreshOn('projectSamples'))\n\n      const api = get(apiState)\n      return fetchProjectSamplesByProjectId(api)(id)\n    },\n})\n\nexport const selectSitesByProjectId = selectorFamily<Site[], number>({\n  key: 'selectSitesByProjectId',\n  get:\n    (id) =>\n    async ({ get }) => {\n      get(refreshOn('sites'))\n      get(refreshOn('projectSamples'))\n\n      const api = get(apiState)\n      return fetchSitesByProjectId(api)(id)\n    },\n})\n\nexport const selectBoxTaxaByBoxId = selectorFamily<BoxTaxon[], number>({\n  key: 'selectors/selectBoxTaxaByBoxId',\n  get:\n    (boxId) =>\n    async ({ get }) => {\n      get(refreshOn('taxa'))\n      get(refreshOn('boxTaxa'))\n\n      const api = get(apiState)\n      return fetchBoxTaxaByBoxId(api)(boxId)\n    },\n})\n\nexport const selectMinimalSamplesByUsStateId = selectorFamily<MinimalSample[], number>({\n  key: 'selectors/selectMinimalSamplesByUsStateId',\n  get:\n    (id) =>\n    async ({ get }) => {\n      get(refreshOn('samples'))\n\n      const api = get(apiState)\n      return fetchMinimalSamplesByUsStateId(api)(id)\n    },\n})\n\nexport const selectMinimalSamplesByTaxonId = selectorFamily<MinimalSample[], number>({\n  key: 'selectors/selectMinimalSamplesByTaxonId',\n  get:\n    (id) =>\n    async ({ get }) => {\n      get(refreshOn('samples'))\n\n      const api = get(apiState)\n      return fetchMinimalSamplesByTaxonId(api)(id)\n    },\n})\n\nexport const selectMinimalSamplesByOrganizationId = selectorFamily<MinimalSample[], number>({\n  key: 'selectors/selectMinimalSamplesByOrganizationId',\n  get:\n    (id) =>\n    async ({ get }) => {\n      get(refreshOn('samples'))\n\n      const api = get(apiState)\n      return fetchMinimalSamplesByOrganizationId(api)(id)\n    },\n})\n\nexport const selectNull = selector<null>({\n  key: 'selectors/selectNull',\n  get: () => null,\n})\n","import { Taxon } from '../types'\n\nexport const withDescendantIds = (taxa: Taxon[]): Taxon[] => {\n  const highestLevelRankOrder = taxa.reduce(\n    (highest: number, { levelRankOrder }) => Math.max(highest, levelRankOrder),\n    0\n  )\n\n  const result = taxa.map((taxon) => ({ ...taxon })) // copy array\n\n  let currentLevel = highestLevelRankOrder\n\n  while (currentLevel > 0) {\n    // eslint-disable-next-line no-loop-func\n    result.forEach((taxon) => {\n      if (taxon.levelRankOrder !== currentLevel) return\n\n      const childTaxons = result.filter(({ parentId }) => parentId === taxon.id)\n      taxon.descendantIds = childTaxons.reduce(\n        (acc, { id, descendantIds }) => [...acc, id, ...(descendantIds || [])],\n        [] as number[]\n      )\n    })\n    currentLevel -= 1\n  }\n  return result\n}\n","import { useEffect, useRef, useCallback } from 'react'\nimport { atomFamily, RecoilState, useRecoilCallback } from 'recoil'\n\ntype refreshFamily =\n  | 'boxes'\n  | 'boxSamples'\n  | 'boxTaxa'\n  | 'myUser'\n  | 'organizations'\n  | 'projects'\n  | 'projectSamples'\n  | 'samples'\n  | 'sites'\n  | 'taxa'\n  | 'users'\n\nexport type InvalidateFn = (family: refreshFamily, id?: number) => void\n\nconst refreshOnState = atomFamily<number, string>({\n  key: 'refreshOnState',\n  default: 0,\n})\n\nexport const refreshOn = (family: refreshFamily, id?: number): RecoilState<number> => refreshOnState(`${family}:${id}`)\n\nexport const useInvalidate = (): InvalidateFn =>\n  useRecoilCallback(\n    ({ set }) =>\n      (family: refreshFamily, id?: number) => {\n        set(refreshOn(family, id), (v) => v + 1)\n      },\n    []\n  )\n\nexport const useDeferredInvalidate = (): InvalidateFn => {\n  const calls = useRef<[family: refreshFamily, id?: number][]>([]).current\n  const invalidate = useInvalidate()\n\n  useEffect(\n    () => () => {\n      calls.forEach(([family, id]) => invalidate(family, id))\n    },\n    []\n  )\n\n  return useCallback((family: refreshFamily, id?: number) => {\n    calls.push([family, id])\n  }, [])\n}\n","import gql from 'graphql-tag'\n\nimport { Api, ApiError } from '../api'\nimport { InvalidateFn } from '../selectors'\n\ninterface AddProjectSamplesInput {\n  projectId: number\n  sampleIds: number[]\n}\n\nexport const addProjectSamplesMutation = gql`\n  mutation ($projectId: Int!, $sampleIds: [Int]) {\n    addProjectSamples(projectId: $projectId, sampleIds: $sampleIds)\n  }\n`\n\nexport const addProjectSamples =\n  (api: Api, invalidate: InvalidateFn) =>\n  async (params: AddProjectSamplesInput): Promise<true> => {\n    const data = await api.mutation<{\n      addProjectSamples: number // NOTE: return type is number of samples after operation (0 is not indication of failure)\n    }>(addProjectSamplesMutation, { ...params })\n\n    if (!data.addProjectSamples) throw new ApiError('project samples did not update') // not possible to know if no records were added due to return type above\n\n    invalidate('projectSamples')\n    return true\n  }\n","import gql from 'graphql-tag'\n\nimport { Api, ApiError } from '../api'\nimport { InvalidateFn } from '../selectors'\n\nexport interface OrganizationInput {\n  name: string // -> organizationName\n  typeId: number // -> organizationTypeId\n  address1: string\n  address2: string\n  city: string\n  usStateId: number | null\n  countryId: number\n  zipCode: string\n  phone: string\n}\n\nexport const createOrganizationMutation = gql`\n  mutation ($organization: OrganizationInput!) {\n    createOrganization(organization: $organization)\n  }\n`\n\nexport const createOrganization =\n  (api: Api, invalidate: InvalidateFn) =>\n  async (organization: OrganizationInput): Promise<number> => {\n    const { name: organizationName, typeId: organizationTypeId, ...restOrganization } = organization\n    const data = await api.mutation<{\n      createOrganization: number | null // NOTE: new organization ID\n    }>(createOrganizationMutation, { organization: { organizationName, organizationTypeId, ...restOrganization } })\n\n    const id = data.createOrganization\n    if (!id) throw new ApiError('organization did not create')\n\n    invalidate('organizations')\n    return id\n  }\n","import gql from 'graphql-tag'\n\nimport { Api, ApiError } from '../api'\nimport { InvalidateFn } from '../selectors'\nimport { OrganizationInput } from './createOrganization'\n\nexport interface UserInput {\n  firstName: string\n  lastName: string\n  phone: string\n  affiliationId?: number | null\n  roleIds?: number[] // only for updateUser\n}\n\nexport const createOrganizationWithUserMutation = gql`\n  mutation ($organization: OrganizationInput!, $user: IndividualInput!) {\n    createUser(organization: $organization, user: $user)\n  }\n`\n\ninterface createOrganizationWithUserParams {\n  organization: OrganizationInput\n  user: UserInput\n}\n\nexport const createOrganizationWithUser =\n  (api: Api, invalidate: InvalidateFn) =>\n  async ({ organization, user }: createOrganizationWithUserParams): Promise<number> => {\n    const { name: organizationName, typeId: organizationTypeId, ...restOrganization } = organization\n    const data = await api.mutation<{\n      createUser: number | null // NOTE: new user ID\n    }>(createOrganizationWithUserMutation, {\n      organization: { organizationName, organizationTypeId, ...restOrganization },\n      user,\n    })\n\n    const id = data.createUser\n    if (!id) throw new ApiError('user/organization did not create')\n\n    invalidate('organizations')\n    invalidate('users')\n    invalidate('myUser')\n\n    return id\n  }\n","import gql from 'graphql-tag'\n\nimport { Api, ApiError } from '../api'\nimport { InvalidateFn } from '../selectors'\n\nexport interface ProjectInput {\n  name: string // -> projectName\n  isPrivate: boolean\n  description: string\n  contactId: number\n  modelIds: number[]\n}\n\nexport const createProjectMutation = gql`\n  mutation ($project: ProjectInput!) {\n    createProject(project: $project)\n  }\n`\n\nexport const createProject =\n  (api: Api, invalidate: InvalidateFn) =>\n  async (project: ProjectInput): Promise<number> => {\n    const { name: projectName, ...restProject } = project\n    const data = await api.mutation<{\n      createProject: number | null // NOTE: new project ID\n    }>(createProjectMutation, { project: { projectName, ...restProject } })\n\n    const id = data.createProject\n    if (!id) throw new ApiError('project did not create')\n\n    invalidate('projects')\n    return id\n  }\n","import gql from 'graphql-tag'\n\nimport { Api, ApiError } from '../api'\nimport { InvalidateFn } from '../selectors'\n\ninterface SampleSubmission {\n  submitterId: number\n  customerId: number | null\n  data: {\n    templateVersion: number\n    appVersion: string\n    samples: Record<string, string | number | boolean | null | undefined>[]\n  }\n}\n\nexport const createSampleSubmissionMutation = gql`\n  mutation ($submitterId: Int, $customerId: Int, $data: JSONObject) {\n    createSampleSubmission(submitterId: $submitterId, customerId: $customerId, data: $data)\n  }\n`\n\nexport const createSampleSubmission =\n  (api: Api, invalidate: InvalidateFn) =>\n  async (submission: SampleSubmission): Promise<number> => {\n    const data = await api.mutation<{\n      createSampleSubmission: number | null // NOTE: new box ID\n    }>(createSampleSubmissionMutation, { ...submission, data: JSON.stringify(submission.data) })\n\n    const id = data.createSampleSubmission\n    if (!id) throw new ApiError('submission did not create')\n\n    invalidate('boxes')\n    return id\n  }\n","import gql from 'graphql-tag'\n\nimport { Api, ApiError } from '../api'\nimport { Organism } from '../../types'\nimport { InvalidateFn } from '../selectors'\n\nexport const deleteOrganismMutation = gql`\n  mutation ($organismId: Int!) {\n    deleteOrganism(organismId: $organismId)\n  }\n`\n\nexport const deleteOrganism =\n  (api: Api, invalidate: InvalidateFn) =>\n  async (organism: Organism): Promise<true> => {\n    const data = await api.mutation<{ deleteOrganism: number }>(deleteOrganismMutation, {\n      organismId: organism.id,\n    })\n\n    if (!data.deleteOrganism) throw new ApiError('organism record did not delete')\n\n    invalidate('samples')\n    return true\n  }\n","import gql from 'graphql-tag'\n\nimport { Api, ApiError } from '../api'\nimport { Organization } from '../../types'\nimport { InvalidateFn } from '../selectors'\n\nexport const deleteOrganizationMutation = gql`\n  mutation ($organizationId: Int!) {\n    deleteOrganization(id: $organizationId)\n  }\n`\n\nexport const deleteOrganization =\n  (api: Api, invalidate: InvalidateFn) =>\n  async (organization: Organization): Promise<true> => {\n    const data = await api.mutation<{ deleteOrganization: number }>(deleteOrganizationMutation, {\n      organizationId: organization.id,\n    })\n\n    if (!data.deleteOrganization) throw new ApiError('organization did not delete')\n\n    invalidate('organizations')\n    return true\n  }\n","import gql from 'graphql-tag'\n\nimport { Api, ApiError } from '../api'\nimport { Project } from '../../types'\nimport { InvalidateFn } from '../selectors'\n\nexport const deleteProjectMutation = gql`\n  mutation ($projectId: Int!) {\n    deleteProject(projectId: $projectId)\n  }\n`\n\nexport const deleteProject =\n  (api: Api, invalidate: InvalidateFn) =>\n  async (project: Project): Promise<true> => {\n    const data = await api.mutation<{ deleteProject: number }>(deleteProjectMutation, {\n      projectId: project.id,\n    })\n\n    if (!data.deleteProject) throw new ApiError('project did not delete')\n\n    invalidate('projects')\n    return true\n  }\n","import gql from 'graphql-tag'\nimport { Box as GraphBox } from '@namcbugdb/common'\nimport { sortBy } from 'lodash'\n\nimport { Api } from '../api'\nimport { Box } from '../../types'\n\nexport const fetchBoxesQuery = gql`\n  query ($offset: Int) {\n    boxes(limit: 1000, offset: $offset) {\n      records {\n        boxId\n        customerName\n        customerId\n        createdDate\n        boxReceivedDate\n        submittedBy\n        boxState\n        sampleCount\n        midges\n        measurements\n        sortComplete\n        idComplete\n        alias\n      }\n      nextOffset\n    }\n  }\n`\n\nexport const transformBox = ({\n  boxId: id,\n  boxReceivedDate: receivedDate,\n  submittedBy: submittedByName,\n  idComplete: identificationComplete,\n  ...rest\n}: GraphBox): Box => ({\n  id,\n  receivedDate,\n  submittedByName,\n  identificationComplete,\n  ...rest,\n})\n\nexport const fetchBoxes = (api: Api) => async (): Promise<Box[]> => {\n  const data = await api.queryAllPages<{ boxes: { records: GraphBox[] } }>(\n    fetchBoxesQuery,\n    {},\n    { dataProperty: 'boxes' }\n  )\n\n  const boxes = (data.boxes.records ?? []).map(transformBox)\n\n  return sortBy(boxes, 'receivedDate').reverse()\n}\n","import gql from 'graphql-tag'\nimport { BoxInfo as GraphBoxInfo } from '@namcbugdb/common'\n\nimport { Api } from '../api'\nimport { Box } from '../../types'\nimport { transformBox } from './fetchBoxes'\n\nexport const fetchBoxDetailByIdQuery = gql`\n  query ($boxId: Int!) {\n    boxInfo(boxId: $boxId) {\n      boxId\n      boxState\n      boxStateId\n      customerId\n      customer {\n        organizationName\n      }\n      submittedBy\n      createdDate\n      boxReceivedDate\n      processingCompleteDate\n      measurements\n      midges\n      taxaQa\n      sorterQa\n      description\n      sampleCount\n      sortComplete\n      idComplete\n      alias\n      modelIds\n      submissionCount\n    }\n  }\n`\n\nexport const fetchBoxDetailById =\n  (api: Api) =>\n  async (boxId: number): Promise<Box | null> => {\n    const data = await api.query<{ boxInfo: GraphBoxInfo }>(fetchBoxDetailByIdQuery, { boxId })\n    if (!data.boxInfo) return null\n    const {\n      customer: { organizationName: customerName },\n      ...restBoxInfo\n    } = data.boxInfo\n    return transformBox({ ...restBoxInfo, customerName })\n  }\n","import gql from 'graphql-tag'\nimport { PaginatedRecords, Sample as GraphSample } from '@namcbugdb/common'\n\nimport { Api } from '../api'\nimport { SourceSample } from '../../types'\n\nexport const fetchBoxSamplesByBoxIdQuery = gql`\n  query ($boxId: Int!, $offset: Int) {\n    samples(limit: 1000, offset: $offset, boxId: $boxId) {\n      records {\n        sampleId\n        sampleDate\n        usState\n        sampleType\n        sampleMethod\n        sorterName\n        sortStartDate\n        sortEndDate\n        idErName\n        idStartDate\n        idEndDate\n        customerSiteCode\n        visitId\n        siteName\n        siteId\n      }\n      nextOffset\n    }\n  }\n`\n\nexport const transformSourceSample = (sample: GraphSample): SourceSample => {\n  // TODO: SourceSamples are also returned by project samples — should this live somewhere more generic?\n\n  const {\n    sampleId: id,\n    sampleType: type,\n    sampleMethod: method,\n    idErName: identifierName,\n    idStartDate: identificationStartDate,\n    idEndDate: identificationEndDate,\n    ...restSample\n  } = sample\n\n  return {\n    ...restSample,\n    id,\n    type,\n    method,\n    identifierName,\n    identificationStartDate,\n    identificationEndDate,\n  }\n}\n\nexport const fetchBoxSamplesByBoxId =\n  (api: Api) =>\n  async (boxId: number): Promise<SourceSample[]> => {\n    const data = await api.queryAllPages<{\n      samples: PaginatedRecords<GraphSample>\n    }>(fetchBoxSamplesByBoxIdQuery, { boxId }, { dataProperty: 'samples' })\n\n    return data.samples.records.map(transformSourceSample)\n  }\n","import gql from 'graphql-tag'\nimport { PaginatedRecords, BoxTaxa as GraphBoxTaxa } from '@namcbugdb/common'\n\nimport { Api } from '../api'\nimport { BoxTaxon } from '../../types'\n\nexport const fetchBoxTaxaByBoxIdQuery = gql`\n  query ($offset: Int, $boxId: Int!) {\n    boxTaxa(boxId: $boxId, limit: 1000, offset: $offset) {\n      records {\n        order\n        family\n        taxonomyId\n        scientificName\n        taxonomistCounts\n        sampleCount\n        totalCount\n      }\n      nextOffset\n    }\n  }\n`\n\nexport const fetchBoxTaxaByBoxId =\n  (api: Api) =>\n  async (boxId: number): Promise<BoxTaxon[]> => {\n    const data = await api.queryAllPages<{\n      boxTaxa: PaginatedRecords<GraphBoxTaxa>\n    }>(fetchBoxTaxaByBoxIdQuery, { boxId }, { dataProperty: 'boxTaxa' })\n\n    return data.boxTaxa.records.map(({ taxonomyId: id, scientificName: name, taxonomistCounts, ...rest }) => ({\n      ...rest,\n      id,\n      name,\n      taxonomistCounts: taxonomistCounts || {},\n    }))\n  }\n","import gql from 'graphql-tag'\nimport { BoxInfo as GraphBoxInfo } from '@namcbugdb/common'\n\nimport { Api } from '../api'\nimport { Submission } from '../../types'\n\nexport const fetchLatestSubmissionByBoxIdQuery1 = gql`\n  query ($boxId: Int!) {\n    boxInfo(boxId: $boxId) {\n      customer {\n        organizationName\n        phone\n      }\n      latestSubmission {\n        versionId\n        submissionId\n        submitter {\n          firstName\n          lastName\n          email\n          phone\n        }\n        createdDate\n        updatedDate\n      }\n    }\n  }\n`\n\nexport const fetchLatestSubmissionByBoxIdQuery2 = gql`\n  query ($submissionId: Int!) {\n    submissionData(submissionId: $submissionId)\n  }\n`\n\nexport const fetchLatestSubmissionByBoxId =\n  (api: Api) =>\n  async (boxId: number): Promise<Submission | null> => {\n    const data1 = await api.query<{ boxInfo: GraphBoxInfo }>(fetchLatestSubmissionByBoxIdQuery1, { boxId })\n\n    const {\n      customer: { organizationName, phone: organizationPhone },\n      latestSubmission,\n    } = data1.boxInfo\n    if (!latestSubmission) return null\n    const {\n      versionId: version,\n      submissionId,\n      submitterId,\n      submitter: { firstName, lastName, email: submitterEmail, phone: submitterPhone },\n      createdDate,\n      updatedDate,\n    } = latestSubmission\n\n    // eslint-disable-next-line @typescript-eslint/no-explicit-any\n    const data2 = await api.query<{ submissionData: any }>(fetchLatestSubmissionByBoxIdQuery2, {\n      submissionId,\n    })\n\n    try {\n      const { submissionData } = data2\n      const submitterName = `${firstName} ${lastName}`\n\n      if (typeof submissionData !== 'object') throw new Error()\n      const { templateVersion, appVersion, samples } = submissionData\n      if (typeof templateVersion !== 'number') throw new Error()\n      if (typeof appVersion !== 'string') throw new Error()\n      if (!Array.isArray(samples)) throw new Error()\n\n      return {\n        id: submissionId,\n        boxId,\n        organizationName,\n        organizationPhone,\n        submitterName,\n        submitterEmail,\n        submitterPhone,\n        version,\n        submitterId,\n        createdDate,\n        updatedDate,\n        templateVersion,\n        appVersion,\n        samples,\n      }\n    } catch (err) {\n      throw new Error('Could not parse submissionData')\n    }\n  }\n","import gql from 'graphql-tag'\nimport { TaxaLookups, SampleLookups, GeoLookups, EntityLookups } from '@namcbugdb/common'\n\nimport { Api } from '../api'\nimport { LifeStage, NoteType, TaxaLevel, BoxState, UsState, Role } from '../../types'\n\nexport const fetchLookupsQuery = gql`\n  query {\n    lookups {\n      taxa {\n        taxaLevels\n        lifeStages\n      }\n      sample {\n        noteTypes\n        boxStates\n        sampleMethods\n        sampleTypes\n        towTypes\n        effortTypes\n        designTypes\n      }\n      geo {\n        habitats\n        ecosystems\n        waterbodyTypes\n        states\n        countries\n      }\n      entity {\n        organizationTypes\n        roles\n      }\n    }\n  }\n`\n\nexport const fetchLookups =\n  (api: Api) =>\n  async (): Promise<{\n    taxaLevels: TaxaLevel[]\n    lifeStages: LifeStage[]\n    noteTypes: NoteType[]\n    boxStates: BoxState[]\n    sampleMethodNames: string[]\n    sampleTypeNames: string[]\n    towTypeNames: string[]\n    effortTypeNames: string[]\n    designTypeNames: string[]\n    habitatNames: string[]\n    ecosystemNames: string[]\n    waterBodyTypeNames: string[]\n    usStates: UsState[]\n    organizationTypes: EntityLookups['organizationTypes']\n    countries: GeoLookups['countries']\n    roles: Role[]\n  }> => {\n    const data = await api.query<{\n      lookups: {\n        taxa: {\n          taxaLevels: TaxaLookups['taxaLevels']\n          lifeStages: TaxaLookups['lifeStages']\n        }\n        sample: {\n          noteTypes: SampleLookups['noteTypes']\n          boxStates: SampleLookups['boxStates']\n          sampleMethods: SampleLookups['sampleMethods']\n          sampleTypes: SampleLookups['sampleTypes']\n          towTypes: SampleLookups['towTypes']\n          effortTypes: SampleLookups['effortTypes']\n          designTypes: SampleLookups['designTypes']\n        }\n        geo: {\n          habitats: GeoLookups['habitats']\n          ecosystems: GeoLookups['ecosystems']\n          waterbodyTypes: GeoLookups['waterbodyTypes']\n          states: GeoLookups['states']\n          countries: GeoLookups['countries']\n        }\n        entity: {\n          organizationTypes: EntityLookups['organizationTypes']\n          roles: EntityLookups['roles']\n        }\n      }\n    }>(fetchLookupsQuery)\n    const {\n      lookups: {\n        taxa: { taxaLevels, lifeStages },\n        sample: { noteTypes, boxStates, sampleMethods, sampleTypes, towTypes: towTypeNames, effortTypes, designTypes },\n        geo: { habitats, ecosystems, waterbodyTypes, states: usStates, countries },\n        entity: { organizationTypes, roles },\n      },\n    } = data\n\n    const nameExtractor = ({ name }) => name\n\n    return {\n      taxaLevels,\n      lifeStages,\n      noteTypes,\n      boxStates,\n      sampleMethodNames: sampleMethods.map(nameExtractor),\n      sampleTypeNames: sampleTypes.map(nameExtractor),\n      towTypeNames,\n      effortTypeNames: effortTypes.map(nameExtractor),\n      designTypeNames: designTypes.map(nameExtractor),\n      habitatNames: habitats.map(nameExtractor),\n      ecosystemNames: ecosystems.map(nameExtractor),\n      waterBodyTypeNames: waterbodyTypes.map(nameExtractor),\n      usStates,\n      countries,\n      organizationTypes,\n      roles,\n    }\n  }\n","import gql from 'graphql-tag'\nimport { PaginatedRecords, Sample as GraphSample } from '@namcbugdb/common'\n\nimport { Api } from '../api'\nimport { MinimalSample } from '../../types'\n\nexport const fetchMinimalSamplesByIdsQuery = gql`\n  query ($sampleIds: [Int], $offset: Int) {\n    samples(limit: 1000, offset: $offset, sampleIds: $sampleIds) {\n      records {\n        sampleId\n        sampleDate\n        sampleType\n        sampleMethod\n      }\n      nextOffset\n    }\n  }\n`\n\nexport const transformMinimalSample = ({\n  sampleId: id,\n  sampleDate,\n  sampleType: type,\n  sampleMethod: method,\n}: GraphSample): MinimalSample => ({\n  id,\n  sampleDate,\n  type,\n  method,\n})\n\nexport const fetchMinimalSamplesByIds =\n  (api: Api) =>\n  async (sampleIds: number[]): Promise<MinimalSample[]> => {\n    const data = await api.queryAllPages<{\n      samples: PaginatedRecords<GraphSample>\n    }>(fetchMinimalSamplesByIdsQuery, { sampleIds }, { dataProperty: 'samples' })\n\n    return data.samples.records.map(transformMinimalSample)\n  }\n","import gql from 'graphql-tag'\nimport { PaginatedRecords, Sample as GraphSample } from '@namcbugdb/common'\n\nimport { Api } from '../api'\nimport { MinimalSample } from '../../types'\nimport { transformMinimalSample } from './fetchMinimalSamplesByIds'\n\nexport const fetchMinimalSamplesByOrganizationIdQuery = gql`\n  query ($organizationId: Int, $offset: Int) {\n    samples(limit: 1000, offset: $offset, entityId: $organizationId) {\n      records {\n        sampleId\n        sampleDate\n        sampleType\n        sampleMethod\n      }\n      nextOffset\n    }\n  }\n`\n\nexport const fetchMinimalSamplesByOrganizationId =\n  (api: Api) =>\n  async (organizationId: number): Promise<MinimalSample[]> => {\n    const data = await api.queryAllPages<{\n      samples: PaginatedRecords<GraphSample>\n    }>(fetchMinimalSamplesByOrganizationIdQuery, { organizationId }, { dataProperty: 'samples' })\n\n    return data.samples.records.map(transformMinimalSample)\n  }\n","import gql from 'graphql-tag'\nimport { PaginatedRecords, Sample as GraphSample } from '@namcbugdb/common'\n\nimport { Api } from '../api'\nimport { MinimalSample } from '../../types'\nimport { transformMinimalSample } from './fetchMinimalSamplesByIds'\n\nexport const fetchMinimalSamplesByTaxonIdQuery = gql`\n  query ($taxonId: Int, $offset: Int) {\n    samples(limit: 1000, offset: $offset, taxonomyId: $taxonId) {\n      records {\n        sampleId\n        sampleDate\n        sampleType\n        sampleMethod\n      }\n      nextOffset\n    }\n  }\n`\n\nexport const fetchMinimalSamplesByTaxonId =\n  (api: Api) =>\n  async (taxonId: number): Promise<MinimalSample[]> => {\n    const data = await api.queryAllPages<{\n      samples: PaginatedRecords<GraphSample>\n    }>(fetchMinimalSamplesByTaxonIdQuery, { taxonId }, { dataProperty: 'samples' })\n\n    return data.samples.records.map(transformMinimalSample)\n  }\n","import gql from 'graphql-tag'\nimport { PaginatedRecords, Sample as GraphSample } from '@namcbugdb/common'\n\nimport { Api } from '../api'\nimport { MinimalSample } from '../../types'\nimport { transformMinimalSample } from './fetchMinimalSamplesByIds'\n\nexport const fetchMinimalSamplesByUsStateIdQuery = gql`\n  query ($usStateId: Int, $offset: Int) {\n    samples(limit: 1000, offset: $offset, usStateId: $usStateId) {\n      records {\n        sampleId\n        sampleDate\n        sampleType\n        sampleMethod\n      }\n      nextOffset\n    }\n  }\n`\n\nexport const fetchMinimalSamplesByUsStateId =\n  (api: Api) =>\n  async (usStateId: number): Promise<MinimalSample[]> => {\n    const data = await api.queryAllPages<{\n      samples: PaginatedRecords<GraphSample>\n    }>(fetchMinimalSamplesByUsStateIdQuery, { usStateId }, { dataProperty: 'samples' })\n\n    return data.samples.records.map(transformMinimalSample)\n  }\n","import gql from 'graphql-tag'\nimport { Model as GraphModel } from '@namcbugdb/common'\n\nimport { Api } from '../api'\nimport { Model } from '../../types'\n\nexport const fetchModelsQuery = gql`\n  query ($offset: Int!) {\n    models(limit: 500, offset: $offset) {\n      records {\n        modelId\n        modelName\n        modelTypeName\n        abbreviation\n        translationName\n        isActive\n        fixedCount\n        predictorCount\n      }\n      nextOffset\n    }\n  }\n`\n\nexport const fetchModels = (api: Api) => async (): Promise<Model[]> => {\n  const data = await api.queryAllPages<{ models: { records: GraphModel[] } }>(\n    fetchModelsQuery,\n    {},\n    { dataProperty: 'models' }\n  )\n\n  return data.models.records.map(({ modelId: id, modelName: name, modelTypeName: typeName, ...rest }) => ({\n    id,\n    name,\n    typeName,\n    ...rest,\n  }))\n}\n","import gql from 'graphql-tag'\nimport { Profile as GraphProfile, UserPermissions } from '@namcbugdb/common'\n\nimport { Api } from '../api'\nimport { User } from '../../types'\n\nexport const fetchMyUserQuery = gql`\n  query {\n    myProfile {\n      id\n      firstName\n      lastName\n      email\n      phone\n      permissions\n      affiliationId\n      organizationName\n      roleIds\n    }\n  }\n`\n\nexport const fetchMyUser = (api: Api) => async (): Promise<(User & { permissions: UserPermissions }) | null> => {\n  const data = await api.query<{\n    myProfile: GraphProfile | null\n  }>(fetchMyUserQuery)\n  const { myProfile } = data\n\n  if (!myProfile) return null\n\n  return {\n    ...myProfile,\n    permissions: myProfile.permissions || {},\n    fullName: `${myProfile.firstName} ${myProfile.lastName}`,\n  }\n}\n","/* eslint-disable @typescript-eslint/no-explicit-any */\nexport const deNull = <T>(source: T, defaults: Partial<T>): T => {\n  const copy = { ...source }\n  Object.entries(copy).forEach(([key, value]) => {\n    if (value !== null || typeof defaults[key] === 'undefined') return\n    copy[key] = defaults[key]\n  })\n  return copy\n}\n","import gql from 'graphql-tag'\nimport { Organization as GraphOrganization } from '@namcbugdb/common'\n\nimport { Api } from '../api'\nimport { Organization } from '../../types'\nimport { deNull } from '../../lib/deNull'\n\nexport const fetchOrganizationByIdQuery = gql`\n  query ($organizationId: Int) {\n    organizationsById(ids: [$organizationId]) {\n      records {\n        organizationName\n        organizationTypeId\n        entityId\n        address1\n        address2\n        city\n        usState\n        usStateId\n        country\n        countryId\n        zipCode\n        phone\n        userCount\n      }\n    }\n  }\n`\n\nexport const fetchOrganizationById =\n  (api: Api) =>\n  async (organizationId: number): Promise<Organization | null> => {\n    const data = await api.query<{ organizationsById: { records: GraphOrganization[] } }>(fetchOrganizationByIdQuery, {\n      organizationId,\n    })\n    const organization = data.organizationsById.records[0]\n    if (!organization) return null\n    const { entityId: id, organizationName: name, organizationTypeId: typeId, ...restOrganization } = organization\n    return deNull(\n      { id, name, typeId, ...restOrganization },\n      {\n        name: '',\n        // typeId,\n        // id,\n        address1: '',\n        address2: '',\n        city: '',\n        usState: '',\n        // usStateId,\n        country: '',\n        // countryId,\n        zipCode: '',\n        phone: '',\n        userCount: 0,\n      }\n    )\n  }\n","import gql from 'graphql-tag'\nimport { Organization as GraphOrganization } from '@namcbugdb/common'\nimport { sortBy } from 'lodash'\n\nimport { Api } from '../api'\nimport { Organization } from '../../types'\n\nexport const fetchOrganizationsQuery = gql`\n  query ($offset: Int!) {\n    organizations(limit: 500, offset: $offset) {\n      records {\n        entityId\n        organizationName\n      }\n      nextOffset\n    }\n  }\n`\n\nexport const fetchOrganizations = (api: Api) => async (): Promise<Organization[]> => {\n  const data = await api.queryAllPages<{ organizations: { records: GraphOrganization[] } }>(\n    fetchOrganizationsQuery,\n    {},\n    { dataProperty: 'organizations' }\n  )\n\n  return sortBy(\n    data.organizations.records.map(({ entityId: id, organizationName: name }) => ({ id, name })),\n    'name'\n  )\n}\n","import gql from 'graphql-tag'\nimport { Predictor as GraphPredictor } from '@namcbugdb/common'\n\nimport { Api } from '../api'\nimport { Predictor } from '../../types'\n\nexport const fetchPredictorsQuery = gql`\n  query ($offset: Int!) {\n    predictors(limit: 500, offset: $offset) {\n      records {\n        predictorId\n        predictorName\n        predictorType\n        abbreviation\n        units\n        isTemporal\n        modelCount\n      }\n      nextOffset\n    }\n  }\n`\n\nexport const fetchPredictors = (api: Api) => async (): Promise<Predictor[]> => {\n  const data = await api.queryAllPages<{ predictors: { records: GraphPredictor[] } }>(\n    fetchPredictorsQuery,\n    {},\n    { dataProperty: 'predictors' }\n  )\n\n  return data.predictors.records.map(({ predictorId: id, predictorName: name, predictorType: type, ...rest }) => ({\n    id,\n    name,\n    type,\n    ...rest,\n  }))\n}\n","import gql from 'graphql-tag'\nimport { Project as GraphProject } from '@namcbugdb/common'\n\nimport { Api } from '../api'\nimport { Project } from '../../types'\n\nexport const fetchProjectsQuery = gql`\n  query ($offset: Int!) {\n    projects(limit: 500, offset: $offset) {\n      records {\n        projectId\n        projectName\n        contactId\n        contactName\n        description\n        sampleCount\n        modelIds\n        createdDate\n        updatedDate\n        isPrivate\n      }\n      nextOffset\n    }\n  }\n`\n\nexport const fetchProjects = (api: Api) => async (): Promise<Project[]> => {\n  const data = await api.queryAllPages<{ projects: { records: GraphProject[] } }>(\n    fetchProjectsQuery,\n    {},\n    { dataProperty: 'projects' }\n  )\n\n  return data.projects.records.map(({ projectId: id, projectName: name, contactName, ...rest }) => ({\n    id,\n    name,\n    contactName: contactName ?? '',\n    ...rest,\n  }))\n}\n","import gql from 'graphql-tag'\nimport { PaginatedRecords, Sample as GraphSample } from '@namcbugdb/common'\n\nimport { Api } from '../api'\nimport { SourceSample } from '../../types'\nimport { transformSourceSample } from './fetchBoxSamplesByBoxId'\n\nexport const fetchProjectSamplesByProjectIdQuery = gql`\n  query ($projectId: Int!, $offset: Int) {\n    samples(limit: 1000, offset: $offset, projectId: $projectId) {\n      records {\n        sampleId\n        sampleDate\n        usState\n        sampleType\n        sampleMethod\n        sorterName\n        sortStartDate\n        sortEndDate\n        idErName\n        idStartDate\n        idEndDate\n        customerSiteCode\n        visitId\n        siteName\n        siteId\n      }\n      nextOffset\n    }\n  }\n`\n\nexport const fetchProjectSamplesByProjectId =\n  (api: Api) =>\n  async (projectId: number): Promise<SourceSample[]> => {\n    const data = await api.queryAllPages<{\n      samples: PaginatedRecords<GraphSample>\n    }>(fetchProjectSamplesByProjectIdQuery, { projectId }, { dataProperty: 'samples' })\n\n    return data.samples.records.map(transformSourceSample)\n  }\n","import gql from 'graphql-tag'\nimport { PaginatedRecords, Sample as GraphSample, SampleTaxaInfo as GraphSampleTaxaInfo } from '@namcbugdb/common'\n\nimport { Api } from '../api'\nimport { Sample } from '../../types'\n\nexport const fetchSampleByIdQuery = gql`\n  query ($sampleId: Int!) {\n    samples(sampleIds: [$sampleId]) {\n      records {\n        sampleId\n        boxId\n        boxState\n        measurements\n        customerName\n        sampleDate\n        siteName\n        usState\n        idErId\n        idStartDate\n        idEndDate\n        sorterId\n        sorterName\n        sortStartDate\n        sortEndDate\n        labSplit\n        sorterCount\n        elutriation\n        sortTime\n        measurements\n      }\n    }\n    sampleTaxa(sampleIds: [$sampleId]) {\n      records {\n        sampleId\n        organismId\n        lifeStageId\n        taxonomyId\n        levelId\n        levelName\n        splitCount\n        bigRareCount\n        noteTypeIds\n        comments\n      }\n    }\n  }\n`\n\nexport const fetchSampleById =\n  (api: Api) =>\n  async (sampleId: number): Promise<Sample | null> => {\n    const data = await api.query<{\n      samples: PaginatedRecords<GraphSample>\n      sampleTaxa: PaginatedRecords<GraphSampleTaxaInfo>\n    }>(fetchSampleByIdQuery, { sampleId })\n\n    const sample = data.samples.records[0]\n    if (!sample) return null\n\n    const organisms = data.sampleTaxa.records\n    const {\n      sampleId: id,\n      idErId: identificationUserId,\n      idStartDate: identificationStartDate,\n      idEndDate: identificationEndDate,\n      boxState,\n      ...restSample\n    } = sample\n\n    return {\n      ...restSample,\n      id,\n      identificationUserId,\n      identificationStartDate,\n      identificationEndDate,\n      boxState,\n      organisms: organisms.map((organism) => ({\n        ...organism,\n        id: organism.organismId,\n        taxonId: organism.taxonomyId,\n        noteTypeIds: organism.noteTypeIds.filter((noteTypeId) => noteTypeId !== null),\n      })),\n    }\n  }\n","import gql from 'graphql-tag'\nimport { Site as GraphSite } from '@namcbugdb/common'\n\nimport { Api } from '../api'\nimport { Site } from '../../types'\n\nexport const fetchSitesQuery = gql`\n  query sites($offset: Int) {\n    mapSites(limit: 10000, offset: $offset) {\n      records {\n        siteId\n        siteName\n        longitude\n        latitude\n        usStateId\n      }\n      nextOffset\n    }\n  }\n`\n\nexport const transformSite = ({ siteId: id, siteName: name, ...rest }: GraphSite): Site => ({\n  id,\n  name,\n  ...rest,\n})\n\nexport const fetchSites = (api: Api) => async (): Promise<Site[]> => {\n  const data = await api.queryAllPages<{ mapSites: { records: GraphSite[] } }>(\n    fetchSitesQuery,\n    {},\n    {\n      dataProperty: 'mapSites',\n    }\n  )\n  const sites = data.mapSites.records\n\n  return sites.map(transformSite)\n}\n","import gql from 'graphql-tag'\nimport { Site as GraphSite } from '@namcbugdb/common'\n\nimport { Api } from '../api'\nimport { Site } from '../../types'\nimport { transformSite } from './fetchSites'\nimport { deNull } from '../../lib/deNull'\n\nexport const fetchSiteDetailByIdQuery = gql`\n  query ($siteId: Int!) {\n    siteInfo(siteId: $siteId) {\n      siteId\n      siteName\n      latitude\n      longitude\n      usStateId\n      sampleCount\n      system\n      ecosystem\n      waterbodyType\n      waterbodyCode\n      waterbodyName\n      createdDate\n      updatedDate\n    }\n  }\n`\n\nexport const fetchSiteDetailById =\n  (api: Api) =>\n  async (siteId: number): Promise<Site | null> => {\n    const data = await api.query<{ siteInfo: GraphSite }>(fetchSiteDetailByIdQuery, { siteId })\n    const { siteInfo } = data\n    if (!siteInfo) return null\n    return deNull(transformSite(siteInfo), {\n      system: '',\n      ecosystem: '',\n      waterbodyType: '',\n      waterbodyCode: '',\n      waterbodyName: '',\n    })\n  }\n","import gql from 'graphql-tag'\nimport { Site as GraphSite } from '@namcbugdb/common'\n\nimport { Api } from '../api'\nimport { Site } from '../../types'\nimport { transformSite } from './fetchSites'\n\nexport const fetchSitesByBoxIdQuery = gql`\n  query sites($boxId: Int) {\n    sites(boxIds: [$boxId]) {\n      records {\n        siteId\n        siteName\n        longitude\n        latitude\n        usStateId\n      }\n      nextOffset\n    }\n  }\n`\n\nexport const fetchSitesByBoxId =\n  (api: Api) =>\n  async (boxId: number): Promise<Site[]> => {\n    const data = await api.query<{ sites: { records: GraphSite[] } }>(fetchSitesByBoxIdQuery, { boxId })\n    const sites = data.sites.records\n\n    return sites.map(transformSite)\n  }\n","import gql from 'graphql-tag'\nimport { Site as GraphSite } from '@namcbugdb/common'\n\nimport { Api } from '../api'\nimport { Site } from '../../types'\nimport { transformSite } from './fetchSites'\n\nexport const fetchSitesByProjectIdQuery = gql`\n  query sites($projectId: Int) {\n    sites(projectIds: [$projectId]) {\n      records {\n        siteId\n        siteName\n        longitude\n        latitude\n        usStateId\n      }\n      nextOffset\n    }\n  }\n`\n\nexport const fetchSitesByProjectId =\n  (api: Api) =>\n  async (projectId: number): Promise<Site[]> => {\n    const data = await api.query<{ sites: { records: GraphSite[] } }>(fetchSitesByProjectIdQuery, { projectId })\n    const sites = data.sites.records\n\n    return sites.map(transformSite)\n  }\n","import gql from 'graphql-tag'\nimport { Site as GraphSite } from '@namcbugdb/common'\n\nimport { Api } from '../api'\nimport { Site } from '../../types'\nimport { transformSite } from '.'\n\nexport const fetchSitesPageQuery = gql`\n  query sites($offset: Int, $limit: Int) {\n    mapSites(offset: $offset, limit: $limit) {\n      records {\n        siteId\n        siteName\n        longitude\n        latitude\n        usStateId\n      }\n      nextOffset\n    }\n  }\n`\n\nexport const fetchSitesPage =\n  (api: Api) =>\n  async (offset: number, limit: number): Promise<{ records: Site[]; nextOffset: number }> => {\n    const data = await api.query<{ mapSites: { records: GraphSite[]; nextOffset: number } }>(fetchSitesPageQuery, {\n      offset,\n      limit,\n    })\n    const records = data.mapSites.records.map(transformSite)\n    const { nextOffset } = data.mapSites\n\n    return { records, nextOffset }\n  }\n","import gql from 'graphql-tag'\nimport { Individual as GraphIndividual } from '@namcbugdb/common'\nimport { sortBy } from 'lodash'\n\nimport { Api } from '../api'\nimport { User } from '../../types'\n\nexport const fetchSorterUsersQuery = gql`\n  query {\n    sorters {\n      id\n      firstName\n      lastName\n    }\n  }\n`\n\nexport const fetchSorterUsers = (api: Api) => async (): Promise<User[]> => {\n  const data = await api.query<{\n    sorters: GraphIndividual[]\n  }>(fetchSorterUsersQuery)\n  const { sorters } = data\n\n  return sortBy(\n    sorters.map((user) => ({ ...user, fullName: `${user.firstName} ${user.lastName}` })),\n    'fullName'\n  )\n}\n","import gql from 'graphql-tag'\nimport { PaginatedRecords, Taxonomy as GraphTaxonomy } from '@namcbugdb/common'\n\nimport { Api } from '../api'\nimport { Taxon } from '../../types'\n\nexport const fetchTaxaQuery = gql`\n  query ($offset: Int) {\n    taxonomy(limit: 1000, offset: $offset, searchTerm: \"%\") {\n      records {\n        taxonomyId\n        scientificName\n        levelId\n        levelName\n        synonyms\n        parentTaxonomyId\n        notes\n        isTargetEffort\n      }\n      nextOffset\n    }\n  }\n`\n\nexport const fetchTaxa = (api: Api) => async (): Promise<Taxon[]> => {\n  const data = await api.queryAllPages<{\n    taxonomy: PaginatedRecords<GraphTaxonomy>\n  }>(fetchTaxaQuery, {}, { dataProperty: 'taxonomy' })\n  const { records } = data.taxonomy\n\n  return records.map(\n    ({\n      taxonomyId: id,\n      scientificName: name,\n      levelId,\n      levelName,\n      parentTaxonomyId: parentId,\n      synonyms: synonymsJson,\n      isTargetEffort,\n    }) => ({\n      id,\n      name,\n      levelId,\n      levelName,\n      levelRankOrder: -1, // TODO: do something instead of hacking this (re-type as optional, or mod type)\n      parentId,\n      synonyms: synonymsJson ? JSON.parse(synonymsJson) : [],\n      isTargetEffort,\n    })\n  )\n}\n","import gql from 'graphql-tag'\nimport { Translation as GraphTranslation } from '@namcbugdb/common'\n\nimport { Api } from '../api'\nimport { Translation } from '../../types'\n\nexport const fetchTranslationsQuery = gql`\n  query ($offset: Int!) {\n    translations(limit: 500, offset: $offset) {\n      records {\n        translationId\n        translationName\n        isActive\n        taxaCount\n        createdDate\n        updatedDate\n      }\n      nextOffset\n    }\n  }\n`\n\nexport const fetchTranslations = (api: Api) => async (): Promise<Translation[]> => {\n  const data = await api.queryAllPages<{ translations: { records: GraphTranslation[] } }>(\n    fetchTranslationsQuery,\n    {},\n    { dataProperty: 'translations' }\n  )\n\n  return data.translations.records.map(({ translationId: id, translationName: name, ...rest }) => ({\n    id,\n    name,\n    ...rest,\n  }))\n}\n","import gql from 'graphql-tag'\nimport { Box as GraphBox } from '@namcbugdb/common'\nimport { sortBy } from 'lodash'\n\nimport { Api } from '../api'\nimport { Box } from '../../types'\nimport { transformBox } from './fetchBoxes'\n\nexport const fetchUserBoxesQuery = gql`\n  query ($offset: Int) {\n    userBoxes(limit: 1000, offset: $offset) {\n      records {\n        boxId\n        customerName\n        customerId\n        createdDate\n        boxReceivedDate\n        submittedBy\n        boxState\n        sampleCount\n        midges\n        measurements\n        sortComplete\n        idComplete\n        alias\n        submissionCount\n      }\n      nextOffset\n    }\n  }\n`\n\nexport const fetchUserBoxes = (api: Api) => async (): Promise<Box[]> => {\n  const data = await api.queryAllPages<{ userBoxes: { records: GraphBox[] } }>(\n    fetchUserBoxesQuery,\n    {},\n    { dataProperty: 'userBoxes' }\n  )\n\n  const boxes = (data.userBoxes.records ?? []).map(transformBox)\n\n  return sortBy(boxes, 'boxId').reverse()\n}\n","import gql from 'graphql-tag'\nimport { Individual as GraphIndividual } from '@namcbugdb/common'\n\nimport { Api } from '../api'\nimport { User } from '../../types'\nimport { deNull } from '../../lib/deNull'\n\nexport const fetchUserByIdQuery = gql`\n  query ($userId: Int!) {\n    user(id: $userId) {\n      id\n      firstName\n      lastName\n      email\n      phone\n      affiliationId\n      organizationName\n      roleIds\n    }\n  }\n`\n\nexport const fetchUserById =\n  (api: Api) =>\n  async (userId: number): Promise<User | null> => {\n    const data = await api.query<{ user: GraphIndividual }>(fetchUserByIdQuery, { userId })\n    const { user } = data\n    if (!user) return null\n    const fullName = `${user.firstName} ${user.lastName}`\n    return deNull(\n      { fullName, ...data.user },\n      {\n        // id,\n        fullName: '',\n        firstName: '',\n        lastName: '',\n        email: '',\n        phone: '',\n        // affiliationId,\n        organizationName: '',\n        roleIds: [],\n      }\n    )\n  }\n","import gql from 'graphql-tag'\nimport { PaginatedRecords, Individual as GraphIndividual } from '@namcbugdb/common'\n\nimport { Api } from '../api'\nimport { User } from '../../types'\n\nexport const fetchUsersQuery = gql`\n  query ($offset: Int) {\n    users(limit: 1000, offset: $offset) {\n      records {\n        id\n        firstName\n        lastName\n        email\n        phone\n        organizationName\n        affiliationId\n        roleIds\n      }\n      nextOffset\n    }\n  }\n`\n\nexport const fetchUsers = (api: Api) => async (): Promise<User[]> => {\n  const data = await api.queryAllPages<{ users: PaginatedRecords<GraphIndividual> }>(\n    fetchUsersQuery,\n    {},\n    { dataProperty: 'users' }\n  )\n  const { records } = data.users\n\n  return records.map((user) => ({\n    fullName: `${user.firstName} ${user.lastName}`,\n    ...user,\n    roleIds: user.roleIds || [],\n    organizationName: user.organizationName || '',\n  }))\n}\n","import gql from 'graphql-tag'\nimport { USState as GraphUSState } from '@namcbugdb/common' // TODO: no type available yet\n\nimport { Api } from '../api'\nimport { UsState } from '../../types'\n\nexport interface fetchUsStateAtCoordinatesParams {\n  latitude: number\n  longitude: number\n}\n\nexport const fetchUsStateAtCoordinatesQuery = gql`\n  query ($latitude: Float!, $longitude: Float!) {\n    getUSState(latitude: $latitude, longitude: $longitude) {\n      id\n      name\n      abbreviation\n    }\n  }\n`\n\nexport const fetchUsStateAtCoordinates =\n  (api: Api) =>\n  async (params: fetchUsStateAtCoordinatesParams): Promise<UsState | null> => {\n    const data = await api.query<{ getUSState: GraphUSState }>(fetchUsStateAtCoordinatesQuery, { ...params })\n    return data.getUSState\n  }\n","import gql from 'graphql-tag'\n\nimport { Api, ApiError } from '../api'\nimport { InvalidateFn } from '../selectors'\n\ninterface ReconcileParams {\n  boxId: number\n  fromTaxonomyId: number\n  toTaxonomyId: number\n}\n\nexport const reconcileBoxTaxonomyMutation = gql`\n  mutation ($boxId: Int!, $fromTaxonomyId: Int!, $toTaxonomyId: Int!) {\n    taxReconciliation(boxId: $boxId, fromTaxonomyId: $fromTaxonomyId, toTaxonomyId: $toTaxonomyId)\n  }\n`\n\nexport const reconcileBoxTaxonomy =\n  (api: Api, invalidate: InvalidateFn) =>\n  async (params: ReconcileParams): Promise<true> => {\n    const data = await api.mutation<{\n      taxReconciliation: number\n    }>(reconcileBoxTaxonomyMutation, { ...params })\n\n    if (!data.taxReconciliation) throw new ApiError('taxonomy did not reconcile')\n\n    invalidate('boxTaxa')\n    return true\n  }\n","import gql from 'graphql-tag'\n\nimport { Api, ApiError } from '../api'\nimport { InvalidateFn } from '../selectors'\n\ninterface RemoveProjectSamplesInput {\n  projectId: number\n  sampleIds: number[]\n}\n\nexport const removeProjectSamplesMutation = gql`\n  mutation ($projectId: Int!, $sampleIds: [Int]) {\n    removeProjectSamples(projectId: $projectId, sampleIds: $sampleIds)\n  }\n`\n\nexport const removeProjectSamples =\n  (api: Api, invalidate: InvalidateFn) =>\n  async (params: RemoveProjectSamplesInput): Promise<true> => {\n    const data = await api.mutation<{\n      removeProjectSamples: number // NOTE: return type is number of samples after operation (0 is not indication of failure)\n    }>(removeProjectSamplesMutation, { ...params })\n\n    if (data.removeProjectSamples === null) throw new ApiError('project samples did not update') // cannot check for falsey due to return type noted above\n\n    invalidate('projectSamples')\n    return true\n  }\n","import gql from 'graphql-tag'\n\nimport { Api, ApiError } from '../api'\nimport { InvalidateFn } from '../selectors'\n\nexport const startSortMutation = gql`\n  mutation ($sampleId: Int!) {\n    labStartSort(sampleId: $sampleId)\n  }\n`\n\nexport const startSort =\n  (api: Api, invalidate: InvalidateFn) =>\n  async ({ sampleId }: { sampleId: number }): Promise<true> => {\n    const data = await api.mutation<{\n      labStartSort: number // NOTE this is records affected, 1 = success, 0 = failure\n    }>(startSortMutation, { sampleId })\n\n    if (!data.labStartSort) throw new ApiError('sample sorting did not start')\n\n    invalidate('boxes')\n    invalidate('samples')\n    return true\n  }\n","import gql from 'graphql-tag'\n\nimport { Api, ApiError } from '../api'\nimport { InvalidateFn } from '../selectors'\n\nexport const startTaxonomyIdentificationMutation = gql`\n  mutation ($sampleId: Int!) {\n    taxIdentificationStart(sampleId: $sampleId)\n  }\n`\n\nexport const startTaxonomyIdentification =\n  (api: Api, invalidate: InvalidateFn) =>\n  async ({ sampleId }: { sampleId: number }): Promise<true> => {\n    const data = await api.mutation<{\n      taxIdentificationStart: number // NOTE this is records affected, 1 = success, 0 = failure\n    }>(startTaxonomyIdentificationMutation, { sampleId })\n\n    if (!data.taxIdentificationStart) throw new ApiError('taxonomy identification did not start')\n\n    invalidate('boxes')\n    invalidate('samples')\n    return true\n  }\n","import gql from 'graphql-tag'\n\nimport { Api, ApiError } from '../api'\nimport { InvalidateFn } from '../selectors'\n\nexport const stopSortMutation = gql`\n  mutation ($sampleId: Int!) {\n    labStopSort(sampleId: $sampleId)\n  }\n`\n\nexport const stopSort =\n  (api: Api, invalidate: InvalidateFn) =>\n  async ({ sampleId }: { sampleId: number }): Promise<true> => {\n    const data = await api.mutation<{\n      labStopSort: number // NOTE this is records affected, 1 = success, 0 = failure\n    }>(stopSortMutation, { sampleId })\n\n    if (!data.labStopSort) throw new ApiError('sample sorting did not stop')\n\n    invalidate('boxes')\n    invalidate('samples')\n    return true\n  }\n","import gql from 'graphql-tag'\n\nimport { Api, ApiError } from '../api'\nimport { InvalidateFn } from '../selectors'\n\nexport const stopTaxonomyIdentificationMutation = gql`\n  mutation ($sampleId: Int!, $time: Float!) {\n    taxIdentificationStop(sampleId: $sampleId, time: $time)\n  }\n`\n\nexport const stopTaxonomyIdentification =\n  (api: Api, invalidate: InvalidateFn) =>\n  async ({ sampleId, time }: { sampleId: number; time: number }): Promise<true> => {\n    const data = await api.mutation<{\n      taxIdentificationStop: number // NOTE this is records affected, 1 = success, 0 = failure\n    }>(stopTaxonomyIdentificationMutation, { sampleId, time })\n\n    if (!data.taxIdentificationStop) throw new ApiError('taxonomy identification did not stop')\n\n    invalidate('boxes')\n    invalidate('samples')\n    return true\n  }\n","import gql from 'graphql-tag'\n\nimport { Api, ApiError } from '../api'\nimport { InvalidateFn } from '../selectors'\n\ninterface BoxUpdate {\n  boxId: number\n  boxStateId: number\n  measurements: boolean\n  midges: boolean\n  description: string\n  modelIds: number[]\n}\n\nexport const updateBoxMutation = gql`\n  mutation (\n    $boxId: Int!\n    $boxStateId: Int!\n    $customerId: Int!\n    $alias: String\n    $description: String\n    $measurements: Boolean!\n    $midges: Boolean!\n    $modelIds: [Int]\n  ) {\n    setBoxInfo(\n      boxId: $boxId\n      boxStateId: $boxStateId\n      customerId: $customerId\n      alias: $alias\n      description: $description\n      measurements: $measurements\n      midges: $midges\n      models: $modelIds\n    )\n  }\n`\n\nexport const updateBox =\n  (api: Api, invalidate: InvalidateFn) =>\n  async (boxUpdate: BoxUpdate): Promise<true> => {\n    const data = await api.mutation<{\n      setBoxInfo: number // NOTE: count of records changed\n    }>(updateBoxMutation, { ...boxUpdate })\n\n    if (!data.setBoxInfo) throw new ApiError('box did not update')\n\n    invalidate('boxes')\n    invalidate('samples')\n    return true\n  }\n","import gql from 'graphql-tag'\n\nimport { Api, ApiError } from '../api'\nimport { InvalidateFn } from '../selectors'\n\ninterface LabSortSubmission {\n  sampleId: number\n  sorterId: number\n  sortTime: number\n  sorterCount: number\n  elutriation: boolean\n  labSplit: number\n}\n\nexport const updateLabSortMutation = gql`\n  mutation ($sampleId: Int!, $sorterId: Int!, $count: Int!, $elutriation: Boolean!, $time: Float!, $labSplit: Float!) {\n    labSort(\n      sampleId: $sampleId\n      sorterId: $sorterId\n      count: $count\n      elutriation: $elutriation\n      time: $time\n      labSplit: $labSplit\n    )\n  }\n`\n\nexport const updateLabSort =\n  (api: Api, invalidate: InvalidateFn) =>\n  async (submission: LabSortSubmission): Promise<true> => {\n    const { sortTime: time, sorterCount: count, ...rest } = submission\n    const variables = {\n      time,\n      count,\n      ...rest,\n    }\n    const data = await api.mutation<{\n      labSort: number // NOTE: count of records changed\n    }>(updateLabSortMutation, variables)\n\n    if (!data.labSort) throw new ApiError('sample sorting did not update')\n\n    invalidate('boxes')\n    invalidate('samples')\n    return true\n  }\n","import gql from 'graphql-tag'\n\nimport { Api, ApiError } from '../api'\nimport { InvalidateFn } from '../selectors'\n\nimport { OrganizationInput } from './createOrganization'\n\ninterface ExistingOrganizationInput extends OrganizationInput {\n  id: number\n}\n\nexport const updateOrganizationMutation = gql`\n  mutation ($id: Int!, $organization: OrganizationInput!) {\n    updateOrganization(id: $id, organization: $organization)\n  }\n`\n\nexport const updateOrganization =\n  (api: Api, invalidate: InvalidateFn) =>\n  async (organization: ExistingOrganizationInput): Promise<true> => {\n    const { id, name: organizationName, typeId: organizationTypeId, ...restOrganization } = organization\n    const data = await api.mutation<{\n      updateOrganization: number // NOTE: id of organization\n    }>(updateOrganizationMutation, {\n      id,\n      organization: {\n        organizationName,\n        organizationTypeId,\n        ...restOrganization,\n      },\n    })\n\n    if (!data.updateOrganization) throw new ApiError('organization did not update')\n\n    invalidate('organizations')\n    return true\n  }\n","import gql from 'graphql-tag'\n\nimport { Api, ApiError } from '../api'\nimport { InvalidateFn } from '../selectors'\n\nimport { ProjectInput } from './createProject'\n\ninterface ExistingProjectInput extends ProjectInput {\n  id: number\n}\n\nexport const updateProjectMutation = gql`\n  mutation ($id: Int!, $project: ProjectInput!) {\n    updateProject(id: $id, project: $project)\n  }\n`\n\nexport const updateProject =\n  (api: Api, invalidate: InvalidateFn) =>\n  async (project: ExistingProjectInput): Promise<true> => {\n    const { id, name: projectName, ...restProject } = project\n    const data = await api.mutation<{\n      updateProject: number // NOTE: id of project\n    }>(updateProjectMutation, {\n      id,\n      project: {\n        projectName,\n        ...restProject,\n      },\n    })\n\n    if (!data.updateProject) throw new ApiError('project did not update')\n\n    invalidate('projects')\n    return true\n  }\n","import gql from 'graphql-tag'\n\nimport { Api, ApiError } from '../api'\nimport { InvalidateFn } from '../selectors'\n\nimport { UserInput } from './createOrganizationWithUser'\n\ninterface ExistingUserInput extends UserInput {\n  id: number\n}\n\nexport const updateUserMutation = gql`\n  mutation ($id: Int!, $user: IndividualInput!) {\n    updateUser(id: $id, user: $user)\n  }\n`\n\nexport const updateUser =\n  (api: Api, invalidate: InvalidateFn) =>\n  async (user: ExistingUserInput, isSelf: boolean): Promise<true> => {\n    const { id, ...restUser } = user\n    const data = await api.mutation<{\n      updateUser: number // NOTE: id of user\n    }>(updateUserMutation, { id, user: restUser })\n\n    if (!data.updateUser) throw new ApiError('user did not update')\n\n    invalidate(isSelf ? 'myUser' : 'users')\n    return true\n  }\n","import gql from 'graphql-tag'\n\nimport { Api, ApiError } from '../api'\nimport { InvalidateFn } from '../selectors'\n\nexport const updateUserRolesMutation = gql`\n  mutation ($id: Int!, $roleIds: [Int]!) {\n    updateUserRoles(userId: $id, roleIds: $roleIds)\n  }\n`\n\nexport const updateUserRoles =\n  (api: Api, invalidate: InvalidateFn) =>\n  async ({ id, roleIds }: { id: number; roleIds: number[] }): Promise<true> => {\n    const data = await api.mutation<{\n      updateUserRoles: number // NOTE: id of user\n    }>(updateUserRolesMutation, { id, roleIds })\n\n    if (!data.updateUserRoles) throw new ApiError('user roles did not update')\n\n    invalidate('users')\n    return true\n  }\n","import gql from 'graphql-tag'\n\nimport { Api, ApiError } from '../api'\nimport { UnpersistedOrganism, Organism } from '../../types'\nimport { InvalidateFn } from '../selectors'\n\nexport const upsertOrganismMutation = gql`\n  mutation (\n    $sampleId: Int!\n    $taxonId: Int!\n    $lifeStageId: Int!\n    $splitCount: Int!\n    $bigRareCount: Int\n    $comments: String\n    $noteTypeIds: [Int]\n  ) {\n    createSampleTaxaInfo(\n      sampleId: $sampleId\n      taxonomyId: $taxonId\n      lifeStageId: $lifeStageId\n      splitCount: $splitCount\n      comments: $comments\n      noteTypeIds: $noteTypeIds\n      bigRareCount: $bigRareCount\n    )\n  }\n`\n\nexport const upsertOrganism =\n  (api: Api, invalidate: InvalidateFn) =>\n  async (organism: UnpersistedOrganism | Organism): Promise<number> => {\n    const data = await api.mutation<{\n      createSampleTaxaInfo: number\n    }>(upsertOrganismMutation, { lifeStageId: -1, ...organism })\n\n    const id = data.createSampleTaxaInfo\n    if (!id) throw new ApiError('organism record did not create or update')\n\n    invalidate('samples')\n    return id\n  }\n","/** @jsxImportSource @emotion/react */\nimport React, { useMemo, useState, useEffect } from 'react'\nimport { AgGridReact, AgGridReactProps } from 'ag-grid-react'\nimport { ColDef, ColGroupDef, SelectionChangedEvent, GridApi, ColumnApi, GridReadyEvent } from 'ag-grid-community'\n\nimport 'ag-grid-community/dist/styles/ag-grid.css'\n// import 'ag-grid-community/dist/styles/ag-theme-balham.css'\n// import 'ag-grid-community/dist/styles/ag-theme-balham-dark.css'\nimport 'ag-grid-community/dist/styles/ag-theme-material.css'\nimport './DataGrid.css'\n\nexport interface DataGridApis {\n  api: GridApi\n  columnApi: ColumnApi\n}\n\nexport interface DataGridProps<T> extends AgGridReactProps {\n  rows: T[]\n  columnDefs: (ColDef | ColGroupDef)[]\n  onSelectedRowsChanged?: (rows: T[]) => void\n  onGridApisReady?: (params: DataGridApis) => void\n  rowIdProperty?: string\n}\n\nexport const DataGrid = <T,>({\n  rows,\n  columnDefs,\n  onSelectedRowsChanged,\n  onGridApisReady,\n  context,\n  gridOptions,\n  rowIdProperty = 'id',\n  ...restProps\n}: DataGridProps<T>): JSX.Element => {\n  // GRID APIS\n  const [grid, setGrid] = useState<DataGridApis>()\n\n  // EVENT HANDLERS\n\n  const handleOnSelectionChanged = ({ api }: SelectionChangedEvent): void => {\n    if (!onSelectedRowsChanged) return\n    onSelectedRowsChanged(api.getSelectedRows())\n  }\n\n  const handleGridReady = ({ api, columnApi }: GridReadyEvent) => {\n    setGrid({ api, columnApi })\n    if (onGridApisReady) onGridApisReady({ api, columnApi })\n  }\n\n  // CONTEXT AND REFRESH\n\n  useEffect(() => {\n    if (!grid?.api) return\n\n    // must force a refresh when context changes\n    grid.api.refreshCells()\n    grid.api.refreshHeader()\n  }, [context, grid])\n\n  // OTHER OPTIONS\n\n  const memoizedGridOptions = useMemo(\n    // need stable, per instance grid options\n    () => ({\n      suppressCellSelection: true,\n      // rowSelection: 'multiple',\n      defaultColDef: {\n        sortable: true,\n        resizable: true,\n        suppressMovable: true,\n      },\n      // rowClassRules: {\n      //   'DataGrid__row--unselectable': ({ data: { unselectable } }) => unselectable,\n      // },\n      ...gridOptions,\n    }),\n    [gridOptions]\n  )\n\n  // const isRowSelectable = ({ data: { unselectable } }) => !unselectable\n\n  // RENDER\n\n  return (\n    <div className=\"ag-theme-material\" css={{ width: '100%', height: '100%' }}>\n      <AgGridReact\n        rowData={rows}\n        immutableData\n        gridOptions={memoizedGridOptions}\n        columnDefs={columnDefs}\n        onSelectionChanged={handleOnSelectionChanged}\n        animateRows\n        containerStyle={{ width: '100%', height: '100%' }}\n        getRowNodeId={(data) => data[rowIdProperty]}\n        context={context}\n        // frameworkComponents={frameworkComponents}\n        // isRowSelectable={isRowSelectable}\n        onGridReady={handleGridReady}\n        {...restProps}\n      />\n    </div>\n  )\n}\n","import dayjs from 'dayjs'\nimport utc from 'dayjs/plugin/utc'\nimport timezone from 'dayjs/plugin/timezone' // depends on utc\n\ndayjs.extend(utc)\ndayjs.extend(timezone)\n\nconst APP_TIME_ZONE = 'US/Mountain'\n\nexport const formatNumber = (value: number): string => value.toLocaleString()\n\nexport const formatUtcDateTimeToAppDate = (utcDateTime: string | null): string | null => {\n  if (!utcDateTime) return null\n  if (utcDateTime.match(/T00:00:00(\\+00:00|Z)/)) return utcDateTime.substring(0, 'YYYY-MM-DD'.length)\n  return dayjs(utcDateTime).tz(APP_TIME_ZONE).format('YYYY-MM-DD')\n}\n\nexport const getCurrentDateTime = (): string => {\n  return dayjs().toISOString()\n}\n","/** @jsxImportSource @emotion/react */\nimport React from 'react'\n\nimport { Chip } from '../Chip'\nimport { Filter } from './types'\n\nconst NoneChip = () => <Chip label=\"No filters\" />\n\nexport interface FilterChipsProps<T> {\n  className?: string\n  filters: Filter<T>[]\n  joinLabel?: 'and' | 'or'\n  noneNode?: React.ReactNode\n}\n\nenum CHIP_COLOR {\n  default = 'lightblue',\n  warn = '#ffcc00',\n}\n\nexport const FilterChips = <T,>({\n  className,\n  filters,\n  joinLabel,\n  noneNode = <NoneChip />,\n}: FilterChipsProps<T>): JSX.Element => {\n  return (\n    <div\n      className={className}\n      css={{ flex: 1, display: 'flex', flexWrap: 'wrap', gap: '0.5em', alignItems: 'center', fontSize: '0.8125rem' }}\n    >\n      {filters.length > 0\n        ? filters.map(({ id, label, textColor, chipColor = CHIP_COLOR.default, onDelete }, index) => (\n            <React.Fragment key={id}>\n              {joinLabel && !!index && <span css={{ fontStyle: 'italic', opacity: 0.6 }}> {joinLabel} </span>}\n              <Chip\n                label={label}\n                textColor={textColor}\n                chipColor={CHIP_COLOR[chipColor] || chipColor}\n                onDelete={onDelete}\n              />\n            </React.Fragment>\n          ))\n        : noneNode}\n    </div>\n  )\n}\n","import { ColDef, ValueFormatterParams } from 'ag-grid-community'\n\nimport { formatNumber, formatUtcDateTimeToAppDate } from '../../lib/formats'\n\nexport const comparator = {\n  labelComparator: (valueA: { label: string | number }, valueB: { label: string | number }): number => {\n    const labelA = valueA.label\n    const labelB = valueB.label\n    if (labelA == labelB) return 0\n    return labelA > labelB ? 1 : -1\n  },\n}\n\nexport const columnDef = {\n  linkColumn: (colDef: ColDef): ColDef => ({\n    // value is expected to be { label: string, onClick: () => void }\n    cellRenderer: 'LinkRenderer',\n    comparator: comparator.labelComparator,\n    ...colDef,\n  }),\n  textColumn: (colDef: ColDef): ColDef => colDef,\n  textListColumn: (colDef: ColDef): ColDef => ({ valueFormatter: ({ value }) => value.join(', '), ...colDef }),\n  filterableTextColumn: ({ filterTooltip, ...restColDef }: ColDef & { filterTooltip: string }): ColDef => ({\n    // value is expected to be { label: string, onFilter: () => void, disabled?: boolean }\n    cellRenderer: 'FilterableTextRenderer',\n    cellRendererParams: { filterTooltip },\n    comparator: comparator.labelComparator,\n    ...restColDef,\n  }),\n  dateColumn: (colDef: ColDef): ColDef => ({\n    valueFormatter: ({ value }) => formatUtcDateTimeToAppDate(value) ?? '',\n    width: 120,\n    ...colDef,\n  }),\n  progressColumn: (colDef: ColDef): ColDef => ({ cellRenderer: 'ProgressRenderer', ...colDef }),\n  checkColumn: (colDef: ColDef): ColDef => ({ cellRenderer: 'CheckRenderer', ...colDef }),\n  booleanColumn: ({ valueLabels, ...restColDef }: ColDef & { valueLabels: [string, string] }): ColDef => ({\n    valueFormatter: ({ value }) => (value ? valueLabels[1] : valueLabels[0]),\n    ...restColDef,\n  }),\n  numberColumn: (colDef: ColDef): ColDef => ({\n    type: 'numericColumn',\n    valueFormatter: ({ value }: ValueFormatterParams): string => value && formatNumber(value),\n    ...colDef,\n  }),\n}\n","import React from 'react'\nimport Tooltip from '@mui/material/Tooltip'\n\nexport const withTooltip = (content: JSX.Element, tooltip: string | undefined, disabled?: boolean): JSX.Element => {\n  if (!tooltip) return content\n  if (disabled)\n    return (\n      <Tooltip title={tooltip}>\n        <span>{content}</span>\n      </Tooltip>\n    )\n  return <Tooltip title={tooltip}>{content}</Tooltip>\n}\n","/** @jsxImportSource @emotion/react */\nimport React from 'react'\nimport { ICellRendererParams } from 'ag-grid-community'\nimport CheckBoxOutlinedIcon from '@mui/icons-material/CheckBoxOutlined'\nimport CheckBoxOutlineBlankOutlinedIcon from '@mui/icons-material/CheckBoxOutlineBlankOutlined'\nimport IconButton from '@mui/material/IconButton'\nimport FilterAltIcon from '@mui/icons-material/FilterAlt'\n\nimport { withTooltip } from '../withTooltip'\n\ninterface CellRendererParams<T> extends ICellRendererParams {\n  value: T\n}\n\nconst LinkRenderer = ({\n  value: { label, onClick },\n}: CellRendererParams<{\n  label: string | number\n  onClick: () => void\n}>): React.ReactNode => (\n  <span onClick={onClick} className=\"link\">\n    {label}\n  </span>\n)\n\nconst ProgressRenderer = ({ value }: CellRendererParams<number>): React.ReactNode => {\n  const percent = `${Math.floor(value * 100)}%`\n  return (\n    <div css={{ height: '100%', width: '100%', position: 'relative' }}>\n      <div css={{ position: 'absolute', background: 'lightgrey', width: '100%', height: '50%', top: '25%' }} />\n      <div css={{ position: 'absolute', background: '#42d64c', width: percent, height: '50%', top: '25%' }} />\n      <div css={{ position: 'absolute', width: '100%', textAlign: 'center' }}>{percent}</div>\n    </div>\n  )\n}\n\nconst CheckRenderer = ({ value }: CellRendererParams<boolean>): React.ReactNode => (\n  <div css={{ display: 'flex', alignItems: 'center', height: '100%' }}>\n    {value ? <CheckBoxOutlinedIcon /> : <CheckBoxOutlineBlankOutlinedIcon />}\n  </div>\n)\n\nconst FilterableTextRenderer = ({\n  value: { label, onFilter, disabled },\n  filterTooltip,\n}: CellRendererParams<{\n  label: string | number\n  onFilter: () => void\n  disabled?: boolean\n}> & { filterTooltip: string }): React.ReactNode => {\n  return (\n    <div>\n      <div css={{ position: 'absolute', right: 0 }}>\n        <IconButton\n          onClick={() => {\n            onFilter()\n          }}\n          disabled={disabled}\n        >\n          {withTooltip(<FilterAltIcon />, filterTooltip, disabled)}\n        </IconButton>\n      </div>\n      {label}\n    </div>\n  )\n}\n\nexport const renderers = { LinkRenderer, ProgressRenderer, CheckRenderer, FilterableTextRenderer }\n","export const pluralize = (qty: number | null | undefined, word: string): string => {\n  const isOne = typeof qty === 'number' && qty === 1\n\n  switch (word) {\n    case 'is':\n      return isOne ? 'is' : 'are'\n    case 'box':\n      return isOne ? 'box' : 'boxes'\n    case 'taxon':\n      return isOne ? 'taxon' : 'taxa'\n    case 'taxa':\n      return 'taxa'\n    default:\n      return isOne ? word : `${word}s`\n  }\n}\n","/** @jsxImportSource @emotion/react */\nimport React from 'react'\n\nimport { formatNumber } from '../../lib/formats'\nimport { pluralize } from '../../lib/pluralize'\n\ninterface DataGridRecordCountProps {\n  className?: string\n  descriptor: string\n  total: number\n  visible: number\n}\n\nexport const DataGridRecordCount = ({\n  className,\n  descriptor,\n  total,\n  visible,\n}: DataGridRecordCountProps): JSX.Element => {\n  return (\n    <div\n      className={className}\n      css={{\n        fontSize: '0.8125rem' /* match chip */,\n        display: 'flex',\n        alignItems: 'center',\n      }}\n    >\n      {total === visible\n        ? `${formatNumber(total)} ${pluralize(total, descriptor)}`\n        : `${formatNumber(visible)} of ${formatNumber(total)} ${descriptor} shown`}\n    </div>\n  )\n}\n","import { ColDef } from 'ag-grid-community'\nimport { columnDef } from '../DataGrid'\n\nexport const privilegedColumnDefs = [\n  columnDef.linkColumn({\n    headerName: 'Box ID',\n    field: 'boxId',\n    width: 120,\n  }),\n  columnDef.filterableTextColumn({\n    field: 'customer',\n    flex: 3,\n    minWidth: 400,\n    filterTooltip: 'Filter by this customer',\n  }),\n  columnDef.textColumn({\n    field: 'alias',\n    flex: 1,\n    minWidth: 110,\n  }),\n  columnDef.numberColumn({\n    field: 'sampleCount',\n    width: 130,\n  }),\n  columnDef.textColumn({\n    field: 'boxState',\n    width: 110,\n  }),\n  columnDef.booleanColumn({\n    field: 'measurements',\n    valueLabels: ['No', 'Yes'],\n    width: 130,\n  }),\n  columnDef.booleanColumn({\n    field: 'midges',\n    valueLabels: ['No', 'Yes'],\n    width: 90,\n  }),\n  columnDef.dateColumn({\n    field: 'receivedDate',\n    width: 150,\n  }),\n  columnDef.progressColumn({\n    headerName: '% Complete Sort',\n    field: 'sortComplete',\n    width: 140,\n  }),\n  columnDef.progressColumn({\n    headerName: '% Complete ID',\n    field: 'identificationComplete',\n    width: 140,\n  }),\n] as ColDef[]\n\nexport const customerColumnDefs = [\n  columnDef.textColumn({\n    headerName: 'Submission ID',\n    field: 'id',\n    width: 150,\n  }),\n  columnDef.dateColumn({\n    headerName: 'Submitted On',\n    field: 'createdDate',\n    width: 150,\n  }),\n  columnDef.textColumn({\n    headerName: 'Submission State',\n    field: 'boxState',\n    width: 150,\n  }),\n  columnDef.numberColumn({\n    field: 'sampleCount',\n    width: 130,\n  }),\n  columnDef.linkColumn({\n    field: 'forms',\n    flex: 1,\n  }),\n] as ColDef[]\n","/** @jsxImportSource @emotion/react */\nimport React from 'react'\nimport MuiFormControl from '@mui/material/FormControl'\nimport MuiInputLabel from '@mui/material/InputLabel'\n\nexport interface ReadOnlyFieldProps {\n  className?: string\n  gridArea?: string\n  label?: React.ReactNode\n  minWidth?: string | number\n  value: React.ReactNode\n}\n\nexport const ReadOnlyField = ({\n  className,\n  gridArea,\n  label,\n  minWidth = 195, // match fields, prevent label collapse\n  value,\n}: ReadOnlyFieldProps): JSX.Element => {\n  const displayValue = (() => {\n    if (typeof value === 'boolean') return value ? 'Yes' : 'No'\n    if (!value && value !== 0) return '—'\n    return value\n  })()\n  return (\n    <MuiFormControl className={className} css={{ gridArea }}>\n      <MuiInputLabel shrink>{label}</MuiInputLabel>\n      <div\n        css={{\n          // below to match Material UI; there may be class/es which correctly apply the below with manual CSS\n          minWidth,\n          padding: '8.5px 14px',\n          lineHeight: '1.4375em',\n          letterSpacing: '0.00938em',\n        }}\n      >\n        {displayValue}\n      </div>\n    </MuiFormControl>\n  )\n}\n","/** @jsxImportSource @emotion/react */\nimport React from 'react'\nimport InputLabel from '@mui/material/InputLabel'\nimport MenuItem from '@mui/material/MenuItem'\nimport FormControl from '@mui/material/FormControl'\nimport Select, { SelectChangeEvent } from '@mui/material/Select'\n\nimport { ReadOnlyField } from '../ReadOnlyField'\nimport { CommonFieldProps } from '../../types'\n\nexport interface SelectFieldProps extends CommonFieldProps<string | number> {\n  options: {\n    value: string | number\n    label: React.ReactNode\n    disabled?: boolean\n  }[]\n}\n\nexport const SelectField = ({\n  // CommonFieldProps\n  className,\n  disabled,\n  error,\n  gridArea,\n  label,\n  onChange,\n  readOnly,\n  value,\n\n  // SelectFieldProps\n  options,\n}: SelectFieldProps): JSX.Element => {\n  if (readOnly) {\n    const valueLabel = options.find((option) => option.value === value)?.label ?? ''\n    return <ReadOnlyField className={className} gridArea={gridArea} label={label} value={valueLabel} />\n  }\n\n  const handleChange = ({ target: { value: newValue } }: SelectChangeEvent<string | number>) => {\n    onChange(newValue)\n  }\n\n  return (\n    <FormControl\n      sx={{ minWidth: '10em' }}\n      className={className}\n      disabled={disabled || readOnly}\n      css={{ '.MuiInputBase-root': { color: 'unset' }, gridArea }}\n    >\n      {label && (\n        <InputLabel\n          // size=\"small\" // typing says this isn't a prop, but it works to correctly position label :-|\n          error={error}\n        >\n          {label}\n        </InputLabel>\n      )}\n      <Select<string | number> error={error} label={label} onChange={handleChange} value={value} size=\"small\">\n        {options.map((option) => (\n          <MenuItem key={option.value} value={option.value} disabled={option.disabled}>\n            {option.label || <span css={{ fontStyle: 'italic' }}>(clear)</span>}\n          </MenuItem>\n        ))}\n      </Select>\n    </FormControl>\n  )\n}\n","/** @jsxImportSource @emotion/react */\nimport React from 'react'\nimport MuiChip from '@mui/material/Chip'\n\ninterface ChipProps {\n  // variant?: 'standard' | 'reference'\n  label: string\n  textColor?: string\n  chipColor?: string\n  onDelete?: () => void\n}\n\nexport const Chip = ({ label, chipColor, textColor, onDelete }: ChipProps): JSX.Element => (\n  <MuiChip\n    sx={{ backgroundColor: chipColor, color: textColor }}\n    label={label}\n    variant={chipColor ? 'filled' : 'outlined'}\n    onDelete={onDelete}\n  />\n)\n","/** @jsxImportSource @emotion/react */\nimport React from 'react'\nimport MuiTextField, { StandardTextFieldProps } from '@mui/material/TextField'\n\nimport { ReadOnlyField } from '../ReadOnlyField'\nimport { CommonFieldProps } from '../../types'\n\nexport interface TextFieldProps extends CommonFieldProps<string>, Omit<StandardTextFieldProps, 'value' | 'onChange'> {\n  inputRef?: React.RefObject<HTMLInputElement>\n  maxLength?: number\n}\n\nexport const TextField = ({\n  // CommonFieldProps\n  className,\n  disabled,\n  error,\n  gridArea,\n  label,\n  onChange,\n  readOnly,\n  value,\n\n  // TextField\n  inputRef,\n  maxLength,\n\n  // StandardTextFieldProps\n  inputProps = {},\n  ...restProps\n}: TextFieldProps): JSX.Element => {\n  if (readOnly) return <ReadOnlyField className={className} gridArea={gridArea} label={label} value={value} />\n\n  const handleChange = ({ target: { value: newValue } }) => {\n    onChange(newValue)\n  }\n\n  const combinedInputProps = { ...inputProps, maxLength }\n\n  return (\n    <MuiTextField\n      className={className}\n      disabled={disabled}\n      error={error}\n      label={label}\n      onChange={handleChange}\n      value={value}\n      size=\"small\"\n      inputRef={inputRef}\n      css={{ gridArea }}\n      inputProps={combinedInputProps}\n      {...restProps}\n    />\n  )\n}\n","/** @jsxImportSource @emotion/react */\nimport React, { useRef } from 'react'\nimport { useHotkeys } from 'react-hotkeys-hook'\n\nimport { TextField, TextFieldProps } from '../TextField'\n\nexport interface TextFilterFieldProps extends TextFieldProps {\n  hotkeys?: string | false\n}\n\nexport const TextFilterField = ({\n  hotkeys = 'cmd+f, ctrl+f',\n  inputRef,\n  onChange,\n  value,\n  ...restProps\n}: TextFilterFieldProps): JSX.Element => {\n  const ownRef = useRef<HTMLInputElement>(null)\n  const effectiveRef = inputRef || ownRef\n\n  useHotkeys(hotkeys || '', (e) => {\n    e.preventDefault()\n    e.stopPropagation()\n    effectiveRef.current?.focus()\n  })\n\n  return <TextField css={{ width: '30em' }} value={value} onChange={onChange} inputRef={effectiveRef} {...restProps} />\n}\n","import { useCallback } from 'react'\n\nimport { useDebounce } from '../../lib/useDebounce'\n\ntype UseTextFilterFieldReturnTuple = [\n  text: string,\n  setText: (newValue: string) => void,\n  filterText: string,\n  clear: () => void\n]\n\nexport const useTextFilterField = (\n  state: [text: string, setText: (newValue: string) => void]\n): UseTextFilterFieldReturnTuple => {\n  const [text, setText] = state\n\n  const [rawFilterText, setRawFilterText] = useDebounce(text, 500)\n\n  const filterText = rawFilterText.trim()\n\n  const clear = useCallback(() => {\n    setText('')\n    setRawFilterText('')\n  }, [])\n\n  return [text, setText, filterText, clear]\n}\n","import { useState, useRef, useEffect, useCallback } from 'react'\n\nexport const useDebounce = <T>(input: T, delayMs: number): [T, (setValue) => void] => {\n  const debounceTimerRef = useRef<NodeJS.Timeout>()\n  const [debounced, setDebounced] = useState<T>(input)\n\n  const setDebouncedImmediately = useCallback((value: T) => {\n    if (debounceTimerRef.current) clearTimeout(debounceTimerRef.current)\n    setDebounced(value)\n  }, [])\n\n  useEffect(() => {\n    if (debounceTimerRef.current) clearTimeout(debounceTimerRef.current)\n    debounceTimerRef.current = setTimeout(() => {\n      setDebounced(input)\n    }, delayMs)\n  }, [input])\n\n  return [debounced, setDebouncedImmediately]\n}\n","import React, { Suspense } from 'react'\n\nexport const withSuspense = <T,>(Component: React.FC<T>, Fallback: React.FC<T>): React.FC<T> => {\n  const WrappedComponent: React.FC<T> = (props: T): JSX.Element => (\n    <Suspense fallback={<Fallback {...props} />}>\n      <Component {...props} />\n    </Suspense>\n  )\n  WrappedComponent.displayName = Component.displayName\n  return WrappedComponent\n}\n","/** @jsxImportSource @emotion/react */\nimport React from 'react'\nimport Skeleton from '@mui/material/Skeleton'\n\nexport const Fallback = (): JSX.Element => (\n  <div css={{ height: '100%', display: 'flex', flexDirection: 'column', gap: '1em' }}>\n    <div css={{ width: '40em' }}>\n      <Skeleton height=\"3em\" variant=\"rectangular\" />\n    </div>\n    <div css={{ width: '10em' }}>\n      <Skeleton height=\"2em\" variant=\"rectangular\" />\n    </div>\n    <Skeleton height=\"20em\" variant=\"rectangular\" />\n  </div>\n)\n","/** @jsxImportSource @emotion/react */\nimport React, { useMemo } from 'react'\nimport { useRecoilState, atom, useRecoilValue } from 'recoil'\nimport MuiButton from '@mui/material/Button'\nimport { GrantAction, NAMCResource } from '@namcbugdb/common'\n// import log from 'loglevel'\n\nimport { DataGrid, renderers, DataGridRecordCount } from '../DataGrid'\nimport { Box, BoxState } from '../../types'\nimport { privilegedColumnDefs } from './columnDefs'\nimport { SelectField } from '../SelectField'\nimport { useNavigate } from '../AppRouter'\nimport { FilterChips, Filter } from '../Filters'\nimport { TextFilterField, useTextFilterField } from '../TextFilterField'\nimport { selectMyUser } from '../../data/selectors'\nimport { withSuspense } from '../withSuspense'\nimport { Fallback } from './Fallback'\n\nexport interface PrivilegedBoxesListingProps {\n  boxes: Box[]\n  boxStates: BoxState[]\n}\n\nexport interface BoxRow extends Box {\n  boxId: {\n    label: number\n    onClick: () => void\n  }\n  customer: {\n    label: string\n    onFilter: () => void\n    disabled: boolean\n  }\n}\n\nconst ANY_BOX_STATE = 'ANY'\nconst ACTIVE_BOX_STATE = 'Active'\n\nconst boxStateNameFilterState = atom({\n  key: 'PrivilegedBoxesListing/boxStateNameFilter',\n  default: ACTIVE_BOX_STATE,\n})\n\nconst textFilterState = atom({\n  key: 'PrivilegedBoxesListing/textFilter',\n  default: '',\n})\n\nconst addedFiltersState = atom<Filter<Box>[]>({\n  key: 'PrivilegedBoxesListing/addedFilters',\n  default: [],\n})\n\nexport const PrivilegedBoxesListing = withSuspense(({ boxes, boxStates }: PrivilegedBoxesListingProps): JSX.Element => {\n  const navigate = useNavigate()\n  const user = useRecoilValue(selectMyUser)\n\n  // STATE AND REFS\n\n  const [boxStateNameFilter, setBoxStateNameFilter] = useRecoilState(boxStateNameFilterState)\n  const [textFilter, setTextFilter, textFilterDebounced, clearTextFilter] = useTextFilterField(\n    useRecoilState(textFilterState)\n  )\n  const [addedFilters, setAddedFilters] = useRecoilState(addedFiltersState)\n\n  // FILTERS\n\n  const filters = useMemo(() => {\n    const result: Filter<Box>[] = []\n\n    if (boxStateNameFilter !== ANY_BOX_STATE) {\n      result.push({\n        id: 'state',\n        label: boxStateNameFilter,\n        filterFn: (box) => box.boxState === boxStateNameFilter,\n        onDelete: () => {\n          setBoxStateNameFilter(ANY_BOX_STATE)\n        },\n      })\n    }\n\n    if (textFilterDebounced) {\n      if (textFilterDebounced.match(/^\\d+$/)) {\n        const targetBoxId = Number(textFilterDebounced)\n        result.push({\n          id: 'text',\n          label: `Box ${textFilterDebounced}`,\n          filterFn: (box) => box.id === targetBoxId,\n          onDelete: clearTextFilter,\n        })\n      } else {\n        result.push({\n          id: 'text',\n          label: `Customer contains \"${textFilterDebounced}\"`,\n          filterFn: ({ customerName }) => customerName.toLowerCase().includes(textFilterDebounced.toLowerCase()),\n          onDelete: clearTextFilter,\n        })\n      }\n    }\n\n    result.push(...addedFilters)\n\n    return result\n  }, [boxStateNameFilter, textFilterDebounced, addedFilters])\n\n  const rows = useMemo<BoxRow[]>(() => {\n    const filtered = filters.reduce<Box[]>((acc, { filterFn }) => acc.filter(filterFn), boxes)\n    return filtered.map((box) => {\n      const filterId = `filter/${String(box.customerId)}`\n      return {\n        ...box,\n        boxId: {\n          label: box.id,\n          onClick: () => navigate.boxDetail({ boxId: box.id }),\n        },\n        customer: {\n          label: box.customerName,\n          onFilter: () => {\n            clearTextFilter()\n            setAddedFilters([\n              {\n                id: filterId,\n                label: box.customerName,\n                filterFn: ({ customerId }) => customerId === box.customerId,\n                onDelete: () => setAddedFilters((value) => value.filter(({ id }) => id !== filterId)),\n              },\n            ])\n          },\n          disabled: !!addedFilters.find(({ id }) => id === filterId),\n        },\n      }\n    })\n  }, [boxes, filters])\n\n  // RENDER\n\n  const boxStateOptions = useMemo(() => {\n    return [\n      { value: ANY_BOX_STATE, label: 'Any' },\n      ...boxStates.filter(({ isActive }) => isActive).map(({ name }) => ({ value: name, label: name })),\n    ]\n  }, [boxStates])\n\n  return (\n    <>\n      <div css={{ height: '100%', display: 'flex', flexDirection: 'column' }}>\n        <div css={{ display: 'flex', gap: '0.5em' }}>\n          <SelectField\n            value={boxStateNameFilter}\n            onChange={(value) => setBoxStateNameFilter(String(value))}\n            options={boxStateOptions}\n            label=\"Box State\"\n          />\n          <TextFilterField value={textFilter} onChange={setTextFilter} label=\"Box ID or Customer\" />\n          {user.hasPermission(NAMCResource.submissions, GrantAction.createAny) && (\n            <div css={{ marginLeft: 'auto' }}>\n              <MuiButton\n                variant=\"outlined\"\n                onClick={() => {\n                  navigate.boxSubmission()\n                }}\n              >\n                Create New Submission\n              </MuiButton>\n            </div>\n          )}\n        </div>\n        <div css={{ minHeight: '2em', marginTop: '0.75em', display: 'flex' }}>\n          <FilterChips filters={filters} joinLabel=\"and\" />\n          <DataGridRecordCount total={boxes.length} visible={rows.length} descriptor=\"box\" />\n        </div>\n        <div css={{ flex: 1 }}>\n          <DataGrid<BoxRow> rows={rows} columnDefs={privilegedColumnDefs} frameworkComponents={renderers} />\n        </div>\n      </div>\n    </>\n  )\n}, Fallback)\n","/** @jsxImportSource @emotion/react */\nimport React, { useMemo } from 'react'\nimport MuiButton from '@mui/material/Button'\n// import log from 'loglevel'\n\nimport { DataGrid, renderers, DataGridRecordCount } from '../DataGrid'\nimport { Box } from '../../types'\nimport { customerColumnDefs } from './columnDefs'\nimport { useNavigate } from '../AppRouter'\n\nexport interface CustomerBoxesListingProps {\n  boxes: Box[]\n}\n\nexport interface BoxRow extends Box {\n  forms: {\n    label: string\n    onClick: () => void\n  }\n}\n\nexport const CustomerBoxesListing = ({ boxes }: CustomerBoxesListingProps): JSX.Element => {\n  const navigate = useNavigate()\n\n  // STATE AND REFS\n\n  const rows = useMemo<BoxRow[]>(() => {\n    return boxes.map((box) => {\n      return {\n        ...box,\n        forms: {\n          label: box.submissionCount ? 'Chain of Custody' : '',\n          onClick: () => {\n            navigate.chainOfCustodyForm({ boxId: box.id })\n          },\n        },\n      }\n    })\n  }, [boxes])\n\n  // RENDER\n\n  return (\n    <div css={{ height: '100%', display: 'flex', flexDirection: 'column' }}>\n      <div css={{ minHeight: '2em', gap: '0.5em', display: 'flex' }}>\n        <MuiButton\n          variant=\"outlined\"\n          onClick={() => {\n            navigate.boxSubmission()\n          }}\n        >\n          Create New Submission\n        </MuiButton>\n        <DataGridRecordCount\n          total={boxes.length}\n          visible={rows.length}\n          descriptor=\"submission\"\n          css={{ marginLeft: 'auto' }}\n        />\n      </div>\n      <div css={{ flex: 1 }}>\n        <DataGrid<BoxRow> rows={rows} columnDefs={customerColumnDefs} frameworkComponents={renderers} />\n      </div>\n    </div>\n  )\n}\n","import React from 'react'\nimport { useRecoilValue } from 'recoil'\nimport { GrantAction, NAMCResource } from '@namcbugdb/common'\n\nimport { selectBoxes, selectUserBoxes, selectBoxStates, selectMyUser } from '../../data/selectors'\nimport { PrivilegedBoxesListing } from './PrivilegedBoxesListing'\nimport { CustomerBoxesListing } from './CustomerBoxesListing'\nimport { Fallback } from './Fallback'\nimport { withSuspense } from '../withSuspense'\n\nconst CustomerConnector = (): JSX.Element => {\n  const boxes = useRecoilValue(selectUserBoxes)\n\n  return <CustomerBoxesListing boxes={boxes} />\n}\n\nconst PrivilegedConnector = (): JSX.Element => {\n  const boxes = useRecoilValue(selectBoxes)\n  const boxStates = useRecoilValue(selectBoxStates)\n\n  return <PrivilegedBoxesListing boxes={boxes} boxStates={boxStates} />\n}\n\nexport const BoxesListing = withSuspense((): JSX.Element => {\n  const user = useRecoilValue(selectMyUser)\n\n  if (user.hasPermission(NAMCResource.boxes, GrantAction.readAny)) return <PrivilegedConnector />\n  return <CustomerConnector />\n}, Fallback)\n","/** @jsxImportSource @emotion/react */\nimport React from 'react'\nimport FormControlLabel from '@mui/material/FormControlLabel'\nimport Checkbox from '@mui/material/Checkbox'\n\nimport { ReadOnlyField } from '../ReadOnlyField'\nimport { CommonFieldProps } from '../../types'\n\ninterface CheckboxFieldProps extends Omit<CommonFieldProps<boolean>, 'error' | 'label'> {\n  label: string\n  valueLabels?: [string, string]\n}\n\nexport const CheckboxField = ({\n  // CommonFieldProps\n  className,\n  disabled,\n  gridArea,\n  onChange,\n  readOnly,\n  value,\n\n  // CheckboxField\n  label,\n  valueLabels = ['No', 'Yes'],\n}: CheckboxFieldProps): JSX.Element => {\n  if (readOnly)\n    return (\n      <ReadOnlyField\n        className={className}\n        gridArea={gridArea}\n        label={label}\n        value={value ? valueLabels[1] : valueLabels[0]}\n      />\n    )\n\n  const handleChange = ({ target: { checked: newValue } }) => {\n    onChange(newValue)\n  }\n\n  return (\n    <FormControlLabel\n      className={className}\n      disabled={disabled}\n      label={label}\n      control={<Checkbox onChange={handleChange} checked={value} />}\n      css={{ gridArea }}\n    />\n  )\n}\n","/** @jsxImportSource @emotion/react */\nimport React, { Suspense } from 'react'\nimport MuiTextField from '@mui/material/TextField'\nimport MuiAutocomplete from '@mui/material/Autocomplete'\nimport { RecoilValue, useRecoilValue } from 'recoil'\nimport Skeleton from '@mui/material/Skeleton'\n\nimport { ReadOnlyField } from '../ReadOnlyField'\nimport { CommonFieldProps } from '../../types'\n\nexport interface Option<T> {\n  value: T\n  label: string\n  disabled?: boolean\n}\n\ninterface EditableAutocompleteFieldProps<T> extends CommonFieldProps<T | null> {\n  isClearable?: boolean\n  options: Option<T>[]\n  optionsSelector?: never\n  valueLabel?: never\n}\n\ninterface SuspensedEditableAutocompleteFieldProps<T> extends CommonFieldProps<T | null> {\n  options?: never\n  optionsSelector: RecoilValue<Option<T>[]>\n  valueLabel: string | null\n}\n\nexport type AutocompleteFieldProps<T> = CommonFieldProps<T | null> & {\n  isClearable?: boolean\n  label?: string\n} & (EditableAutocompleteFieldProps<T> | SuspensedEditableAutocompleteFieldProps<T>)\n\nconst EditableAutocompleteField = <T,>({\n  // CommonFieldProps\n  className,\n  disabled,\n  error,\n  gridArea,\n  label,\n  onChange,\n  value,\n\n  // EditableAutocompleteFieldProps\n  isClearable,\n  options,\n}: EditableAutocompleteFieldProps<T>): JSX.Element => {\n  const foundValue = options.find((option) => option.value === value) || null\n\n  return (\n    <MuiAutocomplete\n      className={className}\n      // disablePortal\n      options={options}\n      disabled={disabled}\n      getOptionLabel={(option) => option.label}\n      getOptionDisabled={(option) => !!option.disabled}\n      renderInput={(params) => (\n        <MuiTextField\n          {...params}\n          label={label}\n          error={error}\n          // InputLabelProps={{ shrink: !!foundValue }} // TODO: figure out why I needed this in the first place; is it due to valueLabel somehow?\n        />\n      )}\n      onChange={(event, selected) => {\n        onChange(selected && selected.value)\n      }}\n      size=\"small\"\n      value={foundValue}\n      css={{ gridArea }}\n      disableClearable={!isClearable}\n    />\n  )\n}\n\nconst SuspensedEditableAutocompleteField = <T,>({\n  optionsSelector,\n  // eslint-disable-next-line @typescript-eslint/no-unused-vars\n  valueLabel, // deliberately discarded\n  ...rest\n}: SuspensedEditableAutocompleteFieldProps<T>) => {\n  const options = useRecoilValue(optionsSelector)\n  return <EditableAutocompleteField options={options} {...rest} />\n}\n\nconst mismatchedPropsErrorMessage =\n  'AutocompleteField requires either `options`, or `optionsSelector` with `valueLabel`.'\n\nexport const AutocompleteField = <T,>({\n  options,\n  optionsSelector,\n  readOnly,\n  valueLabel,\n  ...restProps\n}: AutocompleteFieldProps<T>): JSX.Element => {\n  const isFixedType = !!options\n  const isSelectorType = optionsSelector && typeof valueLabel !== 'undefined'\n  if (isFixedType && isSelectorType) throw new Error(mismatchedPropsErrorMessage) // should never be reached\n\n  if (readOnly) {\n    if (isFixedType) {\n      const foundValueLabel = options.find((option) => option.value === restProps.value)?.label ?? ''\n      return <ReadOnlyField {...restProps} value={foundValueLabel} />\n    } else if (isSelectorType) {\n      return <ReadOnlyField {...restProps} value={valueLabel} />\n    }\n  } else {\n    if (isFixedType) {\n      return <EditableAutocompleteField options={options} {...restProps} />\n    } else if (isSelectorType) {\n      return (\n        <Suspense fallback={<ReadOnlyField {...restProps} value={<Skeleton />} />}>\n          <SuspensedEditableAutocompleteField\n            optionsSelector={optionsSelector}\n            valueLabel={valueLabel}\n            {...restProps}\n          />\n        </Suspense>\n      )\n    }\n  }\n\n  throw new Error(mismatchedPropsErrorMessage) // should never be reached\n}\n","import { columnDef } from '../DataGrid/columnDef'\n\nexport const samplesColumnDefs = [\n  columnDef.linkColumn({\n    headerName: 'Sample ID',\n    field: 'sampleId',\n    width: 120,\n  }),\n  columnDef.dateColumn({\n    field: 'sampleDate',\n  }),\n  columnDef.textColumn({\n    headerName: 'Sample Type',\n    field: 'type',\n    width: 120,\n  }),\n  columnDef.textColumn({\n    headerName: 'Sample Method',\n    field: 'method',\n    width: 140,\n  }),\n  columnDef.linkColumn({\n    headerName: 'Site Name',\n    field: 'site',\n    width: 160,\n  }),\n  columnDef.textColumn({\n    headerName: 'US State',\n    field: 'usState',\n    width: 120,\n  }),\n  columnDef.textColumn({\n    headerName: 'Visit ID',\n    field: 'visitId',\n    width: 100,\n  }),\n  columnDef.textColumn({\n    field: 'customerSiteCode',\n    width: 220,\n  }),\n  columnDef.textColumn({\n    headerName: 'Sort',\n    field: 'sortState',\n    minWidth: 120,\n    flex: 1,\n  }),\n  columnDef.textColumn({\n    headerName: 'Identification',\n    field: 'identificationState',\n    minWidth: 120,\n    flex: 1,\n  }),\n]\n\nexport const samplesDownloadColumns = [\n  { header: 'Sample ID', key: 'id' },\n  { header: 'Sample Date', key: 'sampleDate' },\n  { header: 'Sample Type', key: 'type' },\n  { header: 'Sample Method', key: 'method' },\n  { header: 'Site Name', key: 'siteName' },\n  { header: 'US State', key: 'usState' },\n  { header: 'Visit ID', key: 'visitId' },\n  { header: 'Customer Site Code', key: 'customerSiteCode' },\n  // { header: 'Sort', key: 'sortState' },\n  // { header: 'Identification', key: 'identificationState' },\n]\n","import { WebMercatorViewport } from 'react-map-gl'\nimport { LngLatBounds, LngLatLike } from 'mapbox-gl'\n\nimport { MAX_ZOOM } from './useSitesMapController'\n\nexport const calculateFit = (\n  points: { latitude: number; longitude: number }[],\n  {\n    height,\n    width,\n    padding = 50,\n    maxZoom = MAX_ZOOM,\n  }: { height: number; width: number; padding?: number; maxZoom?: number }\n): { longitude: number; latitude: number; zoom: number } | undefined => {\n  if (points.length === 0) return undefined // guard against no points\n\n  const updatedViewport = new WebMercatorViewport({ width, height })\n  const allPointsLngLat = points.map(({ longitude, latitude }) => [longitude, latitude]) as LngLatLike[]\n  const updatedBounds = new LngLatBounds([allPointsLngLat[0], allPointsLngLat[0]])\n  allPointsLngLat.forEach((pointLngLat) => updatedBounds.extend(pointLngLat))\n  const sw = updatedBounds.getSouthWest()\n  const ne = updatedBounds.getNorthEast()\n\n  const { longitude, latitude, zoom } = updatedViewport.fitBounds(\n    [\n      [sw.lng, sw.lat],\n      [ne.lng, ne.lat],\n    ],\n    { padding, maxZoom }\n  )\n\n  return { longitude, latitude, zoom }\n}\n","/** @jsxImportSource @emotion/react */\nimport React, { useMemo, useState } from 'react'\nimport { FlyToInterpolator, MapEvent, ViewportProps } from 'react-map-gl'\nimport { FeatureCollection } from 'geojson'\nimport log from 'loglevel'\n\nimport { Site } from '../../types'\nimport { calculateFit } from './calculateFit'\n\nexport interface SitesMapController {\n  viewport: ViewportProps\n  setViewport: React.Dispatch<React.SetStateAction<ViewportProps>>\n  fitSites: (targetSites: Site[], options?: { padding?: number }) => void\n  centerSite: (targetSite: Site, options?: { zoom?: number }) => void\n  sitesData: FeatureCollection\n  handleClick: (event: MapEvent) => void\n  smartFitAll: () => void\n  handleHover: (event: MapEvent) => void\n  hoverInfo: HoverInfo | null\n  isViewportReady: boolean\n}\n\ninterface HoverInfo {\n  node: React.ReactNode\n  x: number\n  y: number\n}\n\ninterface UseSitesMapControllerParams {\n  initialViewport?: ViewportProps\n  onSitesClick?: (targetSites: Site[]) => void\n  sites: Site[]\n}\n\nexport const DEFAULT_VIEWPORT = {\n  longitude: -97.6701409,\n  latitude: 38.7250438,\n  zoom: 3, // crude approximation as what you see depends on window size; this fits Lower 48 @ 600px\n}\n\nexport const MAX_ZOOM = 22 // closest we ever want to be\nexport const IDEAL_CLOSE_ZOOM = 9 // good zoom for single point, and closest we ever want to be on map loading\n\nexport const SITES_LAYER_ID = 'namc-sites'\n\nexport const useSitesMapController = ({\n  initialViewport,\n  onSitesClick,\n  sites,\n}: UseSitesMapControllerParams): SitesMapController => {\n  const [viewport, setViewport] = useState<ViewportProps>({ ...DEFAULT_VIEWPORT, ...initialViewport })\n  const [hoverInfo, setHoverInfo] = useState<HoverInfo | null>(null)\n\n  const sitesData = useMemo<FeatureCollection>(\n    () => ({\n      type: 'FeatureCollection',\n      features: sites.map((site) => ({\n        type: 'Feature',\n        geometry: { type: 'Point', coordinates: [site.longitude, site.latitude] },\n        properties: site,\n      })),\n    }),\n    [sites]\n  )\n\n  const fitSites = (targetSites: Site[], options: { padding?: number } = {}) => {\n    const { width, height } = viewport\n    if (!width || !height) {\n      log.debug('fitSites skipped: no viewport yet')\n      return\n    }\n\n    const calculatedViewport = calculateFit(targetSites, { height, width, ...options })\n\n    const transition = { transitionInterpolator: new FlyToInterpolator(), transitionDuration: 1000 }\n\n    setViewport((vp) => ({\n      ...vp,\n      ...transition,\n      ...calculatedViewport,\n    }))\n  }\n\n  const centerSite = (site: Site, options: { zoom?: number } = {}) => {\n    const { latitude, longitude } = site\n    const { zoom = IDEAL_CLOSE_ZOOM } = options\n    setViewport({\n      ...viewport,\n      longitude,\n      latitude,\n      zoom,\n      transitionDuration: 750,\n    })\n  }\n\n  const smartFitAll = () => {\n    if (sites.length === 0) return\n\n    if (sites.length === 1) {\n      centerSite(sites[0])\n      return\n    }\n\n    fitSites(sites)\n  }\n\n  const handleClick = (event: MapEvent) => {\n    setHoverInfo(null)\n    const targetSites =\n      event.features &&\n      event.features.filter((feature) => feature.layer?.source === SITES_LAYER_ID).map((feature) => feature.properties)\n    if (targetSites?.length && onSitesClick) onSitesClick(targetSites)\n  }\n\n  const handleHover = (event: MapEvent) => {\n    const mouseEvent = event.srcEvent as MouseEvent\n    const { features = [] } = event\n    const { offsetX: x, offsetY: y } = mouseEvent\n\n    const targetSites = features.map((feature) => feature.properties) as Site[]\n\n    if (targetSites.length === 0) {\n      setHoverInfo(null)\n      return\n    }\n\n    const node =\n      targetSites.length < 6 ? (\n        <div>\n          {targetSites.map(({ id, name }) => (\n            <div key={id} css={{ display: 'flex', justifyContent: 'center', marginTop: '0.1em' }}>\n              <span css={{ whiteSpace: 'nowrap', background: '#ffffffaa', padding: '0.1em' }}>{name}</span>\n            </div>\n          ))}\n        </div>\n      ) : (\n        <div>{targetSites.length} sites</div>\n      )\n\n    setHoverInfo({ node, x, y })\n  }\n\n  const isViewportReady = !!(viewport.width && viewport.height)\n\n  return {\n    viewport,\n    setViewport,\n    fitSites,\n    centerSite,\n    sitesData,\n    handleClick,\n    handleHover,\n    smartFitAll,\n    hoverInfo,\n    isViewportReady,\n  }\n}\n","import MapboxGL from 'mapbox-gl'\nimport { FeatureCollection } from 'geojson'\nimport { SITES_LAYER_ID } from '../useSitesMapController'\nexport const SOURCE_PREFIX = 'BGS_'\nexport const LAYER_PREFIX = 'BGL_'\n\nimport basicStylesJson from './basicStyles.json'\nimport satStylesJson from './satStyles.json'\nimport topoStylesJson from './topoStyles.json'\nimport sitesLayerJson from './sites.json'\n\nimport basicThumb from './basicThumb.png'\nimport satThumb from './satThumb.jpg'\nimport topoThumb from './topoThumb.png'\n\nexport const sitesLayer = sitesLayerJson as MapboxGL.CircleLayer\n\nexport type MapStyleKey = keyof typeof mapStyles\n\nexport const mapStyles = {\n  basic: (data: FeatureCollection): MapboxGL.Style => createNewStyle(basicStylesJson as MapboxGL.Style, data),\n  sat: (data: FeatureCollection): MapboxGL.Style => createNewStyle(satStylesJson as MapboxGL.Style, data),\n  topo: (data: FeatureCollection): MapboxGL.Style => createNewStyle(topoStylesJson as MapboxGL.Style, data),\n}\n\nexport const mapStylesThumbs = {\n  basic: basicThumb,\n  sat: satThumb,\n  topo: topoThumb,\n}\n\n/**\n * This is just stripping out all the useful information from a direct export from Mapbox\n * We prefix the IDs too so that we can find them easier for map shuffling\n * @param sourcePrefix\n * @param rawStyle\n * @returns\n */\nexport function createNewStyle(rawStyle: MapboxGL.Style, sitesData: FeatureCollection): MapboxGL.Style {\n  if (!rawStyle.sources) return { sources: {}, layers: [], version: 8 }\n  const rawSources = rawStyle.sources || {}\n  const rawLayers = rawStyle.layers || []\n  const glyphs = rawStyle.glyphs\n  const sprite = rawStyle.sprite\n  const sourceLookup: Record<string, string> = {}\n  const sources = Object.keys(rawStyle.sources).reduce<MapboxGL.Sources>(\n    (acc, sKey) => {\n      const newId = `${SOURCE_PREFIX}_${sKey}`\n      const source = rawSources[sKey]\n      // Add to the lookup so we can find this in the layers later\n      sourceLookup[sKey] = newId\n      return {\n        ...acc,\n        [newId]: source,\n      }\n    },\n    {\n      [SITES_LAYER_ID]: {\n        type: 'geojson',\n        data: sitesData,\n      },\n    }\n  )\n  const layers = [\n    ...rawLayers.map<MapboxGL.AnyLayer>((rawLayer) => {\n      const newLyr = {\n        ...rawLayer,\n        id: `${LAYER_PREFIX}_${rawLayer.id}`,\n      }\n      // IF the source is specified (and it is not a complex type) then go get it from the lookup\n      if (\n        newLyr.type !== 'background' &&\n        newLyr.type !== 'circle' &&\n        newLyr.type !== 'custom' &&\n        newLyr.source &&\n        typeof newLyr.type === 'string'\n      )\n        newLyr.source = sourceLookup[newLyr.source.toString()]\n      return newLyr\n    }),\n    {\n      ...sitesLayerJson,\n      id: SITES_LAYER_ID,\n      source: SITES_LAYER_ID,\n    } as MapboxGL.CircleLayer,\n  ]\n  return { sources, layers, glyphs, sprite, version: 8 }\n}\n","export default \"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAHgAAAB4BAMAAADLSivhAAAAJ1BMVEXs4cvv5dLw59Xx6Nfz69z17uL28eX48uf38un59Ov69vD7+fX////S7BO1AAAEmUlEQVRYhe1YzW8bRRSf2Q8ngYtp3bQGDkYUKveUSGmFRQ9u0zbawiFRTdEKDk6bAKv20BaC5BtBoiWIQ9J41x6JA9x7ABVO5IBUQArZP4qZNx87+5ndBAmB/DusZ968N+9j3nuza4QAU336mA7D8As2m15GAnjQlcNZH+HHdST4wvCvoVyxdhknJf0Gsx1Jn/lSjkxCt2kzHdYeyLqP5BIK2ONpGP4O+tSmqC4H7irbwaeL34HibnOgmJwWfVyiG8LsI5TEOb6f00UfguwmsklLLjaZmy9SKqhy5hKy1ohzWsPzIPsztYCocNjMTZuS+xCc3bgs9mQIPwDZP8GRvlr22ZPSf+TMcdUduZnJgwWr7W217jJ774Xhc5jVhrqsHci4fQuKuRm1J4qhzTx4NQz3xV7dSNZQh/0OyP4g4xDtzoyYoUtiGqnGzkMxaoIsnCY6eZ0QxWIyblPZhNwrwlTT9QWLBbL7lI4XXBLcVDmA0MfssSciSTkJWWfyja2hYMJPmexBFxnXBmTjsh4U1GEhfFemN0InrnlkvHaR3JQMPDv6dNtxr4XigNpgabKvSFR+pDS8DbLP6DHq9kqPWORrjOF7jar4YCX8g2bfbkqUgsUFQw5kLIpSqqM3/bReZLhOXTgd/pRalaWErHEy7SkaAx9q4wZENLU57Bnu0HxZ0ck8ed4gd6A2bB/YnidkX5al5Hwao7O0xUtkBVoA9roGOBe3zZaldM6P0VFnSN0NQL8L1fNKlIICvJQO5pA9SjiM3Z7n8zNvXwUz9nhoItwTpWQOllECFlkToxqBxRdAz23FoErJfZiUpXmkzBM1xo/lFxHyaVlKbw3TshqcVY09PPgVIEvpVJBM6DjMEdfG+4UGWkom6RbK0tBvwg++mxDu07jePkQWGVvCtBsx2WdwoofitCyZWU2WltJhDnODPekZLyMopRY9ziyHbyUJUeMzviFfP1p/r3e1Sx1ezdJUS1HcDB1OCYe5aj9Fmg0y6j8bzkqCkO1wNmiuxxRhL7lbERpeoFUeLu2w4F+KmnXDy2p4CTzRJ7ZPeIkbS+SzEtnh6fs3l02Xdnt8gQSXcyU0nHmgTdhdfXEbzUTWF8MItDEcdR1ZJSzm6ET9yd4p4MuEFZ1Iu3xSSDhKxKssi2z1xlMtK4RCEZ/a/SMIn+YNjL8iVAUWp/V5eRHtBuGnZWXe/NnQomNCcsz081jTcLU0gtNySucVfQnS0omdFk63oXzoSY3cOdSplJsdLRmndkp19wi2Fl08rtDsAFofwF7VgmpGZ1Ox2SF5vAynSnX3k1d0LvktU6a7s3dhQjZ685IgOkfOdZaQHK/Nn1h4n5DR+iIYgB9zA4odxgufiPd3NnmdWQDDNquIQocxU7axGON4aQF+WP8qcvjsLUK+Wszb221hr8BhEvRey1+d2ix0eL5gjVbHuMR1locq93cS1e7vBKqndITZf8fhUe8YDl8nFfp0CvjoDk8wwQQT/AM4VhMq9/GTg6XEp2M1nB0ER7/l6Kfj9uFM+Zh07gkm+H/gOC0Mlf0LJxONLb/Sd2schnusFvYfxN9OtcK2vfmpIAAAAABJRU5ErkJggg==\"","export default \"data:image/jpeg;base64,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\"","export default \"data:image/png;base64,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\"","/** @jsxImportSource @emotion/react */\nimport React, { useCallback, useEffect, useMemo, useState } from 'react'\nimport { atom, selector, useRecoilCallback, useRecoilState, useRecoilValue, useSetRecoilState } from 'recoil'\nimport { identity } from 'lodash'\nimport log from 'loglevel'\n\nimport { Site } from '../../types'\nimport { Filter, FilterChips } from '../Filters'\nimport { SitesMap } from '../SitesMap/SitesMap'\nimport { DataGridRecordCount } from '../DataGrid'\nimport { selectSitesByBoxId, selectSitesByProjectId, selectUsStates } from '../../data/selectors'\nimport { AutocompleteField } from '../AutocompleteField'\nimport { withSuspense } from '../withSuspense'\nimport { useSitesMapController, MAX_ZOOM } from '../SitesMap/useSitesMapController'\nimport { SiteDetailPanel } from './SiteDetailPanel'\nimport { TextField } from '../TextField'\nimport { useTextFilterField } from '../TextFilterField'\nimport { fetchSiteDetailById, fetchSitesPage } from '../../data/calls'\nimport { useNavigate } from '../AppRouter'\nimport { makeOnPageHandler, useAccumulateApiItems } from '../../data/util'\nimport { PinMarker } from './PinMarker'\nimport { useApi } from '../../data/api'\nimport { LinearProgress } from '../LinearProgress'\nimport { Fallback } from './Fallback'\n\nexport interface SitesListingProps {\n  siteId?: string | number\n}\n\nexport const ANY_US_STATE = 0\n\nconst DETAIL_PANEL_TRANSITION_MS = 200\n\n// SELECTORS\n\nconst selectUsStateOptions = selector({\n  key: 'SitesListing/selectUsStateOptions',\n  get: async ({ get }) => {\n    const usStates = get(selectUsStates)\n    return [\n      { value: ANY_US_STATE, label: 'Any' },\n      ...usStates.map(({ id: value, abbreviation: label }) => ({ value, label })),\n    ]\n  },\n})\n\n// MODE & FILTER STATE\n\nexport type SitesListingSource = { type: 'box'; id: number } | { type: 'project'; id: number; name: string } | null\n\nconst sitesListingSourceAtom = atom<SitesListingSource>({\n  key: 'SitesListing/sitesListingSourceAtom',\n  default: null,\n})\n\nconst usStateFilterIdAtom = atom<number>({\n  key: 'SitesListing/usStateFilterIdAtom',\n  default: ANY_US_STATE,\n})\n\nconst textFilterAtom = atom<string>({\n  key: 'SitesListing/textFilterAtom',\n  default: '',\n})\n\nexport const useSetSitesListingSource = (): ((sitesListingSource: SitesListingSource) => void) => {\n  const setSitesListingSource = useSetRecoilState(sitesListingSourceAtom)\n  const setUsStateFilter = useSetRecoilState(usStateFilterIdAtom)\n  const setTextFilter = useSetRecoilState(textFilterAtom)\n  return useCallback((sitesListingSource: SitesListingSource) => {\n    setSitesListingSource(sitesListingSource)\n    setUsStateFilter(ANY_US_STATE)\n    setTextFilter('')\n  }, [])\n}\n\n// ALL SITES STATE\n\nenum ALL_SITES_STATUS {\n  unfetched = 0,\n  fetching = 1,\n  fetched = 2,\n}\n\nconst allSitesStatusAtom = atom<ALL_SITES_STATUS>({\n  key: 'SitesListing/allSitesStatusAtom',\n  default: ALL_SITES_STATUS.unfetched,\n})\n\nconst allSitesAtom = atom<Site[]>({\n  key: 'SitesListing/allSitesAtom',\n  default: [],\n})\n\nconst sparseSitesDetailAtom = atom<Site[]>({\n  key: 'SitesListing/sparseSitesDetailAtom',\n  default: [],\n})\n\n// COMPONENT\n\nexport const SitesListing = withSuspense(\n  ({ siteId: siteIdUnsanitized }: SitesListingProps): JSX.Element => {\n    const siteId = siteIdUnsanitized ? Number(siteIdUnsanitized) : null\n    const navigate = useNavigate()\n    const api = useApi()\n\n    // CONTROLS STATE\n\n    const usStateOptions = useRecoilValue(selectUsStateOptions)\n    const [usStateIdFilter, setUsStateIdFilter] = useRecoilState(usStateFilterIdAtom)\n    const [textFilter, setTextFilter, textFilterDebounced, resetTextFilter] = useTextFilterField(\n      useRecoilState(textFilterAtom)\n    )\n\n    // DATA MANAGEMENT\n\n    const [sitesListingSource, setSitesListingSource] = useRecoilState(sitesListingSourceAtom)\n    const [allSitesStatus, setAllSitesStatus] = useRecoilState(allSitesStatusAtom)\n    const [allSites, setAllSites] = useRecoilState(allSitesAtom)\n    const [sparseSitesDetail, setSparseSitesDetail] = useRecoilState(sparseSitesDetailAtom)\n\n    const [sourceSites, setSourceSites] = useState<Site[]>([])\n    const [detailPanelSite, setDetailPanelSite] = useState<Site | undefined>(undefined)\n\n    const accumulateAllSites = useAccumulateApiItems(fetchSitesPage, 5000, makeOnPageHandler(setAllSites))\n\n    const getBoxSitesByBoxId = useRecoilCallback<[number], Promise<Site[]>>(({ snapshot }) => async (id: number) => {\n      return snapshot.getPromise(selectSitesByBoxId(id))\n    })\n\n    const getProjectSitesByProjectId = useRecoilCallback<[number], Promise<Site[]>>(\n      ({ snapshot }) =>\n        async (id: number) => {\n          return snapshot.getPromise(selectSitesByProjectId(id))\n        }\n    )\n\n    useEffect(() => {\n      if (!sitesListingSource && allSitesStatus === ALL_SITES_STATUS.unfetched) {\n        // \"all\" mode, and sites haven't been fetched yet: fetch all sites\n        setAllSitesStatus(ALL_SITES_STATUS.fetching)\n        Promise.all([\n          accumulateAllSites(0, 10000),\n          accumulateAllSites(10000, 20000),\n          accumulateAllSites(20000, 30000),\n          accumulateAllSites(30000, Infinity),\n        ]).then(() => {\n          setAllSitesStatus(ALL_SITES_STATUS.fetched)\n        })\n      }\n\n      switch (sitesListingSource?.type) {\n        case 'box': {\n          // box mode: use selector\n          getBoxSitesByBoxId(sitesListingSource.id).then(setSourceSites)\n          break\n        }\n        case 'project': {\n          // project mode: use selector\n          getProjectSitesByProjectId(sitesListingSource.id).then(setSourceSites)\n          break\n        }\n      }\n    }, [sitesListingSource])\n\n    useEffect(() => {\n      if (!sitesListingSource) {\n        // \"all\" mode, and allSites have changed: use all sites\n        setSourceSites(allSites)\n      }\n    }, [sitesListingSource, allSites])\n\n    useEffect(() => {\n      // fetch site detail if applicable\n      if (!siteId || sparseSitesDetail.find((siteDetail) => siteDetail.id === siteId)) return\n      fetchSiteDetailById(api)(siteId).then((siteDetail) => {\n        if (!siteDetail) return\n        setSparseSitesDetail((existing) => {\n          return [...existing, siteDetail] // TODO: handle replacement in case\n        })\n      })\n    }, [siteId])\n\n    const isFetching = allSitesStatus === ALL_SITES_STATUS.fetching\n\n    const selectedSite = useMemo(() => {\n      // get best selected site data\n      if (!siteId) return undefined\n      return (\n        sparseSitesDetail.find((siteDetail) => siteDetail.id === siteId) ||\n        sourceSites.find((site) => site.id === siteId)\n      )\n    }, [sourceSites, sparseSitesDetail, siteId])\n\n    // FILTERING\n\n    const filters = useMemo(() => {\n      const result: Filter<Site>[] = []\n\n      if (sitesListingSource) {\n        const id = 'sitesListingSource'\n        const filterFn = identity\n        const onDelete = () => setSitesListingSource(null)\n\n        switch (sitesListingSource.type) {\n          case 'box': {\n            result.push({ id, label: `Box ${sitesListingSource.id}`, filterFn, onDelete })\n            break\n          }\n          case 'project': {\n            result.push({ id, label: `Project ${sitesListingSource.name}`, filterFn, onDelete })\n            break\n          }\n        }\n      }\n\n      if (usStateIdFilter !== ANY_US_STATE) {\n        const usStateAbbreviation = usStateOptions.find(({ value }) => value === usStateIdFilter)?.label ?? '?'\n        result.push({\n          id: 'state',\n          label: `State: ${usStateAbbreviation}`,\n          filterFn: ({ usStateId }) => usStateId === usStateIdFilter,\n          onDelete: () => {\n            setUsStateIdFilter(ANY_US_STATE)\n          },\n        })\n      }\n\n      if (textFilterDebounced) {\n        result.push({\n          id: 'text',\n          label: `Name contains \"${textFilterDebounced}\"`,\n          filterFn: ({ name }) => name.toLowerCase().includes(textFilterDebounced.toLowerCase()),\n          onDelete: resetTextFilter,\n        })\n      }\n\n      return result\n    }, [sitesListingSource, usStateIdFilter, textFilterDebounced])\n\n    const filteredSites = useMemo<Site[]>(() => {\n      return filters.reduce<Site[]>((acc, { filterFn }) => acc.filter(filterFn), sourceSites)\n    }, [sourceSites, filters])\n\n    // EVENTS AND CONTROLLER\n\n    const onSitesClick = (targetSites: Site[]) => {\n      const { viewport, fitSites } = controller\n      if (targetSites.length === 1) {\n        const [targetSite] = targetSites\n        navigate.siteDetail({ siteId: targetSite.id }, true)\n      } else if (viewport.zoom === MAX_ZOOM) {\n        log.warn('not implemented: multiple points at max zoom') // TODO: implement disambiguation chooser\n      } else {\n        if (!viewport.width || !viewport.height) throw new Error('No viewport.')\n        fitSites(targetSites, { padding: Math.min(viewport.width, viewport.height) / 4 })\n      }\n    }\n\n    const controller = useSitesMapController({ sites: filteredSites, onSitesClick })\n\n    // SELECTION & FITTING\n\n    useEffect(() => {\n      // synchronize site detail panel with current selected site\n      setDetailPanelSite(selectedSite)\n    }, [selectedSite])\n\n    useEffect(() => {\n      // target site has changed\n      if (!selectedSite) return // site isn't in data yet, must wait (not accounting for unusual case where ID doesn't exist)\n\n      const { viewport, centerSite } = controller\n      window.setTimeout(\n        () => {\n          centerSite(selectedSite, { zoom: Math.max(9, viewport.zoom || 0) }) // center selected, and zoom in (unless already zoomed closer)\n        },\n        detailPanelSite ? 0 : DETAIL_PANEL_TRANSITION_MS // if detail panel open, center immediately, if detail panel closed, wait for open to avoid map jank\n      )\n    }, [siteId, !!selectedSite])\n\n    useEffect(() => {\n      // filters changed, attempt to fit\n      if (selectedSite) return // site selected, do not perform fit\n      if (!controller.isViewportReady) return // viewport not ready, don't fit yet (desired behaviour for all-sites initial load)\n      controller.smartFitAll() // fit filtered sites; if no sites, smartFitAll does nothing\n    }, [filters])\n\n    const [isInitialFitted, setIsInitalFitted] = useState(false)\n\n    useEffect(() => {\n      // if sitesListingSource in use, perform initial fit once\n      if (!sitesListingSource || isInitialFitted) return // not doing or already done\n      if (!controller.isViewportReady) return // viewport not ready so smartFitAll can't be run yet\n      controller.smartFitAll() // fit sites\n      setIsInitalFitted(true) // ensure runs only once\n    }, [sitesListingSource, controller.isViewportReady])\n\n    // RENDER\n\n    return (\n      <div css={{ height: '100%', display: 'flex', flexDirection: 'column' }}>\n        <div css={{ display: 'flex', gap: '0.5em' }}>\n          <AutocompleteField\n            value={usStateIdFilter}\n            onChange={(value) => setUsStateIdFilter(Number(value))}\n            options={usStateOptions}\n            label=\"State\"\n            css={{ width: '10em' }}\n          />\n          <TextField\n            value={textFilter}\n            onChange={(value) => setTextFilter(value)}\n            label=\"Site Name\"\n            css={{ width: '20em' }}\n          />\n        </div>\n        <div css={{ minHeight: '2em', margin: '0.75em 0', display: 'flex' }}>\n          <FilterChips filters={filters} joinLabel=\"and\" />\n          <DataGridRecordCount total={sourceSites.length} visible={filteredSites.length} descriptor=\"site\" />\n        </div>\n        <div css={{ flex: 1, display: 'flex' }}>\n          <div css={{ flex: 1, position: 'relative' }}>\n            {isFetching && (\n              <LinearProgress\n                delayMs={500}\n                css={{ position: 'absolute', width: '100%', height: '5px', opacity: 0.75, zIndex: 100 }}\n              />\n            )}\n            <SitesMap controller={controller}>{selectedSite && <PinMarker site={selectedSite} />}</SitesMap>\n          </div>\n          <SiteDetailPanel\n            site={detailPanelSite}\n            onClose={() => {\n              navigate.sites(undefined, true)\n            }}\n            transitionMs={DETAIL_PANEL_TRANSITION_MS}\n          />\n        </div>\n      </div>\n    )\n  },\n  () => <Fallback />\n)\n","/** @jsxImportSource @emotion/react */\nimport React, { useState } from 'react'\nimport SpeedDial from '@mui/material/SpeedDial'\nimport SpeedDialAction from '@mui/material/SpeedDialAction'\nimport SatelliteIcon from '@mui/icons-material/Satellite'\n\nimport { MapStyleKey, mapStylesThumbs } from './styles'\n\ninterface StyleControlProps {\n  value: MapStyleKey\n  onChange: (updated: MapStyleKey) => void\n}\n\nconst styleKeys = Object.keys(mapStylesThumbs) as MapStyleKey[]\nconst tooltips: Record<MapStyleKey, string> = {\n  basic: 'Basic',\n  sat: 'Satellite',\n  topo: 'Topographic',\n}\n\nconst StyleThumb = ({ value, styleKey, onChange }: StyleControlProps & { styleKey: MapStyleKey }) => (\n  <img\n    src={mapStylesThumbs[styleKey]}\n    css={{\n      cursor: 'pointer',\n      height: 40,\n      width: 40,\n      border: value === styleKey ? '2px solid blue' : '2px solid white',\n      borderRadius: 10,\n      margin: 2,\n    }}\n    onClick={(e) => {\n      e.stopPropagation()\n      if (value !== styleKey) onChange(styleKey)\n    }}\n  />\n)\n\nexport const StyleControl = ({ value, onChange }: StyleControlProps): JSX.Element => {\n  const [isOpen, setIsOpen] = useState(false) // using controlled state to prevent large empty div blocking map hover when closed\n\n  return (\n    <div>\n      <SpeedDial\n        ariaLabel=\"Style\"\n        hidden={false}\n        FabProps={{ size: 'small' }}\n        icon={<SatelliteIcon />}\n        direction=\"right\"\n        open={isOpen}\n        onOpen={() => setIsOpen(true)}\n        onClose={() => setIsOpen(false)}\n        css={{ minHeight: '56px' }} // hack to prevent collapse\n      >\n        {isOpen &&\n          styleKeys.map((styleKey) => (\n            <SpeedDialAction\n              key={styleKey}\n              tooltipTitle={tooltips[styleKey]}\n              icon={<StyleThumb styleKey={styleKey} value={value} onChange={onChange} />}\n            />\n          ))}\n      </SpeedDial>\n    </div>\n  )\n}\n","/** @jsxImportSource @emotion/react */\nimport React, { useMemo } from 'react'\nimport ReactMapGL, { NavigationControl } from 'react-map-gl'\nimport ZoomOutMapIcon from '@mui/icons-material/ZoomOutMap'\nimport 'mapbox-gl/dist/mapbox-gl.css'\n\nimport { mapStyles, MapStyleKey } from './styles'\n\nimport { SitesMapController, SITES_LAYER_ID, MAX_ZOOM } from './useSitesMapController'\nimport { atom, useRecoilState } from 'recoil'\nimport { StyleControl } from './StyleControl'\n\nexport interface SitesMapProps {\n  controller: SitesMapController\n  minimal?: boolean\n  children?: React.ReactNode\n}\n\nconst { REACT_APP_MAPBOX_TOKEN } = process.env\n\nexport const mapStyleKeyAtom = atom<MapStyleKey>({\n  key: 'SitesMap/mapStyleKeyAtom',\n  default: 'basic',\n})\n\nexport const SitesMap = ({ controller, children, minimal }: SitesMapProps): JSX.Element => {\n  const { viewport, setViewport, sitesData, handleClick, handleHover, hoverInfo, smartFitAll } = controller\n  const [mapStyleKey, setMapStyleKey] = useRecoilState(mapStyleKeyAtom)\n\n  const mapStyle = useMemo(() => mapStyles[mapStyleKey](sitesData), [sitesData, mapStyleKey])\n\n  // RENDER\n\n  if (!REACT_APP_MAPBOX_TOKEN)\n    return (\n      <div>\n        No Mapbox token found. Add <code>REACT_APP_MAPBOX_TOKEN</code> to relevant <code>.env</code> file.\n      </div>\n    )\n\n  return (\n    <div css={{ height: '100%', width: '100%' }}>\n      <ReactMapGL\n        onViewportChange={setViewport}\n        mapboxApiAccessToken={REACT_APP_MAPBOX_TOKEN}\n        onHover={handleHover}\n        interactiveLayerIds={[SITES_LAYER_ID]}\n        onClick={handleClick}\n        maxZoom={MAX_ZOOM}\n        mapStyle={mapStyle}\n        {...viewport} // must be before width and height\n        width=\"100%\"\n        height=\"100%\"\n      >\n        <NavigationControl\n          style={{\n            right: 10,\n            top: 10,\n          }}\n          showCompass={false}\n        />\n        {children}\n        {hoverInfo && (\n          <div\n            css={{\n              position: 'absolute',\n              left: hoverInfo.x,\n              top: hoverInfo.y - 10,\n              pointerEvents: 'none',\n              transform: 'translate(-50%,-100%)',\n            }}\n          >\n            <div>{hoverInfo.node}</div>\n          </div>\n        )}\n      </ReactMapGL>\n      <div css={{ position: 'absolute', top: 80, right: 10 }}>\n        <div className=\"mapboxgl-ctrl mapboxgl-ctrl-group\">\n          <button className=\"mapboxgl-ctrl-icon\" type=\"button\" title=\"Zoom to Fit\" onClick={smartFitAll}>\n            <ZoomOutMapIcon sx={{ height: 18, width: 18, paddingTop: '4px' }} />\n          </button>\n        </div>\n      </div>\n      {!minimal && (\n        <div css={{ position: 'absolute', bottom: 30, left: 8 }}>\n          <StyleControl value={mapStyleKey} onChange={setMapStyleKey} />\n        </div>\n      )}\n    </div>\n  )\n}\n","/** @jsxImportSource @emotion/react */\nimport React from 'react'\nimport { useRecoilValue } from 'recoil'\nimport IconButton from '@mui/material/IconButton'\nimport CloseIcon from '@mui/icons-material/Close'\nimport MuiSkeleton from '@mui/material/Skeleton'\n\nimport { ReadOnlyField } from '../ReadOnlyField'\nimport { Site } from '../../types'\nimport { selectUsStates } from '../../data/selectors'\nimport { withSuspense } from '../withSuspense'\nimport { formatUtcDateTimeToAppDate } from '../../lib/formats'\n\nexport interface SiteDetailPanelProps {\n  site?: Site\n  onClose: () => void\n  transitionMs: number\n}\n\nexport const SiteDetailPanel = withSuspense(\n  ({ site, onClose, transitionMs }: SiteDetailPanelProps): JSX.Element => {\n    const usStates = useRecoilValue(selectUsStates)\n    const isOpen = !!site\n\n    return (\n      <div\n        css={{\n          width: isOpen ? '400px' : 0,\n          maxWidth: '50%',\n          transition: `width ${transitionMs}ms`,\n          position: 'relative',\n          overflow: 'hidden',\n        }}\n      >\n        {site && (\n          <div\n            css={{\n              position: 'absolute',\n              border: '1px solid lightgrey',\n              width: '100%',\n              height: '100%',\n              boxSizing: 'border-box',\n              padding: '0.5em',\n            }}\n          >\n            <div css={{ display: 'flex', alignItems: 'center', paddingLeft: '0.8em' }}>\n              <div css={{ fontWeight: 'bold', fontSize: '120%' }}>{site.name}</div>\n              <div css={{ marginLeft: 'auto' }}>\n                <IconButton onClick={onClose}>\n                  <CloseIcon />\n                </IconButton>\n              </div>\n            </div>\n\n            <div\n              css={{\n                marginTop: '1em',\n                display: 'grid',\n                gridTemplateColumns: '1fr 1fr',\n                gridTemplateRows: `\n                  auto\n                  auto\n                  1em\n                  auto\n                  auto\n                  1em\n                  auto\n                  1em\n                  auto\n                `,\n                gap: '0.5em',\n                gridTemplateAreas: `\n                  \"usState id\"\n                  \"latitude longitude\"\n                  \". .\"\n                  \"system ecosystem\"\n                  \"waterbodyName waterbodyType\"\n                  \". .\"\n                  \"sampleCount .\"\n                  \". .\"\n                  \"createdDate updatedDate\"\n                `,\n              }}\n            >\n              <ReadOnlyField\n                gridArea=\"usState\"\n                label=\"State\"\n                value={usStates.find(({ id }) => id === site.usStateId)?.abbreviation}\n              />\n              <ReadOnlyField gridArea=\"id\" label=\"ID\" value={site.id} />\n              <ReadOnlyField gridArea=\"latitude\" label=\"Latitude\" value={site.latitude} />\n              <ReadOnlyField gridArea=\"longitude\" label=\"Longitude\" value={site.longitude} />\n              <ReadOnlyField\n                gridArea=\"sampleCount\"\n                label=\"# Samples\"\n                value={site.sampleCount ?? <MuiSkeleton sx={{ width: '3em' }} />}\n              />\n              <ReadOnlyField\n                gridArea=\"system\"\n                label=\"System\"\n                value={site.system ?? <MuiSkeleton sx={{ width: '10em' }} />}\n              />\n              <ReadOnlyField\n                gridArea=\"ecosystem\"\n                label=\"Ecosystem\"\n                value={site.ecosystem ?? <MuiSkeleton sx={{ width: '10em' }} />}\n              />\n              <ReadOnlyField\n                gridArea=\"waterbodyType\"\n                label=\"Waterbody Type\"\n                value={site.waterbodyType ?? <MuiSkeleton sx={{ width: '10em' }} />}\n              />\n              <ReadOnlyField\n                gridArea=\"waterbodyName\"\n                label=\"Waterbody\"\n                value={site.waterbodyName ?? <MuiSkeleton sx={{ width: '10em' }} />}\n              />\n              <ReadOnlyField\n                gridArea=\"createdDate\"\n                label=\"Created\"\n                value={\n                  site.createdDate ? (\n                    formatUtcDateTimeToAppDate(site.createdDate)\n                  ) : (\n                    <MuiSkeleton sx={{ width: '7em' }} />\n                  )\n                }\n              />\n              <ReadOnlyField\n                gridArea=\"updatedDate\"\n                label=\"Updated\"\n                value={\n                  site.updatedDate ? (\n                    formatUtcDateTimeToAppDate(site.updatedDate)\n                  ) : (\n                    <MuiSkeleton sx={{ width: '7em' }} />\n                  )\n                }\n              />\n            </div>\n          </div>\n        )}\n      </div>\n    )\n  },\n  () => null\n)\n","/** @jsxImportSource @emotion/react */\nimport React from 'react'\nimport { Marker } from 'react-map-gl'\n\nimport { Site } from '../../types'\n\nexport interface PinMarkerProps {\n  site: Site\n  color?: string\n  size?: number\n}\n\nexport const PinMarker = ({ site, color = '#aa00aa', size = 40 }: PinMarkerProps): JSX.Element => {\n  return (\n    <Marker latitude={site.latitude} longitude={site.longitude} css={{ pointerEvents: 'none' }}>\n      <svg\n        version=\"1.1\"\n        xmlns=\"http://www.w3.org/2000/svg\"\n        xmlnsXlink=\"http://www.w3.org/1999/xlink\"\n        viewBox=\"0 0 293.334 293.334\"\n        xmlSpace=\"preserve\"\n        css={{ height: size, width: size, transform: 'translate(-50%,-100%)' }}\n      >\n        <g>\n          <g>\n            <path\n              style={{ fill: color }}\n              d=\"M146.667,0C94.903,0,52.946,41.957,52.946,93.721c0,22.322,7.849,42.789,20.891,58.878\n\t\t\tc4.204,5.178,11.237,13.331,14.903,18.906c21.109,32.069,48.19,78.643,56.082,116.864c1.354,6.527,2.986,6.641,4.743,0.212\n\t\t\tc5.629-20.609,20.228-65.639,50.377-112.757c3.595-5.619,10.884-13.483,15.409-18.379c6.554-7.098,12.009-15.224,16.154-24.084\n\t\t\tc5.651-12.086,8.882-25.466,8.882-39.629C240.387,41.962,198.43,0,146.667,0z M146.667,144.358\n\t\t\tc-28.892,0-52.313-23.421-52.313-52.313c0-28.887,23.421-52.307,52.313-52.307s52.313,23.421,52.313,52.307\n\t\t\tC198.98,120.938,175.559,144.358,146.667,144.358z\"\n            />\n            <circle style={{ fill: color }} cx=\"146.667\" cy=\"90.196\" r=\"21.756\" />\n          </g>\n        </g>\n      </svg>\n    </Marker>\n  )\n}\n","/** @jsxImportSource @emotion/react */\nimport React, { useEffect, useRef, useState } from 'react'\nimport MuiLinearProgress from '@mui/material/LinearProgress'\n\nexport interface LinearProgressProps {\n  delayMs?: number\n  className?: string\n}\n\nexport const LinearProgress = ({ delayMs = 0, className }: LinearProgressProps): JSX.Element | null => {\n  const timeoutRef = useRef<number | undefined>(undefined)\n  const [isActive, setIsActive] = useState(false)\n\n  useEffect(() => {\n    timeoutRef.current = window.setTimeout(() => {\n      setIsActive(true)\n    }, delayMs)\n    return () => {\n      window.clearTimeout(timeoutRef.current)\n    }\n  }, [])\n\n  return isActive ? <MuiLinearProgress className={className} /> : null\n}\n","/** @jsxImportSource @emotion/react */\nimport React from 'react'\nimport Skeleton from '@mui/material/Skeleton'\n\nexport const Fallback = (): JSX.Element => (\n  <div css={{ height: '100%', display: 'flex', flexDirection: 'column', gap: '1em' }}>\n    <div css={{ width: '30em' }}>\n      <Skeleton height=\"3em\" variant=\"rectangular\" />\n    </div>\n    <div css={{ width: '10em' }}>\n      <Skeleton height=\"2em\" variant=\"rectangular\" />\n    </div>\n    <Skeleton height=\"30em\" variant=\"rectangular\" />\n  </div>\n)\n","import { uniqBy } from 'lodash'\nimport { Api, useApi } from './api'\n\nexport const useAccumulateApiItems = <T>(\n  fetchCall: (api: Api) => (offset: number, limit: number) => Promise<{ records: T[]; nextOffset: number }>,\n  pageSize: number,\n  onPage: (page: T[]) => void\n): ((from: number, to: number) => void) => {\n  const api = useApi()\n\n  const accumulateItems = (from: number, to: number) =>\n    fetchCall(api)(from, Math.min(pageSize, to - from)).then(({ records, nextOffset }) => {\n      onPage(records)\n      if (nextOffset && nextOffset < to) return accumulateItems(nextOffset, to)\n    })\n\n  return accumulateItems\n}\n\nexport const makeOnPageHandler =\n  <T>(setState: (updater: (existing: T[]) => T[]) => void) =>\n  (incoming: T[]): void => {\n    setState((existing: T[]) => uniqBy([...incoming, ...existing], 'id'))\n  }\n","import React, { useMemo } from 'react'\n\nimport { DataGrid } from '../DataGrid'\nimport { samplesColumnDefs } from './columnDefs'\nimport { SourceSample } from '../../types'\nimport { formatUtcDateTimeToAppDate } from '../../lib/formats'\nimport { useNavigate } from '../AppRouter'\nimport { renderers } from '../DataGrid'\nimport { SitesListingSource, useSetSitesListingSource } from '../SitesListing'\n\ninterface SamplesDataGridProps {\n  samples: SourceSample[]\n  sitesListingSource: SitesListingSource\n}\n\ninterface SampleRow extends SourceSample {\n  sampleId: {\n    label: number\n    onClick: () => void\n  }\n  site: {\n    label: string\n    onClick: () => void\n  }\n  sortState: string\n  identificationState: string\n}\n\nexport const SamplesDataGrid = ({ samples, sitesListingSource }: SamplesDataGridProps): JSX.Element => {\n  const navigate = useNavigate()\n  const setSitesListingSource = useSetSitesListingSource()\n\n  const rows = useMemo<SampleRow[]>(\n    () =>\n      samples.map((sample) => {\n        const { id } = sample\n        const sampleId = {\n          label: id,\n          onClick: () => navigate.sampleOverview({ sampleId: id }),\n        }\n\n        const { sortEndDate, sortStartDate, sorterName, siteId, siteName } = sample\n\n        const sortState = (() => {\n          if (sortEndDate) return `${sorterName} on ${formatUtcDateTimeToAppDate(sortEndDate)}`\n          if (!sortStartDate) return 'Not sorted'\n          return `Started by ${sorterName} on ${formatUtcDateTimeToAppDate(sortStartDate)}`\n        })()\n\n        const { identifierName, identificationEndDate, identificationStartDate } = sample\n        const identificationState = (() => {\n          if (identificationEndDate) return `${identifierName} on ${formatUtcDateTimeToAppDate(identificationEndDate)}`\n          if (!identificationStartDate) return 'Not identified'\n          return `Started by ${identifierName} on ${formatUtcDateTimeToAppDate(identificationStartDate)}`\n        })()\n\n        const site = {\n          label: siteName,\n          onClick: () => {\n            setSitesListingSource(sitesListingSource)\n            navigate.siteDetail({ siteId })\n          },\n        }\n\n        return {\n          ...sample,\n          sampleId,\n          site,\n          sortState,\n          identificationState,\n        }\n      }),\n    [samples]\n  )\n\n  return <DataGrid<SampleRow> columnDefs={samplesColumnDefs} rows={rows} frameworkComponents={renderers} />\n}\n","import React from 'react'\nimport { useRecoilValue } from 'recoil'\nimport Skeleton from '@mui/material/Skeleton'\n\nimport { withSuspense } from '../withSuspense'\nimport { selectBoxSamplesByBoxId } from '../../data/selectors'\nimport { SamplesDataGrid } from '../SamplesDataGrid'\n\ninterface BoxDetailProps {\n  boxId: number\n}\n\nexport const BoxSamples = withSuspense(\n  ({ boxId }: BoxDetailProps): JSX.Element => {\n    const boxSamples = useRecoilValue(selectBoxSamplesByBoxId(boxId))\n    return <SamplesDataGrid samples={boxSamples} sitesListingSource={{ type: 'box', id: boxId }} />\n  },\n  () => <Skeleton height=\"3em\" variant=\"rectangular\" />\n)\n","/** @jsxImportSource @emotion/react */\nimport React, { useMemo } from 'react'\nimport { useSnackbar } from 'notistack'\nimport IconButton from '@mui/material/IconButton'\nimport CloseIcon from '@mui/icons-material/Close'\n\nimport { useApi } from '../../data/api'\n\ninterface Notifications {\n  info: (message: string, deferMs?: number) => () => void\n  error: (message: string) => void\n}\n\nexport const useNotifications = (): Notifications => {\n  const { enqueueSnackbar, closeSnackbar } = useSnackbar()\n\n  const api = useApi()\n\n  return useMemo(() => {\n    const closeAction = (key) => (\n      <IconButton size=\"small\" aria-label=\"close\" color=\"inherit\" onClick={() => closeSnackbar(key)}>\n        <CloseIcon fontSize=\"small\" />\n      </IconButton>\n    )\n\n    return {\n      info: (message: string, deferMs = 0) => {\n        const timeout = window.setTimeout(() => {\n          enqueueSnackbar(message, {\n            autoHideDuration: 4000,\n            action: closeAction,\n          })\n        }, deferMs)\n        return () => {\n          clearTimeout(timeout)\n        }\n      },\n      error: (message: string) => {\n        enqueueSnackbar(message, { persist: true, variant: 'error', action: closeAction })\n        api.log('WARN', `notification/error: \"${message}\"`, {})\n      },\n    }\n  }, [enqueueSnackbar, closeSnackbar, api])\n}\n","import React, { useState, useCallback, useRef, useEffect } from 'react'\nimport produce, { Draft } from 'immer'\n\nexport type Updater<T> = (draft: Draft<T>) => void\n\nexport type UpdatableStateReturnTuple<T> = [\n  state: T,\n  setState: React.Dispatch<React.SetStateAction<T>>,\n  updateState: (updater: Updater<T>) => void\n]\n\nexport const useUpdatableState = <T>(\n  initialState: T,\n  deps: React.DependencyList = []\n): UpdatableStateReturnTuple<T> => {\n  const [state, setState] = useState<T>(initialState)\n  const instance = useRef<{ isFirstRender: boolean }>({ isFirstRender: true }).current\n  const updateState = useCallback((updater: Updater<T>) => setState((current) => produce(current, updater)), [setState])\n\n  useEffect(() => {\n    if (instance.isFirstRender) {\n      instance.isFirstRender = false\n      return\n    }\n    setState(initialState)\n  }, deps)\n\n  return [state, setState, updateState]\n}\n","import { BoxDetailProps } from './BoxDetail'\nimport { Box } from '../../types'\nimport { useApi } from '../../data/api'\nimport { useNotifications } from '../AppNotifications'\nimport { useUpdatableState } from '../../lib/useUpdatableState'\nimport { updateBox } from '../../data/calls'\nimport { useInvalidate } from '../../data/selectors/invalidate'\n\ninterface Fields {\n  boxStateId: number\n  measurements: boolean\n  midges: boolean\n  description: string\n  customerId: number\n  alias: string\n  modelIds: number[]\n}\n\ntype FieldErrors = Partial<Record<keyof Fields, boolean>> | undefined\n\nexport type ControllerState = {\n  // box?: Box\n  values: Fields\n  errors: FieldErrors\n  editMode: 'stopped' | 'started' | 'stopping'\n  isDirty: boolean\n}\n\ntype InternalControllerState = Omit<ControllerState, 'errors'>\n\nexport interface ControllerActions {\n  // eslint-disable-next-line @typescript-eslint/no-explicit-any\n  setFieldValue: (fieldName: keyof Fields, value: any) => void\n  startEdit: () => void\n  stopEdit: (cancel?: boolean) => void\n}\n\n// const getFieldErrors = (values: Fields): FieldErrors => {\n//   const errors = {}\n//   if (!Object.values(errors).some((value) => value)) return undefined\n//   return errors\n// }\n\nconst getInitialState = (box: Box): InternalControllerState => ({\n  values: {\n    boxStateId: box.boxStateId ?? -1,\n    measurements: !!box.measurements,\n    midges: !!box.midges,\n    description: box.description ?? '',\n    customerId: box.customerId,\n    alias: box.alias,\n    modelIds: box.modelIds ?? [],\n  },\n  editMode: 'stopped',\n  isDirty: false,\n})\n\nexport const useComponentController = ({ box }: Pick<BoxDetailProps, 'box'>): [ControllerState, ControllerActions] => {\n  const api = useApi()\n  const invalidate = useInvalidate()\n  const notifications = useNotifications()\n\n  const [state, setState, updateState] = useUpdatableState<InternalControllerState>(getInitialState(box))\n\n  const actions = {\n    // TODO: handle reset through useUpdatableState enhancement\n    setFieldValue: async (fieldName: keyof Fields, value: unknown) => {\n      updateState((draft) => {\n        Object.assign(draft.values, { [fieldName]: value })\n        draft.isDirty = true\n      })\n    },\n    startEdit: () => {\n      updateState((draft) => {\n        draft.editMode = 'started'\n      })\n    },\n    stopEdit: async (cancel?: boolean) => {\n      if (cancel) {\n        setState(getInitialState(box))\n        return\n      }\n      updateState((draft) => {\n        draft.editMode = 'stopping'\n      })\n      try {\n        await updateBox(api, invalidate)({ boxId: box.id, ...state.values })\n        updateState((draft) => {\n          draft.editMode = 'stopped'\n          draft.isDirty = false\n        })\n      } catch (err) {\n        notifications.error(`Failed to save box: ${err}`)\n        updateState((draft) => {\n          draft.editMode = 'started'\n        })\n      }\n    },\n  }\n\n  // const errors = state.editMode === 'stopped' ? undefined : getFieldErrors(state.values)\n\n  return [{ ...state, errors: undefined }, actions]\n}\n","/** @jsxImportSource @emotion/react */\nimport React from 'react'\nimport MuiAccordion from '@mui/material/Accordion'\nimport MuiAccordionSummary from '@mui/material/AccordionSummary'\nimport MuiAccordionDetails from '@mui/material/AccordionDetails'\nimport ExpandMoreIcon from '@mui/icons-material/ExpandMore'\n\nexport interface AccordionPanelProps {\n  value: boolean\n  onChange: (newValue: boolean) => void\n  locked?: boolean\n  summary: React.ReactNode\n  actions?: React.ReactNode\n  children: React.ReactNode\n}\n\nexport const AccordionPanel = ({\n  value,\n  onChange,\n  locked,\n  summary,\n  actions,\n  children,\n}: AccordionPanelProps): JSX.Element => (\n  <MuiAccordion\n    expanded={value}\n    onChange={(e, newValue) => {\n      if (locked) return\n      onChange(newValue)\n    }}\n    css={{ marginBottom: '1em' }}\n  >\n    <MuiAccordionSummary\n      expandIcon={<ExpandMoreIcon color={locked ? 'disabled' : undefined} />}\n      style={{ cursor: locked ? 'default' : undefined }} // deliberately using style here as override\n    >\n      <div css={{ display: 'flex', alignItems: 'center', width: '100%' }}>\n        <div>{summary}</div>\n        {actions && (\n          <div\n            css={{ margin: '0 0.5em 0 auto' }}\n            onClick={(e) => {\n              e.stopPropagation()\n            }}\n          >\n            {actions}\n          </div>\n        )}\n      </div>\n    </MuiAccordionSummary>\n    <MuiAccordionDetails>{children}</MuiAccordionDetails>\n  </MuiAccordion>\n)\n","/** @jsxImportSource @emotion/react */\nimport React from 'react'\n\nexport interface TitleProps {\n  children: React.ReactNode\n  className?: string\n}\n\nexport const Title = ({ children, className }: TitleProps): JSX.Element => {\n  return (\n    <div className={className} css={{ fontWeight: '700', fontSize: '125%' }}>\n      {children}\n    </div>\n  )\n}\n\nconst Subtitle = ({ children }: TitleProps): JSX.Element => {\n  return <span css={{ fontWeight: '300' }}>{children}</span>\n}\n\nTitle.Subtitle = Subtitle\n","/** @jsxImportSource @emotion/react */\nimport React from 'react'\n\nimport { ReadOnlyField } from '../ReadOnlyField'\n\nexport interface ProgressFieldProps {\n  // CommonFieldProps\n  gridArea?: string\n  label: string\n  value: number\n\n  // ProgressField\n  doneCount: number\n  totalCount: number\n}\n\nexport const ProgressField = ({\n  doneCount,\n  gridArea, //\n  label,\n  totalCount,\n  value,\n}: ProgressFieldProps): JSX.Element => {\n  const percent = `${Math.floor(value * 100)}%`\n\n  const roValue = (\n    <div\n      css={{\n        height: '1em',\n        width: '100%',\n        position: 'relative',\n      }}\n    >\n      <div css={{ position: 'absolute', background: 'lightgrey', width: '100%', height: '110%', top: '16%' }} />\n      <div css={{ position: 'absolute', background: '#42d64c', width: percent, height: '110%', top: '16%' }} />\n      <div css={{ position: 'absolute', width: '100%', textAlign: 'center' }}>\n        {doneCount} of {totalCount} ({percent})\n      </div>\n    </div>\n  )\n\n  return <ReadOnlyField label={label} value={roValue} gridArea={gridArea} minWidth={120} />\n}\n","import React from 'react'\nimport Skeleton from '@mui/material/Skeleton'\nimport { useRecoilValue } from 'recoil'\n\nimport { ReadOnlyField } from '../ReadOnlyField'\nimport { ProgressField } from '../ProgressField'\nimport { withSuspense } from '../withSuspense'\nimport { selectBoxSamplesByBoxId } from '../../data/selectors'\n\nexport const SortingProgressField = withSuspense<{\n  boxId: number\n  gridArea: string\n  value: number\n}>(\n  ({ boxId, value, ...restProps }) => {\n    const boxSamples = useRecoilValue(selectBoxSamplesByBoxId(boxId))\n    const doneCount = boxSamples.filter((boxSample) => boxSample.sortEndDate).length\n    const totalCount = boxSamples.length\n    return <ProgressField {...restProps} label=\"Sorting\" value={value} doneCount={doneCount} totalCount={totalCount} />\n  },\n  (props): JSX.Element => <ReadOnlyField {...props} label=\"Sorting\" value={<Skeleton />} minWidth={120} />\n)\n","import React from 'react'\nimport Skeleton from '@mui/material/Skeleton'\nimport { useRecoilValue } from 'recoil'\n\nimport { ReadOnlyField } from '../ReadOnlyField'\nimport { ProgressField } from '../ProgressField'\nimport { withSuspense } from '../withSuspense'\nimport { selectBoxSamplesByBoxId } from '../../data/selectors'\n\nexport const IdentificationProgressField = withSuspense<{\n  boxId: number\n  gridArea: string\n  value: number\n}>(\n  ({ boxId, value, ...restProps }) => {\n    const boxSamples = useRecoilValue(selectBoxSamplesByBoxId(boxId))\n    const doneCount = boxSamples.filter((boxSample) => boxSample.identificationEndDate).length\n    const totalCount = boxSamples.length\n    return (\n      <ProgressField\n        {...restProps}\n        label=\"Identification\"\n        value={value}\n        doneCount={doneCount}\n        totalCount={totalCount}\n      />\n    )\n  },\n  (props): JSX.Element => <ReadOnlyField {...props} label=\"Identification\" value={<Skeleton />} minWidth={120} />\n)\n","/** @jsxImportSource @emotion/react */\nimport React from 'react'\nimport TextField from '@mui/material/TextField'\nimport MuiAutocomplete from '@mui/material/Autocomplete'\nimport MuiChip, { ChipProps } from '@mui/material/Chip'\n\nimport { ReadOnlyField } from '../ReadOnlyField'\nimport { CommonFieldProps } from '../../types'\n\nexport interface Option {\n  value: string | number\n  label: string\n  disabled?: boolean\n}\n\nexport interface AutocompleteArrayFieldProps extends CommonFieldProps<(string | number)[]> {\n  options: Option[]\n}\n\nconst SelectedOptionChip = ({ label, value, onDelete }: Option & ChipProps) => (\n  <MuiChip label={label} key={value} onDelete={onDelete} css={{ margin: '2px' }} />\n)\n\nexport const AutocompleteArrayField = ({\n  // CommonFieldProps\n  className,\n  disabled,\n  error,\n  gridArea,\n  label,\n  onChange,\n  readOnly,\n  value: valueArray,\n\n  // AutocompleteArrayField\n  options,\n}: AutocompleteArrayFieldProps): JSX.Element => {\n  const selectedOptions = options.filter((option) => valueArray.includes(option.value))\n\n  if (readOnly)\n    return (\n      <ReadOnlyField\n        label={label}\n        gridArea={gridArea}\n        className={className}\n        value={\n          selectedOptions.length > 0\n            ? selectedOptions.map(({ value, label }) => <SelectedOptionChip key={value} value={value} label={label} />)\n            : null\n        }\n      />\n    )\n\n  return (\n    <MuiAutocomplete\n      multiple\n      className={className}\n      disablePortal\n      options={options}\n      disabled={disabled}\n      getOptionLabel={(option) => option.label}\n      getOptionDisabled={(option) => !!option.disabled}\n      renderInput={(params) => (\n        <TextField {...params} label={label} error={error} InputLabelProps={{ shrink: selectedOptions.length > 0 }} />\n      )}\n      renderTags={(renderedOptions: readonly Option[], getTagProps) =>\n        renderedOptions.map(({ value, label }, index) => (\n          <SelectedOptionChip value={value} label={label} {...getTagProps({ index })} key={value} />\n        ))\n      }\n      onChange={(event, selected) => {\n        onChange(selected.map(({ value }) => value))\n      }}\n      size=\"small\"\n      value={selectedOptions}\n      css={{ gridArea }}\n      disableClearable\n    />\n  )\n}\n","/** @jsxImportSource @emotion/react */\nimport React from 'react'\nimport { useRecoilValue } from 'recoil'\nimport Skeleton from '@mui/material/Skeleton'\n\nimport { selectModels } from '../../data/selectors'\nimport { ReadOnlyField } from '../ReadOnlyField'\nimport { withSuspense } from '../withSuspense'\nimport { AutocompleteArrayField, AutocompleteArrayFieldProps } from '../AutocompleteArrayField'\n\nexport type ModelsFieldProps = Omit<AutocompleteArrayFieldProps, 'options'>\n\nexport const ModelsField = withSuspense<ModelsFieldProps>(\n  (props): JSX.Element => {\n    const models = useRecoilValue(selectModels)\n    const options = models.map(({ id: value, abbreviation: label }) => ({ value, label }))\n\n    return <AutocompleteArrayField {...props} options={options} />\n  },\n  (props) => <ReadOnlyField {...props} value={<Skeleton />} />\n)\n","/** @jsxImportSource @emotion/react */\nimport React, { useEffect, useMemo } from 'react'\nimport { RecoilValue, useRecoilValue } from 'recoil'\nimport MuiSkeleton from '@mui/material/Skeleton'\nimport IconButton from '@mui/material/IconButton'\nimport OpenInNewIcon from '@mui/icons-material/OpenInNew'\n// import log from 'loglevel'\n\nimport { Site } from '../../types'\nimport { withSuspense } from '../withSuspense'\nimport { calculateFit } from './calculateFit'\nimport { SitesMap } from './SitesMap'\nimport { useSitesMapController, IDEAL_CLOSE_ZOOM, DEFAULT_VIEWPORT } from './useSitesMapController'\nimport { useNavigate } from '../AppRouter'\nimport { useSetSitesListingSource, SitesListingSource } from '../SitesListing'\n\ninterface SitesMapPreviewProps {\n  sitesSelector: RecoilValue<Site[]>\n  sitesListingSource: SitesListingSource\n}\n\nconst height = 300\nconst width = 300\n\nexport const SitesMapPreview = withSuspense(\n  ({ sitesSelector, sitesListingSource }: SitesMapPreviewProps): JSX.Element => {\n    const sites = useRecoilValue(sitesSelector)\n    const navigate = useNavigate()\n    const setSitesListingSource = useSetSitesListingSource()\n\n    const initialViewport = useMemo(() => {\n      if (sites.length === 0)\n        return {\n          ...DEFAULT_VIEWPORT,\n          zoom: 0.5,\n        }\n      return calculateFit(sites, { height, width, maxZoom: IDEAL_CLOSE_ZOOM })\n    }, [])\n\n    const onSitesClick = (targetSites: Site[]) => {\n      const { viewport } = controller\n      if (targetSites.length === 1) {\n        setSitesListingSource(sitesListingSource)\n        window.setTimeout(() => navigate.siteDetail({ siteId: targetSites[0].id }))\n      } else {\n        if (!viewport.width || !viewport.height) throw new Error('No viewport.')\n        controller.fitSites(targetSites)\n      }\n    }\n\n    const handleExpandMapClick = () => {\n      setSitesListingSource(sitesListingSource)\n      window.setTimeout(navigate.sites)\n    }\n\n    const controller = useSitesMapController({ sites, initialViewport, onSitesClick })\n\n    useEffect(() => {\n      // refocus when sites changes; has no effect when map first loaded with initialViewport (desired behaviour)\n      if (sites.length === 0) return\n      controller.smartFitAll()\n    }, [sites])\n\n    return (\n      <div css={{ height, width, position: 'relative' }}>\n        <IconButton\n          title=\"Expand Sites Map\"\n          onClick={handleExpandMapClick}\n          css={{ position: 'absolute', left: 0, right: 10, zIndex: 100 }}\n        >\n          <OpenInNewIcon />\n        </IconButton>\n        <SitesMap controller={controller} minimal></SitesMap>\n      </div>\n    )\n  },\n  () => (\n    <div css={{ height, width }}>\n      <MuiSkeleton width={width} height={height} variant=\"rectangular\" />\n    </div>\n  )\n)\n","/** @jsxImportSource @emotion/react */\nimport React from 'react'\nimport { selectSitesByBoxId } from '../../data/selectors'\nimport { SitesMapPreview } from '../SitesMap/SitesMapPreview'\n\nexport interface BoxSitesMapPreviewProps {\n  boxId: number\n}\n\nexport const BoxSitesMapPreview = ({ boxId }: BoxSitesMapPreviewProps): JSX.Element => {\n  const sitesSelector = selectSitesByBoxId(boxId)\n  return <SitesMapPreview sitesSelector={sitesSelector} sitesListingSource={{ type: 'box', id: boxId }} />\n}\n","/** @jsxImportSource @emotion/react */\nimport React from 'react'\nimport MuiButton, { ButtonProps } from '@mui/material/Button'\nimport MuiMenu from '@mui/material/Menu'\nimport MuiMenuItem from '@mui/material/MenuItem'\nimport ArrowDropDownIcon from '@mui/icons-material/ArrowDropDown'\nimport MuiDivider from '@mui/material/Divider'\n\nexport interface MenuProps {\n  label: React.ReactNode\n  disabled?: boolean\n  icon?: React.ReactNode\n  items: (\n    | {\n        key: string | number\n        label: React.ReactNode\n        onClick: () => void\n        disabled?: boolean\n      }\n    | typeof Divider\n  )[]\n  variant?: ButtonProps['variant']\n}\n\nexport const Divider = 'DIVIDER'\n\nexport const Menu = ({\n  label,\n  disabled,\n  icon = <ArrowDropDownIcon />,\n  items,\n  variant = 'outlined',\n}: MenuProps): JSX.Element => {\n  const [anchorEl, setAnchorEl] = React.useState<HTMLElement | null>(null)\n  const isOpen = !!anchorEl\n\n  const handleMenuClick = (event: React.MouseEvent<HTMLButtonElement>) => {\n    setAnchorEl(event.currentTarget)\n  }\n\n  const handleMenuClose = () => {\n    setAnchorEl(null)\n  }\n\n  return (\n    <div>\n      <MuiButton onClick={handleMenuClick} variant={variant} disabled={disabled} startIcon={icon}>\n        {label}\n      </MuiButton>\n      <MuiMenu anchorEl={anchorEl} open={isOpen} onClose={handleMenuClose}>\n        {items.map((item, index) => {\n          if (item === Divider) return <MuiDivider key={`divider-${index}`} />\n          return (\n            <MuiMenuItem\n              key={item.key}\n              disabled={item.disabled}\n              onClick={() => {\n                item.onClick()\n                handleMenuClose()\n              }}\n            >\n              {item.label}\n            </MuiMenuItem>\n          )\n        })}\n      </MuiMenu>\n    </div>\n  )\n}\n","/** @jsxImportSource @emotion/react */\nimport React from 'react'\nimport MuiButton from '@mui/material/Button'\nimport { selector, atom, useRecoilState } from 'recoil'\nimport { NAMCResource, GrantAction } from '@namcbugdb/common'\n\nimport { ReadOnlyField } from '../ReadOnlyField'\nimport { CheckboxField } from '../CheckboxField'\nimport { TextField } from '../TextField'\nimport { AutocompleteField } from '../AutocompleteField'\nimport { Box, MyUser } from '../../types'\nimport { BoxSamples } from './BoxSamples'\nimport { useComponentController } from './componentController'\nimport { selectBoxStates, selectOrganizations } from '../../data/selectors'\nimport { AccordionPanel } from '../AccordionPanel'\nimport { Title } from '../Title'\nimport { formatUtcDateTimeToAppDate } from '../../lib/formats'\nimport { SortingProgressField } from './SortingProgressField'\nimport { IdentificationProgressField } from './IdentificationProgressField'\nimport { ModelsField } from '../ModelsField'\nimport { ConfirmNavigateAway } from '../AppRouter'\nimport { BoxSitesMapPreview } from './BoxSitesMapPreview'\nimport { useNavigate } from '../AppRouter'\nimport { Menu } from '../Menu'\nimport { pluralize } from '../../lib/pluralize'\n\nconst selectOrganizationOptions = selector({\n  key: 'BoxDetail/selectOrganizationOptions',\n  get: async ({ get }) => {\n    const organizations = await get(selectOrganizations)\n    return organizations.map(({ id: value, name: label }) => ({ value, label }))\n  },\n})\n\nconst selectBoxStateOptions = selector({\n  key: 'BoxDetail/selectBoxStateOptions',\n  get: async ({ get }) => {\n    const boxStates = await get(selectBoxStates)\n    return boxStates.map(({ id, name }) => ({ value: id, label: name }))\n  },\n})\n\nconst isExpandedState = atom<boolean>({\n  key: 'BoxDetail/isExpandedState',\n  default: true,\n})\n\nexport interface BoxDetailProps {\n  box: Box\n  user: MyUser\n}\n\nexport const BoxDetail = ({ box, user }: BoxDetailProps): JSX.Element => {\n  const navigate = useNavigate()\n\n  const [state, actions] = useComponentController({ box })\n  const [isPanelExpanded, setIsPanelExpanded] = useRecoilState(isExpandedState)\n  const {\n    editMode,\n    values: { boxStateId, measurements, midges, description, customerId, alias, modelIds },\n    isDirty,\n  } = state\n  const { setFieldValue } = actions\n\n  const isStopped = editMode === 'stopped'\n  const isEditing = editMode === 'started'\n  const isSaving = editMode === 'stopping'\n\n  return (\n    <>\n      <div css={{ height: '100%', display: 'flex', flexDirection: 'column' }}>\n        <AccordionPanel\n          value={isPanelExpanded}\n          onChange={setIsPanelExpanded}\n          locked={isEditing}\n          summary={\n            <Title>\n              Box {box.id}{' '}\n              <Title.Subtitle>\n                ({box.boxState}, {box.sampleCount} {pluralize(box.sampleCount, 'sample')})\n              </Title.Subtitle>\n            </Title>\n          }\n          actions={\n            <div css={{ display: 'flex', gap: '0.5em' }}>\n              {isStopped && <MuiButton onClick={() => navigate.boxTaxonomy({ boxId: box.id })}>Taxonomy</MuiButton>}\n              {isStopped && user.hasPermission(NAMCResource.boxes, GrantAction.updateAny) && (\n                <Menu\n                  label=\"Actions\"\n                  items={[\n                    {\n                      key: 'edit',\n                      label: 'Edit Box',\n                      onClick: () => {\n                        actions.startEdit()\n                        setIsPanelExpanded(true)\n                      },\n                    },\n                  ]}\n                ></Menu>\n              )}\n              {(isEditing || isSaving) && (\n                <>\n                  <MuiButton\n                    onClick={() => {\n                      actions.stopEdit(true)\n                    }}\n                    variant=\"outlined\"\n                    disabled={isSaving}\n                  >\n                    Cancel\n                  </MuiButton>\n                  <MuiButton\n                    onClick={() => {\n                      actions.stopEdit()\n                    }}\n                    variant=\"contained\"\n                    disabled={!isDirty || isSaving}\n                  >\n                    Save\n                  </MuiButton>\n                </>\n              )}\n            </div>\n          }\n        >\n          <div\n            css={{\n              flex: 1,\n              display: 'grid',\n              gap: '0.75em',\n              gridTemplateColumns: 'auto auto auto auto auto',\n              gridTemplateAreas: `\n              \"boxState     customerId              sorting       identification     map\"\n              \"measurements submittedByName         modelIds      modelIds           map\"\n              \"midges       createdDate             modelIds      modelIds           map\"\n              \"taxaQa       receivedDate            alias         alias              map\"\n              \"sorterQa     processingCompleteDate  description   description        map\"\n              \".            .                       description   description        map\"\n            `,\n            }}\n          >\n            <AutocompleteField\n              label=\"Box State\"\n              optionsSelector={selectBoxStateOptions}\n              value={boxStateId}\n              valueLabel={box.boxState}\n              onChange={(value) => setFieldValue('boxStateId', value)}\n              readOnly={!isEditing}\n              gridArea=\"boxState\"\n            />\n            <AutocompleteField\n              gridArea=\"customerId\"\n              optionsSelector={selectOrganizationOptions}\n              valueLabel={box.customerName}\n              value={customerId}\n              onChange={(value) => setFieldValue('customerId', value)}\n              label=\"Customer\"\n              readOnly={!isEditing}\n              css={{ minWidth: '20em' }}\n            />\n            <ReadOnlyField gridArea=\"submittedByName\" value={box.submittedByName} label=\"Submitted By\" />\n            <ReadOnlyField\n              gridArea=\"createdDate\"\n              value={formatUtcDateTimeToAppDate(box.createdDate ?? null)}\n              label=\"Submitted On\"\n            />\n            <ReadOnlyField\n              gridArea=\"receivedDate\"\n              value={formatUtcDateTimeToAppDate(box.receivedDate)}\n              label=\"Received On\"\n            />\n            <ReadOnlyField\n              gridArea=\"processingCompleteDate\"\n              value={formatUtcDateTimeToAppDate(box.processingCompleteDate ?? null)}\n              label=\"Processing Completed On\"\n            />\n            <CheckboxField\n              label=\"Measurements\"\n              value={measurements}\n              onChange={(value) => setFieldValue('measurements', value)}\n              readOnly={!isEditing}\n              gridArea=\"measurements\"\n            />\n            <CheckboxField\n              label=\"Midges\"\n              value={midges}\n              onChange={(value) => setFieldValue('midges', value)}\n              readOnly={!isEditing}\n              gridArea=\"midges\"\n            />\n            <ReadOnlyField label=\"Taxonomic QA\" value={box.taxaQa} gridArea=\"taxaQa\" />\n            <ReadOnlyField label=\"Sorting QA\" value={box.sorterQa} gridArea=\"sorterQa\" />\n            <ModelsField\n              label=\"Models\"\n              value={modelIds}\n              onChange={(value) => setFieldValue('modelIds', value)}\n              readOnly={!isEditing}\n              gridArea=\"modelIds\"\n            />\n            <TextField\n              label=\"Alias\"\n              value={alias}\n              onChange={(value) => setFieldValue('alias', value)}\n              readOnly={!isEditing}\n              gridArea=\"alias\"\n            />\n            <TextField\n              label=\"Description\"\n              value={description}\n              onChange={(value) => setFieldValue('description', value)}\n              readOnly={!isEditing}\n              multiline\n              minRows={3}\n              gridArea=\"description\"\n            />\n            <SortingProgressField boxId={box.id} value={box.sortComplete} gridArea=\"sorting\" />\n            <IdentificationProgressField boxId={box.id} value={box.identificationComplete} gridArea=\"identification\" />\n            {editMode !== 'started' && (\n              <div css={{ gridArea: 'map' }}>\n                <BoxSitesMapPreview boxId={box.id} />\n              </div>\n            )}\n          </div>\n        </AccordionPanel>\n        <div css={{ fontWeight: '500', marginLeft: '1em' }}>Samples</div>\n        <div css={{ flex: 1, minHeight: '10em' }}>\n          <BoxSamples boxId={box.id} />\n        </div>\n      </div>\n      {isDirty && <ConfirmNavigateAway message=\"Some changes are not saved. Are you sure you want to leave?\" />}\n    </>\n  )\n}\n","import React from 'react'\nimport { useRecoilValue } from 'recoil'\n\nimport { selectBoxById, selectMyUser } from '../../data/selectors'\nimport { withSuspense } from '../withSuspense'\nimport { BoxDetail as Component } from './BoxDetail'\nimport { Fallback } from './Fallback'\n\nexport interface BoxDetailProps {\n  boxId: string | number\n}\n\nexport const BoxDetail = withSuspense(({ boxId }: BoxDetailProps): JSX.Element => {\n  const box = useRecoilValue(selectBoxById(Number(boxId)))\n  const user = useRecoilValue(selectMyUser)\n\n  if (box === null) return <h2>Box {boxId} not found.</h2>\n\n  return <Component box={box} user={user} />\n}, Fallback)\n","/** @jsxImportSource @emotion/react */\nimport React from 'react'\nimport Skeleton from '@mui/material/Skeleton'\n\nexport const Fallback = (): JSX.Element => (\n  <div css={{ height: '100%', display: 'flex', flexDirection: 'column', gap: '1em' }}>\n    <div css={{ width: '40em' }}>\n      <Skeleton height=\"3em\" variant=\"rectangular\" />\n    </div>\n    <div css={{ width: '10em' }}>\n      <Skeleton height=\"2em\" variant=\"rectangular\" />\n    </div>\n    <Skeleton height=\"20em\" variant=\"rectangular\" />\n  </div>\n)\n","/** @jsxImportSource @emotion/react */\nimport React from 'react'\nimport MuiButton from '@mui/material/Button'\n\nimport { useNavigate } from '../AppRouter'\nimport { Sample } from '../../types'\n\nexport interface SampleOverviewProps {\n  sample: Sample\n}\n\nexport const SampleOverview = ({ sample }: SampleOverviewProps): JSX.Element => {\n  const navigate = useNavigate()\n\n  // RENDER\n\n  const taxonomyStatus = (() => {\n    if (sample.identificationEndDate) return 'Complete'\n    if (sample.identificationStartDate) return 'Started'\n    return 'Not Started'\n  })()\n\n  return (\n    <div css={{ height: '100%', display: 'flex', flexDirection: 'column' }}>\n      <div>Sample: {sample.id}</div>\n      <div>Box: {sample.boxId}</div>\n      <div>Customer: {sample.customerName}</div>\n      <div>Box Status: {sample.boxState}</div>\n      <div>Sort Status: {sample.sorterId ? 'Complete' : 'Not Started'}</div>\n      <div>Taxonomy: {taxonomyStatus}</div>\n      <div css={{ marginTop: '1em', display: 'grid', gridTemplateColumns: '15em', gap: '1em' }}>\n        <MuiButton variant=\"outlined\" onClick={() => navigate.sampleSorting({ sampleId: sample.id })}>\n          Sorting\n        </MuiButton>\n        <MuiButton variant=\"outlined\" onClick={() => navigate.sampleTaxonomyIdentification({ sampleId: sample.id })}>\n          Taxonomy\n        </MuiButton>\n      </div>\n    </div>\n  )\n}\n","import React from 'react'\nimport { useRecoilValue } from 'recoil'\n\nimport { selectSampleById } from '../../data/selectors'\nimport { SampleOverview as Component } from './SampleOverview'\nimport { Fallback } from './Fallback'\nimport { withSuspense } from '../withSuspense'\n\nexport interface SampleOverviewProps {\n  sampleId: string | number\n}\n\nexport const SampleOverview = withSuspense(({ sampleId }: SampleOverviewProps): JSX.Element => {\n  const sample = useRecoilValue(selectSampleById(Number(sampleId)))\n\n  if (sample === null) return <h2>Sample {sampleId} not found.</h2>\n\n  return <Component sample={sample} />\n}, Fallback)\n","/** @jsxImportSource @emotion/react */\nimport React from 'react'\nimport Skeleton from '@mui/material/Skeleton'\n\nexport const Fallback = (): JSX.Element => (\n  <div css={{ height: '100%', display: 'flex', flexDirection: 'column', gap: '1em' }}>\n    <Skeleton height=\"20em\" variant=\"rectangular\" />\n  </div>\n)\n","/** @jsxImportSource @emotion/react */\nimport React from 'react'\nimport { atom, useRecoilState } from 'recoil'\nimport MuiAccordion from '@mui/material/Accordion'\nimport MuiAccordionSummary from '@mui/material/AccordionSummary'\nimport MuiAccordionDetails from '@mui/material/AccordionDetails'\nimport Skeleton from '@mui/material/Skeleton'\nimport ExpandMoreIcon from '@mui/icons-material/ExpandMore'\n\nimport { Sample } from '../../types'\nimport { formatUtcDateTimeToAppDate } from '../../lib/formats'\n\nconst isExpandedState = atom<boolean>({\n  key: 'SampleInfoPanel/isExpanded',\n  default: true,\n})\n\ninterface SampleInfoPanelProps {\n  sample: Sample\n  actions?: React.ReactNode\n}\n\nconst GridInfoField = ({ name, label, value }: { name: string; label: string; value: React.ReactNode }) => (\n  <>\n    <div css={{ gridArea: `${name}Label` }}>{label}:</div>\n    <div css={{ gridArea: `${name}Value` }}>{value}</div>\n  </>\n)\n\nexport const SampleInfoPanel = ({ sample, actions = null }: SampleInfoPanelProps): JSX.Element => {\n  const [isExpanded, setIsExpanded] = useRecoilState(isExpandedState)\n\n  if (!sample) return <Skeleton variant=\"rectangular\" />\n\n  const { id, boxId, sorterName = '', sampleDate, sortEndDate, customerName, siteName } = sample\n\n  return (\n    <MuiAccordion\n      expanded={isExpanded}\n      onChange={(e, newValue) => setIsExpanded(newValue)}\n      css={{ marginBottom: '1em' }}\n    >\n      <MuiAccordionSummary expandIcon={<ExpandMoreIcon />} css={{ display: 'flex' }}>\n        <span css={{ alignSelf: 'center', fontSize: '125%' }}>\n          <span css={{ fontWeight: 'bold' }}>Sample {id}</span> (Box {boxId})\n        </span>\n        {actions && (\n          <div\n            css={{ margin: '0 0.5em 0 auto' }}\n            onClick={(e) => {\n              e.stopPropagation()\n            }}\n          >\n            {actions}\n          </div>\n        )}\n      </MuiAccordionSummary>\n      <MuiAccordionDetails\n        css={{\n          display: 'grid',\n          gap: '0.75em',\n          gridTemplateColumns: 'repeat(4, auto) 1fr',\n          gridTemplateAreas: `\n          \"sampleDateLabel sampleDateValue . . .\"\n            \"sorterLabel sorterValue sortDateLabel sortDateValue .\"\n            \"customerLabel customerValue siteLabel siteValue .\"\n        `,\n        }}\n      >\n        <GridInfoField name=\"sorter\" label=\"Sorter\" value={sorterName} />\n        <GridInfoField name=\"sortDate\" label=\"Sort Date\" value={formatUtcDateTimeToAppDate(sortEndDate)} />\n        <GridInfoField name=\"sampleDate\" label=\"Sample Date\" value={formatUtcDateTimeToAppDate(sampleDate)} />\n        <GridInfoField name=\"customer\" label=\"Customer\" value={customerName} />\n        <GridInfoField name=\"site\" label=\"Site\" value={siteName} />\n      </MuiAccordionDetails>\n    </MuiAccordion>\n  )\n}\n","/** @jsxImportSource @emotion/react */\nimport React from 'react'\nimport MuiTextField, { StandardTextFieldProps } from '@mui/material/TextField'\n\nimport { ReadOnlyField } from '../ReadOnlyField'\nimport { CommonFieldProps } from '../../types'\n\ninterface NumberFieldProps extends CommonFieldProps<number | null>, Omit<StandardTextFieldProps, 'value' | 'onChange'> {\n  inputRef?: React.Ref<HTMLInputElement>\n  max?: number\n  min?: number\n  precision?: number\n}\n\nexport const NumberField = ({\n  // CommonFieldProps\n  className,\n  disabled,\n  error,\n  gridArea,\n  label,\n  onChange,\n  readOnly,\n  value,\n\n  // NumberField\n  inputRef,\n  max,\n  min,\n  precision,\n\n  // StandardTextFieldProps\n  ...restProps\n}: NumberFieldProps): JSX.Element => {\n  if (readOnly) return <ReadOnlyField className={className} gridArea={gridArea} label={label} value={value} />\n\n  const handleChange = ({ target: { value: textValue } }) => {\n    if (!textValue.trim()) {\n      onChange(null)\n      return\n    }\n    const numberValue = Number(textValue)\n    if (precision !== undefined && Number(numberValue.toFixed(precision)) !== numberValue) return\n    if (min !== undefined && numberValue < min) return\n    if (max !== undefined && numberValue > max) return\n    onChange(numberValue)\n  }\n\n  return (\n    <MuiTextField\n      size=\"small\"\n      className={className}\n      disabled={disabled || readOnly}\n      error={error}\n      inputRef={inputRef}\n      label={label}\n      onChange={handleChange}\n      value={value ?? ''}\n      type=\"number\"\n      css={{ gridArea }}\n      {...restProps}\n    />\n  )\n}\n","import React from 'react'\nimport MuiButton from '@mui/material/Button'\nimport EditIcon from '@mui/icons-material/Edit'\nimport StopIcon from '@mui/icons-material/Stop'\n\nimport { Sample } from '../../types'\nimport { ControllerState, ControllerActions } from './componentController'\nimport { withTooltip } from '../withTooltip'\n\ninterface ToggleEditModeButtonProps {\n  userId: number\n  sample: Sample\n  editMode: ControllerState['editMode']\n  canStopOwn: boolean\n  canStopOther: boolean\n  actions: ControllerActions\n}\n\nexport const ToggleEditModeButton = ({\n  userId,\n  sample,\n  editMode,\n  canStopOwn,\n  canStopOther,\n  actions,\n}: ToggleEditModeButtonProps): JSX.Element | null => {\n  const isStartedByOther = sample.sortStartDate && !sample.sortEndDate && sample.sorterId !== userId\n\n  const error = (() => {\n    if (sample.boxState !== 'Active')\n      return 'The sorting for this sample cannot be edited because the box it is associated with is not currently active.'\n    if (isStartedByOther && !canStopOther) return 'Sorting for this sample is already underway by another user.'\n  })()\n\n  const isActive = (editMode !== 'stopped' && editMode !== 'starting') || isStartedByOther\n  const disabled =\n    !!error || editMode === 'starting' || editMode === 'stopping' || (editMode === 'started' && !canStopOwn)\n\n  return withTooltip(\n    <MuiButton\n      disabled={disabled}\n      onClick={() => {\n        if (editMode === 'started' || isStartedByOther) {\n          actions.stopSort()\n        } else {\n          actions.startSort()\n        }\n      }}\n      startIcon={isActive ? <StopIcon /> : <EditIcon />}\n      variant={isActive ? 'contained' : 'outlined'}\n    >\n      {isActive ? 'Stop Sorting' : 'Start Sorting'}\n    </MuiButton>,\n    error,\n    disabled\n  )\n}\n","import { round } from 'lodash'\n\nimport { SampleSortingProps, LAB_SPLIT_PERCENT_PRECISION } from './SampleSorting'\nimport { Sample } from '../../types'\nimport { useApi } from '../../data/api'\nimport { useNotifications } from '../AppNotifications'\nimport { useUpdatableState } from '../../lib/useUpdatableState'\nimport { updateLabSort, startSort, stopSort } from '../../data/calls'\nimport { getCurrentDateTime } from '../../lib/formats'\nimport { useDeferredInvalidate } from '../../data/selectors/invalidate'\n\ninterface Fields {\n  sorterId: number | ''\n  labSplitPercent: number | null\n  sorterCount: number | null\n  sortTime: number | null\n  elutriation: boolean\n}\n\ntype FieldErrors = Partial<Record<keyof Fields, boolean>> | undefined\n\nexport type ControllerState = {\n  sample?: Sample\n  values: Fields\n  errors: FieldErrors\n  editMode: 'stopped' | 'starting' | 'started' | 'stopping'\n  persistence?: 'unsaved' | 'dirty' | 'saving' | 'saved'\n}\n\nexport interface ControllerActions {\n  reset: () => void\n  // eslint-disable-next-line @typescript-eslint/no-explicit-any\n  setFieldValue: (fieldName: keyof Fields, value: any) => void\n  startSort: () => void\n  stopSort: () => void\n  saveSort: () => void\n}\n\nconst initialState = {\n  values: { sorterId: '', labSplitPercent: null, sorterCount: null, sortTime: null, sortDate: '', elutriation: false },\n  editMode: 'stopped',\n  persistence: 'unsaved',\n  errors: undefined,\n} as ControllerState\n\nconst getFieldErrors = (values: Fields): FieldErrors => {\n  const errors = {\n    sorterId: !values.sorterId,\n    labSplitPercent: values.labSplitPercent === null,\n    sorterCount: values.sorterCount === null,\n    sortTime: values.sortTime === null,\n  }\n  if (!Object.values(errors).some((value) => value)) return undefined\n  return errors\n}\n\nexport const useComponentController = ({\n  sample,\n  user,\n  sorterUsers,\n}: SampleSortingProps): [ControllerState, ControllerActions] => {\n  const api = useApi()\n  const deferredInvalidate = useDeferredInvalidate()\n  const notifications = useNotifications()\n\n  const [state, setState, updateState] = useUpdatableState<ControllerState>(initialState)\n\n  const actions = {\n    reset: () => {\n      const { sorterId, sorterCount, sortTime, labSplit, elutriation } = sample\n      const values: Fields = {\n        sorterId: sorterId || '',\n        sorterCount,\n        sortTime,\n        labSplitPercent: labSplit && round(labSplit * 100, LAB_SPLIT_PERCENT_PRECISION),\n        elutriation: !!elutriation,\n      }\n\n      setState(() => ({\n        ...initialState,\n        sample,\n        userId: user.id,\n        values,\n        persistence: getFieldErrors(values) ? 'unsaved' : 'saved',\n        editMode: sample.sorterId === user.id && !sample.sortEndDate ? 'started' : 'stopped',\n      }))\n    },\n    setFieldValue: async (fieldName: keyof Fields, value: unknown) => {\n      if (!state.sample) throw new Error('No sample')\n      updateState((draft) => {\n        Object.assign(draft.values, { [fieldName]: value })\n        draft.persistence = 'dirty'\n      })\n    },\n    saveSort: async () => {\n      try {\n        const { sorterId, labSplitPercent, sorterCount, sortTime, elutriation } = state.values\n        if (\n          !state.sample?.id ||\n          sorterId === '' ||\n          labSplitPercent === null ||\n          sorterCount === null ||\n          sortTime === null\n        )\n          throw new Error('Missing values.')\n        const updatedSample = {\n          sampleId: state.sample.id,\n          sorterId,\n          labSplit: labSplitPercent / 100,\n          sorterCount,\n          sortTime,\n          elutriation,\n        }\n        updateState((draft) => {\n          draft.persistence = 'saving'\n        })\n        await updateLabSort(api, deferredInvalidate)(updatedSample)\n        const sorterName =\n          sorterUsers.find(({ id }) => id === updatedSample.sorterId)?.fullName ?? state.sample.sorterName\n        updateState((draft) => {\n          draft.persistence = 'saved'\n          Object.assign(draft.sample, { ...updatedSample, sorterName })\n        })\n      } catch (err) {\n        notifications.error(`Failed to update Lab Sort: ${err}`)\n        updateState((draft) => {\n          draft.persistence = 'dirty'\n        })\n      }\n    },\n    startSort: async () => {\n      if (!state.sample) throw new Error('No sample')\n      try {\n        updateState((draft) => {\n          draft.editMode = 'starting'\n        })\n        await startSort(api, deferredInvalidate)({ sampleId: state.sample.id })\n        updateState((draft) => {\n          if (!draft.sample) throw new Error('No sample.')\n          draft.editMode = 'started'\n          draft.values.sorterId = user.id\n          draft.sample.sorterId = user.id\n          draft.sample.sorterName = user.fullName\n        })\n      } catch (err) {\n        notifications.error(`Failed to start Lab Sort: ${err}`)\n        updateState((draft) => {\n          draft.editMode = 'stopped'\n        })\n      }\n    },\n    stopSort: async () => {\n      if (!state.sample) throw new Error('No sample')\n      try {\n        updateState((draft) => {\n          draft.editMode = 'stopping'\n        })\n        await stopSort(api, deferredInvalidate)({ sampleId: state.sample.id })\n        const todayDate = getCurrentDateTime()\n        updateState((draft) => {\n          if (!draft.sample) throw new Error('No sample.')\n          draft.editMode = 'stopped'\n          draft.sample.sortEndDate = todayDate\n        })\n      } catch (err) {\n        notifications.error(`Failed to stop Lab Sort: ${err}`)\n        updateState((draft) => {\n          draft.editMode = 'started'\n        })\n      }\n    },\n  }\n\n  const errors = state.editMode === 'stopped' ? undefined : getFieldErrors(state.values)\n\n  return [{ ...state, errors }, actions]\n}\n","/* eslint-disable @typescript-eslint/no-non-null-assertion */\n/** @jsxImportSource @emotion/react */\nimport React, { useEffect, useMemo } from 'react'\nimport { NAMCResource, GrantAction } from '@namcbugdb/common'\nimport MuiButton from '@mui/material/Button'\n// import log from 'loglevel'\n\nimport { User, Sample, MyUser } from '../../types'\nimport { SampleInfoPanel } from '../SampleInfoPanel'\nimport { SelectField, SelectFieldProps } from '../SelectField'\nimport { NumberField } from '../NumberField'\nimport { CheckboxField } from '../CheckboxField'\nimport { ConfirmNavigateAway } from '../AppRouter'\nimport { ToggleEditModeButton } from './ToggleEditModeButton'\nimport { useComponentController } from './componentController'\n\nexport const LAB_SPLIT_PERCENT_PRECISION = 3\nexport interface SampleSortingProps {\n  sorterUsers: User[]\n  sample: Sample\n  user: MyUser\n}\n\nexport const SampleSorting = (props: SampleSortingProps): JSX.Element => {\n  const { sorterUsers: sorterUsersProp, sample, user } = props\n\n  // STATE\n\n  const sorterUsers = useMemo(() => {\n    const resultSorterUsers = [...sorterUsersProp]\n    if (!sorterUsersProp.find((sorterUser) => sorterUser.id === user.id)) resultSorterUsers.push(user)\n    return resultSorterUsers\n  }, [sorterUsersProp])\n\n  const [state, actions] = useComponentController({ sample, user, sorterUsers })\n  const {\n    values: { sorterId, labSplitPercent, sorterCount, sortTime, elutriation },\n    errors,\n    editMode,\n  } = state\n  const { setFieldValue } = actions\n  const isEditing = editMode === 'started'\n\n  // EFFECTS\n\n  useEffect(() => {\n    actions.reset()\n  }, [sample.id])\n\n  // RENDER\n\n  const sorterOptions: SelectFieldProps['options'] = sorterUsers.map((sorterUser) => ({\n    value: sorterUser.id,\n    label: sorterUser.fullName,\n  }))\n  if (sample.sorterId && !sorterUsers.find((sorterUser) => sorterUser.id === sorterId))\n    sorterOptions.push({\n      value: sorterId,\n      label: sample.sorterName,\n    })\n\n  const canSort = user.hasPermission(NAMCResource.sorting, GrantAction.updateOwn)\n  const isLabManager = user.hasPermission(NAMCResource.sorting, GrantAction.updateAny)\n  const canStopOwn = state.editMode === 'started' && state.persistence === 'saved'\n  const canStopOther = isLabManager\n  const isDirty = state.persistence === 'dirty'\n  const canSave = isDirty && !errors\n\n  return (\n    <>\n      <div css={{ height: '100%', display: 'flex', flexDirection: 'column' }}>\n        {state.sample && (\n          <SampleInfoPanel\n            sample={state.sample}\n            actions={\n              canSort && (\n                <ToggleEditModeButton\n                  userId={user.id}\n                  sample={state.sample}\n                  actions={actions}\n                  canStopOwn={canStopOwn}\n                  canStopOther={canStopOther}\n                  editMode={state.editMode}\n                />\n              )\n            }\n          />\n        )}\n        <div css={{ display: 'grid', gridTemplateColumns: '20em', gap: '1em' }}>\n          <SelectField\n            label=\"Sorter\"\n            value={sorterId}\n            onChange={(value) => setFieldValue('sorterId', value)}\n            options={sorterOptions}\n            error={errors?.sorterId}\n            readOnly={!isEditing}\n            disabled={!isLabManager}\n          />\n          <NumberField\n            label=\"Split %\"\n            value={labSplitPercent}\n            onChange={(value) => setFieldValue('labSplitPercent', value)}\n            min={0}\n            max={100}\n            precision={LAB_SPLIT_PERCENT_PRECISION}\n            error={errors?.labSplitPercent}\n            readOnly={!isEditing}\n          />\n          <NumberField\n            label=\"Number of bugs\"\n            value={sorterCount}\n            onChange={(value) => setFieldValue('sorterCount', value)}\n            min={0}\n            max={999999}\n            error={errors?.sorterCount}\n            readOnly={!isEditing}\n          />\n          <CheckboxField\n            label=\"Elutriation\"\n            value={elutriation}\n            onChange={(value) => setFieldValue('elutriation', value)}\n            readOnly={!isEditing}\n          />\n          <NumberField\n            label=\"Sort time (hours)\"\n            value={sortTime}\n            onChange={(value) => setFieldValue('sortTime', value)}\n            min={0}\n            max={999999}\n            error={errors?.sortTime}\n            readOnly={!isEditing}\n          />\n          {(editMode === 'started' || editMode === 'stopping') && (\n            <MuiButton onClick={actions.saveSort} disabled={!canSave} variant=\"contained\">\n              Save\n            </MuiButton>\n          )}\n        </div>\n      </div>\n      {isDirty && <ConfirmNavigateAway message=\"Some changes are not saved. Are you sure you want to leave?\" />}\n    </>\n  )\n}\n","import React from 'react'\nimport { useRecoilValue } from 'recoil'\n\nimport { selectSampleById, selectSorterUsers, selectMyUser } from '../../data/selectors'\nimport { SampleSorting as Component } from './SampleSorting'\nimport { Fallback } from './Fallback'\nimport { withSuspense } from '../withSuspense'\n\nexport interface SampleSortingProps {\n  sampleId: string | number\n}\n\nexport const SampleSorting = withSuspense(({ sampleId }: SampleSortingProps): JSX.Element => {\n  const sorterUsers = useRecoilValue(selectSorterUsers)\n  const user = useRecoilValue(selectMyUser)\n  const sample = useRecoilValue(selectSampleById(Number(sampleId)))\n\n  if (sample === null) return <h2>Sample {sampleId} not found.</h2>\n\n  return <Component sorterUsers={sorterUsers} sample={sample} user={user} />\n}, Fallback)\n","/** @jsxImportSource @emotion/react */\nimport React from 'react'\nimport Skeleton from '@mui/material/Skeleton'\n\nexport const Fallback = (): JSX.Element => (\n  <div css={{ height: '100%', display: 'flex', flexDirection: 'column', gap: '1em' }}>\n    <Skeleton height=\"9em\" variant=\"rectangular\" />\n    <Skeleton height=\"3em\" variant=\"rectangular\" />\n  </div>\n)\n","/** @jsxImportSource @emotion/react */\nimport React from 'react'\n\nimport { withTooltip } from '../withTooltip'\n\ninterface FlagBadgeProps {\n  label: string\n  badgeColor: string\n  className?: string\n  tooltip?: string\n  textColor?: string\n  disabled?: boolean\n}\n\nexport const Badge = ({ className, label, tooltip, badgeColor, textColor }: FlagBadgeProps): JSX.Element =>\n  withTooltip(\n    <span\n      className={className}\n      css={{\n        background: badgeColor,\n        color: textColor,\n        height: '1.2em',\n        padding: '0.1em 0.2em',\n      }}\n    >\n      <span\n        css={{\n          width: '1em',\n          display: 'inline-block',\n          textAlign: 'center',\n        }}\n      >\n        {label}\n      </span>\n    </span>,\n    tooltip\n  )\n","/** @jsxImportSource @emotion/react */\nimport React from 'react'\nimport ListItem from '@mui/material/ListItem'\nimport parse from 'autosuggest-highlight/parse'\nimport match from 'autosuggest-highlight/match'\n\nimport { Badge } from '../Badge'\nimport { Taxon } from '../../types'\n\nexport const HighlightedText = ({ text, highlightText }: { text: string; highlightText: string }): JSX.Element => (\n  <>\n    {parse(text, match(text, highlightText)).map<JSX.Element>(\n      // TODO: match is not finding all occurrences, but this needs to be rewritten custom anyway because the algoritm isn't exactly what we need\n      (part: { text: string; highlight: boolean }, index: number) => (\n        <span\n          key={index}\n          style={{\n            fontWeight: part.highlight ? 700 : 400,\n          }}\n        >\n          {part.text}\n        </span>\n      )\n    )}\n  </>\n)\n\nexport type TaxaOptionStatus = 'in' | 'notIn'\n\nexport const MAX_MATCHES = 100\nexport const MAX_DISPLAYED_SYNONYMS = 10\n\nexport const Group = ({\n  group,\n  children,\n  labels,\n}: {\n  group: TaxaOptionStatus\n  children?: React.ReactNode\n  labels: [string, string]\n}): JSX.Element => {\n  const color = group === 'in' ? 'green' : 'blue'\n  return (\n    <div>\n      <div\n        css={{\n          borderBottom: `3px solid ${color}`,\n          color,\n          height: '2em',\n          display: 'flex',\n          alignItems: 'center',\n          paddingLeft: '1em',\n        }}\n      >\n        {group === 'in' ? labels[0] : labels[1]}\n      </div>\n      {children}\n    </div>\n  )\n}\n\ninterface OptionProps extends React.HTMLAttributes<HTMLLIElement> {\n  taxon: Taxon\n  inputValue: string\n  actions?: React.ReactNode\n}\n\nexport const Option = ({ taxon, inputValue, actions, ...restProps }: OptionProps): JSX.Element => {\n  const { name, levelName, synonyms } = taxon\n\n  const synonymArea = [] as JSX.Element[]\n\n  if (synonyms.length <= MAX_DISPLAYED_SYNONYMS) {\n    synonymArea.push(<HighlightedText key=\"only\" text={synonyms.join(', ')} highlightText={inputValue} />)\n  } else {\n    const isSynonymsMatched = match(synonyms.join(' '), inputValue).length > 0\n\n    if (isSynonymsMatched) {\n      synonyms.forEach((synonym) => {\n        if (match(synonym, inputValue).length === 0) return\n        if (synonymArea.length > 0) synonymArea.push(<span key={`${synonym} separator`}>, </span>)\n        synonymArea.push(<HighlightedText key={synonym} text={synonym} highlightText={inputValue} />)\n      })\n      synonymArea.push(\n        <span key=\"remainder\" css={{ opacity: 0.75 }}>\n          {' '}\n          ({synonyms.length - synonymArea.length} unmatched not shown)\n        </span>\n      )\n    } else {\n      synonymArea.push(\n        <React.Fragment key=\"more\">\n          {synonyms.slice(0, MAX_DISPLAYED_SYNONYMS).join(', ')}\n          <span css={{ opacity: 0.75 }}> ({synonyms.length - MAX_DISPLAYED_SYNONYMS} more not shown)</span>\n        </React.Fragment>\n      )\n    }\n  }\n\n  return (\n    <ListItem\n      {...restProps}\n      css={{\n        borderBottom: '1px solid lightgrey',\n        display: 'flex',\n      }}\n    >\n      <span css={{ maxWidth: '15em', flex: 1 }}>\n        <HighlightedText text={name} highlightText={inputValue} />\n        {taxon.isTargetEffort && (\n          <Badge\n            badgeColor=\"#bbbbbb\"\n            tooltip=\"Taxon is at for below the SAFIT II required target effort\"\n            css={{ marginLeft: '0.5em' }}\n            label=\"S\"\n          />\n        )}\n      </span>\n      <span css={{ maxWidth: '6em', flex: 1 }}>{levelName}</span>\n      <span css={{ fontStyle: 'italic', flex: 1 }}>{synonymArea}</span>\n      {actions}\n    </ListItem>\n  )\n}\n","/** @jsxImportSource @emotion/react */\nimport React, { useState } from 'react'\nimport TextField from '@mui/material/TextField'\nimport Autocomplete from '@mui/material/Autocomplete'\n\nimport Button, { ButtonProps } from '@mui/material/Button'\nimport KeyboardReturnIcon from '@mui/icons-material/KeyboardReturn'\nimport AddIcon from '@mui/icons-material/AddCircleOutline'\nimport FilterAltIcon from '@mui/icons-material/FilterAlt'\nimport match from 'autosuggest-highlight/match'\n\nimport { Taxon } from '../../types'\nimport { Option, MAX_MATCHES, TaxaOptionStatus, Group } from './util'\n\nexport interface AddableTaxonOption extends Taxon {\n  status: TaxaOptionStatus\n  canAdd: boolean\n  canFilter: boolean\n  defaultAction?: 'add' | 'filter'\n}\n\nexport interface TaxonomyFieldProps {\n  options: AddableTaxonOption[]\n  onAddOrganism: (taxon: AddableTaxonOption) => void\n  onAddFilter: (taxon: AddableTaxonOption) => void\n  inputRef?: React.RefObject<HTMLInputElement>\n}\n\nconst ActionButton = ({\n  isDefault,\n  children,\n  onClick,\n  className,\n  disabled,\n  ...restProps\n}: ButtonProps & {\n  isDefault?: boolean\n}) => {\n  return (\n    <div css={{ position: 'relative' }} className={className}>\n      {disabled && (\n        <div\n          css={{ width: '100%', height: '100%', position: 'absolute', cursor: 'default' }}\n          onClick={(e) => {\n            // this element is a bit of a hack to use a disabled button but still\n            // catch the click to prevent autocomplete from choosing row\n            e.stopPropagation()\n          }}\n        />\n      )}\n      <Button variant=\"outlined\" size=\"small\" onClick={onClick} disabled={disabled} data-skip-choose {...restProps}>\n        {children}\n        {isDefault && <KeyboardReturnIcon sx={{ marginLeft: '0.25em', fontSize: '100%' }} />}\n      </Button>\n    </div>\n  )\n}\n\nconst filterOptions = (input: AddableTaxonOption[], { inputValue }: { inputValue: string }) =>\n  input\n    .filter(({ name, synonyms }) => {\n      const filterableName = [name, ...synonyms].join(' ')\n      return match(filterableName, inputValue).length > 0\n    })\n    .slice(0, MAX_MATCHES)\n\nexport const TaxonomyField = ({ options, onAddOrganism, onAddFilter, inputRef }: TaxonomyFieldProps): JSX.Element => {\n  const [text, setText] = useState('')\n\n  const handleTextChange = (e: React.SyntheticEvent, newValue: string) => {\n    if (newValue === '/') return // for slicker keyboard shortcut behavior\n    setText(newValue)\n  }\n\n  const handleChoose = (\n    e: React.SyntheticEvent & { target: { attributes?: { 'data-skip-choose'?: string } } },\n    taxon?: AddableTaxonOption | null\n  ) => {\n    if (taxon && !e.target.attributes?.['data-skip-choose']) {\n      switch (taxon?.defaultAction) {\n        case 'add':\n          onAddOrganism(taxon)\n          break\n        case 'filter':\n          onAddFilter(taxon)\n          break\n      }\n    }\n    window.setTimeout(() => {\n      setText('')\n    }, 0)\n  }\n\n  const handleKeyDown = ({ key }: { key: string }) => {\n    if (key !== 'Escape' || !inputRef?.current) return\n    inputRef.current.blur()\n  }\n\n  const isOptionsPresented = text.length >= 3\n\n  return (\n    <Autocomplete\n      disablePortal\n      options={isOptionsPresented ? options : []}\n      onChange={handleChoose}\n      renderInput={(params) => <TextField {...params} inputRef={inputRef} label=\"Taxonomy\" />}\n      onKeyDown={handleKeyDown}\n      renderOption={(optionProps, taxon, { inputValue }) => (\n        <Option\n          {...optionProps}\n          key={taxon.id}\n          taxon={taxon}\n          inputValue={inputValue}\n          actions={\n            <div css={{ display: 'grid', gridGap: '0.25em', gridTemplateColumns: 'auto auto' }}>\n              <ActionButton\n                onClick={() => onAddOrganism(taxon)}\n                isDefault={taxon.defaultAction === 'add'}\n                disabled={!taxon.canAdd}\n                startIcon={<AddIcon />}\n              >\n                Add Organism\n              </ActionButton>\n              <ActionButton\n                onClick={() => onAddFilter(taxon)}\n                isDefault={taxon.defaultAction === 'filter'}\n                disabled={!taxon.canFilter}\n                startIcon={<FilterAltIcon />}\n              >\n                Add Filter\n              </ActionButton>\n            </div>\n          }\n        />\n      )}\n      inputValue={text}\n      onInputChange={handleTextChange}\n      clearOnEscape\n      autoHighlight\n      noOptionsText={isOptionsPresented ? 'No taxa found' : '...'}\n      groupBy={(taxon) => taxon.status}\n      value={null}\n      renderGroup={({ group, ...rest }) => (\n        <Group group={group as TaxaOptionStatus} labels={['Already In Sample', 'Not In Sample']} {...rest} />\n      )}\n      getOptionLabel={({ id }) => String(id)} // being used by Autocomplete for array key; not displayed due to renderOption\n      filterOptions={filterOptions}\n    />\n  )\n}\n","/** @jsxImportSource @emotion/react */\nimport React, { useState } from 'react'\nimport TextField from '@mui/material/TextField'\nimport Autocomplete from '@mui/material/Autocomplete'\nimport match from 'autosuggest-highlight/match'\n\nimport { Taxon } from '../../types'\nimport { Option, MAX_MATCHES, TaxaOptionStatus, Group } from './util'\n\nexport interface SelectableTaxonOption extends Taxon {\n  status?: TaxaOptionStatus\n}\n\nexport interface TaxonomySelectFieldProps {\n  className?: string\n  disabled?: boolean\n  gridArea?: string\n  label: React.ReactNode\n  onChange: (newId: number | null) => void\n  options: SelectableTaxonOption[]\n  value: number | null\n}\n\nconst filterOptions = (options: SelectableTaxonOption[], state) => {\n  return options\n    .filter(({ name, synonyms }) => {\n      const filterableName = [name, ...synonyms].join(' ')\n      return match(filterableName, state.inputValue).length > 0\n    })\n    .slice(0, MAX_MATCHES)\n}\n\nexport const TaxonomySelectField = ({\n  className,\n  disabled,\n  gridArea,\n  label,\n  onChange,\n  options,\n  value,\n}: TaxonomySelectFieldProps): JSX.Element => {\n  const [text, setText] = useState('')\n\n  const handleTextChange = (e: React.SyntheticEvent, newValue: string) => {\n    setText(newValue)\n  }\n\n  const handleChoose = (e, taxon?: SelectableTaxonOption | null) => {\n    if (taxon) {\n      onChange(taxon.id)\n    } else {\n      onChange(null)\n    }\n  }\n\n  const isOptionsPresented = text.length >= 3\n\n  const foundValue = options.find((option) => option.id === value) || null\n\n  return (\n    <Autocomplete\n      className={className}\n      css={{ gridArea }}\n      // disablePortal\n      options={isOptionsPresented || foundValue ? options : []}\n      onChange={handleChoose}\n      renderInput={(params) => <TextField {...params} label={label} />}\n      renderOption={(optionProps, taxon, { inputValue }) => (\n        <Option {...optionProps} key={taxon.id} taxon={taxon} inputValue={inputValue} />\n      )}\n      inputValue={text}\n      onInputChange={handleTextChange}\n      noOptionsText={\n        isOptionsPresented ? (foundValue ? 'Change value to continue taxon search' : 'No taxa found') : '...'\n      }\n      groupBy={(taxon) => taxon.status || 'default'}\n      value={foundValue}\n      isOptionEqualToValue={(option, v) => option.id === v.id}\n      renderGroup={({ group, ...rest }) => (\n        <Group group={group as TaxaOptionStatus} labels={['Currently In Box', 'Not In Box']} {...rest} />\n      )}\n      getOptionLabel={({ name }) => String(name)} // display value; also used by Autocomplete for array key\n      filterOptions={filterOptions}\n      disabled={disabled}\n      size=\"small\"\n    />\n  )\n}\n","import { useReducer, useMemo } from 'react'\nimport produce from 'immer'\nimport { uniqueId } from 'lodash'\nimport log from 'loglevel'\n\nimport { MyUser, Organism, Sample } from '../../types'\nimport { LocalOrganism, OrganismFilter, ControllerActions, ReducerAction, ReducerState } from './types'\nimport { useApi } from '../../data/api'\nimport {\n  deleteOrganism,\n  startTaxonomyIdentification,\n  stopTaxonomyIdentification,\n  upsertOrganism,\n} from '../../data/calls'\nimport { useNotifications } from '../AppNotifications'\nimport { useDeferredInvalidate } from '../../data/selectors/invalidate'\n\nconst generateRowId = () => `row/${uniqueId()}`\n\nconst initialState = {\n  sample: undefined,\n  organisms: [],\n  measurements: false,\n  organismFilters: [],\n  editMode: 'stopped',\n  scrollToRowId: null,\n} as ReducerState\n\nconst reducer = (state: ReducerState, action: ReducerAction): ReducerState => {\n  log.debug('dispatched:', action)\n\n  if (action.type === 'reset') {\n    const {\n      payload: { sample, user },\n    } = action\n    return {\n      ...initialState,\n      sample,\n      organisms: sample.organisms.map((organism) => ({ ...organism, rowId: generateRowId(), persistence: 'saved' })),\n      editMode: sample.identificationUserId === user.id && !sample.identificationEndDate ? 'started' : 'stopped',\n      measurements: !!sample.measurements,\n    }\n  }\n\n  const newState = produce(state, (draft) => {\n    switch (action.type) {\n      case 'createLocalOrganism': {\n        const { payload: organism } = action\n        draft.organisms.push({\n          ...organism,\n          persistence: 'unsaved',\n        })\n        draft.scrollToRowId = organism.rowId\n        break\n      }\n      case 'updateLocalOrganism': {\n        const {\n          payload: { rowId, fields },\n        } = action\n        const organism = draft.organisms.find((organism) => organism.rowId === rowId)\n        if (!organism) return\n        Object.assign(organism, fields)\n        break\n      }\n      case 'deleteLocalOrganism': {\n        const {\n          payload: { rowId },\n        } = action\n        draft.organisms = draft.organisms.filter((organism) => organism.rowId !== rowId)\n        break\n      }\n      case 'createFilter': {\n        const {\n          payload: { taxonId },\n        } = action\n        if (state.organismFilters.find((existingFilter) => existingFilter.taxonId === taxonId)) return\n        draft.organismFilters.push({ taxonId })\n        break\n      }\n      case 'deleteFilter': {\n        const {\n          payload: { taxonId },\n        } = action\n        draft.organismFilters = draft.organismFilters.filter((organismFilter) => organismFilter.taxonId !== taxonId)\n        break\n      }\n      case 'setEditMode': {\n        const editMode = action.payload\n        draft.editMode = editMode\n        if (editMode === 'stopped')\n          draft.organisms = draft.organisms.filter((organism) => organism.persistence !== 'unsaved')\n        break\n      }\n      case 'setScrollToRowId': {\n        draft.scrollToRowId = action.payload\n      }\n    }\n  })\n  return newState\n}\n\nexport const useComponentController = (): [ReducerState, ControllerActions] => {\n  const api = useApi()\n  const deferredInvalidate = useDeferredInvalidate()\n  const notifications = useNotifications()\n\n  const upsertOrganismIfSavable = async (organism: LocalOrganism) => {\n    if (organism.lifeStageId) {\n      dispatch({ type: 'updateLocalOrganism', payload: { rowId: organism.rowId, fields: { persistence: 'saving' } } })\n      try {\n        const id = await upsertOrganism(api, deferredInvalidate)(organism)\n        dispatch({\n          type: 'updateLocalOrganism',\n          payload: { rowId: organism.rowId, fields: { id, persistence: 'saved' } },\n        })\n      } catch (err) {\n        dispatch({ type: 'updateLocalOrganism', payload: { rowId: organism.rowId, fields: { persistence: 'error' } } })\n        notifications.error(`Failed to save organism record: ${err}`)\n      }\n    }\n  }\n\n  const [state, dispatch] = useReducer(reducer, initialState)\n\n  const actions = useMemo(\n    () => ({\n      createOrganism: async ({ taxonId }: Pick<LocalOrganism, 'taxonId'>) => {\n        if (!state.sample) throw new Error('No sample')\n        const rowId = generateRowId()\n        const newOrganism: LocalOrganism = {\n          rowId,\n          taxonId,\n          sampleId: state.sample.id,\n          splitCount: 0,\n          bigRareCount: null,\n          noteTypeIds: [],\n          comments: '',\n        }\n        dispatch({ type: 'createLocalOrganism', payload: newOrganism })\n        await upsertOrganismIfSavable(newOrganism)\n      },\n      duplicateOrganism: async (organism: LocalOrganism) => {\n        if (!state.sample) throw new Error('No sample')\n        const rowId = generateRowId()\n        const newOrganism: LocalOrganism = {\n          rowId,\n          taxonId: organism.taxonId,\n          sampleId: state.sample.id,\n          splitCount: 0,\n          bigRareCount: null,\n          noteTypeIds: [],\n          comments: '',\n        }\n        dispatch({ type: 'createLocalOrganism', payload: newOrganism })\n        await upsertOrganismIfSavable(newOrganism)\n      },\n      updateOrganism: async (organism: LocalOrganism) => {\n        dispatch({ type: 'updateLocalOrganism', payload: { rowId: organism.rowId, fields: organism } })\n        await upsertOrganismIfSavable(organism)\n      },\n      deleteOrganism: async (organism: LocalOrganism) => {\n        try {\n          if (organism.persistence !== 'unsaved') {\n            dispatch({\n              type: 'updateLocalOrganism',\n              payload: { rowId: organism.rowId, fields: { persistence: 'deleting' } },\n            })\n            await deleteOrganism(api, deferredInvalidate)(organism as Organism)\n          }\n          dispatch({ type: 'deleteLocalOrganism', payload: organism })\n        } catch (err) {\n          dispatch({\n            type: 'updateLocalOrganism',\n            payload: { rowId: organism.rowId, fields: { persistence: 'error' } },\n          })\n          notifications.error(`Failed to delete organism record: ${err}`)\n        }\n      },\n      createFilter: (filter: OrganismFilter) => dispatch({ type: 'createFilter', payload: filter }),\n      deleteFilter: (filter: OrganismFilter) => dispatch({ type: 'deleteFilter', payload: filter }),\n      reset: async (payload: { sample: Sample; user: MyUser }) => {\n        dispatch({ type: 'reset', payload })\n      },\n      startTaxonomyIdentification: async () => {\n        try {\n          if (!state.sample) throw new Error('No sample')\n          dispatch({ type: 'setEditMode', payload: 'starting' })\n          await startTaxonomyIdentification(api, deferredInvalidate)({ sampleId: state.sample.id })\n          dispatch({ type: 'setEditMode', payload: 'started' })\n        } catch (err) {\n          dispatch({ type: 'setEditMode', payload: 'stopped' })\n          notifications.error(`Failed to start taxonomy identification: ${err}`)\n        }\n      },\n      stopTaxonomyIdentification: () => {\n        dispatch({ type: 'setEditMode', payload: 'stoppingPrompt' })\n      },\n      finishTaxonomyIdentification: async ({ time }: { time: number }) => {\n        try {\n          if (!state.sample) throw new Error('No sample')\n          dispatch({ type: 'setEditMode', payload: 'stoppingSaving' })\n          await stopTaxonomyIdentification(api, deferredInvalidate)({ sampleId: state.sample.id, time })\n          dispatch({ type: 'setEditMode', payload: 'stopped' })\n        } catch (err) {\n          dispatch({ type: 'setEditMode', payload: 'started' })\n          notifications.error(`Failed to stop taxonomy identification: ${err}`)\n        }\n      },\n      setScrollToRowId: (rowId: LocalOrganism['rowId'] | null) => {\n        dispatch({ type: 'setScrollToRowId', payload: rowId })\n      },\n    }),\n    [api, state.sample] // TODO: memoizing here isn't desirable, except we don't want new grid context every time :-/\n  )\n  return [state, actions]\n}\n","import { ColDef } from 'ag-grid-community'\n\nimport { OrganismRow, OrganismValueSetterParams, OrganismCellClassParams } from './types'\n\ninterface RowNode {\n  data: OrganismRow\n}\n\nconst singleValueSetter = ({\n  colDef: { field },\n  newValue: value,\n  data,\n  context: { actions },\n}: OrganismValueSetterParams) => {\n  actions.updateOrganism({ ...data, [field]: value })\n  return false\n}\n\nconst notesAndCommentsValueSetter = ({\n  newValue: { noteTypeIds, comments },\n  data,\n  context: { actions },\n}: OrganismValueSetterParams) => {\n  actions.updateOrganism({ ...data, noteTypeIds, comments })\n  return false\n}\n\nexport const organismsColumnDefs = [\n  {\n    headerName: '',\n    field: 'persistence',\n    width: 70,\n    hide: true,\n    cellRenderer: 'PersistenceRenderer',\n  },\n  {\n    headerName: 'Taxon',\n    field: 'taxonName',\n    width: 300,\n    cellRenderer: 'TaxonRenderer',\n  },\n  {\n    field: 'levelName',\n    headerName: 'Level',\n    width: 150,\n    comparator: (valueA, valueB, nodeA: RowNode, nodeB: RowNode) =>\n      nodeA.data.levelRankOrder - nodeB.data.levelRankOrder,\n  },\n  {\n    field: 'lifeStageId',\n    headerName: 'Life Stage',\n    width: 150,\n    editable: true,\n    cellEditor: 'LifeStageEditor',\n    cellRenderer: 'LifeStageRenderer',\n    valueSetter: singleValueSetter,\n    cellClassRules: {\n      'DataGrid__cell--error': ({ value }: OrganismCellClassParams) => !value,\n    },\n    comparator: (valueA, valueB, nodeA: RowNode, nodeB: RowNode) =>\n      nodeA.data.lifeStageRankOrder - nodeB.data.lifeStageRankOrder,\n  },\n  {\n    field: 'splitCount',\n    width: 150,\n    editable: true,\n    cellEditor: 'NumberEditor',\n    cellRenderer: 'NumberRenderer',\n    type: 'numericColumn',\n    valueSetter: singleValueSetter,\n    cellClassRules: {\n      'DataGrid__cell--error': ({ data, value }: OrganismCellClassParams) => data.persistence === 'unsaved' && value,\n    },\n  },\n  {\n    field: 'bigRareCount',\n    width: 150,\n    editable: true,\n    cellEditor: 'NumberEditor',\n    cellRenderer: 'NumberRenderer',\n    type: 'numericColumn',\n    valueSetter: singleValueSetter,\n    cellClassRules: {\n      'DataGrid__cell--error': ({ data, value }: OrganismCellClassParams) => data.persistence === 'unsaved' && value,\n    },\n  },\n  {\n    field: 'bugSize',\n    headerName: 'Size',\n    width: 150,\n    editable: true,\n    cellEditor: 'NumberEditor',\n    cellEditorParams: {\n      precisionAllowed: 1,\n    },\n    cellRenderer: 'NumberRenderer',\n    type: 'numericColumn',\n    valueSetter: singleValueSetter,\n    cellClassRules: {\n      'DataGrid__cell--error': (params) => !params.value,\n    },\n  },\n  {\n    colId: 'notesAndComments',\n    headerName: 'Notes/Comments',\n    width: 150,\n    editable: true,\n    cellRenderer: 'NotesAndCommentsRenderer',\n    cellEditor: 'NotesAndCommentsEditor',\n    valueSetter: notesAndCommentsValueSetter,\n    flex: 1,\n    cellClassRules: {\n      'DataGrid__cell--error': ({ data }: OrganismCellClassParams) =>\n        data.persistence === 'unsaved' && (data.noteTypeIds.length > 0 || data.comments),\n    },\n  },\n  {\n    colId: 'actions',\n    width: 150,\n    cellRenderer: 'ActionsRenderer',\n    pinned: 'right',\n  },\n] as ColDef[]\n","import React from 'react'\nimport Button from '@mui/material/Button'\nimport Dialog from '@mui/material/Dialog'\nimport DialogActions from '@mui/material/DialogActions'\nimport DialogContent from '@mui/material/DialogContent'\nimport DialogTitle from '@mui/material/DialogTitle'\n\ninterface Props {\n  title?: React.ReactNode\n  isOpen: boolean\n  onClose: () => void\n  onConfirm: () => void\n  children?: React.ReactNode\n  confirmButtonLabel: string\n}\n\nexport const ConfirmDialog = ({\n  title,\n  isOpen,\n  onClose,\n  onConfirm,\n  children,\n  confirmButtonLabel,\n}: Props): JSX.Element => {\n  const handleClose = () => {\n    onClose()\n  }\n  const handleConfirm = () => {\n    onConfirm()\n    onClose()\n  }\n  return (\n    <Dialog open={isOpen} onClose={handleClose}>\n      {title && <DialogTitle>{title}</DialogTitle>}\n      {children && <DialogContent>{children}</DialogContent>}\n      <DialogActions>\n        <Button onClick={handleClose}>Cancel</Button>\n        <Button onClick={handleConfirm}>{confirmButtonLabel}</Button>\n      </DialogActions>\n    </Dialog>\n  )\n}\n","/** @jsxImportSource @emotion/react */\nimport React, { useState, useRef, useEffect } from 'react'\nimport Button from '@mui/material/Button'\nimport Dialog from '@mui/material/Dialog'\nimport DialogActions from '@mui/material/DialogActions'\nimport DialogContent from '@mui/material/DialogContent'\nimport DialogTitle from '@mui/material/DialogTitle'\n\nimport { NumberField } from '../NumberField'\n\ninterface TimeEntryDialogProps {\n  isOpen: boolean\n  onConfirm: (metrics: { time: number }) => void\n}\n\nexport const TimeEntryDialog = (props: TimeEntryDialogProps): JSX.Element => {\n  const { isOpen } = props\n  return (\n    <Dialog open={isOpen} disableEscapeKeyDown>\n      <DialogBody {...props} />\n    </Dialog>\n  )\n}\n\nconst DialogBody = ({ onConfirm }: TimeEntryDialogProps): JSX.Element => {\n  const [time, setTime] = useState<number | null>(null)\n  const inputRef = useRef<HTMLInputElement | null>(null)\n\n  const hasErrors = time === null\n\n  const handleConfirm = () => {\n    if (time !== null) onConfirm({ time })\n  }\n\n  useEffect(() => {\n    inputRef.current?.focus()\n  }, [inputRef.current])\n\n  return (\n    <>\n      <DialogTitle>Metrics</DialogTitle>\n      <DialogContent>\n        <div css={{ padding: '0.5em' }}>\n          <NumberField\n            inputRef={inputRef}\n            label=\"Hours\"\n            value={time}\n            onChange={setTime}\n            error={hasErrors}\n            min={0}\n            onKeyDown={(e) => {\n              if (e.key !== 'Enter') return\n              e.preventDefault()\n              handleConfirm()\n            }}\n          />\n        </div>\n      </DialogContent>\n      <DialogActions>\n        <Button disabled={time === null} onClick={handleConfirm}>\n          OK\n        </Button>\n      </DialogActions>\n    </>\n  )\n}\n","import React from 'react'\nimport MuiButton from '@mui/material/Button'\nimport EditIcon from '@mui/icons-material/Edit'\nimport StopIcon from '@mui/icons-material/Stop'\n\nimport { Sample } from '../../types'\nimport { ControllerActions, ReducerState } from './types'\nimport { withTooltip } from '../withTooltip'\n\ninterface ToggleEditModeButtonProps {\n  userId: number\n  sample: Sample\n  editMode: ReducerState['editMode']\n  actions: ControllerActions\n  canLeave: boolean\n}\n\nexport const ToggleEditModeButton = ({\n  userId,\n  sample,\n  editMode,\n  actions,\n  canLeave,\n}: ToggleEditModeButtonProps): JSX.Element | null => {\n  const error = (() => {\n    if (sample.boxState !== 'Active')\n      return 'The taxa for this sample cannot be edited because the box it is associated with is not currently active.'\n    if (!sample.sortEndDate) return 'The taxa for this sample cannot be edited because the box has not been sorted.'\n    if (sample.identificationStartDate && !sample.identificationEndDate && sample.identificationUserId !== userId)\n      return 'Taxonomic identification for this sample is already underway by another user.'\n  })()\n\n  if (error)\n    return withTooltip(\n      <MuiButton disabled variant=\"outlined\" startIcon={<EditIcon />}>\n        Start Identification\n      </MuiButton>,\n      error,\n      true\n    )\n\n  const isActive = editMode !== 'stopped' && editMode !== 'starting'\n\n  return (\n    <MuiButton\n      disabled={(editMode !== 'started' && editMode !== 'stopped') || !canLeave}\n      onClick={() => {\n        if (editMode === 'started') {\n          actions.stopTaxonomyIdentification()\n        } else {\n          actions.startTaxonomyIdentification()\n        }\n      }}\n      startIcon={isActive ? <StopIcon /> : <EditIcon />}\n      variant={isActive ? 'contained' : 'outlined'}\n    >\n      {isActive ? 'Stop Identification' : 'Start Identification'}\n    </MuiButton>\n  )\n}\n","/** @jsxImportSource @emotion/react */\nimport React, { useImperativeHandle, useEffect, forwardRef, useState, useRef } from 'react'\nimport { ICellRendererParams, ICellEditorParams } from 'ag-grid-community'\nimport AddIcon from '@mui/icons-material/AddCircleOutline'\nimport DeleteIcon from '@mui/icons-material/Delete'\nimport FilterAltIcon from '@mui/icons-material/FilterAlt'\nimport IconButton from '@mui/material/IconButton'\nimport CheckCircleOutlinedIcon from '@mui/icons-material/CheckCircleOutlined'\nimport ChangeCircleOutlinedIcon from '@mui/icons-material/ChangeCircleOutlined'\nimport CircleOutlinedIcon from '@mui/icons-material/CircleOutlined'\nimport ErrorOutlineIcon from '@mui/icons-material/ErrorOutline'\n\nimport { Badge } from '../Badge'\nimport { OrganismsDataGridContext, OrganismRow } from './types'\nimport { withTooltip } from '../withTooltip'\n\ninterface CellRendererParams<T> extends ICellRendererParams {\n  context: OrganismsDataGridContext\n  data: OrganismRow\n  value: T\n}\ninterface CellEditorParams<T> extends ICellEditorParams {\n  context: OrganismsDataGridContext\n  data: OrganismRow\n  value: T\n}\n\nexport const NumberEditor = forwardRef(\n  (\n    {\n      value: oldValue,\n      data: { canEdit },\n      precisionAllowed = 0,\n      negativeAllowed = false,\n    }: CellEditorParams<number> & { precisionAllowed: number; negativeAllowed?: boolean },\n    ref\n  ) => {\n    const [value, setValue] = useState(oldValue || '')\n    const inputRef = useRef<HTMLInputElement | null>(null)\n\n    useEffect(() => {\n      setTimeout(() => inputRef.current?.focus())\n    }, [])\n\n    useImperativeHandle(ref, () => {\n      return {\n        getValue: () => value || 0,\n        isCancelBeforeStart: () => !canEdit,\n        isCancelAfterEnd: () => false,\n        isPopup: () => false,\n      }\n    })\n\n    const handleChange = ({ target: { value: newValue } }: React.ChangeEvent<HTMLInputElement>) => {\n      const newNumber = Number(newValue)\n      if (Number(newNumber.toFixed(precisionAllowed)) !== newNumber) return\n      if (!negativeAllowed && newNumber < 0) return\n      setValue(newNumber)\n    }\n\n    return (\n      <input\n        // className=\"ag-input\"\n        type=\"number\"\n        ref={inputRef}\n        value={value}\n        onChange={handleChange}\n        style={{ width: '100%', textAlign: 'right' }}\n      />\n    )\n  }\n)\nNumberEditor.displayName = 'NumberEditor'\n\nexport const LifeStageEditor = forwardRef(\n  ({ value: oldValue, data: { allowedLifeStages, canEdit } }: CellEditorParams<number>, ref) => {\n    const [value, setValue] = useState(oldValue)\n    const [done, setDone] = useState(false)\n\n    const inputRef = useRef<HTMLSelectElement | null>(null)\n\n    const handleChange = ({ target: { value: newValue } }: React.ChangeEvent<HTMLSelectElement>) => {\n      setValue(Number(newValue))\n      setDone(true)\n    }\n    useEffect(() => {\n      if (!done) return\n      // api.stopEditing();\n    }, [done])\n\n    useEffect(() => {\n      setTimeout(() => inputRef.current?.focus())\n    }, [])\n\n    useImperativeHandle(ref, () => {\n      return {\n        getValue: () => Number(value),\n        isCancelBeforeStart: () => !canEdit || value,\n        isCancelAfterEnd: () => false,\n        isPopup: () => false,\n      }\n    })\n\n    const options = allowedLifeStages.map(({ id: value, name: label }) => ({ value, label }))\n\n    if (!value) options.unshift({ value: -1, label: '' })\n\n    return (\n      <select value={value} onChange={handleChange} ref={inputRef} style={{ width: '100%' }}>\n        {options.map(({ value, label }) => (\n          <option key={value} value={value}>\n            {label}\n          </option>\n        ))}\n      </select>\n    )\n  }\n)\nLifeStageEditor.displayName = 'LifeStageEditor'\n\nexport const LifeStageRenderer = ({ context, value }: CellRendererParams<number>): React.ReactNode => {\n  return context.lifeStages.find(({ id }) => value === id)?.name || ''\n}\n\nexport const NumberRenderer = ({ value }: CellRendererParams<number>): React.ReactNode => {\n  return value || ''\n}\n\nexport const TaxonRenderer = ({ value, data: { isTargetEffort } }: CellRendererParams<string>): React.ReactNode => {\n  return (\n    <span>\n      {value}\n      {isTargetEffort && (\n        <Badge\n          badgeColor=\"#bbb\"\n          tooltip=\"Taxon is at for below the SAFIT II required target effort\"\n          css={{ marginLeft: '0.5em' }}\n          label=\"S\"\n        />\n      )}\n    </span>\n  )\n}\n\nexport const NotesAndCommentsRenderer = ({\n  data: { noteTypeIds, comments },\n  context: { noteTypes },\n}: CellRendererParams<undefined>): React.ReactNode => {\n  return (\n    <div>\n      {noteTypeIds.map((noteTypeId) => {\n        const noteType = noteTypes.find(({ id }) => id === noteTypeId)\n        return (\n          <Badge\n            badgeColor=\"#cc7000\"\n            textColor=\"white\"\n            tooltip={noteType?.name || 'Unknown'}\n            css={{ marginRight: '0.2em' }}\n            key={noteTypeId}\n            label={noteType?.abbreviation || '?'}\n          />\n        )\n      })}\n      <span>{comments}</span>\n    </div>\n  )\n}\n\nexport const NotesAndCommentsEditor = forwardRef(\n  (\n    {\n      data: { noteTypeIds: oldNoteTypeIds, comments: oldComments, canEdit },\n      context: { noteTypes },\n    }: CellEditorParams<undefined>,\n    ref\n  ) => {\n    const [noteTypeIds, setNoteTypeIds] = useState(oldNoteTypeIds)\n    const [comments, setComments] = useState(oldComments)\n\n    const inputRef = useRef<HTMLTextAreaElement | null>(null)\n\n    useEffect(() => {\n      setTimeout(() => inputRef.current?.focus())\n    }, [])\n\n    useImperativeHandle(ref, () => {\n      return {\n        getValue: () => ({\n          noteTypeIds,\n          comments,\n        }),\n        isCancelBeforeStart: () => !canEdit,\n        isCancelAfterEnd: () => false,\n        isPopup: () => true,\n      }\n    })\n\n    // TODO: limit to active note types\n\n    return (\n      <div css={{ minWidth: '20em' }}>\n        <textarea\n          ref={inputRef}\n          value={comments}\n          onChange={(event) => setComments(event.target.value)}\n          css={{ width: '95%', height: '3em', fontFamily: 'Roboto' }}\n        />\n        <div>\n          {noteTypes.map(({ id, name, abbreviation }) => (\n            <div key={id} css={{ margin: '0.2em 0' }}>\n              <input\n                type=\"checkbox\"\n                checked={noteTypeIds.includes(id)}\n                onChange={(e) => {\n                  if (e.target.checked) {\n                    setNoteTypeIds(() => [...noteTypeIds, id])\n                  } else {\n                    setNoteTypeIds(() => noteTypeIds.filter((noteTypeId) => noteTypeId !== id))\n                  }\n                }}\n              />\n              (<span css={{ fontWeight: 'bold' }}>{abbreviation}</span>) - {name}\n            </div>\n          ))}\n        </div>\n      </div>\n    )\n  }\n)\nNotesAndCommentsEditor.displayName = 'NotesAndCommentsEditor'\n\nexport const ActionsRenderer = ({\n  data: organismRow,\n  context: { actions, setDeletionCandidateOrganism },\n}: CellRendererParams<OrganismRow>): React.ReactNode => {\n  const { splitCount, bigRareCount, noteTypeIds, comments, canDuplicate, canFilter, canDelete, persistence } =\n    organismRow\n  return (\n    <div css={{ display: 'flex', alignItems: 'center', height: '100%' }}>\n      <IconButton\n        disabled={!canDuplicate}\n        onClick={() => {\n          actions.duplicateOrganism(organismRow)\n        }}\n      >\n        {withTooltip(<AddIcon />, 'Create a similar organism record')}\n      </IconButton>\n      <IconButton\n        disabled={!canFilter}\n        onClick={() => {\n          actions.createFilter(organismRow)\n        }}\n      >\n        {withTooltip(<FilterAltIcon />, 'Filter by this taxonomy')}\n      </IconButton>\n      <IconButton\n        disabled={!canDelete}\n        onClick={() => {\n          if (persistence !== 'saved' && !splitCount && !bigRareCount && noteTypeIds.length === 0 && !comments) {\n            actions.deleteOrganism(organismRow)\n          } else {\n            setDeletionCandidateOrganism(organismRow)\n          }\n        }}\n      >\n        {withTooltip(<DeleteIcon />, 'Delete this organism record')}\n      </IconButton>\n    </div>\n  )\n}\n\nexport const PersistenceRenderer = ({ value }: CellRendererParams<OrganismRow['persistence']>): React.ReactNode => {\n  return (\n    <div css={{ display: 'flex', alignItems: 'center', height: '100%' }}>\n      {(() => {\n        switch (value) {\n          case 'unsaved':\n            return withTooltip(<CircleOutlinedIcon />, 'Record is not ready to be saved to database.')\n          case 'saving':\n            return withTooltip(<ChangeCircleOutlinedIcon />, 'Record is saving to database...')\n          case 'saved':\n            return withTooltip(<CheckCircleOutlinedIcon />, 'Record is saved in database.')\n          case 'error':\n            return withTooltip(\n              <ErrorOutlineIcon css={{ path: { fill: 'red' } }} />,\n              'Record had an error saving or deleting.'\n            )\n        }\n        return null\n      })()}\n    </div>\n  )\n}\n","/** @jsxImportSource @emotion/react */\nimport React from 'react'\nimport Skeleton from '@mui/material/Skeleton'\n\nexport const Fallback = (): JSX.Element => (\n  <div css={{ height: '100%', display: 'flex', flexDirection: 'column', gap: '1em' }}>\n    <Skeleton height=\"9em\" variant=\"rectangular\" />\n    <Skeleton height=\"3em\" variant=\"rectangular\" />\n  </div>\n)\n","/** @jsxImportSource @emotion/react */\nimport React, { useMemo, useRef, useState, useEffect, useCallback } from 'react'\nimport { useRecoilValue } from 'recoil'\nimport { useHotkeys } from 'react-hotkeys-hook'\nimport MuiChip from '@mui/material/Chip'\nimport { GrantAction, NAMCResource } from '@namcbugdb/common'\n\nimport { DataGrid, DataGridApis, DataGridRecordCount } from '../DataGrid'\nimport { TaxonomyField, AddableTaxonOption } from '../TaxonomyField'\nimport { Taxon, Sample } from '../../types'\nimport { OrganismsDataGridContext, OrganismRow } from './types'\nimport { useComponentController } from './componentController'\nimport { organismsColumnDefs } from './columnDefs'\nimport { SampleInfoPanel } from '../SampleInfoPanel'\nimport { ConfirmDialog } from '../ConfirmDialog'\nimport { TimeEntryDialog } from './TimeEntryDialog'\nimport { ToggleEditModeButton } from './ToggleEditModeButton'\nimport { ConfirmNavigateAway } from '../AppRouter'\nimport * as renderers from './renderers'\nimport { selectTaxa, selectLifeStages, selectNoteTypes, selectMyUser } from '../../data/selectors'\nimport { withSuspense } from '../withSuspense'\nimport { Fallback } from './Fallback'\n\nexport interface SampleTaxonomyIdentificationProps {\n  sample: Sample\n}\n\nconst gridOptions = {\n  stopEditingWhenCellsLoseFocus: true,\n  suppressCellSelection: false,\n}\n\nexport const SampleTaxonomyIdentification = withSuspense(\n  ({ sample }: SampleTaxonomyIdentificationProps): JSX.Element => {\n    const taxa = useRecoilValue(selectTaxa)\n    const lifeStages = useRecoilValue(selectLifeStages)\n    const noteTypes = useRecoilValue(selectNoteTypes)\n    const user = useRecoilValue(selectMyUser)\n\n    // STATE AND REFS\n\n    const [state, actions] = useComponentController()\n    const { organisms, organismFilters, editMode, scrollToRowId } = state\n    const { measurements } = state.sample || {}\n    const isEditing = editMode === 'started'\n\n    const [deletionCanddateOrganism, setDeletionCandidateOrganism] = useState<OrganismRow | null>(null)\n    const [gridApis, setGridApis] = useState<DataGridApis>()\n\n    const inputRef = useRef<HTMLInputElement | null>(null)\n\n    // EFFECTS\n\n    useEffect(() => {\n      actions.reset({ sample, user })\n    }, [sample, user])\n\n    useEffect(() => {\n      if (!gridApis) return\n      gridApis.columnApi.setColumnVisible('bugSize', !!measurements)\n    }, [gridApis, measurements])\n\n    useEffect(() => {\n      if (!gridApis) return\n      gridApis.columnApi.setColumnVisible('persistence', isEditing)\n    }, [gridApis, isEditing])\n\n    useEffect(() => {\n      if (!gridApis || !scrollToRowId) return\n      window.setTimeout(() => {\n        gridApis.api.ensureNodeVisible(({ data: { rowId } }) => rowId === scrollToRowId)\n      })\n      actions.setScrollToRowId(null)\n    }, [gridApis, scrollToRowId, actions.setScrollToRowId])\n\n    // DATA GRID CONTEXT\n\n    const context = useMemo<OrganismsDataGridContext>(\n      () => ({\n        lifeStages,\n        noteTypes,\n        actions,\n        setDeletionCandidateOrganism,\n      }),\n      [lifeStages, noteTypes, actions]\n    )\n\n    // ROWS\n\n    const getTaxonById = useCallback((taxonId: number) => taxa.find(({ id }) => id === taxonId), [taxa])\n\n    const organismFilterTaxons = useMemo<Taxon[]>(\n      () =>\n        organismFilters.reduce<Taxon[]>((acc, { taxonId }) => {\n          const taxon = getTaxonById(taxonId)\n          if (!taxon) return acc\n          return [...acc, taxon]\n        }, []),\n      [organismFilters, getTaxonById]\n    )\n\n    const filterTaxonIds = useMemo<number[] | null>(() => {\n      if (organismFilterTaxons.length === 0) return null\n      return organismFilterTaxons.reduce(\n        (acc, { id, descendantIds }) => [...acc, id, ...(descendantIds || [])],\n        [] as number[]\n      )\n    }, [organismFilterTaxons])\n\n    const rows = useMemo<OrganismRow[]>(() => {\n      const filteredOrganisms = filterTaxonIds\n        ? organisms.filter(({ taxonId }) => filterTaxonIds.includes(taxonId))\n        : organisms\n\n      const activeLifeStages = lifeStages.filter(({ isActive }) => isActive)\n\n      return filteredOrganisms\n        .filter((organism) => organism.persistence !== 'deleting')\n        .map((organism) => {\n          const taxon = getTaxonById(organism.taxonId)\n\n          // computed\n          const taxonName = taxon?.name || '?'\n          const levelName = taxon?.levelName || '?'\n          const levelRankOrder = taxon?.levelRankOrder ?? -1\n          const lifeStageRankOrder = lifeStages.find(({ id }) => id === organism.lifeStageId)?.rankOrder ?? 0\n          const isTargetEffort = taxon?.isTargetEffort ?? false\n\n          // row permissions/options\n          const canDuplicate =\n            isEditing &&\n            (sample.measurements ||\n              organisms.filter(({ taxonId }) => taxonId === organism.taxonId).length < activeLifeStages.length)\n          const canFilter = !organismFilters.find(({ taxonId }) => taxonId === organism.taxonId)\n          const canDelete = isEditing\n          const canEdit = isEditing\n          const usedLifeStageIds = organisms\n            .filter(({ id, taxonId }) => taxonId === organism.taxonId && id !== organism.id)\n            .map(({ lifeStageId }) => lifeStageId)\n          const allowedLifeStages = activeLifeStages.filter(({ id }) => !usedLifeStageIds.includes(id))\n\n          return {\n            ...organism,\n            taxonName,\n            levelName,\n            levelRankOrder,\n            lifeStageRankOrder,\n            isTargetEffort,\n            canDuplicate,\n            canFilter,\n            canDelete,\n            canEdit,\n            allowedLifeStages,\n          }\n        })\n    }, [getTaxonById, filterTaxonIds, organisms, organismFilters, lifeStages, isEditing])\n\n    // UI OPTIONS\n\n    const taxonOptions = useMemo<AddableTaxonOption[]>(() => {\n      const organismTaxonIds = organisms.map(({ taxonId }) => taxonId)\n      const added = taxa\n        .filter((taxon) => organismTaxonIds.includes(taxon.id))\n        .map((taxon) => ({ ...taxon, status: 'in' as const }))\n      const available = taxa\n        .filter((taxon) => !organismTaxonIds.includes(taxon.id))\n        .map((taxon) => ({ ...taxon, status: 'notIn' as const }))\n      return [...added, ...available].map((taxonOption) => ({\n        ...taxonOption,\n        canAdd: isEditing,\n        canFilter: true,\n        defaultAction: isEditing ? 'add' : 'filter',\n      }))\n    }, [taxa, organisms, isEditing])\n\n    // HOTKEYS\n\n    useHotkeys('/', (e) => {\n      e.preventDefault()\n      e.stopPropagation()\n      inputRef.current?.focus()\n    })\n\n    // RENDER\n\n    const canIdentify = user.hasPermission(NAMCResource.organisms, GrantAction.createAny)\n    const canLeave = rows.every(({ persistence }) => persistence === 'unsaved' || persistence === 'saved')\n\n    return (\n      <>\n        <div css={{ height: '100%', display: 'flex', flexDirection: 'column' }}>\n          {state.sample && (\n            <SampleInfoPanel\n              sample={state.sample}\n              actions={\n                canIdentify && (\n                  <ToggleEditModeButton\n                    userId={user.id}\n                    sample={state.sample}\n                    actions={actions}\n                    editMode={state.editMode}\n                    canLeave={canLeave}\n                  />\n                )\n              }\n            />\n          )}\n          <div>\n            <TaxonomyField\n              inputRef={inputRef}\n              options={taxonOptions}\n              onAddOrganism={(taxon) => {\n                actions.createOrganism({\n                  taxonId: taxon.id,\n                })\n                if (filterTaxonIds && !filterTaxonIds.includes(taxon.id)) actions.createFilter({ taxonId: taxon.id })\n              }}\n              onAddFilter={(taxon) => actions.createFilter({ taxonId: taxon.id })}\n            />\n          </div>\n          <div css={{ minHeight: '2em', marginTop: '0.75em', display: 'flex' }}>\n            <div css={{ flex: 1 }}>\n              {organismFilters.length === 0 && (\n                <MuiChip sx={{ margin: '0.2em' }} label=\"No filters\" variant=\"outlined\" />\n              )}\n              {organismFilters.map((organismFilter) => {\n                const taxon = getTaxonById(organismFilter.taxonId)\n                return (\n                  <MuiChip\n                    key={taxon?.id}\n                    sx={{ margin: '0.2em', backgroundColor: 'lightblue' }}\n                    label={`${taxon?.levelName}: ${taxon?.name}`}\n                    onDelete={() => actions.deleteFilter(organismFilter)}\n                  />\n                )\n              })}\n            </div>\n            <DataGridRecordCount total={organisms.length} visible={rows.length} descriptor=\"organism record\" />\n          </div>\n          <div css={{ flex: 1 }}>\n            <DataGrid<OrganismRow>\n              rows={rows}\n              rowIdProperty=\"rowId\"\n              columnDefs={organismsColumnDefs}\n              frameworkComponents={renderers}\n              context={context}\n              gridOptions={gridOptions}\n              onGridApisReady={setGridApis}\n            />\n          </div>\n        </div>\n        <ConfirmDialog\n          title=\"Delete organism record?\"\n          isOpen={!!deletionCanddateOrganism}\n          onClose={() => setDeletionCandidateOrganism(null)}\n          onConfirm={() => {\n            if (!deletionCanddateOrganism) return\n            actions.deleteOrganism(deletionCanddateOrganism)\n          }}\n          confirmButtonLabel=\"Delete\"\n        ></ConfirmDialog>\n        <TimeEntryDialog\n          isOpen={editMode === 'stoppingPrompt'}\n          onConfirm={({ time }) => {\n            actions.finishTaxonomyIdentification({ time })\n          }}\n        />\n        {!canLeave && (\n          <ConfirmNavigateAway message=\"Some data hasn't finished saving or deleting. Are you sure you want to leave?\" />\n        )}\n      </>\n    )\n  },\n  Fallback\n)\n","import React from 'react'\nimport { useRecoilValue } from 'recoil'\n\nimport { selectSampleById } from '../../data/selectors'\nimport { SampleTaxonomyIdentification as Component } from './SampleTaxonomyIdentification'\nimport { Fallback } from './Fallback'\nimport { withSuspense } from '../withSuspense'\n\nexport interface SampleTaxonomyIdentificationProps {\n  sampleId: string | number\n}\n\nexport const SampleTaxonomyIdentification = withSuspense(\n  ({ sampleId }: SampleTaxonomyIdentificationProps): JSX.Element => {\n    const sample = useRecoilValue(selectSampleById(Number(sampleId)))\n\n    if (sample === null) return <h2>Sample {sampleId} not found.</h2>\n\n    return <Component sample={sample} />\n  },\n  Fallback\n)\n","/** @jsxImportSource @emotion/react */\nimport React, { useState, useRef } from 'react'\nimport MuiTextField from '@mui/material/TextField'\nimport { useHotkeys } from 'react-hotkeys-hook'\n\nimport { useNavigate } from '../AppRouter'\n\nexport interface QuickNavigateFieldProps {\n  className?: string\n}\n\nexport const QuickNavigateField = ({ className }: QuickNavigateFieldProps): JSX.Element => {\n  const navigate = useNavigate()\n\n  const inputRef = useRef<HTMLInputElement | null>(null)\n  const [value, setValue] = useState('')\n\n  const handleKeyDown = ({ key }: React.KeyboardEvent<HTMLInputElement>): void => {\n    switch (key) {\n      case 'Enter': {\n        const trimmedValue = value.trim()\n        if (!trimmedValue.match(/^\\d+$/)) return\n        setValue('')\n        navigate.sampleOverview({ sampleId: Number(trimmedValue) })\n        break\n      }\n      case 'Escape': {\n        setValue('')\n        inputRef.current?.blur()\n      }\n    }\n  }\n\n  useHotkeys('cmd+o, ctrl+o', (e) => {\n    e.preventDefault()\n    e.stopPropagation()\n    inputRef.current?.focus()\n  })\n\n  return (\n    <MuiTextField\n      className={className}\n      size=\"small\"\n      value={value}\n      onChange={({ target: { value: newValue } }) => setValue(newValue)}\n      InputProps={{\n        onKeyDown: handleKeyDown,\n      }}\n      inputRef={inputRef}\n      placeholder=\"Quick Open\"\n    />\n  )\n}\n","export const isStagingApi = process.env.REACT_APP_GRAPHQL && process.env.REACT_APP_GRAPHQL.includes('/staging/api')\n\nexport const isLocalhost = location.hostname === 'localhost'\n\nexport const isDev = process.env.NODE_ENV && process.env.NODE_ENV === 'development'\n\nexport const appVersion = process.env.REACT_APP_VERSION\n","/** @jsxImportSource @emotion/react */\nimport React, { useEffect } from 'react'\nimport { useRecoilValue } from 'recoil'\nimport IconButton from '@mui/material/IconButton'\nimport MenuIcon from '@mui/icons-material/Menu'\n\nimport { QuickNavigateField } from '../QuickNavigateField'\nimport { isLocalhost, isStagingApi } from '../../lib/environment'\nimport { selectHasUser } from '../../data/selectors'\n\nexport interface AppHeaderProps {\n  openNavigation: () => void\n}\n\nexport const AppHeader = ({ openNavigation }: AppHeaderProps): JSX.Element => {\n  const hasUser = useRecoilValue(selectHasUser)\n\n  useEffect(() => {\n    if (isLocalhost) {\n      document.title = `${document.title} (local)`\n    } else if (isStagingApi) {\n      document.title = `${document.title} (staging)`\n    }\n  }, [])\n\n  const conditionalVisibility = hasUser ? 'visible' : 'hidden'\n\n  return (\n    <header\n      css={{\n        height: '3em',\n        background: '#064270',\n        color: 'white',\n        display: 'flex',\n        alignItems: 'center',\n        padding: '0 0.5em',\n      }}\n    >\n      <IconButton onClick={openNavigation}>\n        <MenuIcon sx={{ fill: 'white' }} />\n      </IconButton>\n      <h1 css={{ fontWeight: 500, letterSpacing: '0.05em', fontSize: '200%' }}>\n        INSTAR\n        {isStagingApi && <span css={{ color: 'yellow' }}> STAGING</span>}\n      </h1>\n\n      <div css={{ margin: '0 0.25em 0 auto', visibility: conditionalVisibility }}>\n        <QuickNavigateField css={{ '.MuiInputBase-root': { background: 'white' } }} />\n      </div>\n    </header>\n  )\n}\n","/** @jsxImportSource @emotion/react */\nimport React, { Suspense } from 'react'\nimport { useRecoilValue } from 'recoil'\nimport AccountCircleIcon from '@mui/icons-material/AccountCircle'\nimport Skeleton from '@mui/material/Skeleton'\n\nimport { selectMyUser } from '../../data/selectors'\n\nconst Connector = (): JSX.Element => {\n  const user = useRecoilValue(selectMyUser)\n\n  return (\n    <>\n      <AccountCircleIcon /> {user.fullName}\n    </>\n  )\n}\n\nconst Fallback = (): JSX.Element => (\n  <>\n    <Skeleton variant=\"circular\" width={25} />\n    <Skeleton variant=\"text\" width={120} />\n  </>\n)\n\nexport const UserName = (): JSX.Element => (\n  <div css={{ display: 'flex', alignItems: 'center', justifyContent: 'center', height: '3em' }}>\n    <Suspense fallback={<Fallback />}>\n      <Connector />\n    </Suspense>\n  </div>\n)\n","/** @jsxImportSource @emotion/react */\nimport React from 'react'\nimport { useRecoilValue } from 'recoil'\nimport { noop, times } from 'lodash'\nimport MuiDrawer from '@mui/material/Drawer'\nimport Skeleton from '@mui/material/Skeleton'\nimport { GrantAction, NAMCResource } from '@namcbugdb/common'\n\nimport { UserName } from './UserName'\nimport { useApi } from '../../data/api'\nimport { useNavigate } from '../AppRouter'\nimport { withSuspense } from '../withSuspense'\nimport { selectHasUser, selectMyUser } from '../../data/selectors'\nimport { appVersion } from '../../lib/environment'\n\nexport interface SideNavBarProps {\n  className?: string\n  isOpen: boolean\n  onClose: () => void\n}\n\nconst CenteredDiv = (props) => (\n  <div css={{ display: 'flex', alignItems: 'center', flexDirection: 'column' }} {...props} />\n)\n\nconst Links = withSuspense<{ onClose: () => void }>(\n  ({ onClose }) => {\n    const navigate = useNavigate()\n    const user = useRecoilValue(selectMyUser)\n\n    const links = [\n      {\n        label: 'Boxes',\n        onClick: () => navigate.boxes(),\n        visible: user.hasPermission(NAMCResource.boxes, GrantAction.readOwn),\n      },\n      {\n        label: 'Sites',\n        onClick: () => navigate.sites(),\n        visible: user.hasPermission(NAMCResource.sites, GrantAction.readAny),\n      },\n      {\n        label: 'Customers',\n        onClick: noop,\n        disabled: true,\n        visible: user.hasPermission(NAMCResource.organizations, GrantAction.readAny),\n      },\n      {\n        label: 'Projects',\n        onClick: () => navigate.projects(),\n        visible: user.hasPermission(NAMCResource.projects, GrantAction.readAny),\n      },\n      {\n        label: 'Taxonomy',\n        onClick: noop,\n        disabled: true,\n        visible: user.hasPermission(NAMCResource.taxonomy, GrantAction.readAny),\n      },\n      {\n        label: 'Models',\n        onClick: () => navigate.models(),\n        visible: user.hasPermission(NAMCResource.models, GrantAction.readAny),\n      },\n      {\n        label: 'Predictors',\n        onClick: () => navigate.predictors(),\n        visible: user.hasPermission(NAMCResource.models, GrantAction.readAny),\n      },\n      {\n        label: 'Translations',\n        onClick: () => navigate.translations(),\n        visible: user.hasPermission(NAMCResource.translations, GrantAction.readAny),\n      },\n      {\n        label: 'Metrics',\n        onClick: noop,\n        disabled: true,\n        visible: user.hasPermission(NAMCResource.metrics, GrantAction.readAny),\n      },\n      {\n        label: 'Billing',\n        onClick: noop,\n        disabled: true,\n        visible: user.hasPermission(NAMCResource.billing, GrantAction.readAny),\n      },\n      {\n        label: 'Users',\n        onClick: () => navigate.users(),\n        visible: user.hasPermission(NAMCResource.individuals, GrantAction.readAny),\n      },\n    ]\n\n    return (\n      <>\n        {links\n          .filter(({ visible }) => visible)\n          .map(({ label, onClick, disabled }) =>\n            disabled ? (\n              <span key={label} css={{ opacity: 0.5 }}>\n                {label}\n              </span>\n            ) : (\n              <a\n                key={label}\n                onClick={() => {\n                  onClick()\n                  onClose()\n                }}\n              >\n                {label}\n              </a>\n            )\n          )}\n      </>\n    )\n  },\n  () => (\n    <>\n      {times(10).map((i) => (\n        <Skeleton key={i} width=\"8em\" />\n      ))}\n    </>\n  )\n)\n\nexport const SideNavBar = ({ className, isOpen, onClose }: SideNavBarProps): JSX.Element => {\n  const api = useApi()\n  const navigate = useNavigate()\n  const hasUser = useRecoilValue(selectHasUser)\n\n  return (\n    <MuiDrawer anchor=\"left\" open={isOpen} onClose={() => onClose()} className={className}>\n      <CenteredDiv css={{ minWidth: '20em', height: '100%' }}>\n        <UserName />\n        <div css={{ display: 'flex', gap: '1em' }}>\n          {hasUser && (\n            <a\n              onClick={() => {\n                navigate.profile()\n                onClose()\n              }}\n            >\n              Profile\n            </a>\n          )}\n          <a\n            onClick={() => {\n              api.signOut()\n            }}\n          >\n            Sign Out\n          </a>\n        </div>\n        <div css={{ marginTop: '2em', fontSize: '125%', display: 'flex', flexDirection: 'column', gap: '1em' }}>\n          <Links onClose={onClose} />\n        </div>\n        <CenteredDiv\n          css={{\n            marginTop: 'auto',\n            padding: '1em 0',\n            gap: '0.25em',\n          }}\n        >\n          <span>v{appVersion}</span>\n          <a href=\"https://github.com/namc-utah/namc-bug-db/issues/new\" target=\"_blank\" rel=\"noreferrer\">\n            Report Issue\n          </a>\n        </CenteredDiv>\n      </CenteredDiv>\n    </MuiDrawer>\n  )\n}\n","/** @jsxImportSource @emotion/react */\nimport React from 'react'\nimport { atom, useRecoilState } from 'recoil'\n\nimport { SideNavBar as Component } from './SideNavBar'\n\nexport const isNavigationOpenState = atom<boolean>({\n  key: 'isNavigationOpen',\n  default: false,\n})\n\nexport const SideNavBar = (): JSX.Element => {\n  const [isOpen, setIsOpen] = useRecoilState(isNavigationOpenState)\n\n  return (\n    <Component\n      isOpen={isOpen}\n      onClose={() => {\n        setIsOpen(false)\n      }}\n    />\n  )\n}\n","import React from 'react'\n\nimport { AppHeader as Component } from './AppHeader'\nimport { isNavigationOpenState } from '../SideNavBar'\nimport { useSetRecoilState } from 'recoil'\n\nexport const AppHeader = (): JSX.Element => {\n  const setIsNavigationOpen = useSetRecoilState(isNavigationOpenState)\n\n  return (\n    <Component\n      openNavigation={() => {\n        setIsNavigationOpen(true)\n      }}\n    />\n  )\n}\n","/* eslint-disable react/prop-types */\nimport React from 'react'\n\ninterface ErrorBoundaryProps {\n  children: React.ReactNode\n}\n\ninterface ErrorState {\n  hasError: boolean\n  message: string\n}\n\nexport class ErrorBoundary extends React.Component {\n  state: ErrorState\n\n  constructor(props: ErrorBoundaryProps) {\n    super(props)\n    this.state = { hasError: false, message: '' }\n  }\n\n  static getDerivedStateFromError(error: Error): ErrorState {\n    return { hasError: true, message: error.toString() }\n  }\n\n  // componentDidCatch(error, errorInfo) {\n  // You can also log the error to an error reporting service\n  // logErrorToMyService(error, errorInfo)\n  // }\n\n  render(): React.ReactNode {\n    if (this.state.hasError) {\n      // You can render any custom fallback UI\n      return (\n        <div>\n          <h1>An error has occurred.</h1>\n          <div>{this.state.message}</div>\n        </div>\n      )\n    }\n\n    return this.props.children\n  }\n}\n","import { ColDef } from 'ag-grid-community'\nimport { columnDef } from '../DataGrid'\n\nexport const modelsColumnDefs = [\n  columnDef.textColumn({\n    headerName: 'Model ID',\n    field: 'id',\n    width: 120,\n  }),\n  columnDef.textColumn({\n    field: 'abbreviation',\n    flex: 1,\n  }),\n  columnDef.textColumn({\n    field: 'name',\n    flex: 2,\n  }),\n  columnDef.textColumn({\n    headerName: 'Type',\n    field: 'typeName',\n    flex: 1,\n  }),\n  columnDef.textColumn({\n    field: 'translationName',\n    flex: 1,\n  }),\n  columnDef.numberColumn({\n    field: 'fixedCount',\n    width: 140,\n  }),\n  columnDef.booleanColumn({\n    headerName: 'Active',\n    field: 'isActive',\n    valueLabels: ['No', 'Yes'],\n    width: 100,\n  }),\n  columnDef.numberColumn({\n    field: 'predictorCount',\n    width: 140,\n  }),\n] as ColDef[]\n","/** @jsxImportSource @emotion/react */\nimport React from 'react'\nimport { useRecoilValue } from 'recoil'\nimport Skeleton from '@mui/material/Skeleton'\n\nimport { selectModels } from '../../data/selectors'\nimport { DataGrid } from '../DataGrid'\nimport { Model } from '../../types'\nimport { withSuspense } from '../withSuspense'\nimport { modelsColumnDefs } from './columnDefs'\nimport { Title } from '../Title'\n\nexport const ModelsListing = withSuspense(\n  () => {\n    const models = useRecoilValue(selectModels)\n    return (\n      <div css={{ height: '100%', display: 'flex', flexDirection: 'column' }}>\n        <div css={{ flex: 1 }}>\n          <Title>Models</Title>\n          <DataGrid<Model> rows={models} columnDefs={modelsColumnDefs} />\n        </div>\n      </div>\n    )\n  },\n  () => <Skeleton height=\"20em\" />\n)\n","import { ColDef } from 'ag-grid-community'\nimport { columnDef } from '../DataGrid'\n\nexport const predictorsColumnDefs = [\n  columnDef.textColumn({\n    headerName: 'Predictor ID',\n    field: 'id',\n    width: 120,\n  }),\n  columnDef.textColumn({\n    field: 'abbreviation',\n    flex: 1,\n  }),\n  columnDef.textColumn({\n    field: 'name',\n    flex: 3,\n  }),\n  columnDef.textColumn({\n    field: 'units',\n    width: 150,\n  }),\n  columnDef.booleanColumn({\n    field: 'isTemporal',\n    valueLabels: ['No', 'Yes'],\n    width: 120,\n  }),\n  columnDef.numberColumn({\n    field: 'modelCount',\n    width: 120,\n  }),\n  columnDef.textColumn({\n    field: 'type',\n    width: 180,\n  }),\n] as ColDef[]\n","/** @jsxImportSource @emotion/react */\nimport React from 'react'\nimport { useRecoilValue } from 'recoil'\nimport Skeleton from '@mui/material/Skeleton'\n\nimport { selectPredictors } from '../../data/selectors'\nimport { DataGrid } from '../DataGrid'\nimport { Predictor } from '../../types'\nimport { withSuspense } from '../withSuspense'\nimport { predictorsColumnDefs } from './columnDefs'\nimport { Title } from '../Title'\n\nexport const PredictorsListing = withSuspense(\n  () => {\n    const predictors = useRecoilValue(selectPredictors)\n    return (\n      <div css={{ height: '100%', display: 'flex', flexDirection: 'column' }}>\n        <div css={{ flex: 1 }}>\n          <Title>Predictors</Title>\n          <DataGrid<Predictor> rows={predictors} columnDefs={predictorsColumnDefs} />\n        </div>\n      </div>\n    )\n  },\n  () => <Skeleton height=\"20em\" />\n)\n","import dayjs from 'dayjs'\nimport utc from 'dayjs/plugin/utc'\n\nimport { ListName } from '../schema/templateSchema'\nimport { CellProcessor } from '../types'\nimport { KnownError } from './excel'\n\ndayjs.extend(utc)\n\nexport const isRequired: CellProcessor = (cell) => {\n  if (cell.value === undefined || cell.value === null) throw new KnownError({ message: 'Cell is required' })\n}\n\nexport const isNumber: CellProcessor = (cell) => {\n  if (!cell.value) return\n  if (typeof cell.value !== 'number') throw new KnownError({ message: 'Cell must be a number' })\n}\n\nexport const isWholeNumber: CellProcessor = (cell, config) => {\n  if (!cell.value) return\n  isNumber(cell, config)\n  if (cell.value !== Math.trunc(Number(cell.value))) throw new KnownError({ message: 'Cell must be a whole number' })\n}\n\nexport const isNumberBetween =\n  (min: number, max: number): CellProcessor =>\n  (cell, config) => {\n    if (!cell.value) return\n    isNumber(cell, config)\n    if (cell.value < min || cell.value > max)\n      throw new KnownError({ message: `Cell must be a number between ${min} and ${max}` })\n  }\n\nexport const isPositiveNumber: CellProcessor = (cell, config) => {\n  if (!cell.value) return\n  isNumber(cell, config)\n  if (cell.value <= 0) throw new KnownError({ message: `Cell must be a number greater than 0` })\n}\n\nexport const isPercent: CellProcessor = (cell, config) => {\n  if (!cell.value) return\n  isNumber(cell, config)\n  if (cell.value < 0 || cell.value > 1) throw new KnownError({ message: `Cell must be a percentage` })\n}\n\nexport const isInList =\n  (listName: ListName): CellProcessor =>\n  (cell, config) => {\n    if (!cell.value) return\n    if (!config?.lists[listName]) throw new Error(`Missing lookup list \"${listName}\"`)\n    const list = config.lists[listName]\n    if (!list.values.map((v) => v.toLowerCase()).includes(String(cell.value).toLowerCase()))\n      throw new KnownError({ message: `Cell must be a valid ${list.descriptor}` })\n  }\n\nexport const isAcceptableDate: CellProcessor = (cell) => {\n  const MIN_DATE = '2000-01-01'\n  if (!cell.value) return\n  if (!(cell.value instanceof Date)) throw new KnownError({ message: 'Cell must be a date' })\n  if (dayjs(cell.value).isBefore(MIN_DATE)) throw new KnownError({ message: `Cell must be a date after ${MIN_DATE}` })\n}\n\nexport const toShortDateString: CellProcessor = (cell) => {\n  if (!cell.value) return\n  if (!(cell.value instanceof Date)) throw new KnownError({ message: 'Cell must be a date' })\n  cell.value = dayjs.utc(cell.value).format('YYYY-MM-DD')\n}\n\nexport const toString: CellProcessor = (cell) => {\n  cell.value = cell.value && String(cell.value)\n}\n\nexport const divideBy100: CellProcessor = (cell, config) => {\n  if (!cell.value) return\n  isNumber(cell, config)\n  if (typeof cell.value !== 'number') return\n  cell.value = cell.value / 100\n}\n\nexport const isReadable: CellProcessor = (cell) => {\n  if (\n    !(\n      typeof cell.value === 'string' ||\n      typeof cell.value === 'number' ||\n      typeof cell.value === 'boolean' ||\n      typeof cell.value === 'undefined' ||\n      cell.value instanceof Date ||\n      cell.value === null\n    )\n  )\n    throw new KnownError({ message: 'Cell must be a simple value (e.g. no formulas)' })\n}\n\nexport const trimIfString: CellProcessor = (cell) => {\n  if (typeof cell.value !== 'string') return\n  cell.value = cell.value.trim() || null // also force trimmed-to-empty string to become null\n}\n","import { SampleProcessor } from '../types'\nimport { fetchUsStateAtCoordinates } from '../../../data/calls'\n\nexport const setLiteralValue = (value: string | number | boolean): SampleProcessor => {\n  const processor: SampleProcessor = async ({ sample, fieldName }) => {\n    if (typeof fieldName !== 'string') return\n    sample[fieldName] = value\n  }\n  processor.isSamplePostProcessor = true as const\n  return processor\n}\n\nexport const split = (separator: string, fieldName1: string, fieldName2: string): SampleProcessor => {\n  const processor: SampleProcessor = async ({ sample, fieldName }) => {\n    if (typeof fieldName !== 'string') return\n    const fieldValue = sample[fieldName]\n    if (typeof fieldValue !== 'string') return\n\n    const [part1, part2] = fieldValue.split(separator)\n    sample[fieldName1] = part1.trim()\n    sample[fieldName2] = (part2 ?? '').trim()\n\n    delete sample[fieldName]\n  }\n  processor.isSamplePostProcessor = true as const\n  return processor\n}\n\nexport const isRequiredIf = (callback: (sample) => boolean): SampleProcessor => {\n  const processor: SampleProcessor = async ({ sample, fieldName, rowNumber, columnNumber, problems }) => {\n    const value = sample[fieldName]\n    if (callback(sample) && (value === undefined || value === null))\n      problems.push({ type: 'row', rowNumber, columnNumber, message: 'Cell is required' })\n  }\n  processor.isSamplePostProcessor = true as const\n  return processor\n}\n\nexport const isAcceptableLatitudeAndLongitude: SampleProcessor = async ({ sample, config, rowNumber, problems }) => {\n  const { latitude, longitude } = sample\n  const { api } = config\n  if (typeof latitude === 'number' && typeof longitude === 'number') {\n    const usState = await fetchUsStateAtCoordinates(api)({ latitude, longitude }) // TODO: may want API-level caching here?\n    if (!usState) {\n      problems.push({ type: 'row', rowNumber, message: 'Latitude/Longitude is outside of accepted area.' })\n    }\n  }\n}\nisAcceptableLatitudeAndLongitude.isSamplePostProcessor = true as const\n\nexport const setRowNumber: SampleProcessor = async ({ sample, fieldName, rowNumber }) => {\n  if (typeof fieldName !== 'string') return\n  sample[fieldName] = rowNumber\n}\nsetRowNumber.isSamplePostProcessor = true as const\n\nexport const setSampleNumber: SampleProcessor = async ({ sample, fieldName, sampleNumber }) => {\n  if (typeof fieldName !== 'string') return\n  sample[fieldName] = sampleNumber\n}\nsetSampleNumber.isSamplePostProcessor = true as const\n\nexport const setTemplateVersion: SampleProcessor = async ({ sample, fieldName, templateVersion }) => {\n  if (typeof fieldName !== 'string') return\n  sample[fieldName] = templateVersion\n}\nsetTemplateVersion.isSamplePostProcessor = true as const\n","import { selector } from 'recoil'\n\nimport { selectLookups } from '../../../data/selectors'\nimport { CellProcessor, SampleProcessor, StringValueList } from '../types'\nimport {\n  divideBy100, // divides number by 100 (for converting whole number percentage to fractional percentage)\n  isAcceptableDate, // ensures Excel date value on/after 2000-01-01\n  isInList, // ensures string value is in list values\n  isNumber, // ensures Excel numeric value\n  isNumberBetween, // ensures Excel numeric value between min and max params\n  // isPercent, // ensures Excel numeric value between 0 and 1\n  isPositiveNumber, // ensures Excel numeric value greater than 0\n  isReadable, // ensures readable value (e.g. not link, forumla, etc.)\n  isRequired, // ensures cell has a value (other \"is\" validators ignore no value!)\n  isWholeNumber, // ensures Excel numeric value integer\n  toShortDateString, // ensures Excel date, then converts to string in 'YYYY-MM-DD' format\n  toString, // converts any cell value to string\n  trimIfString, // trims any string\n} from '../processing/cellProcessors'\n\nimport {\n  // isAcceptableLatitudeAndLongitude, // ensures latitude and longitude are in a US state (via API)\n  isRequiredIf, // ensures value is present if callback condition is met (callback is passed the sample data object)\n  setLiteralValue, // directly sets field value to string, number, or boolean parameter\n  setRowNumber, // directly sets field value to worksheet row number\n  setSampleNumber, // directly sets field value to 1-based incrementing sample number\n  // setTemplateVersion, // directly sets field value to detected Excel template version\n  split, // replaces a field value with two new fields based on a separator\n} from '../processing/sampleProcessors'\n\nexport type SheetSchema = Record<string, (CellProcessor | SampleProcessor)[]>\n\n/* \n  acceptedTemplateVersions\n  - currently-accepted template versions\n  - files uploaded with a version not in array will throw an error\n*/\nexport const acceptedTemplateVersions = [5]\n\n/* \n  lookupsWsName\n  - name of the control worksheet which must contain named ranges \"FirstDataRow\" and \"TemplateVersion\"\n*/\nexport const lookupsWsName = 'Lookups'\n\n/* \n  everyCellProcessors\n  - validations/transforms applied to every cell before those in schemasByWsName\n*/\nexport const everyCellProcessors = [isReadable, trimIfString]\n\n/*\n  schemasByWsName\n  - must contain keys matching names of every worksheet; any other worksheets found (besides Lookups) will throw as unrecognized\n  - any columns found that are not in worksheet schema will throw as unrecognized\n  - processors from cellProcessors.ts are applied left-to-right; empty array simply recognizes/allows field without any processing\n  - processors from sampleProcessors.ts are applied AFTER any from cellProcessors.ts\n  - processParsedSample is performed on sample after this schema applied, and may further validate/transform sample\n  - the \"ALL\" schema is applied to every worksheet, but will be overridden if a same-named column is in the specific worksheet schema\n*/\nexport const schemasByWsName: Record<string, SheetSchema> = {\n  ALL: {\n    sampleIndex: [setSampleNumber],\n    rowNumber: [setRowNumber],\n  },\n  Benthic: {\n    sampleType: [setLiteralValue('benthic')],\n    siteId: [isRequired, toString],\n    visitId: [toString],\n    sampleDate: [isRequired, isAcceptableDate, toShortDateString],\n    jarCount: [isRequired, isWholeNumber, isNumberBetween(1, 100)],\n    fieldSplit: [isRequired, isNumberBetween(0, 100), divideBy100],\n    latitude: [isRequired, isNumber],\n    longitude: [isRequired, isNumber],\n    waterbodyName: [isRequired],\n    ecosystemHabitat: [isRequired, isInList('ecosystemHabitats'), split(':', 'ecosystem', 'habitat')],\n    sampleDesign: [isRequired, isInList('designTypes')],\n    sampleEffortStandardization: [isRequired, isInList('effortTypes')],\n    areaTime: [\n      isPositiveNumber,\n      isRequiredIf(({ sampleEffortStandardization }) => sampleEffortStandardization === 'Not Standardized'),\n    ],\n    samplerType: [isRequired, isInList('samplerTypes')],\n    meshSize: [isPositiveNumber],\n    nhdType: [isInList('nhdTypes')],\n    nhdId: [],\n    notes: [toString],\n  },\n  'Fish Diet': {\n    sampleType: [setLiteralValue('fishDiet')],\n    siteId: [isRequired, toString],\n    visitId: [toString],\n    sampleDate: [isRequired, isAcceptableDate, toShortDateString],\n    jarCount: [isRequired, isWholeNumber, isNumberBetween(1, 100)],\n    fieldSplit: [isRequired, isNumberBetween(0, 100), divideBy100],\n    latitude: [isRequired, isNumber],\n    longitude: [isRequired, isNumber],\n    waterbodyName: [isRequired],\n    ecosystem: [isRequired, isInList('ecosystems')],\n    samplerType: [isRequired, isInList('samplerTypes')],\n    fishSpecies: [isRequired],\n    fishLength: [isRequired, isPositiveNumber],\n    fishMass: [isRequired, isPositiveNumber],\n    nhdType: [isInList('nhdTypes')],\n    nhdId: [],\n    notes: [toString],\n  },\n  Zooplankton: {\n    sampleType: [setLiteralValue('zooplankton')],\n    siteId: [isRequired, toString],\n    visitId: [toString],\n    sampleDate: [isRequired, isAcceptableDate, toShortDateString],\n    jarCount: [isRequired, isWholeNumber, isNumberBetween(1, 100)],\n    fieldSplit: [isRequired, isNumberBetween(0, 100), divideBy100],\n    latitude: [isRequired, isNumber],\n    longitude: [isRequired, isNumber],\n    waterbodyName: [isRequired],\n    ecosystemHabitat: [isRequired, isInList('ecosystemHabitats'), split(':', 'ecosystem', 'habitat')],\n    sampleDesign: [isRequired, isInList('designTypes')],\n    samplerType: [isRequired, isInList('samplerTypes')],\n    meshSize: [isPositiveNumber],\n    netArea: [isPositiveNumber],\n    towLength: [isPositiveNumber],\n    towType: [isInList('towTypes')],\n    nhdType: [isInList('nhdTypes')],\n    nhdId: [],\n    notes: [toString],\n  },\n  Drift: {\n    sampleType: [setLiteralValue('drift')],\n    siteId: [isRequired, toString],\n    visitId: [toString],\n    sampleDate: [isRequired, isAcceptableDate, toShortDateString],\n    jarCount: [isRequired, isWholeNumber, isNumberBetween(1, 100)],\n    fieldSplit: [isRequired, isNumberBetween(0, 100), divideBy100],\n    latitude: [isRequired, isNumber],\n    longitude: [isRequired, isNumber],\n    waterbodyName: [isRequired],\n    ecosystemHabitat: [isRequired, isInList('ecosystemHabitats'), split(':', 'ecosystem', 'habitat')],\n    samplerType: [isRequired, isInList('samplerTypes')],\n    meshSize: [isPositiveNumber],\n    netArea: [isPositiveNumber],\n    duration: [isPositiveNumber],\n    velocity: [isPositiveNumber],\n    nhdType: [isInList('nhdTypes')],\n    nhdId: [],\n    notes: [toString],\n  },\n  'Water Quality': {\n    sampleType: [setLiteralValue('waterQuality')],\n    siteId: [isRequired, toString],\n    visitId: [toString],\n    sampleDate: [isRequired, isAcceptableDate, toShortDateString],\n    jarCount: [isRequired, isWholeNumber, isNumberBetween(1, 100)],\n    samplerType: [isRequired, isInList('samplerTypes')],\n    waterbodyName: [isRequired],\n    ecosystem: [isRequired, isInList('ecosystems')],\n    latitude: [isRequired, isNumber],\n    longitude: [isRequired, isNumber],\n    nhdType: [isInList('nhdTypes')],\n    nhdId: [],\n    notes: [toString],\n  },\n}\n\n/*\n  ListName and selectLists\n  - ListName defines all available list names for isInList\n  - selectLists is a Recoil selector which produces descriptor (used in problem message) and allowed values for each list\n  - TypeScript will catch omissions, however the completeness of the value lists is the responsibility of database and below selector code\n */\nexport type ListName =\n  | 'sampleMethods'\n  | 'towTypes'\n  | 'designTypes'\n  | 'effortTypes'\n  | 'samplerTypes'\n  | 'ecosystems'\n  | 'habitats'\n  | 'ecosystemHabitats'\n  | 'nhdTypes'\n\nexport const selectLists = selector<Record<ListName, StringValueList>>({\n  key: 'submissions/selectLists',\n  get: async ({ get }) => {\n    const lookups = get(selectLookups)\n\n    return {\n      sampleMethods: {\n        descriptor: 'sample method',\n        values: lookups.sampleMethodNames,\n      },\n      towTypes: {\n        descriptor: 'tow type',\n        values: lookups.towTypeNames,\n      },\n      designTypes: {\n        descriptor: 'sample design type',\n        values: lookups.designTypeNames,\n      },\n      effortTypes: {\n        descriptor: 'sample effort type',\n        values: lookups.effortTypeNames,\n      },\n      samplerTypes: {\n        descriptor: 'sampler type',\n        values: lookups.sampleMethodNames,\n      },\n      ecosystems: {\n        descriptor: 'ecosystem',\n        values: lookups.ecosystemNames,\n      },\n      habitats: {\n        descriptor: 'habitat',\n        values: lookups.habitatNames,\n      },\n      ecosystemHabitats: {\n        descriptor: 'ecosystem/habitat',\n        values: lookups.ecosystemNames.reduce<string[]>(\n          (acc, ecosystemName) => [\n            ...acc,\n            ...lookups.habitatNames.map((habitatName) => `${ecosystemName}: ${habitatName}`),\n          ],\n          []\n        ),\n      },\n      nhdTypes: {\n        descriptor: 'NHD type',\n        values: lookups.waterBodyTypeNames,\n      },\n    }\n  },\n})\n","/** @jsxImportSource @emotion/react */\nimport React, { useMemo, useRef } from 'react'\nimport { atom, useRecoilState, useRecoilValue, selector } from 'recoil'\nimport MuiStepper from '@mui/material/Stepper'\nimport MuiStep from '@mui/material/Step'\nimport MuiStepLabel from '@mui/material/StepLabel'\nimport MuiButton from '@mui/material/Button'\nimport Radio from '@mui/material/Radio'\nimport RadioGroup from '@mui/material/RadioGroup'\nimport FormControlLabel from '@mui/material/FormControlLabel'\nimport FormControl from '@mui/material/FormControl'\nimport FormLabel from '@mui/material/FormLabel'\nimport LinearProgress from '@mui/material/LinearProgress'\nimport KeyboardArrowLeftIcon from '@mui/icons-material/KeyboardArrowLeft'\nimport KeyboardArrowRightIcon from '@mui/icons-material/KeyboardArrowRight'\nimport SendIcon from '@mui/icons-material/Send'\nimport ErrorOutlineIcon from '@mui/icons-material/ErrorOutline'\nimport CheckCircleOutlineIcon from '@mui/icons-material/CheckCircleOutline'\nimport { GrantAction, NAMCResource } from '@namcbugdb/common'\n\nimport { useUpdatableState } from '../../lib/useUpdatableState'\nimport { DataGrid } from '../DataGrid'\nimport { FileProblem, ProcessFileResult, PreparationPage, FinishedPage } from '../../lib/submissions'\nimport { problemsColumnDefs } from './columnDefs'\nimport { UploadFileBox } from './UploadFileBox'\nimport { appVersion, isStagingApi } from '../../lib/environment'\nimport { useApi } from '../../data/api'\nimport { useInvalidate } from '../../data/selectors'\nimport { useNotifications } from '../AppNotifications'\nimport { createOrganization, createSampleSubmission } from '../../data/calls'\nimport { withSuspense } from '../withSuspense'\nimport { AutocompleteField } from '../AutocompleteField'\nimport { TextField } from '../TextField'\nimport {\n  selectDefaultOrganizationTypeId,\n  selectMyUser,\n  selectOrganizations,\n  selectUsCountryId,\n  selectUsers,\n  selectUsStates,\n} from '../../data/selectors'\nimport { Fallback } from './Fallback'\nimport { useNavigate } from '../AppRouter'\nimport { MyUser } from '../../types'\nimport { StepPage } from './StepPage'\nimport { ReadOnlyField } from '../ReadOnlyField'\n\nconst TEMPLATE_URL = `${process.env.PUBLIC_URL}/namc_sample_upload_template.xlsx` // this file must be in react/app/public\n\nexport type ProcessingStatus = 'empty' | 'uploading' | 'processing' | 'processed' | 'submitting' | 'submitted'\n\nexport interface ProblemRow extends FileProblem {\n  id: string\n}\n\nenum STEP {\n  prepare = 0,\n  upload = 1,\n  review = 2,\n  finished = 3,\n}\n\nconst stepTitles = ['Download Submission Template', 'Upload Template', 'Review', 'Finished']\n\nconst getProblemRowId = (() => {\n  const idDict = {}\n  let nextId = 1\n  return (problem: FileProblem) => {\n    const key = JSON.stringify(problem)\n    if (!idDict[key]) idDict[key] = nextId++\n    return idDict[key]\n  }\n})()\n\nconst selectOrganizationOptions = selector({\n  key: 'CustomerSubmission/selectOrganizationOptions',\n  get: async ({ get }) => {\n    const organizations = get(selectOrganizations)\n    return organizations.map(({ id: value, name: label }) => ({ value, label }))\n  },\n})\n\nconst selectUserOptions = selector({\n  key: 'CustomerSubmission/selectUserOptions',\n  get: async ({ get }) => {\n    const users = get(selectUsers)\n    return users.map(({ id: value, fullName, organizationName }) => ({\n      value,\n      label: `${fullName} (${organizationName})`,\n    }))\n  },\n})\n\nconst selectUsStateOptions = selector({\n  key: 'CustomerSubmission/selectUsStateOptions',\n  get: async ({ get }) => {\n    const usStates = get(selectUsStates)\n    return usStates.map(({ id: value, abbreviation: label }) => ({ value, label }))\n  },\n})\n\nconst expandJsonState = atom({\n  key: 'CustomerSubmission/expandJsonState',\n  default: false,\n})\n\nexport const emptyProcessResult = { samples: [], info: {}, problems: [], templateVersion: null }\n\ninterface Fields {\n  existingOrganizationId: number | null\n  submitterId: number | null\n  organizationMode: 'existing' | 'new'\n  organizationName: string\n  address1: string\n  address2: string\n  city: string\n  usStateId: number | null\n  zipCode: string\n  phone: string\n}\n\ntype FieldErrors = Partial<Record<keyof Fields, boolean>> | undefined\n\nexport interface State {\n  // current\n  processingStatus: ProcessingStatus\n  processResult: ProcessFileResult\n  filename: string\n  processingToken: number\n  errorMessage: string\n  boxId?: number\n  createdOrganizationId?: number\n\n  // for revert\n  lastProcessingStatus: ProcessingStatus\n  lastFilename: string\n\n  // field values\n  values: Fields\n}\n\nconst getInitialState = ({ user }: { user: MyUser }): State => ({\n  processingStatus: 'empty',\n  processResult: emptyProcessResult,\n  filename: '',\n  processingToken: 0,\n  errorMessage: '',\n  lastProcessingStatus: 'empty',\n  lastFilename: '',\n  values: {\n    existingOrganizationId: user.affiliationId,\n    submitterId: user.id,\n    organizationMode: 'existing',\n    organizationName: '',\n    address1: '',\n    address2: '',\n    city: '',\n    usStateId: null,\n    zipCode: '',\n    phone: '',\n  },\n})\n\nconst MessageBlock = (props) => (\n  <div css={{ margin: '1em 0', fontWeight: 'bold', display: 'flex', alignItems: 'center' }} {...props} />\n)\n\nexport const CustomerSubmission = withSuspense(\n  (/* props: CustomerSubmissionProps */): JSX.Element => {\n    const [expandJson, setExpandJson] = useRecoilState(expandJsonState)\n    const user = useRecoilValue(selectMyUser)\n    const countryId = useRecoilValue(selectUsCountryId)\n    const organizationTypeId = useRecoilValue(selectDefaultOrganizationTypeId)\n\n    const navigate = useNavigate()\n    const api = useApi()\n    const invalidate = useInvalidate()\n    const notifications = useNotifications()\n    const downloadTemplateLinkRef = useRef<HTMLAnchorElement | null>(null)\n\n    // eslint-disable-next-line @typescript-eslint/no-unused-vars\n    const [state, setState, updateState] = useUpdatableState<State>(getInitialState({ user }))\n    const [activeStep, setActiveStep] = React.useState<STEP>(STEP.prepare)\n\n    const { processingStatus, processingToken, processResult, errorMessage, filename, boxId, values } = state\n    const errors: FieldErrors = (() => {\n      let errors: FieldErrors = {}\n      switch (values.organizationMode) {\n        case 'existing':\n          errors = {\n            existingOrganizationId: !values.existingOrganizationId,\n          }\n          break\n        case 'new': {\n          errors = {\n            organizationName: values.organizationName.trim().length < 3,\n            address1: !values.address1.trim(),\n            city: !values.city.trim(),\n            zipCode: !values.zipCode.trim().match(/^[\\d-]{5,}$/),\n            usStateId: !values.usStateId,\n            phone: !values.phone,\n          }\n          break\n        }\n        default:\n      }\n      if (!Object.values(errors).some((value) => value)) return undefined\n      return errors\n    })()\n\n    const { samples, info, problems, templateVersion } = processResult\n\n    const setFieldValue = (fieldName: keyof Fields, value: unknown) => {\n      updateState((draft) => {\n        Object.assign(draft.values, { [fieldName]: value })\n      })\n    }\n\n    const handleSubmit = async () => {\n      try {\n        updateState((draft) => {\n          draft.processingStatus = 'submitting'\n        })\n        let customerId: number | null\n        switch (values.organizationMode) {\n          case 'new': {\n            // create organization\n            if (typeof values.usStateId !== 'number') throw new Error('missing state')\n            const newOrganizationId = await createOrganization(\n              api,\n              invalidate\n            )({\n              name: values.organizationName.trim(),\n              typeId: organizationTypeId,\n              address1: values.address1.trim(),\n              address2: values.address2.trim(),\n              city: values.city.trim(),\n              phone: values.phone.trim(),\n              usStateId: values.usStateId,\n              countryId,\n              zipCode: values.zipCode.trim(),\n            })\n            updateState((draft) => {\n              draft.createdOrganizationId = newOrganizationId\n            })\n            customerId = newOrganizationId\n            break\n          }\n          case 'existing': {\n            if (!values.existingOrganizationId) throw new Error('missing customer ID')\n            customerId = values.existingOrganizationId\n            break\n          }\n        }\n        const { submitterId } = values\n        if (!submitterId) throw new Error('missing submitter ID')\n        if (!templateVersion) throw new Error('parsing did not return template version')\n        const newBoxId = await createSampleSubmission(\n          api,\n          invalidate\n        )({\n          customerId,\n          submitterId,\n          data: { appVersion: appVersion ?? 'unknown', templateVersion, samples },\n        })\n        updateState((draft) => {\n          draft.processingStatus = 'submitted'\n          draft.boxId = newBoxId\n        })\n        setActiveStep(STEP.finished)\n      } catch (err) {\n        updateState((draft) => {\n          draft.processingStatus = 'processed'\n        })\n        notifications.error(`Failed to create submission: ${err}`)\n        return\n      }\n    }\n\n    const rows = useMemo(() => {\n      return problems.map((problem) => ({ id: getProblemRowId(problem), ...problem }))\n    }, [problems])\n\n    const canSubmit = samples.length > 0 && problems.length === 0 && processingStatus === 'processed' && !errors\n\n    const hasFatalProblem = processResult.problems.some(({ type }) => type === 'fatal')\n    const hasOnlyRowProblems = !hasFatalProblem && processResult.problems.length > 0\n    const hasNoSamples = processingStatus === 'processed' && processResult.samples.length === 0\n\n    const uploadAttentionMessage = (() => {\n      if (errorMessage) return <span>Error reading file. Did you choose the correct file? ({errorMessage})</span>\n      if (hasFatalProblem)\n        return (\n          <span>Error processing file. Did you choose the correct file? ({processResult.problems[0].message})</span>\n        )\n      if (hasOnlyRowProblems)\n        return <span>Correct the following {processResult.problems.length} problems and try uploading again:</span>\n      if (hasNoSamples) return <span>File does not contain any samples.</span>\n      return null\n    })()\n\n    // PERMISSIONS\n\n    const canChangeUser = user.hasPermission(NAMCResource.individuals, GrantAction.readAny)\n    const canChangeOrganization =\n      user.hasPermission(NAMCResource.organizations, GrantAction.readAny) &&\n      user.hasPermission(NAMCResource.organizations, GrantAction.createAny)\n\n    // RENDER\n\n    return (\n      <div css={{ height: '100%', display: 'flex', flexDirection: 'column', maxWidth: '70rem' }}>\n        <MuiStepper activeStep={activeStep}>\n          {stepTitles.map((stepTitle) => (\n            <MuiStep key={stepTitle}>\n              <MuiStepLabel>{stepTitle}</MuiStepLabel>\n            </MuiStep>\n          ))}\n        </MuiStepper>\n        <div css={{ display: 'flex', alignItems: 'center', margin: '2em 0' }}>\n          <div>\n            <MuiButton\n              variant=\"outlined\"\n              onClick={() => setActiveStep((s) => s - 1)}\n              disabled={\n                activeStep === STEP.prepare || activeStep === STEP.finished || processingStatus === 'submitting'\n              }\n            >\n              <KeyboardArrowLeftIcon />\n              Back\n            </MuiButton>\n          </div>\n          <div css={{ flex: 1, textAlign: 'center', fontSize: '125%' }}>\n            Step {activeStep + 1}: {stepTitles[activeStep]}\n          </div>\n          <div>\n            {activeStep < STEP.review && (\n              <MuiButton\n                variant=\"outlined\"\n                onClick={() => setActiveStep((s) => s + 1)}\n                disabled={activeStep === STEP.upload && !canSubmit}\n              >\n                Next\n                <KeyboardArrowRightIcon />\n              </MuiButton>\n            )}\n            {activeStep >= STEP.review && (\n              <MuiButton\n                variant={activeStep === STEP.finished ? 'outlined' : 'contained'}\n                onClick={handleSubmit}\n                disabled={!canSubmit || activeStep === STEP.finished}\n              >\n                Submit&nbsp;\n                <SendIcon />\n              </MuiButton>\n            )}\n          </div>\n        </div>\n        <div css={{ flex: 1, position: 'relative' }}>\n          {/* PREPARE */}\n          <StepPage active={activeStep === STEP.prepare}>\n            <a\n              ref={downloadTemplateLinkRef}\n              href={TEMPLATE_URL}\n              css={{ visibility: 'hidden', position: 'absolute' }}\n              download\n            ></a>\n            <PreparationPage\n              onDownloadTemplate={() => {\n                downloadTemplateLinkRef.current?.click()\n              }}\n            />\n          </StepPage>\n          {/* UPLOAD */}\n          <StepPage\n            active={activeStep === STEP.upload}\n            css={{\n              display: 'flex',\n              flexDirection: 'column',\n            }}\n          >\n            <UploadFileBox\n              updateState={updateState}\n              processingToken={processingToken}\n              processingStatus={processingStatus}\n              filename={filename}\n            />\n            {uploadAttentionMessage && (\n              <MessageBlock>\n                <ErrorOutlineIcon />\n                &nbsp;{uploadAttentionMessage}\n              </MessageBlock>\n            )}\n            {canSubmit && (\n              <MessageBlock>\n                <CheckCircleOutlineIcon />\n                &nbsp;Ready to review. Click Next to continue.\n              </MessageBlock>\n            )}\n            {hasOnlyRowProblems && (\n              <div css={{ flex: 1 }}>\n                <DataGrid<ProblemRow> columnDefs={problemsColumnDefs} rows={rows} />\n              </div>\n            )}\n          </StepPage>\n          {/* REVIEW */}\n          <StepPage active={activeStep === STEP.review && processingStatus !== 'submitting'}>\n            <div css={{ display: 'flex', gap: '1em' }}>\n              <div css={{ minWidth: '20em', flex: 1 }}>\n                <FormControl component=\"fieldset\" css={{ width: '100%' }}>\n                  <FormLabel component=\"legend\">User</FormLabel>\n                  {canChangeUser ? (\n                    <AutocompleteField\n                      optionsSelector={selectUserOptions}\n                      valueLabel={user.fullName}\n                      value={values.submitterId}\n                      onChange={(value) => setFieldValue('submitterId', value)}\n                    />\n                  ) : (\n                    <ReadOnlyField value={user.fullName} />\n                  )}\n                </FormControl>\n                <div css={{ paddingTop: '1em' }}>\n                  <FormControl component=\"fieldset\" css={{ width: '100%' }}>\n                    <FormLabel component=\"legend\">Organization</FormLabel>\n                    {canChangeOrganization && (\n                      <RadioGroup\n                        row\n                        value={values.organizationMode}\n                        onChange={(_, newValue) => setFieldValue('organizationMode', newValue)}\n                      >\n                        <FormControlLabel value=\"existing\" control={<Radio />} label=\"Existing\" />\n                        <FormControlLabel value=\"new\" control={<Radio />} label=\"New\" />\n                      </RadioGroup>\n                    )}\n                  </FormControl>\n                </div>\n                {values.organizationMode === 'existing' &&\n                  (canChangeOrganization ? (\n                    <AutocompleteField\n                      optionsSelector={selectOrganizationOptions}\n                      valueLabel={user.organizationName}\n                      value={values.existingOrganizationId}\n                      onChange={(value) => setFieldValue('existingOrganizationId', value)}\n                      error={errors?.existingOrganizationId}\n                    />\n                  ) : (\n                    <ReadOnlyField value={user.organizationName} />\n                  ))}\n                {values.organizationMode === 'new' && (\n                  <div\n                    css={{\n                      display: 'grid',\n                      gap: '0.75em',\n                      gridTemplateColumns: '1fr 1fr',\n                      gridTemplateAreas: `\n                        \"organizationName organizationName\"\n                        \"address1         address1\"\n                        \"address2         address2\"\n                        \"city             city\"\n                        \"usStateId        zipCode\"\n                        \"phone            .\"\n                      `,\n                    }}\n                  >\n                    <TextField\n                      gridArea=\"organizationName\"\n                      value={values.organizationName}\n                      onChange={(value) => setFieldValue('organizationName', value)}\n                      label=\"Organization Name\"\n                      error={errors?.organizationName}\n                    />\n                    <TextField\n                      gridArea=\"address1\"\n                      value={values.address1}\n                      onChange={(value) => setFieldValue('address1', value)}\n                      label=\"Address 1\"\n                      error={errors?.address1}\n                    />\n                    <TextField\n                      gridArea=\"address2\"\n                      value={values.address2}\n                      onChange={(value) => setFieldValue('address2', value)}\n                      label=\"Address 2\"\n                      error={errors?.address2}\n                    />\n                    <TextField\n                      gridArea=\"city\"\n                      value={values.city}\n                      onChange={(value) => setFieldValue('city', value)}\n                      label=\"City\"\n                      error={errors?.city}\n                    />\n                    <AutocompleteField\n                      gridArea=\"usStateId\"\n                      value={values.usStateId}\n                      valueLabel=\"State\"\n                      onChange={(value) => setFieldValue('usStateId', value)}\n                      optionsSelector={selectUsStateOptions}\n                      label=\"State\"\n                      error={errors?.usStateId}\n                      isClearable\n                    />\n                    <TextField\n                      gridArea=\"zipCode\"\n                      value={values.zipCode}\n                      onChange={(value) => setFieldValue('zipCode', value)}\n                      label=\"Zip\"\n                      error={errors?.zipCode}\n                    />\n                    <TextField\n                      gridArea=\"phone\"\n                      value={values.phone}\n                      onChange={(value) => setFieldValue('phone', value)}\n                      label=\"Phone\"\n                      error={errors?.phone}\n                    />\n                  </div>\n                )}\n              </div>\n              <div css={{ flex: 1 }}>\n                <FormLabel component=\"legend\">Submission Summary</FormLabel>\n                <table\n                  css={{\n                    borderCollapse: 'collapse',\n                    th: { fontWeight: 'normal' },\n                    td: { border: '1px solid grey' },\n                    'th,td': { padding: '0.75em' },\n                  }}\n                >\n                  <thead>\n                    <tr>\n                      <th>Sample Type</th>\n                      <th># Samples</th>\n                    </tr>\n                  </thead>\n                  <tbody>\n                    {Object.entries(info).map(([wsName, sampleCount]) => (\n                      <tr key={wsName}>\n                        <td>{wsName}</td>\n                        <td css={{ textAlign: 'right' }}>{sampleCount}</td>\n                      </tr>\n                    ))}\n                  </tbody>\n                </table>\n              </div>\n            </div>\n            {canSubmit && (\n              <MessageBlock>\n                <CheckCircleOutlineIcon />\n                &nbsp;Ready to submit. Click Submit to finish.\n              </MessageBlock>\n            )}\n            {errors && (\n              <MessageBlock>\n                <ErrorOutlineIcon />\n                &nbsp;Correct the above address issues.\n              </MessageBlock>\n            )}\n            {isStagingApi && (\n              <div>\n                <MuiButton\n                  onClick={() => {\n                    setExpandJson((v) => !v)\n                  }}\n                >\n                  {expandJson ? 'Hide Sample Data' : 'Show Sample Data'}\n                </MuiButton>\n                {expandJson && <pre>{JSON.stringify(samples, null, 2)}</pre>}\n              </div>\n            )}\n          </StepPage>\n          <StepPage active={activeStep === STEP.review && processingStatus === 'submitting'}>\n            <LinearProgress />\n          </StepPage>\n          {/* FINISHED */}\n          <StepPage active={activeStep === STEP.finished}>\n            {boxId && (\n              <FinishedPage\n                boxId={boxId}\n                onGoToBoxes={() => navigate.boxes()}\n                onGoToBoxDetail={() => navigate.boxDetail({ boxId })}\n                onGoToChainOfCustody={() => navigate.chainOfCustodyForm({ boxId })}\n              />\n            )}\n          </StepPage>\n        </div>\n      </div>\n    )\n  },\n  () => <Fallback />\n)\n","import { FileSample, FileProblem, ProcessorsConfig, CellProcessor, SampleProcessor } from '../types'\nimport { SheetSchema } from '../schema/templateSchema'\n\ninterface ProcessParsedSampleParams {\n  sample: FileSample\n  schema: SheetSchema\n  config: ProcessorsConfig\n  rowNumber: number\n  sampleNumber: number\n  templateVersion: number\n  columnKeys: string[]\n}\n\nconst isSamplePostProcessor = (processor: CellProcessor | SampleProcessor): processor is SampleProcessor =>\n  (processor as SampleProcessor).isSamplePostProcessor\n\nexport const processParsedSample = async ({\n  sample: sourceSample,\n  schema,\n  config,\n  rowNumber,\n  sampleNumber,\n  templateVersion,\n  columnKeys,\n}: ProcessParsedSampleParams): Promise<{ sample: FileSample; problems: FileProblem[] }> => {\n  const sample = { ...sourceSample }\n  const problems: FileProblem[] = []\n\n  const allPromises: Promise<void>[] = []\n\n  // perform sample processors\n  Object.entries(schema).forEach(([fieldName, processors]) => {\n    processors.filter(isSamplePostProcessor).forEach((processor) => {\n      allPromises.push(\n        processor({\n          sample,\n          config,\n          rowNumber,\n          columnNumber: columnKeys.findIndex((columnKey) => columnKey === fieldName), // note that columnKeys are already [1] = column A\n          sampleNumber,\n          templateVersion,\n          fieldName,\n          problems,\n        })\n      )\n    })\n  })\n\n  await Promise.all(allPromises)\n\n  return { sample, problems }\n}\n","import Excel from 'exceljs'\n\nimport { FileSample, FileProblem, ProcessFileResult, ProcessorsConfig, CellProcessor, SampleProcessor } from '../types'\nimport { schemasByWsName, lookupsWsName, everyCellProcessors, acceptedTemplateVersions } from '../schema/templateSchema'\nimport { processParsedSample } from './processParsedSample'\n\nexport class KnownError extends Error {\n  problem: FileProblem\n\n  constructor(problem: FileProblem) {\n    super()\n    this.problem = problem\n  }\n}\n\nconst isCellProcessor = (processor: CellProcessor | SampleProcessor): processor is CellProcessor =>\n  !(processor as SampleProcessor).isSamplePostProcessor\n\nexport const processFile = async (wb: Excel.Workbook, config: ProcessorsConfig): Promise<ProcessFileResult> => {\n  const samples: FileSample[] = []\n  const problems: FileProblem[] = []\n  const info = {}\n\n  const promises: Promise<void>[] = []\n\n  try {\n    const lookupsWs = wb.worksheets.find((ws) => ws.name === lookupsWsName)\n    if (!lookupsWs)\n      throw new KnownError({\n        type: 'fatal',\n        message: `File does not appear to be a valid template.`,\n      })\n\n    const getNamedCellValues = (): Record<string, Excel.CellValue> => {\n      const values = {}\n      wb.definedNames.model.forEach(({ name, ranges }) => {\n        const [range] = ranges\n        const value = lookupsWs.getCell(range.split('!')[1]).value\n        values[name] = value\n      })\n      return values\n    }\n\n    const { FirstDataRow: firstDataRowNumber, TemplateVersion: templateVersion } = getNamedCellValues()\n    if (typeof firstDataRowNumber !== 'number')\n      throw new KnownError({\n        type: 'fatal',\n        message: 'File does not appear to be a valid template: \"FirstDataRow\" is missing.',\n      })\n    if (typeof templateVersion !== 'number')\n      throw new KnownError({\n        type: 'fatal',\n        message: 'File does not appear to be a valid template: \"TemplateVersion\" is missing.',\n      })\n    if (!acceptedTemplateVersions.includes(templateVersion))\n      throw new KnownError({\n        type: 'fatal',\n        message: `File version of ${templateVersion} is not accepted. Accepted versions are: ${acceptedTemplateVersions\n          .map((version) => `${version}`)\n          .join(', ')}.`,\n      })\n\n    wb.eachSheet((ws) => {\n      const wsName = ws.name\n\n      // skip Lookups\n      if (wsName === lookupsWsName) return\n\n      const columnKeys = (ws.getRow(firstDataRowNumber - 1).values as Excel.CellValue[]).map(String) // as per file design scheme\n\n      // get worksheet schema\n      const sheetSchema = schemasByWsName[wsName]\n      if (!sheetSchema)\n        throw new KnownError({\n          wsName,\n          type: 'fatal',\n          message: `Unrecognized worksheet \"${wsName}\".`,\n        })\n      const universalSchema = schemasByWsName.ALL\n      const schema = { ...universalSchema, ...sheetSchema }\n\n      let sampleNumber = 1 // 1-based sample serial number\n\n      // process each worksheet row\n      ws.eachRow((row, rowNumber) => {\n        // skip top rows\n        if (rowNumber < firstDataRowNumber) return\n\n        try {\n          // begin with row (sample)\n          const sample: FileSample = {}\n          const sampleProblems: FileProblem[] = []\n\n          // extract all cell values\n          row.eachCell({ includeEmpty: true }, (cell, columnNumber) => {\n            const key = columnKeys[columnNumber]\n\n            if (!key && !cell.value) return // irrelevant cell\n\n            if (!key)\n              throw new KnownError({\n                type: 'row',\n                wsName,\n                rowNumber,\n                columnNumber,\n                message: 'Unidentified cell: not in known column',\n              })\n            const processors = schema[key]\n            if (!processors)\n              throw new KnownError({\n                type: 'row',\n                wsName,\n                rowNumber,\n                columnNumber,\n                message: 'Unexpected cell: column is not in schema',\n              })\n\n            // process/validate cell\n            try {\n              everyCellProcessors.filter(isCellProcessor).forEach((processorFn) => {\n                processorFn(cell, config) // tests and/or mutates cell.value\n              })\n\n              processors.filter(isCellProcessor).forEach((processorFn) => {\n                processorFn(cell, config) // tests and/or mutates cell.value\n              })\n\n              if (\n                typeof cell.value === 'string' ||\n                typeof cell.value === 'number' ||\n                typeof cell.value === 'boolean' ||\n                typeof cell.value === 'undefined' ||\n                cell.value === null\n              ) {\n                sample[key] = cell.value\n              } else {\n                sample[key] = 'UNKNOWN' // TODO: handle this\n              }\n            } catch (err) {\n              if (!(err instanceof KnownError)) throw err\n              sampleProblems.push({ wsName, type: 'row', rowNumber, columnNumber, ...err.problem })\n            }\n          })\n\n          // process parsed sample\n          promises.push(\n            processParsedSample({ sample, schema, config, rowNumber, sampleNumber, templateVersion, columnKeys }).then(\n              (processedResult) => {\n                // finish with row (sample)\n                const finalProblems = [\n                  ...sampleProblems,\n                  ...processedResult.problems.map((problem) => ({ ...problem, wsName })),\n                ]\n                if (finalProblems.length > 0) {\n                  problems.push(...finalProblems)\n                } else {\n                  info[wsName] = (info[wsName] || 0) + 1\n                  samples.push(processedResult.sample)\n                }\n              }\n            )\n          )\n        } catch (err) {\n          if (!(err instanceof KnownError)) throw err\n          problems.push(err.problem)\n        }\n\n        sampleNumber += 1\n      })\n    })\n\n    // wait for all asyncs to return\n    await Promise.all(promises)\n\n    return { samples, info, problems, templateVersion }\n  } catch (err) {\n    if (err instanceof KnownError) return { samples: [], info: {}, problems: [err.problem], templateVersion: null }\n    return {\n      samples: [],\n      info: {},\n      problems: [{ type: 'fatal', message: `Fatal error while processing file: ${err}` }],\n      templateVersion: null,\n    }\n  }\n}\n","/** @jsxImportSource @emotion/react */\nimport React from 'react'\nimport { css } from '@emotion/react'\nimport MuiButton from '@mui/material/Button'\n\ninterface PreparationPageProps {\n  onDownloadTemplate: () => void\n}\n\nconst styles = css`\n  .download-template-columns {\n    display: flex;\n  }\n\n  .download-template-button {\n    width: 15em;\n  }\n`\n\nexport const PreparationPage = ({ onDownloadTemplate }: PreparationPageProps): JSX.Element => {\n  return (\n    <div css={styles}>\n      <div className=\"download-template-columns\">\n        <div>\n          <p>Welcome to the NAMC online sample submission process.</p>\n          <p>\n            The first step to making a new submission is to download the latest Excel template and fill in the\n            information defining your samples. It&apos;s important that you always submit data using the latest template\n            and we recommend that you download it each time you wish to make a submission.\n          </p>\n          <p>\n            The template helps you by limiting the values that can be used in certain columns. Further information\n            describing each column is available on the{' '}\n            <a href=\"https://namc-usu.org\" target=\"_blank\" rel=\"noreferrer\">\n              NAMC web site\n            </a>\n            . Note that the template does allow you to submit different types of samples (benthic, zooplankton, drift,\n            fish diet or water quality) within a single Excel template upload.\n          </p>\n          <p>If you cut and paste information into the template, we recommend using &ldquo;paste values&rdquo;.</p>\n          <p>\n            Once you have downloaded and populated the latest version of the template with information describing your\n            samples, click next to upload your Excel file and validate the information.\n          </p>\n          <p>\n            <a href=\"https://namc-usu.org/contactus.html\" target=\"_blank\" rel=\"noreferrer\">\n              Contact the NAMC Lab Manager\n            </a>{' '}\n            if you have questions or experience problems submitting data.\n          </p>\n        </div>\n        <div>\n          <MuiButton onClick={onDownloadTemplate} variant=\"contained\" className=\"download-template-button\">\n            Download Template\n          </MuiButton>\n        </div>\n      </div>\n    </div>\n  )\n}\n","/** @jsxImportSource @emotion/react */\nimport React from 'react'\nimport MuiButton from '@mui/material/Button'\nimport { css } from '@emotion/react'\n\ninterface FinishedPageProps {\n  boxId: number\n  onGoToBoxes: () => void\n  onGoToBoxDetail: () => void\n  onGoToChainOfCustody: () => void\n}\n\nconst styles = css`\n  button {\n    margin: 0.5em;\n  }\n`\n\nexport const FinishedPage = ({\n  boxId,\n  onGoToBoxes,\n  // onGoToBoxDetail,\n  onGoToChainOfCustody,\n}: FinishedPageProps): JSX.Element => {\n  return (\n    <div css={styles}>\n      <p>Your submission was successful. Your submission reference is {boxId}.</p>\n      <p>\n        You should now print and follow the instructions on the chain of custody form. You can track the status of your\n        submission on the customer box listing.\n      </p>\n      <MuiButton variant=\"outlined\" onClick={onGoToBoxes}>\n        Customer Submission Listing\n      </MuiButton>\n      <MuiButton variant=\"outlined\" onClick={onGoToChainOfCustody}>\n        Open Chain of Custody Form\n      </MuiButton>\n    </div>\n  )\n}\n","/** @jsxImportSource @emotion/react */\nimport React from 'react'\nimport { times } from 'lodash'\nimport dayjs from 'dayjs'\nimport { SerializedStyles } from '@emotion/react'\n\nexport const Document = ({\n  children,\n  styles,\n}: {\n  children: React.ReactNode\n  styles: SerializedStyles\n}): JSX.Element => (\n  <div css={styles}>\n    {/* below padding ensures borders print */}\n    <div className=\"document\" css={{ padding: '0 2px' }}>\n      {children}\n    </div>\n  </div>\n)\n\nexport const EmptyCell = ({ qty = 1 }: { qty: number }): JSX.Element => (\n  <>\n    {times(qty).map((i) => (\n      <td key={i}></td>\n    ))}\n  </>\n)\n\nexport const Table = ({ children, borders }: { children: React.ReactNode; borders?: boolean }): JSX.Element => (\n  <table\n    css={{\n      'th,td': { minWidth: '1em', border: borders ? '1px solid black' : 'none', padding: '0.1em' },\n      borderCollapse: 'collapse',\n      width: '100%',\n    }}\n  >\n    {children}\n  </table>\n)\n\nexport const PageBreak = (): JSX.Element => (\n  <div css={{ height: '1px', pageBreakAfter: 'always', '@media screen': { borderBottom: '3px dashed green' } }} />\n)\n\nexport const Line = (): JSX.Element => <hr css={{ borderBottom: '1px solid black', margin: '0.75em 0' }} />\n\nexport const longDate = (date: string | number | boolean | null | undefined): string => {\n  if (typeof date !== 'string') return '?'\n  return dayjs(date).format('MMMM D, YYYY')\n}\n\nexport const shortDate = (date: string | number | boolean | null | undefined): string => {\n  if (typeof date !== 'string') return '?'\n  return dayjs(date).format('M/D/YY')\n}\n","/** @jsxImportSource @emotion/react */\nimport React from 'react'\nimport { css } from '@emotion/react'\n\nimport { Document, EmptyCell, Table, PageBreak, Line, shortDate, longDate } from './helpers'\nimport { Submission } from '../../../types'\n\nexport interface ChainOfCustodyFormProps {\n  submission: Submission\n}\n\nconst styles = css`\n  .document {\n    font-family: serif;\n    font-size: 12pt;\n    line-height: 1.2;\n    color: black;\n  }\n  u {\n    text-decoration: underline;\n  }\n  i {\n    text-style: italic;\n  }\n  b {\n    font-weight: bold;\n  }\n  th {\n    text-align: center;\n  }\n  td {\n    text-align: left;\n  }\n  .indent {\n    margin-left: 3em;\n    display: inline-block;\n  }\n  .notes-box {\n    border: 1px solid black;\n    width: 100%;\n    height: 5em;\n  }\n  .float-right {\n    display: inline-block;\n    float: right;\n    padding-right: 2em;\n  }\n`\n\nexport const ChainOfCustodyForm = ({ submission }: ChainOfCustodyFormProps): JSX.Element => (\n  <Document styles={styles}>\n    <p>\n      {submission.submitterName} <br />\n      {submission.organizationName} <br />\n      {submission.submitterPhone} <br />\n      {submission.submitterEmail} <br />\n    </p>\n    <p>{longDate(submission.createdDate)}</p> <p>Dear {submission.submitterName},</p>\n    <p>\n      On {longDate(submission.createdDate)}, {submission.samples.length} samples were electronically submitted to the\n      USU/BLM National Aquatic Monitoring Center (a.k.a. BugLab). The documentation on page 2 is your Chain of Custody\n      form and should be used for sample tracking purposes. As such,{' '}\n      <u>send this documentation with the sample shipment</u> and also retain a copy for your records.\n    </p>\n    <p>\n      Samples should be sent to:\n      <br />\n      <span className=\"indent\">\n        USU/BLM National Aquatic Monitoring Center (BugLab) <br />\n        Department of Watershed Sciences <br />\n        Utah State University <br />\n        5210 Old Main Hill <br />\n        Logan, Utah 84322 5210 <br />\n      </span>\n    </p>\n    <p>\n      Samples should be preserved in ethanol (70-95%) unless you have made prior arrangements with our lab. To prepare\n      for shipping, follow the guidelines for Class 3 (Flammable Liquid) Hazardous Materials according to your chosen\n      carrier&apos;s guidelines.{' '}\n      <u>\n        If you do not have a hazardous materials permit, samples can be shipped overnight in water as long as the\n        samples were in ethanol prior to shipment. If shipping in water, you must let NAMC know before shipment.\n      </u>{' '}\n      General packaging guidelines are as follows:\n    </p>\n    <ul>\n      <li>Make sure the lids are on tightly. To be extra careful, you can wrap duct tape around the lids.</li>\n      <li>\n        Place individual samples in ziploc baggies or other secondary sealed containers lined with absorbent material\n        (such as paper towels) for support, cushion, and to absorb any leaks.\n      </li>\n      <li>\n        Place data sheets, <b>including provided chain of custody forms, and any other paper documentation</b> in a\n        separate zip-lock plastic bag.\n      </li>\n      <li>\n        As specified by your carrier, mark package as Hazardous Material and fill out a Shipping Declaration for\n        Dangerous Goods form to accompany the package (and keep a copy for your records).\n      </li>\n    </ul>\n    <p>For any clarification on these instructions or the submission process, visit www.usu.edu/buglab.</p>\n    <p>\n      For additional questions, please contact Trip Armstrong (760-709-1210; <u>trip.armstrong@usu.edu</u>), Scott\n      Miller (435-797-2612; <u>scott.miller@usu.edu</u>), or Matt Tagg (435-797-3945; <u>matt.tagg@usu.edu</u>).\n    </p>\n    <p>\n      Sincerely, <br />\n      Scott Miller <br />\n      Director <br />\n      USU/BLM National Aquatic Monitoring Center (BugLab) <br />\n      Department of Watershed Sciences <br />\n      Utah State University <br />\n      5210 Old Main Hill <br />\n      Utah State University <br />\n      Logan, Utah 84322\n    </p>\n    <PageBreak />\n    <span className=\"float-right\">\n      BoxID: {submission.boxId} <br />\n      (lab use only)\n    </span>\n    Customer: {submission.organizationName} <br />\n    Number of Samples: {submission.samples.length} <br />\n    <br />\n    <b>Chain of Custody</b>\n    <Table borders>\n      <thead>\n        <tr>\n          <th></th>\n          <th>Date</th>\n          <th>Condition</th>\n          <th>Approved by</th>\n          <th>Signature</th>\n          <th>Data</th>\n        </tr>\n      </thead>\n      <tbody>\n        <tr>\n          <td>\n            <b>Submitted</b>\n          </td>\n          <td>{shortDate(submission.createdDate)}</td>\n          <td></td>\n          <td>{submission.submitterName}</td>\n          <td></td>\n          <td></td>\n        </tr>\n        <tr>\n          <td>\n            <b>Shipped</b>\n          </td>\n          <EmptyCell qty={5} />\n        </tr>\n        <tr>\n          <td>\n            <b>Received in Lab</b>\n          </td>\n          <EmptyCell qty={5} />\n        </tr>\n        <tr>\n          <td>\n            <b>Lab Work Initiated</b>\n          </td>\n          <EmptyCell qty={5} />\n        </tr>\n        <tr>\n          <td>\n            <b>Lab Work Finished</b>\n          </td>\n          <EmptyCell qty={5} />\n        </tr>\n        <tr>\n          <td>\n            <b>Report Sent</b>\n          </td>\n          <EmptyCell qty={5} />\n        </tr>\n        <tr>\n          <td>\n            <b>Jars/Specimens Returned</b>\n          </td>\n          <EmptyCell qty={5} />\n        </tr>\n        <tr>\n          <td>\n            <b>Returned Jars/Specimens Received</b>\n          </td>\n          <EmptyCell qty={5} />\n        </tr>\n      </tbody>\n    </Table>\n    <br />\n    <b>Notes:</b>\n    <div className=\"notes-box\" />\n    <Line />\n    <b>Special Handling</b> (all additional services are in addition to baseline price. Prior arrangements must be made){' '}\n    <br />\n    <Table>\n      <tbody>\n        <tr>\n          <td>\n            <u>Measurements</u>\n          </td>\n          <td>\n            <u>Identification</u>\n          </td>\n          <td>\n            <u>QAQC</u>\n          </td>\n          <td>\n            <u>Cataloging</u>\n          </td>\n        </tr>\n        <tr>\n          <td>Length</td>\n          <td>Midges</td>\n          <td>Sorting ( __ %)</td>\n          <td>Reference Collection</td>\n        </tr>\n        <tr>\n          <td>Biomass</td>\n          <td>OTUs</td>\n          <td>Taxonomy ( __ %)</td>\n          <td>Return Specimens</td>\n        </tr>\n      </tbody>\n    </Table>\n    <Line />\n    <b>Sample Log</b> (lab use only) <br />\n    <Table borders>\n      <thead>\n        <tr>\n          <th>#</th>\n          <th>Jars</th>\n          <th>Station</th>\n          <th>Location</th>\n          <th>Date</th>\n          <th>Sample Type</th>\n          <th></th>\n          <th>Problems</th>\n        </tr>\n      </thead>\n      <tbody>\n        {submission.samples.map((sample) => (\n          /* see schema for field names */\n          <tr key={String(sample.sampleIndex)}>\n            <td>{sample.sampleIndex}</td>\n            <td>{sample.jarCount}</td>\n            <td>{sample.siteId}</td>\n            <td>{sample.waterbodyName}</td>\n            <td>{shortDate(sample.sampleDate)}</td>\n            <td>{sample.sampleType}</td>\n            <td></td>\n            <td></td>\n          </tr>\n        ))}\n      </tbody>\n    </Table>\n  </Document>\n)\n","import { ColDef } from 'ag-grid-community'\n\nimport { columnDef } from '../DataGrid'\nimport { ProblemRow } from './CustomerSubmission'\n\nconst columnNumberToLetters = (columnNumber) => {\n  let col = columnNumber - 1\n  let letters = ''\n  while (col >= 0) {\n    letters = 'ABCDEFGHIJKLMNOPQRSTUVWXYZ'[col % 26] + letters\n    col = Math.floor(col / 26) - 1\n  }\n  return letters\n}\n\nexport const problemsColumnDefs = [\n  // columnDef.numberColumn({\n  //   field: 'id',\n  //   width: 100,\n  // }),\n  columnDef.textColumn({\n    headerName: 'Worksheet',\n    field: 'wsName',\n    width: 150,\n  }),\n  columnDef.textColumn({\n    headerName: 'Cell',\n    colId: 'cell',\n    valueGetter: ({ data }: { data: ProblemRow }): string | null => {\n      const { columnNumber, rowNumber } = data\n      if (!columnNumber || !rowNumber) return null\n      return `${columnNumberToLetters(columnNumber)}${rowNumber}`\n    },\n    width: 100,\n  }),\n  columnDef.textColumn({\n    headerName: 'Problem',\n    field: 'message',\n    flex: 1,\n    minWidth: 150,\n  }),\n  columnDef.numberColumn({\n    headerName: 'Column #',\n    field: 'columnNumber',\n    width: 100,\n  }),\n  columnDef.numberColumn({\n    headerName: 'Row #',\n    field: 'rowNumber',\n    width: 100,\n  }),\n] as ColDef[]\n","/** @jsxImportSource @emotion/react */\nimport React from 'react'\nimport { useRecoilValue } from 'recoil'\nimport { useDropzone } from 'react-dropzone'\nimport MuiLinearProgress from '@mui/material/LinearProgress'\nimport UploadFileIcon from '@mui/icons-material/UploadFile'\nimport FilePresentIcon from '@mui/icons-material/FilePresent'\nimport MuiButton from '@mui/material/Button'\nimport Excel from 'exceljs'\n\nimport { Updater } from '../../lib/useUpdatableState'\nimport { useApi } from '../../data/api'\nimport { selectLists, processFile } from '../../lib/submissions'\nimport { ProcessingStatus, emptyProcessResult, State } from './CustomerSubmission'\n\nexport interface UploadFileBoxProps {\n  // onDrop: (files: File[]) => void\n  updateState: (updater: Updater<State>) => void\n  processingToken: number\n  processingStatus: ProcessingStatus\n  filename: string\n}\n\nexport const UploadFileBox = ({\n  updateState,\n  processingToken,\n  processingStatus,\n  filename,\n}: UploadFileBoxProps): JSX.Element => {\n  const lists = useRecoilValue(selectLists)\n\n  const api = useApi()\n\n  const onDrop = (acceptedFiles: File[]) => {\n    const handleError = (message: string) => {\n      updateState((draft) => {\n        draft.processingStatus = 'empty'\n        draft.processResult = emptyProcessResult\n        draft.filename = ''\n        draft.errorMessage = message\n      })\n    }\n\n    if (acceptedFiles.length > 1) {\n      handleError('Only a single template file is allowed.')\n      return\n    }\n\n    const file = acceptedFiles[0]\n    const reader = new FileReader()\n    const thisProcessingToken = processingToken + 1\n\n    updateState((draft) => {\n      draft.lastProcessingStatus = draft.processingStatus\n      draft.processingStatus = 'uploading'\n      draft.processingToken = thisProcessingToken\n      draft.errorMessage = ''\n    })\n\n    reader.onerror = () => {\n      handleError('Could not read template file.')\n    }\n    reader.onload = async () => {\n      updateState((draft) => {\n        draft.processingStatus = 'processing'\n        draft.lastFilename = draft.filename\n        draft.filename = file.name\n      })\n      try {\n        const buffer = reader.result\n        if (!(buffer instanceof ArrayBuffer)) throw new Error('ArrayBuffer error')\n        const wb = new Excel.Workbook()\n        await wb.xlsx.load(buffer)\n\n        const processResult = await processFile(wb, { lists, api })\n\n        updateState((draft) => {\n          if (draft.processingToken !== thisProcessingToken) return // this processing is aborted/stale\n          draft.processingStatus = 'processed'\n          draft.processResult = processResult\n        })\n      } catch (err) {\n        handleError('Could not parse template file.')\n      }\n    }\n    try {\n      reader.readAsArrayBuffer(file)\n    } catch (err) {\n      handleError('Could not read template file.')\n    }\n  }\n\n  const { getRootProps, getInputProps, isDragActive } = useDropzone({\n    onDrop,\n    accept: 'application/vnd.openxmlformats-officedocument.spreadsheetml.sheet',\n  })\n\n  const handleAbort = () => {\n    updateState((draft) => {\n      draft.processingStatus = draft.lastProcessingStatus\n      draft.filename = draft.lastFilename\n      draft.processingToken++\n    })\n  }\n\n  const isPerforming = processingStatus === 'uploading' || processingStatus === 'processing'\n\n  return (\n    <div\n      {...(isPerforming ? {} : getRootProps())}\n      css={{\n        border: isDragActive ? '3px dashed blue' : '3px dashed lightgrey',\n        minHeight: '6em',\n        width: '100%',\n        display: 'flex',\n        flexDirection: 'column',\n        alignItems: 'center',\n        justifyContent: 'center',\n        cursor: isPerforming ? 'default' : 'pointer',\n        position: 'relative',\n      }}\n    >\n      {isPerforming ? (\n        <div css={{ width: '80%' }}>\n          <MuiLinearProgress />\n          <div css={{ textAlign: 'center' }}>\n            <MuiButton onClick={handleAbort}>Cancel</MuiButton>\n          </div>\n        </div>\n      ) : (\n        <div css={{ display: 'flex', width: '80%', minHeight: '3em' }}>\n          <div\n            css={{\n              flex: 1,\n              display: 'flex',\n              alignItems: 'center',\n              justifyContent: 'center',\n              borderRight: '1px solid grey',\n              paddingRight: '1em',\n              textAlign: 'center',\n            }}\n          >\n            {filename ? (\n              <>\n                <FilePresentIcon /> {filename}\n              </>\n            ) : (\n              <>\n                <UploadFileIcon /> No template\n              </>\n            )}\n          </div>\n          <div\n            css={{\n              flex: 1,\n              display: 'flex',\n              alignItems: 'center',\n              justifyContent: 'center',\n              paddingLeft: '1em',\n              textAlign: 'center',\n            }}\n          >\n            <span>\n              Drop here or&nbsp;<a>choose template</a>\n            </span>\n          </div>\n        </div>\n      )}\n      <input {...getInputProps()} />\n    </div>\n  )\n}\n","/** @jsxImportSource @emotion/react */\nimport React from 'react'\nimport Skeleton from '@mui/material/Skeleton'\n\nexport const Fallback = (): JSX.Element => (\n  <div css={{ height: '100%', maxWidth: '70rem', display: 'flex', flexDirection: 'column', gap: '1em' }}>\n    <Skeleton height=\"1em\" variant=\"rectangular\" />\n    <Skeleton height=\"10em\" variant=\"rectangular\" />\n  </div>\n)\n","/** @jsxImportSource @emotion/react */\nimport React from 'react'\n\ninterface StepPageProps {\n  active: boolean\n  className?: string\n  children: React.ReactNode\n}\n\nexport const StepPage = ({ active, className, children, ...rest }: StepPageProps): JSX.Element => (\n  <div\n    className={className}\n    css={{\n      width: '100%',\n      height: '100%',\n      position: 'absolute',\n      visibility: active ? 'visible' : 'hidden',\n    }}\n    {...rest}\n  >\n    {children}\n  </div>\n)\n","import { ColDef } from 'ag-grid-community'\nimport { columnDef } from '../DataGrid'\n\nexport const projectsColumnDefs = [\n  columnDef.linkColumn({\n    field: 'title',\n    flex: 1,\n    minWidth: 140,\n  }),\n  columnDef.textColumn({\n    headerName: 'Project ID',\n    field: 'id',\n    width: 120,\n  }),\n  columnDef.filterableTextColumn({\n    field: 'owner',\n    filterTooltip: 'Filter by this owner',\n    flex: 1,\n    minWidth: 140,\n  }),\n  columnDef.numberColumn({\n    field: 'sampleCount',\n    width: 140,\n  }),\n  columnDef.numberColumn({\n    headerName: 'Model Count',\n    colId: 'modelCount',\n    valueGetter: ({ data }) => data.modelIds.length,\n    width: 140,\n  }),\n  columnDef.dateColumn({\n    headerName: 'Created',\n    field: 'createdDate',\n    width: 140,\n  }),\n  columnDef.dateColumn({\n    headerName: 'Updated',\n    field: 'updatedDate',\n    width: 140,\n  }),\n] as ColDef[]\n","/** @jsxImportSource @emotion/react */\nimport React, { useMemo } from 'react'\nimport { atom, useRecoilState, useRecoilValue } from 'recoil'\nimport Skeleton from '@mui/material/Skeleton'\nimport MuiButton from '@mui/material/Button'\nimport { GrantAction, NAMCResource } from '@namcbugdb/common'\n\nimport { selectMyUser, selectProjects } from '../../data/selectors'\nimport { DataGrid, renderers, DataGridRecordCount } from '../DataGrid'\nimport { Project } from '../../types'\nimport { withSuspense } from '../withSuspense'\nimport { projectsColumnDefs } from './columnDefs'\nimport { Filter, FilterChips } from '../Filters'\nimport { TextFilterField, useTextFilterField } from '../TextFilterField'\nimport { useNavigate } from '../AppRouter'\n\nexport interface ProjectRow extends Project {\n  title: {\n    label: string\n    onClick: () => void\n  }\n  owner: {\n    label: string\n    onFilter: () => void\n    disabled: boolean\n  }\n}\n\nconst textFilterState = atom({\n  key: 'ProjectsListing/textFilterState',\n  default: '',\n})\n\nconst addedFiltersState = atom<Filter<Project>[]>({\n  key: 'ProjectsListing/addedFiltersState',\n  default: [],\n})\n\nexport const ProjectsListing = withSuspense(\n  () => {\n    const navigate = useNavigate()\n    const user = useRecoilValue(selectMyUser)\n    const projects = useRecoilValue(selectProjects)\n\n    // STATE AND REFS\n\n    const [textFilter, setTextFilter, textFilterDebounced, clearTextFilter] = useTextFilterField(\n      useRecoilState(textFilterState)\n    )\n    const [addedFilters, setAddedFilters] = useRecoilState(addedFiltersState)\n\n    // FILTERS\n\n    const filters = useMemo(() => {\n      const result: Filter<Project>[] = []\n\n      if (textFilterDebounced) {\n        if (textFilterDebounced.match(/^\\d+$/)) {\n          const targetBoxId = Number(textFilterDebounced)\n          result.push({\n            id: 'text',\n            label: `Project ${textFilterDebounced}`,\n            filterFn: (box) => box.id === targetBoxId,\n            onDelete: clearTextFilter,\n          })\n        } else {\n          result.push({\n            id: 'text',\n            label: `Title/Owner contains \"${textFilterDebounced}\"`,\n            filterFn: ({ name, contactName }) =>\n              name.toLowerCase().includes(textFilterDebounced.toLowerCase()) ||\n              contactName.toLowerCase().includes(textFilterDebounced.toLowerCase()),\n            onDelete: clearTextFilter,\n          })\n        }\n      }\n\n      result.push(...addedFilters)\n\n      return result\n    }, [textFilterDebounced, addedFilters])\n\n    const rows = useMemo<ProjectRow[]>(() => {\n      const filtered = filters.reduce<Project[]>((acc, { filterFn }) => acc.filter(filterFn), projects)\n      return filtered.map((project) => {\n        const filterId = `filter/${String(project.contactName)}`\n        return {\n          ...project,\n          title: {\n            label: project.name,\n            onClick: () => navigate.projectDetail({ projectId: project.id }),\n          },\n          owner: {\n            label: project.contactName,\n            onFilter: () => {\n              clearTextFilter()\n              setAddedFilters([\n                {\n                  id: filterId,\n                  label: project.contactName,\n                  filterFn: ({ contactName }) => contactName === project.contactName,\n                  onDelete: () => setAddedFilters((value) => value.filter(({ id }) => id !== filterId)),\n                },\n              ])\n            },\n            disabled: !!addedFilters.find(({ id }) => id === filterId) || !project.contactName,\n          },\n        }\n      })\n    }, [projects, filters])\n\n    // RENDER\n\n    return (\n      <div css={{ height: '100%', display: 'flex', flexDirection: 'column' }}>\n        <div css={{ display: 'flex', gap: '0.5em' }}>\n          <TextFilterField value={textFilter} onChange={setTextFilter} label=\"Project ID, Title, Owner\" />\n          {user.hasPermission(NAMCResource.projects, GrantAction.createAny) && (\n            <div css={{ marginLeft: 'auto' }}>\n              <MuiButton\n                variant=\"outlined\"\n                onClick={() => {\n                  navigate.projectCreate()\n                }}\n              >\n                Create New Project\n              </MuiButton>\n            </div>\n          )}\n        </div>\n        <div css={{ minHeight: '2em', marginTop: '0.75em', display: 'flex' }}>\n          <FilterChips filters={filters} joinLabel=\"and\" />\n          <DataGridRecordCount total={projects.length} visible={rows.length} descriptor=\"project\" />\n        </div>\n        <div css={{ flex: 1 }}>\n          <DataGrid<Project> rows={rows} columnDefs={projectsColumnDefs} frameworkComponents={renderers} />\n        </div>\n      </div>\n    )\n  },\n  () => <Skeleton height=\"20em\" />\n)\n","import { ColDef } from 'ag-grid-community'\nimport { columnDef } from '../DataGrid'\n\nexport const translationsColumnDefs = [\n  columnDef.textColumn({\n    headerName: 'Translation ID',\n    field: 'id',\n    width: 150,\n  }),\n  columnDef.textColumn({\n    field: 'name',\n    flex: 1,\n  }),\n  columnDef.booleanColumn({\n    field: 'isActive',\n    valueLabels: ['No', 'Yes'],\n    width: 120,\n  }),\n  columnDef.numberColumn({\n    headerName: 'Taxa Name Count',\n    field: 'taxaCount',\n    width: 150,\n  }),\n  columnDef.dateColumn({\n    headerName: 'Created',\n    field: 'createdDate',\n    width: 140,\n  }),\n  columnDef.dateColumn({\n    headerName: 'Updated',\n    field: 'updatedDate',\n    width: 140,\n  }),\n] as ColDef[]\n","/** @jsxImportSource @emotion/react */\nimport React from 'react'\nimport { useRecoilValue } from 'recoil'\nimport Skeleton from '@mui/material/Skeleton'\n\nimport { selectTranslations } from '../../data/selectors'\nimport { DataGrid } from '../DataGrid'\nimport { Translation } from '../../types'\nimport { withSuspense } from '../withSuspense'\nimport { translationsColumnDefs } from './columnDefs'\nimport { Title } from '../Title'\n\nexport const TranslationsListing = withSuspense(\n  () => {\n    const translations = useRecoilValue(selectTranslations)\n    return (\n      <div css={{ height: '100%', display: 'flex', flexDirection: 'column' }}>\n        <div css={{ flex: 1 }}>\n          <Title>Translations</Title>\n          <DataGrid<Translation> rows={translations} columnDefs={translationsColumnDefs} />\n        </div>\n      </div>\n    )\n  },\n  () => <Skeleton height=\"20em\" />\n)\n","/** @jsxImportSource @emotion/react */\nimport React, { useEffect } from 'react'\n\nimport { ChainOfCustodyForm } from '../../lib/submissions'\nimport { Submission } from '../../types'\n\nexport interface ChainOfCustodyProps {\n  submission: Submission\n  autoPrint?: boolean\n}\n\nexport const ChainOfCustody = ({ submission, autoPrint }: ChainOfCustodyProps): JSX.Element => {\n  useEffect(() => {\n    if (!autoPrint) return\n    window.setTimeout(() => {\n      window.print()\n    }, 500)\n  }, [])\n\n  return <ChainOfCustodyForm submission={submission} />\n}\n","import React from 'react'\nimport { useRecoilValue } from 'recoil'\n\nimport { selectLatestSubmissionByBoxId } from '../../data/selectors'\nimport { withSuspense } from '../withSuspense'\nimport { ChainOfCustody as Component } from './ChainOfCustody'\nimport { Fallback } from './Fallback'\n\ninterface ChainOfCustodyProps {\n  boxId: number\n  autoPrint?: boolean\n}\n\nexport const ChainOfCustody = withSuspense(({ boxId, autoPrint }: ChainOfCustodyProps): JSX.Element => {\n  const submission = useRecoilValue(selectLatestSubmissionByBoxId(Number(boxId)))\n\n  if (submission === null) return <h2>Submission for box {boxId} not found.</h2>\n\n  return <Component submission={submission} autoPrint={autoPrint} />\n}, Fallback)\n","/** @jsxImportSource @emotion/react */\nimport React from 'react'\nimport Skeleton from '@mui/material/Skeleton'\n\nexport const Fallback = (): JSX.Element => (\n  <div css={{ height: '100%', display: 'flex', flexDirection: 'column', gap: '1em' }}>\n    <Skeleton height=\"1em\" width=\"20em\" />\n    <Skeleton height=\"1em\" width=\"20em\" />\n    <Skeleton height=\"1em\" width=\"20em\" />\n    <Skeleton height=\"1em\" width=\"20em\" />\n    <Skeleton height=\"10em\" width=\"40em\" />\n  </div>\n)\n","/** @jsxImportSource @emotion/react */\nimport React from 'react'\nimport CircularProgress from '@mui/material/CircularProgress'\n\nexport interface FullScreenWaitProps {\n  children: React.ReactNode\n}\n\nexport const FullScreenWait = ({ children }: FullScreenWaitProps): JSX.Element => (\n  <div\n    css={{\n      height: '100vh',\n      width: '100%',\n      display: 'flex',\n      flexDirection: 'column',\n      alignItems: 'center',\n      justifyContent: 'center',\n      position: 'fixed',\n      zIndex: 1000,\n      backgroundColor: 'ffffff88',\n    }}\n  >\n    <CircularProgress />\n    {children}\n  </div>\n)\n","/** @jsxImportSource @emotion/react */\nimport React from 'react'\nimport { useRecoilValue } from 'recoil'\nimport Skeleton from '@mui/material/Skeleton'\nimport { uniq } from 'lodash'\n\nimport { selectRoles } from '../../data/selectors'\nimport { ReadOnlyField } from '../ReadOnlyField'\nimport { withSuspense } from '../withSuspense'\nimport { AutocompleteArrayField, AutocompleteArrayFieldProps } from '../AutocompleteArrayField'\n\nexport type RolesFieldProps = Omit<AutocompleteArrayFieldProps, 'options'> & { hideRoleLevel?: number }\n\nexport const RolesField = withSuspense<RolesFieldProps>(\n  ({ value, onChange, hideRoleLevel = -1, ...restProps }): JSX.Element => {\n    const roles = useRecoilValue(selectRoles)\n\n    const hiddenIds = roles.filter(({ level }) => level <= hideRoleLevel).map(({ id }) => id)\n\n    const options = roles\n      .filter(({ id }) => !hiddenIds.includes(id))\n      .map(({ id: value, name: label }) => ({\n        value,\n        label,\n      }))\n\n    const displayValue = value.filter((id) => !hiddenIds.includes(Number(id)))\n    const hiddenValue = value.filter((id) => hiddenIds.includes(Number(id)))\n\n    const handleChange = (value) => onChange(uniq([...value, ...hiddenValue]))\n\n    return <AutocompleteArrayField value={displayValue} onChange={handleChange} {...restProps} options={options} />\n  },\n  (props) => <ReadOnlyField {...props} value={<Skeleton />} />\n)\n","/** @jsxImportSource @emotion/react */\nimport React from 'react'\nimport { selector, useRecoilValue } from 'recoil'\nimport MuiButton from '@mui/material/Button'\n\nimport { useUpdatableState } from '../../lib/useUpdatableState'\nimport { TextField } from '../TextField'\nimport { CheckboxField } from '../CheckboxField'\nimport { AutocompleteField } from '../AutocompleteField'\nimport {\n  selectDefaultOrganizationTypeId,\n  selectMyUser,\n  selectOrganizations,\n  selectRoles,\n  selectSystemAdminRoleLevel,\n  selectUsCountryId,\n  selectUsStates,\n  useInvalidate,\n} from '../../data/selectors'\nimport { Organization, User } from '../../types'\nimport { GrantAction, NAMCResource } from '@namcbugdb/common'\nimport { RolesField } from './RolesField'\nimport {\n  createOrganizationWithUser,\n  deleteOrganization,\n  updateOrganization,\n  updateUser,\n  updateUserRoles,\n} from '../../data/calls'\nimport { useApi } from '../../data/api'\nimport { useNotifications } from '../AppNotifications'\nimport { ConfirmNavigateAway } from '../AppRouter'\nimport { useDeferredInvalidate } from '../../data/selectors/invalidate'\nimport { Title } from '../Title'\n\nexport interface UserDetailProps {\n  user?: User\n  organization?: Organization\n  isSelf?: boolean\n}\n\ninterface Fields {\n  firstName: string\n  lastName: string\n  userPhone: string\n  affiliationId: number | null\n  deleteOldOrganization: boolean\n  roleIds: number[]\n  organizationName: string\n  address1: string\n  address2: string\n  city: string\n  usStateId: number | null\n  zipCode: string\n  organizationPhone: string\n}\n\ntype FieldErrors = Partial<Record<keyof Fields, boolean>> | undefined\n\ninterface State {\n  editMode: 'stopped' | 'started' | 'stopping'\n  isDirty: boolean\n  values: Fields\n  lastValues?: Fields\n}\n\nconst selectOrganizationOptions = selector({\n  key: 'UserDetail/selectOrganizationOptions',\n  get: async ({ get }) => {\n    const organizations = get(selectOrganizations)\n    return organizations.map(({ id: value, name: label }) => ({ value, label }))\n  },\n})\n\nconst selectUsStateOptions = selector({\n  key: 'UserDetail/selectUsStateOptions',\n  get: async ({ get }) => {\n    const usStates = get(selectUsStates)\n    return usStates.map(({ id: value, abbreviation: label }) => ({ value, label }))\n  },\n})\n\nconst getInitialState = ({ user, organization }: Pick<UserDetailProps, 'user' | 'organization'>): State => ({\n  editMode: !user && !organization ? 'started' : 'stopped',\n  isDirty: false,\n  values: {\n    firstName: user?.firstName || '',\n    lastName: user?.lastName || '',\n    userPhone: user?.phone || '',\n    affiliationId: user?.affiliationId || null,\n    deleteOldOrganization: true,\n    roleIds: user?.roleIds || [],\n    organizationName: organization?.name || '',\n    address1: organization?.address1 || '',\n    address2: organization?.address2 || '',\n    city: organization?.city || '',\n    usStateId: organization?.usStateId || null,\n    zipCode: organization?.zipCode || '',\n    organizationPhone: organization?.phone || '',\n  },\n})\n\nexport const UserDetail = ({ user, organization, isSelf }: UserDetailProps): JSX.Element => {\n  const api = useApi()\n  const invalidate = useInvalidate()\n  const deferredInvalidate = useDeferredInvalidate()\n  const notifications = useNotifications()\n  // eslint-disable-next-line @typescript-eslint/no-unused-vars\n  const [state, setState, updateState] = useUpdatableState<State>(getInitialState({ user, organization }), [\n    user?.id,\n    organization?.id,\n  ])\n\n  const operatorUser = useRecoilValue(selectMyUser)\n  const usCountryId = useRecoilValue(selectUsCountryId)\n  const typeId = useRecoilValue(selectDefaultOrganizationTypeId)\n  const roles = useRecoilValue(selectRoles)\n  const systemAdminRoleLevel = useRecoilValue(selectSystemAdminRoleLevel)\n\n  const { values, editMode, isDirty } = state\n\n  const canUpdateOwnUser = operatorUser.hasPermission(NAMCResource.individuals, GrantAction.updateOwn)\n  const canUpdateAnyUser = operatorUser.hasPermission(NAMCResource.individuals, GrantAction.updateAny)\n  const isNewUser = !user && !organization\n  const isOtherSystemAdmin =\n    !isSelf &&\n    (user?.roleIds || []).some((roleId) =>\n      roles.find(({ id, level }) => roleId === id && level === systemAdminRoleLevel)\n    )\n  const isEditable = editMode === 'started'\n  const isEditingUserFields = isEditable\n  const isEditingOrganizationFields = isEditable && isSelf\n  const isShowingAdminOnlyControls = !isSelf && canUpdateAnyUser\n  const isShowingDeleteOldOrganization =\n    isShowingAdminOnlyControls &&\n    isEditable &&\n    values.affiliationId !== user?.affiliationId &&\n    organization?.userCount === 1\n\n  const errors: FieldErrors = (() => {\n    const result: FieldErrors = {}\n    if (isEditingUserFields) {\n      result.firstName = !values.firstName.trim()\n      result.lastName = !values.lastName.trim()\n    }\n    if (isEditingOrganizationFields) {\n      result.organizationName = values.organizationName.trim().length < 3\n    }\n\n    if (!Object.values(result).some((value) => value)) return undefined\n    return result\n  })()\n\n  const setFieldValue = (fieldName: keyof Fields, value: unknown) => {\n    updateState((draft) => {\n      Object.assign(draft.values, { [fieldName]: value })\n      draft.isDirty = true\n    })\n  }\n\n  const onEdit = () => {\n    updateState((draft) => {\n      draft.editMode = 'started'\n      draft.lastValues = draft.values\n    })\n  }\n\n  const onCancel = () => {\n    updateState((draft) => {\n      if (!draft.lastValues) throw new Error('no values to revert to')\n      draft.editMode = 'stopped'\n      draft.values = draft.lastValues\n      draft.isDirty = false\n    })\n  }\n\n  const onSave = async () => {\n    try {\n      updateState((draft) => {\n        draft.editMode = 'stopping'\n      })\n      if (isNewUser) {\n        // new user\n        await createOrganizationWithUser(\n          api,\n          invalidate\n        )({\n          organization: {\n            name: values.organizationName,\n            typeId,\n            address1: values.address1,\n            address2: values.address2,\n            city: values.city,\n            countryId: usCountryId,\n            phone: values.organizationPhone,\n            usStateId: values.usStateId,\n            zipCode: values.zipCode,\n          },\n          user: {\n            firstName: values.firstName,\n            lastName: values.lastName,\n            phone: values.userPhone,\n          },\n        })\n        // page automatically refreshes here\n      } else {\n        // existing user\n        if (isEditingOrganizationFields) {\n          // TODO: only if field changes\n          if (!organization?.id) throw new Error('no organization ID')\n          if (!organization?.countryId) throw new Error('no organization country ID')\n          if (!organization?.typeId) throw new Error('no organization type ID')\n          await updateOrganization(\n            api,\n            deferredInvalidate\n          )({\n            id: organization.id,\n            name: values.organizationName,\n            address1: values.address1,\n            address2: values.address2,\n            city: values.city,\n            zipCode: values.zipCode,\n            usStateId: values.usStateId,\n            countryId: organization.countryId,\n            phone: values.organizationPhone,\n            typeId: organization.typeId,\n          })\n        }\n        if (isEditingUserFields) {\n          // TODO: only if field changes\n          if (!user?.id) throw new Error('no user ID')\n          const isAffiliationChanged = user.affiliationId !== values.affiliationId\n          await updateUser(api, isAffiliationChanged ? invalidate : deferredInvalidate)(\n            {\n              id: user.id,\n              firstName: values.firstName,\n              lastName: values.lastName,\n              affiliationId: values.affiliationId,\n              phone: values.userPhone,\n            },\n            !!isSelf\n          )\n        }\n        if (isShowingAdminOnlyControls) {\n          // TODO: only if roles changes\n          if (!user?.id) throw new Error('no user ID')\n          await updateUserRoles(\n            api,\n            deferredInvalidate\n          )({\n            id: user.id,\n            roleIds: values.roleIds,\n          })\n        }\n        if (isShowingDeleteOldOrganization && values.deleteOldOrganization) {\n          try {\n            await deleteOrganization(api, invalidate)(organization)\n          } catch (err) {\n            notifications.error(`Failed to delete organization: ${err}`)\n          }\n        }\n      }\n      updateState((draft) => {\n        draft.editMode = 'stopped'\n        draft.isDirty = false\n      })\n    } catch (err) {\n      notifications.error(`Failed to save: ${err}`)\n      updateState((draft) => {\n        draft.editMode = 'started'\n      })\n    }\n  }\n\n  return (\n    <>\n      <div css={{ maxWidth: '40rem' }}>\n        <div css={{ display: 'flex', gap: '0.5em', alignItems: 'center' }}>\n          <Title css={{ marginRight: 'auto' }}>\n            {isNewUser ? 'Create New User' : user?.email || <em>no email address</em>}\n          </Title>\n          {editMode !== 'stopped' && !isNewUser && (\n            <MuiButton variant=\"outlined\" onClick={onCancel} disabled={editMode === 'stopping'}>\n              Cancel\n            </MuiButton>\n          )}\n          {editMode !== 'stopped' && (\n            <MuiButton variant=\"contained\" onClick={onSave} disabled={!!errors || editMode === 'stopping' || !isDirty}>\n              Save\n            </MuiButton>\n          )}\n          {editMode === 'stopped' && ((isSelf && canUpdateOwnUser) || canUpdateAnyUser) && (\n            <MuiButton variant=\"outlined\" onClick={onEdit} disabled={isOtherSystemAdmin}>\n              Edit\n            </MuiButton>\n          )}\n        </div>\n        <h4 css={{ margin: '0.75em 0' }}>User</h4>\n        <div\n          css={{\n            display: 'grid',\n            gap: '0.75em',\n            gridTemplateColumns: '1fr 1fr',\n            gridTemplateAreas: `\n              \"firstName  lastName\"\n              \"userPhone  .\"\n          `,\n          }}\n        >\n          <TextField\n            gridArea=\"firstName\"\n            value={values.firstName}\n            onChange={(value) => setFieldValue('firstName', value)}\n            label=\"First Name\"\n            error={errors?.firstName}\n            readOnly={!isEditingUserFields}\n            maxLength={255}\n          />\n          <TextField\n            gridArea=\"lastName\"\n            value={values.lastName}\n            onChange={(value) => setFieldValue('lastName', value)}\n            label=\"Last Name\"\n            error={errors?.lastName}\n            readOnly={!isEditingUserFields}\n            maxLength={255}\n          />\n          <TextField\n            gridArea=\"userPhone\"\n            value={values.userPhone}\n            onChange={(value) => setFieldValue('userPhone', value)}\n            label=\"Phone\"\n            error={errors?.userPhone}\n            readOnly={!isEditingUserFields}\n            maxLength={50}\n          />\n        </div>\n        {isShowingAdminOnlyControls && (\n          <>\n            <h4 css={{ margin: '0.75em 0' }}>Roles and Affiliation</h4>\n            <div\n              css={{\n                display: 'flex',\n                flexDirection: 'column',\n                gap: '0.75em',\n              }}\n            >\n              <AutocompleteField\n                label=\"Belongs To\"\n                gridArea=\"affiliationId\"\n                optionsSelector={selectOrganizationOptions}\n                valueLabel={user?.organizationName || ''}\n                value={values.affiliationId}\n                onChange={(value) => setFieldValue('affiliationId', value)}\n                error={errors?.affiliationId}\n                readOnly={!isEditable}\n              />\n              {isShowingDeleteOldOrganization && (\n                <CheckboxField\n                  label={`Delete \"${user?.organizationName}\" organization with no remaining users and move any orphaned resources to the selected organization`}\n                  gridArea=\"deleteOldOrganization\"\n                  value={values.deleteOldOrganization}\n                  onChange={(value) => setFieldValue('deleteOldOrganization', value)}\n                />\n              )}\n              <RolesField\n                label=\"Roles\"\n                gridArea=\"roleIds\"\n                value={values.roleIds}\n                onChange={(value) => setFieldValue('roleIds', value)}\n                error={errors?.roleIds}\n                readOnly={!isEditable}\n                hideRoleLevel={isOtherSystemAdmin ? undefined : systemAdminRoleLevel}\n              />\n            </div>\n          </>\n        )}\n        <h4 css={{ margin: '0.75em 0' }}>Organization</h4>\n        <div\n          css={{\n            display: 'grid',\n            gap: '0.75em',\n            gridTemplateColumns: '1fr 1fr',\n            gridTemplateAreas: `\n                        \"organizationName   organizationName\"\n                        \"address1           address1\"\n                        \"address2           address2\"\n                        \"city               city\"\n                        \"usStateId          zipCode\"\n                        \"organizationPhone  .\"\n                      `,\n          }}\n        >\n          <TextField\n            gridArea=\"organizationName\"\n            value={values.organizationName}\n            onChange={(value) => setFieldValue('organizationName', value)}\n            label=\"Organization Name\"\n            error={errors?.organizationName}\n            readOnly={!isEditingOrganizationFields}\n            maxLength={255}\n          />\n          <TextField\n            gridArea=\"address1\"\n            value={values.address1}\n            onChange={(value) => setFieldValue('address1', value)}\n            label=\"Address 1\"\n            error={errors?.address1}\n            readOnly={!isEditingOrganizationFields}\n            maxLength={255}\n          />\n          <TextField\n            gridArea=\"address2\"\n            value={values.address2}\n            onChange={(value) => setFieldValue('address2', value)}\n            label=\"Address 2\"\n            error={errors?.address2}\n            readOnly={!isEditingOrganizationFields}\n            maxLength={255}\n          />\n          <TextField\n            gridArea=\"city\"\n            value={values.city}\n            onChange={(value) => setFieldValue('city', value)}\n            label=\"City\"\n            error={errors?.city}\n            readOnly={!isEditingOrganizationFields}\n            maxLength={255}\n          />\n          <AutocompleteField\n            gridArea=\"usStateId\"\n            value={values.usStateId}\n            valueLabel=\"State\"\n            onChange={(value) => setFieldValue('usStateId', value)}\n            optionsSelector={selectUsStateOptions}\n            label=\"State\"\n            error={errors?.usStateId}\n            readOnly={!isEditingOrganizationFields}\n            isClearable\n          />\n          <TextField\n            gridArea=\"zipCode\"\n            value={values.zipCode}\n            onChange={(value) => setFieldValue('zipCode', value)}\n            label=\"Zip\"\n            error={errors?.zipCode}\n            readOnly={!isEditingOrganizationFields}\n            maxLength={20}\n          />\n          <TextField\n            gridArea=\"organizationPhone\"\n            value={values.organizationPhone}\n            onChange={(value) => setFieldValue('organizationPhone', value)}\n            label=\"Phone\"\n            error={errors?.organizationPhone}\n            readOnly={!isEditingOrganizationFields}\n            maxLength={50}\n          />\n        </div>\n      </div>\n      {isDirty && <ConfirmNavigateAway message=\"Some changes are not saved. Are you sure you want to leave?\" />}\n    </>\n  )\n}\n","/** @jsxImportSource @emotion/react */\nimport React from 'react'\nimport Skeleton from '@mui/material/Skeleton'\n\nexport const Fallback = (): JSX.Element => (\n  <div css={{ height: '100%', width: '40rem', display: 'flex', flexDirection: 'column', gap: '1em' }}>\n    <Skeleton height=\"2em\" variant=\"rectangular\" />\n    <Skeleton height=\"5em\" variant=\"rectangular\" />\n    <Skeleton height=\"15em\" variant=\"rectangular\" />\n  </div>\n)\n","import React from 'react'\nimport { useRecoilValue } from 'recoil'\n\nimport { selectMyUser, selectOrganizationById, selectUserById } from '../../data/selectors'\nimport { withSuspense } from '../withSuspense'\nimport { UserDetail as Component } from './UserDetail'\nimport { Fallback } from './Fallback'\n\nexport const UserDetail = withSuspense(({ userId }: { userId: string | number }): JSX.Element => {\n  const user = useRecoilValue(selectUserById(Number(userId)))\n  const organization = useRecoilValue(selectOrganizationById(user?.affiliationId || 0)) // TODO: do this in another layer of component?\n\n  if (!user) return <h2>User {userId} not found.</h2>\n  if (!organization) return <h2>User {userId} organization not found.</h2>\n\n  return <Component user={user} organization={organization} />\n}, Fallback)\n\nexport const MyUserDetail = withSuspense((): JSX.Element => {\n  const user = useRecoilValue(selectMyUser)\n  const organization = useRecoilValue(selectOrganizationById(user.affiliationId)) ?? undefined\n\n  return <Component user={user} organization={organization} isSelf />\n}, Fallback)\n\nexport const NewUserDetail = withSuspense((): JSX.Element => {\n  return <Component isSelf />\n}, Fallback)\n","import { ColDef } from 'ag-grid-community'\nimport { columnDef } from '../DataGrid'\n\nexport const usersColumnDefs = [\n  columnDef.linkColumn({\n    headerName: 'User ID',\n    field: 'userId',\n    width: 120,\n  }),\n  columnDef.textColumn({\n    field: 'firstName',\n    flex: 1,\n    minWidth: 120,\n  }),\n  columnDef.textColumn({\n    field: 'lastName',\n    flex: 1,\n    minWidth: 120,\n  }),\n  columnDef.textColumn({\n    headerName: 'Telephone',\n    field: 'phone',\n    flex: 1,\n    minWidth: 120,\n  }),\n  columnDef.textColumn({\n    field: 'email',\n    flex: 1,\n    minWidth: 120,\n  }),\n  columnDef.textColumn({\n    headerName: 'Affiliation',\n    field: 'organizationName',\n    flex: 1,\n    minWidth: 120,\n  }),\n  columnDef.textListColumn({\n    field: 'roles',\n    flex: 1,\n    minWidth: 120,\n  }),\n] as ColDef[]\n","/** @jsxImportSource @emotion/react */\nimport React, { useMemo } from 'react'\nimport { useRecoilState, atom, useRecoilValue } from 'recoil'\nimport { sortBy } from 'lodash'\n// import log from 'loglevel'\n\nimport { DataGrid, renderers, DataGridRecordCount } from '../DataGrid'\nimport { User } from '../../types'\nimport { usersColumnDefs } from './columnDefs'\nimport { useNavigate } from '../AppRouter'\nimport { Filter, FilterChips } from '../Filters'\nimport { withSuspense } from '../withSuspense'\nimport { Fallback } from './Fallback'\nimport { selectRoles, selectUsers } from '../../data/selectors'\nimport { TextFilterField, useTextFilterField } from '../TextFilterField'\n\nexport interface UserRow extends User {\n  userId: {\n    label: string\n    onClick: () => void\n  }\n}\n\nconst textFilterState = atom({\n  key: 'UsersListing/textFilterState',\n  default: '',\n})\n\nexport const UsersListing = withSuspense((): JSX.Element => {\n  const navigate = useNavigate()\n  const users = useRecoilValue(selectUsers)\n  const roles = useRecoilValue(selectRoles)\n\n  // STATE AND REFS\n\n  const [textFilter, setTextFilter, textFilterDebounced, clearTextFilter] = useTextFilterField(\n    useRecoilState(textFilterState)\n  )\n\n  // FILTERS\n\n  const filters = useMemo(() => {\n    const result: Filter<User>[] = []\n\n    if (textFilterDebounced) {\n      const filterText = textFilterDebounced.toLowerCase()\n      result.push({\n        id: 'text',\n        label: `Name/Affiliation contains \"${textFilterDebounced}\"`,\n        filterFn: ({ fullName, organizationName }) =>\n          fullName.toLowerCase().includes(filterText) || organizationName.toLowerCase().includes(filterText),\n        onDelete: clearTextFilter,\n      })\n    }\n\n    return result\n  }, [textFilterDebounced])\n\n  const rows = useMemo<UserRow[]>(() => {\n    const filtered = filters.reduce<User[]>((acc, { filterFn }) => acc.filter(filterFn), users)\n    return filtered.map((user) => ({\n      ...user,\n      userId: {\n        label: String(user.id),\n        onClick: () => navigate.userDetail({ userId: user.id }),\n      },\n      roles: sortBy(user.roleIds).map((roleId) => roles.find((role) => role.id === roleId)?.name || 'Unknown'),\n    }))\n  }, [users, filters])\n\n  // RENDER\n\n  return (\n    <div css={{ height: '100%', display: 'flex', flexDirection: 'column' }}>\n      <div css={{ display: 'flex', gap: '0.5em' }}>\n        <TextFilterField value={textFilter} onChange={setTextFilter} label=\"Name or Affiliation\" />\n      </div>\n      <div css={{ minHeight: '2em', marginTop: '0.75em', display: 'flex' }}>\n        <FilterChips filters={filters} joinLabel=\"and\" />\n        <DataGridRecordCount total={users.length} visible={rows.length} descriptor=\"users\" />\n      </div>\n      <div css={{ flex: 1 }}>\n        <DataGrid<UserRow> rows={rows} columnDefs={usersColumnDefs} frameworkComponents={renderers} />\n      </div>\n    </div>\n  )\n}, Fallback)\n","/** @jsxImportSource @emotion/react */\nimport React from 'react'\nimport Skeleton from '@mui/material/Skeleton'\n\nexport const Fallback = (): JSX.Element => (\n  <div css={{ height: '100%', display: 'flex', flexDirection: 'column', gap: '1em' }}>\n    <div css={{ width: '40em' }}>\n      <Skeleton height=\"3em\" variant=\"rectangular\" />\n    </div>\n    <div css={{ width: '10em' }}>\n      <Skeleton height=\"2em\" variant=\"rectangular\" />\n    </div>\n    <Skeleton height=\"20em\" variant=\"rectangular\" />\n  </div>\n)\n","/** @jsxImportSource @emotion/react */\nimport React from 'react'\nimport TextField, { StandardTextFieldProps } from '@mui/material/TextField'\n\nimport { ReadOnlyField } from '../ReadOnlyField'\nimport { CommonFieldProps } from '../../types'\n\ninterface DateFieldProps extends CommonFieldProps<string | null>, Omit<StandardTextFieldProps, 'value' | 'onChange'> {\n  inputRef?: React.Ref<HTMLInputElement>\n  max?: string\n  min?: string\n}\n\nexport const DateField = ({\n  // CommonFieldProps\n  className,\n  disabled,\n  error,\n  gridArea,\n  label,\n  onChange,\n  readOnly,\n  value,\n\n  // DateField\n  inputRef,\n  max,\n  min,\n\n  // StandardTextFieldProps\n  ...restProps\n}: DateFieldProps): JSX.Element => {\n  if (readOnly) return <ReadOnlyField className={className} gridArea={gridArea} label={label} value={value} />\n\n  const handleChange = ({ target: { value: newValue } }) => {\n    if (min !== undefined && newValue < min) return\n    if (max !== undefined && newValue > max) return\n    onChange(newValue)\n  }\n\n  return (\n    <TextField\n      size=\"small\"\n      className={className}\n      disabled={disabled}\n      error={error}\n      inputRef={inputRef}\n      label={label}\n      onChange={handleChange}\n      value={value ?? ''}\n      type=\"date\"\n      InputLabelProps={{ shrink: true }}\n      InputProps={{ sx: { color: value ? undefined : '#868686' } }}\n      css={{ gridArea }}\n      {...restProps}\n    />\n  )\n}\n","/** @jsxImportSource @emotion/react */\nimport React, { useEffect, useMemo, useRef, useState } from 'react'\nimport { selector, useRecoilValue } from 'recoil'\nimport { identity, sortBy } from 'lodash'\nimport MuiSkeleton from '@mui/material/Skeleton'\nimport MuiTextField from '@mui/material/TextField'\nimport MuiAutocomplete from '@mui/material/Autocomplete'\n// import log from 'loglevel'\n\nimport { TaxonomySelectField } from '../TaxonomyField'\nimport { withSuspense } from '../withSuspense'\nimport { ReadOnlyField } from '../ReadOnlyField'\nimport {\n  selectBoxes,\n  selectLookups,\n  selectOrganizations,\n  selectProjects,\n  selectTaxa,\n  selectUsStates,\n} from '../../data/selectors'\n\nexport type CriterionOption<T> = {\n  id: T\n  optionLabel: string\n  chipLabel: string\n  disabled?: boolean\n}\n\ninterface CriterionFieldProps<T> {\n  value: CriterionOption<T> | null\n  onChange: (newValue: CriterionOption<T> | null) => void\n  gridArea: string\n}\n\nconst selectBoxOptions = selector<CriterionOption<number>[]>({\n  key: 'ModifyProjectSamples/selectBoxOptions',\n  get: ({ get }) => {\n    const boxes = get(selectBoxes)\n    return sortBy(boxes, 'id')\n      .reverse()\n      .map(({ id, alias, sampleCount, boxState }) => ({\n        id,\n        optionLabel: `Box ${id}${alias ? `: ${alias}` : ''} (${boxState}, ${sampleCount} samples)`,\n        chipLabel: `from box ${id}`,\n        disabled: sampleCount === 0 || boxState === 'Pending',\n      }))\n  },\n})\n\nconst selectUsStateOptions = selector<CriterionOption<number>[]>({\n  key: 'ModifyProjectSamples/selectUsStateOptions',\n  get: async ({ get }) => {\n    const usStates = get(selectUsStates)\n    return usStates.map(({ id, name }) => ({ id, optionLabel: name, chipLabel: `in ${name}` }))\n  },\n})\n\nconst selectOrganizationOptions = selector<CriterionOption<number>[]>({\n  key: 'ModifyProjectSamples/selectOrganizationOptions',\n  get: async ({ get }) => {\n    const organizations = get(selectOrganizations)\n    return sortBy(organizations, 'name').map(({ id, name }) => ({ id, optionLabel: name, chipLabel: `for ${name}` }))\n  },\n})\n\nconst selectProjectOptions = selector<CriterionOption<number>[]>({\n  key: 'ModifyProjectSamples/selectProjectOptions',\n  get: async ({ get }) => {\n    const projects = get(selectProjects)\n    return sortBy(projects, 'name').map(({ id, name }) => ({ id, optionLabel: name, chipLabel: `in project ${name}` }))\n  },\n})\n\nconst selectTypeOptions = selector<CriterionOption<string>[]>({\n  key: 'ModifyProjectSamples/selectTypeOptions',\n  get: async ({ get }) => {\n    const typeNames = get(selectLookups).sampleTypeNames\n    return typeNames.map((typeName) => ({ id: typeName, optionLabel: typeName, chipLabel: `type is ${typeName}` }))\n  },\n})\n\nconst selectMethodOptions = selector<CriterionOption<string>[]>({\n  key: 'ModifyProjectSamples/selectMethodOptions',\n  get: async ({ get }) => {\n    const methodNames = get(selectLookups).sampleMethodNames\n    return methodNames.map((methodName) => ({\n      id: methodName,\n      optionLabel: methodName,\n      chipLabel: `method is ${methodName}`,\n    }))\n  },\n})\n\nconst CriterionAutocomplete = <T,>({\n  value,\n  gridArea,\n  onChange,\n  label,\n  options,\n}: CriterionFieldProps<T> & { label: string; options: CriterionOption<T>[] }) => (\n  <MuiAutocomplete\n    options={options}\n    getOptionLabel={(option) => option.optionLabel}\n    getOptionDisabled={(option) => !!option.disabled}\n    renderInput={(params) => <MuiTextField {...params} label={label} />}\n    onChange={(event, selected) => {\n      onChange(selected)\n    }}\n    size=\"small\"\n    value={value && options.find((option) => option.id === value.id)}\n    css={{ gridArea }}\n  />\n)\n\nexport const BoxCriterionField = withSuspense(\n  (props: CriterionFieldProps<number>): JSX.Element => {\n    const options = useRecoilValue(selectBoxOptions)\n    return <CriterionAutocomplete {...props} options={options} label=\"Box\" />\n  },\n  ({ gridArea }) => <ReadOnlyField css={{ gridArea }} value={<MuiSkeleton />} label=\"Box\" />\n)\n\nexport const UsStateCriterionField = withSuspense(\n  (props: CriterionFieldProps<number>): JSX.Element => {\n    const options = useRecoilValue(selectUsStateOptions)\n    return <CriterionAutocomplete {...props} options={options} label=\"US State\" />\n  },\n  ({ gridArea }) => <ReadOnlyField css={{ gridArea }} value={<MuiSkeleton />} label=\"US State\" />\n)\n\nexport const OrganizationCriterionField = withSuspense(\n  (props: CriterionFieldProps<number>): JSX.Element => {\n    const options = useRecoilValue(selectOrganizationOptions)\n    return <CriterionAutocomplete {...props} options={options} label=\"Customer\" />\n  },\n  ({ gridArea }) => <ReadOnlyField css={{ gridArea }} value={<MuiSkeleton />} label=\"Customer\" />\n)\n\nexport const ProjectCriterionField = withSuspense(\n  ({ thisProjectId, ...restProps }: CriterionFieldProps<number> & { thisProjectId: number }): JSX.Element => {\n    const allProjectOptions = useRecoilValue(selectProjectOptions)\n    const options = useMemo(\n      () => allProjectOptions.map((option) => ({ ...option, disabled: option.id === thisProjectId })),\n      [allProjectOptions]\n    )\n    return <CriterionAutocomplete {...restProps} options={options} label=\"Project\" />\n  },\n  ({ gridArea }) => <ReadOnlyField css={{ gridArea }} value={<MuiSkeleton />} label=\"Project\" />\n)\n\nexport const TaxonomyCriterionField = withSuspense(\n  ({ value, onChange, gridArea }: CriterionFieldProps<number>) => {\n    const taxa = useRecoilValue(selectTaxa)\n    const handleChange = (newId: number | null) => {\n      onChange(\n        newId === null\n          ? null\n          : {\n              id: newId,\n              optionLabel: '',\n              chipLabel: `contains ${taxa.find((t) => t.id === newId)?.name}`,\n            }\n      )\n    }\n    return (\n      <TaxonomySelectField\n        label=\"Taxonomy\"\n        options={taxa}\n        value={value && value.id}\n        onChange={handleChange}\n        gridArea={gridArea}\n      />\n    )\n  },\n  ({ gridArea }) => <ReadOnlyField gridArea={gridArea} label=\"Taxonomy\" value={<MuiSkeleton />} />\n)\n\ninterface SampleIdsFieldProps {\n  value: number[]\n  onChange: (sampleIds: number[]) => void\n  gridArea: string\n}\n\nexport const SampleIdsCriterionField = ({ value, onChange, gridArea }: SampleIdsFieldProps): JSX.Element => {\n  const debounceTimerRef = useRef<NodeJS.Timeout>()\n\n  const [text, setText] = useState('')\n  const [isFocused, setIsFocused] = useState(false)\n\n  const setValueFromText = () => {\n    onChange(\n      text\n        .split(/[,\\s]+/)\n        .filter(identity)\n        .map((v) => Number(v))\n    )\n  }\n\n  useEffect(() => {\n    if (debounceTimerRef.current) clearTimeout(debounceTimerRef.current)\n    debounceTimerRef.current = setTimeout(() => {\n      if (!isFocused) return\n      setValueFromText()\n    }, 1000)\n  }, [text, isFocused])\n\n  const handleFocus = () => {\n    setIsFocused(true)\n  }\n\n  const handleBlur = () => {\n    setIsFocused(false)\n    setValueFromText()\n  }\n\n  useEffect(() => {\n    if (isFocused) return\n    setText(value.join(', '))\n  }, [value])\n\n  return (\n    <MuiTextField\n      css={{ width: '100%', gridArea }}\n      label=\"Sample IDs\"\n      value={text}\n      onChange={(e) => {\n        setText(e.target.value.replace(/[^0-9,\\s]/g, '')) // only allow: 0-9 <comma> <whitespace>\n      }}\n      onFocus={handleFocus}\n      onBlur={handleBlur}\n      multiline\n      minRows={2}\n      maxRows={2}\n    />\n  )\n}\n\nexport const TypeCriterionField = withSuspense(\n  (props: CriterionFieldProps<string>): JSX.Element => {\n    const options = useRecoilValue(selectTypeOptions)\n    return <CriterionAutocomplete {...props} options={options} label=\"Sample Type\" />\n  },\n  ({ gridArea }) => <ReadOnlyField css={{ gridArea }} value={<MuiSkeleton />} label=\"Sample Type\" />\n)\n\nexport const MethodCriterionField = withSuspense(\n  (props: CriterionFieldProps<string>): JSX.Element => {\n    const options = useRecoilValue(selectMethodOptions)\n    return <CriterionAutocomplete {...props} options={options} label=\"Sample Method\" />\n  },\n  ({ gridArea }) => <ReadOnlyField css={{ gridArea }} value={<MuiSkeleton />} label=\"Sample Method\" />\n)\n","/** @jsxImportSource @emotion/react */\nimport React, { useEffect, useState } from 'react'\nimport { atom, useRecoilCallback, useRecoilState } from 'recoil'\nimport { identity, intersectionBy } from 'lodash'\nimport produce from 'immer'\nimport MuiButton from '@mui/material/Button'\nimport AddCircleIcon from '@mui/icons-material/AddCircle'\nimport RemoveCircleIcon from '@mui/icons-material/RemoveCircle'\nimport ToggleButton from '@mui/material/ToggleButton'\nimport ToggleButtonGroup from '@mui/material/ToggleButtonGroup'\n// import log from 'loglevel'\n\nimport {\n  selectBoxSamplesByBoxId,\n  selectMinimalSamplesByOrganizationId,\n  selectMinimalSamplesByTaxonId,\n  selectMinimalSamplesByUsStateId,\n  selectProjectSamplesByProjectId,\n} from '../../data/selectors'\nimport { MinimalSample } from '../../types'\nimport { Filter, FilterChips } from '../Filters'\nimport { Title } from '../Title'\nimport { Chip } from '../Chip'\nimport { LinearProgress } from '../LinearProgress'\nimport { pluralize } from '../../lib/pluralize'\nimport { addProjectSamples, fetchMinimalSamplesByIds, removeProjectSamples } from '../../data/calls'\nimport { useApi } from '../../data/api'\nimport { useNotifications } from '../AppNotifications'\nimport { useDeferredInvalidate } from '../../data/selectors/invalidate'\nimport { DateField } from '../DateField'\nimport {\n  BoxCriterionField,\n  CriterionOption,\n  MethodCriterionField,\n  OrganizationCriterionField,\n  ProjectCriterionField,\n  SampleIdsCriterionField,\n  TaxonomyCriterionField,\n  TypeCriterionField,\n  UsStateCriterionField,\n} from './CriterionFields'\n\nexport interface ModifyProjectSamplesProps {\n  initialMode: null | 'add' | 'remove'\n  onOperatingChange?: (operating: boolean) => void\n  onSamplesAdded?: (samples: MinimalSample[]) => void\n  onSamplesRemoved?: (samples: MinimalSample[]) => void\n  projectId: number\n  projectName: string\n  samples: MinimalSample[]\n}\n\nconst minimalSamplesByIdAtom = atom<Record<number, MinimalSample | Promise<MinimalSample | undefined>>>({\n  key: '',\n  default: {},\n})\n\nexport const ModifyProjectSamples = ({\n  initialMode,\n  onOperatingChange,\n  onSamplesAdded,\n  onSamplesRemoved,\n  projectId: thisProjectId,\n  projectName: thisProjectName,\n  samples: initialSamples,\n}: ModifyProjectSamplesProps): JSX.Element => {\n  const api = useApi()\n  const deferredInvalidate = useDeferredInvalidate()\n  const notifications = useNotifications()\n\n  // CRITERIA STATE\n\n  const [boxCriterion, setBoxCriteron] = useState<CriterionOption<number> | null>(null)\n  const [usStateCriterion, setUsStateCriterion] = useState<CriterionOption<number> | null>(null)\n  const [taxonCriteria, setTaxonCriteria] = useState<CriterionOption<number> | null>(null)\n  const [organizationCriterion, setOrganizationCriterion] = useState<CriterionOption<number> | null>(null)\n  const [projectCriterion, setProjectCriterion] = useState<CriterionOption<number> | null>(null)\n  const [sampleIdsCriterion, setSampleIdsCriterion] = useState<number[]>([])\n  const [fromDate, setFromDate] = useState<string | null>(null)\n  const [toDate, setToDate] = useState<string | null>(null)\n  const [typeCriterion, setTypeCriterion] = useState<CriterionOption<string> | null>(null)\n  const [methodCriterion, setMethodCriterion] = useState<CriterionOption<string> | null>(null)\n\n  // OTHER STATE\n\n  const [thisProjectSamples, setThisProjectSamples] = useState(initialSamples)\n  const [candidateSamples, setCandidateSamples] = useState<MinimalSample[]>([])\n  const [resultsMessage, setResultsMessage] = useState<React.ReactNode>(null)\n  const [displayFilters, setDisplayFilters] = useState<Filter<MinimalSample>[]>([])\n  const [isOperating, setIsOperating] = useState(false)\n  const [mode, setMode] = useState(initialMode)\n\n  const isAddMode = mode === 'add'\n\n  useEffect(() => {\n    if (onOperatingChange) onOperatingChange(isOperating)\n  }, [isOperating])\n\n  // RECOIL\n\n  const [minimalSamplesById, setMinimalSamplesById] = useRecoilState(minimalSamplesByIdAtom)\n\n  const getSamplesByBoxId = useRecoilCallback<[number], Promise<MinimalSample[]>>(\n    ({ snapshot }) =>\n      async (boxId: number) =>\n        snapshot.getPromise(selectBoxSamplesByBoxId(boxId)).catch((err) => {\n          notifications.error(`Failed to retrieve box samples: ${err}`)\n          return []\n        })\n  )\n\n  const getSamplesByProjectId = useRecoilCallback<[number], Promise<MinimalSample[]>>(\n    ({ snapshot }) =>\n      async (projectId: number) =>\n        snapshot.getPromise(selectProjectSamplesByProjectId(projectId)).catch((err) => {\n          notifications.error(`Failed to retrieve project samples: ${err}`)\n          return []\n        })\n  )\n\n  const getSamplesByUsStateId = useRecoilCallback<[number], Promise<MinimalSample[]>>(\n    ({ snapshot }) =>\n      async (usStateId: number) =>\n        snapshot.getPromise(selectMinimalSamplesByUsStateId(usStateId)).catch((err) => {\n          notifications.error(`Failed to retrieve US State samples: ${err}`)\n          return []\n        })\n  )\n\n  const getSamplesByTaxonId = useRecoilCallback<[number], Promise<MinimalSample[]>>(\n    ({ snapshot }) =>\n      async (taxonId: number) =>\n        snapshot.getPromise(selectMinimalSamplesByTaxonId(taxonId)).catch((err) => {\n          notifications.error(`Failed to retrieve taxon samples: ${err}`)\n          return []\n        })\n  )\n\n  const getSamplesByOrganizationId = useRecoilCallback<[number], Promise<MinimalSample[]>>(\n    ({ snapshot }) =>\n      async (organizationId: number) =>\n        snapshot.getPromise(selectMinimalSamplesByOrganizationId(organizationId)).catch((err) => {\n          notifications.error(`Failed to retrieve organization samples: ${err}`)\n          return []\n        })\n  )\n\n  useEffect(() => {\n    setMinimalSamplesById(\n      produce((draft) => {\n        initialSamples.forEach((sample) => {\n          draft[sample.id] = sample\n        })\n      })\n    )\n  }, [initialSamples])\n\n  // ADD/REMOVE HANDLERS\n\n  const handleAdd = async () => {\n    if (candidateSamples.length === 0) return\n    const targetIds = candidateSamples.map(({ id }) => id)\n    try {\n      setIsOperating(true)\n      while (targetIds.length > 0) {\n        const sampleIds = targetIds.splice(0, 500) // add 500 per batch\n        await addProjectSamples(api, deferredInvalidate)({ projectId: thisProjectId, sampleIds })\n        setThisProjectSamples((samples) => [...samples, ...candidateSamples.filter(({ id }) => sampleIds.includes(id))])\n      }\n      notifications.info(`Added ${candidateSamples.length} ${pluralize(candidateSamples.length, 'sample')} to project`)\n    } catch (err) {\n      notifications.error(`Failed to add samples to project: ${err}`)\n    } finally {\n      setIsOperating(false)\n    }\n    if (onSamplesAdded) onSamplesAdded(candidateSamples)\n  }\n\n  const handleRemove = async () => {\n    if (candidateSamples.length === 0) return\n    const targetIds = candidateSamples.map(({ id }) => id)\n    try {\n      setIsOperating(true)\n      while (targetIds.length > 0) {\n        const sampleIds = targetIds.splice(0, 500) // remove 500 per batch\n        await removeProjectSamples(api, deferredInvalidate)({ projectId: thisProjectId, sampleIds })\n        setThisProjectSamples((samples) => samples.filter(({ id }) => !sampleIds.includes(id)))\n      }\n      notifications.info(\n        `Removed ${candidateSamples.length} ${pluralize(candidateSamples.length, 'sample')} from project`\n      )\n    } catch (err) {\n      notifications.error(`Failed to remove samples from project: ${err}`)\n    } finally {\n      setIsOperating(false)\n    }\n    if (onSamplesRemoved) onSamplesRemoved(candidateSamples)\n  }\n\n  // FETCHING AND FILTERS\n\n  useEffect(() => {\n    // setup\n    const criteriaFilters: typeof displayFilters = []\n    const thisProjectFilters: typeof displayFilters = []\n    const sourcePromises: Promise<MinimalSample[]>[] = []\n    let cancelled = false\n\n    // source: box\n    if (boxCriterion) {\n      criteriaFilters.push({\n        id: 'boxCriterion',\n        label: boxCriterion.chipLabel,\n        filterFn: identity,\n        onDelete: () => setBoxCriteron(null),\n      })\n      sourcePromises.push(getSamplesByBoxId(boxCriterion.id))\n    }\n\n    // source: customer\n    if (organizationCriterion) {\n      criteriaFilters.push({\n        id: 'organizationCriterion',\n        label: organizationCriterion.chipLabel,\n        filterFn: identity,\n        onDelete: () => setOrganizationCriterion(null),\n      })\n      sourcePromises.push(getSamplesByOrganizationId(organizationCriterion.id))\n    }\n\n    // source: project\n    if (projectCriterion) {\n      criteriaFilters.push({\n        id: 'projectCriterion',\n        label: projectCriterion.chipLabel,\n        filterFn: identity,\n        onDelete: () => setProjectCriterion(null),\n      })\n      sourcePromises.push(getSamplesByProjectId(projectCriterion.id))\n    }\n\n    // source: taxon\n    if (taxonCriteria) {\n      criteriaFilters.push({\n        id: 'taxonCriteria',\n        label: taxonCriteria.chipLabel,\n        filterFn: identity,\n        onDelete: () => setTaxonCriteria(null),\n      })\n      sourcePromises.push(getSamplesByTaxonId(taxonCriteria.id))\n    }\n\n    // source: US State\n    if (usStateCriterion) {\n      criteriaFilters.push({\n        id: 'usStateCriterion',\n        label: usStateCriterion.chipLabel,\n        filterFn: identity,\n        onDelete: () => setUsStateCriterion(null),\n      })\n      sourcePromises.push(getSamplesByUsStateId(usStateCriterion.id))\n    }\n\n    // source: sample IDs\n    if (sampleIdsCriterion.length > 0) {\n      const onDelete = () => setSampleIdsCriterion([])\n      if (sampleIdsCriterion.length === 1)\n        criteriaFilters.push({\n          id: 'sampleIds',\n          label: `ID is ${sampleIdsCriterion[0]}`,\n          filterFn: identity,\n          onDelete,\n        })\n      if (sampleIdsCriterion.length > 1)\n        criteriaFilters.push({\n          id: 'sampleIds',\n          label: `ID is in list (${sampleIdsCriterion.length} samples)`,\n          filterFn: identity,\n          onDelete,\n        })\n\n      const usefulPromises: (MinimalSample | Promise<MinimalSample | undefined>)[] = []\n      const fetchIds: number[] = []\n      sampleIdsCriterion.forEach((needId) => {\n        if (minimalSamplesById[needId]) {\n          usefulPromises.push(minimalSamplesById[needId])\n        } else {\n          fetchIds.push(needId)\n        }\n      })\n      const fetchPromise = fetchIds.length > 0 ? fetchMinimalSamplesByIds(api)(fetchIds) : Promise.resolve([])\n      const newOrderedSamplePromises = fetchIds.map((fetchId) =>\n        fetchPromise.then((fetched) => fetched.find(({ id }) => id === fetchId))\n      )\n      setMinimalSamplesById(\n        produce((draft) => {\n          fetchIds.forEach((fetchId, index) => {\n            draft[fetchId] = newOrderedSamplePromises[index]\n          })\n        })\n      )\n      sourcePromises.push(\n        Promise.all([...usefulPromises, ...newOrderedSamplePromises])\n          .then((resolvedSamplesOrUndefineds) => resolvedSamplesOrUndefineds.filter(identity) as MinimalSample[])\n          .catch((err) => {\n            notifications.error(`Failed to retrieve samples by ID: ${err}`)\n            setMinimalSamplesById(\n              produce((draft) => {\n                fetchIds.forEach((fetchId) => {\n                  delete draft[fetchId] // clear promise so failure isn't permanent with the ID\n                })\n              })\n            )\n            return []\n          })\n      )\n    }\n\n    const isAddModeWithoutSource = isAddMode && sourcePromises.length === 0\n\n    // post-sources filter: sample type\n    if (typeCriterion) {\n      criteriaFilters.push({\n        id: 'typeCriterion',\n        label: typeCriterion.chipLabel,\n        filterFn: ({ type }) => type === typeCriterion.id,\n        onDelete: () => setTypeCriterion(null),\n        chipColor: isAddModeWithoutSource ? 'warn' : 'default',\n      })\n    }\n\n    // post-sources filter: sample method\n    if (methodCriterion) {\n      criteriaFilters.push({\n        id: 'methodCriterion',\n        label: methodCriterion.chipLabel,\n        filterFn: ({ method }) => method === methodCriterion.id,\n        onDelete: () => setMethodCriterion(null),\n        chipColor: isAddModeWithoutSource ? 'warn' : 'default',\n      })\n    }\n\n    // post-sources filter: date range\n    if (fromDate && toDate) {\n      criteriaFilters.push({\n        id: 'dateCriteria',\n        label: `sampled ${fromDate} to ${toDate}`,\n        filterFn: ({ sampleDate }) => sampleDate >= fromDate && sampleDate <= toDate,\n        onDelete: () => {\n          setFromDate(null)\n          setToDate(null)\n        },\n        chipColor: isAddModeWithoutSource ? 'warn' : 'default',\n      })\n    }\n\n    // this project filter\n    if (criteriaFilters.length > 0) {\n      const thisProjectSampleIds = thisProjectSamples.map(({ id }) => id)\n      if (isAddMode) {\n        thisProjectFilters.push({\n          id: 'thisProject',\n          label: 'not already in this project',\n          filterFn: ({ id }) => !thisProjectSampleIds.includes(id),\n        })\n      } else {\n        thisProjectFilters.push({\n          id: 'thisProject',\n          label: 'currently in this project',\n          filterFn: ({ id }) => thisProjectSampleIds.includes(id),\n        })\n      }\n    }\n\n    // set display filters\n    setDisplayFilters([...criteriaFilters, ...thisProjectFilters])\n\n    // clear matched samples\n    setCandidateSamples([])\n\n    // retrieve and filter data\n    if (sourcePromises.length === 0) {\n      // nothing to fetch\n      if (criteriaFilters.length === 0) {\n        // still waiting for any criterion\n        setResultsMessage(null)\n      } else if (isAddMode) {\n        // add mode with post-source filter(s) only; need more criteria\n        setResultsMessage(\n          <span>\n            Add more criteria to match samples. (Type, Method, and Date Range may only be used as supplemental criteria\n            when adding samples.)\n          </span>\n        )\n      } else {\n        // remove mode with post-source filter(s) only; use current project samples as sole source\n        const filteredSamples = criteriaFilters.reduce<MinimalSample[]>(\n          (acc, { filterFn }) => acc.filter(filterFn),\n          thisProjectSamples\n        )\n        setCandidateSamples(filteredSamples)\n        const operableCount = filteredSamples.length\n        setResultsMessage(\n          <span>\n            Matched <strong>{operableCount}</strong> {pluralize(operableCount, 'sample')} currently in your project.\n          </span>\n        )\n      }\n    } else {\n      // enter fetching mode\n      setResultsMessage(<LinearProgress css={{ width: '25rem' }} />)\n\n      // process sources and filters\n      Promise.all(sourcePromises).then((sources) => {\n        if (cancelled) return // do nothing if this effect has been superceded\n\n        // intersect sources\n        const [firstSource, ...restSources] = sources\n        let filteredSamples = restSources.reduce(\n          (acc, source) => intersectionBy(acc, source, ({ id }) => id),\n          firstSource\n        )\n\n        // apply filters\n        filteredSamples = criteriaFilters.reduce<MinimalSample[]>(\n          (acc, { filterFn }) => acc.filter(filterFn),\n          filteredSamples\n        )\n        const matchedCount = filteredSamples.length // get match count before project-based filter\n        filteredSamples = thisProjectFilters.reduce<MinimalSample[]>(\n          (acc, { filterFn }) => acc.filter(filterFn),\n          filteredSamples\n        )\n\n        // set candidate samples and messaging\n        setCandidateSamples(filteredSamples)\n        const operableCount = filteredSamples.length\n        setResultsMessage(\n          <span>\n            Matched {matchedCount} {pluralize(matchedCount, 'sample')} of which <strong>{operableCount}</strong>{' '}\n            {pluralize(operableCount, 'is')} {isAddMode ? 'not already' : 'currently'} in your project.\n          </span>\n        )\n      })\n    }\n\n    // return cleanup function\n    return () => {\n      cancelled = true\n    }\n  }, [\n    thisProjectSamples,\n    thisProjectName,\n    isAddMode,\n\n    // criteria\n    boxCriterion,\n    organizationCriterion,\n    projectCriterion,\n    sampleIdsCriterion,\n    taxonCriteria,\n    usStateCriterion,\n    typeCriterion,\n    methodCriterion,\n    fromDate,\n    toDate,\n  ])\n\n  // RENDER\n\n  const isBothDatesError = !!fromDate && !!toDate && fromDate > toDate\n\n  return (\n    <div>\n      <div css={{ display: 'flex', alignItems: 'center' }}>\n        <Title>\n          Edit Samples in Project {thisProjectName}{' '}\n          <Title.Subtitle>\n            ({thisProjectSamples.length} {pluralize(thisProjectSamples.length, 'sample')})\n          </Title.Subtitle>\n        </Title>\n        <ToggleButtonGroup\n          css={{ marginLeft: 'auto' }}\n          value={mode}\n          onChange={(_, newMode) => setMode(newMode)}\n          exclusive\n        >\n          <ToggleButton size=\"small\" value={'add'} key=\"add\" css={{ width: '6em' }}>\n            Add\n          </ToggleButton>\n          <ToggleButton size=\"small\" value={'remove'} key=\"remove\" css={{ width: '6em' }}>\n            Remove\n          </ToggleButton>\n        </ToggleButtonGroup>\n      </div>\n      <div\n        css={{\n          marginTop: '1rem',\n          display: 'grid',\n          gap: '1rem',\n          gridTemplateColumns: '1fr 1fr',\n          gridTemplateAreas: `\n            \"boxCriterion           boxCriterion\"\n            \"organizationCriterion  organizationCriterion\"\n            \"projectCriterion       projectCriterion\"\n            \"taxonCriterion         taxonCriterion\"\n            \"usStateCriterion       usStateCriterion\"\n            \"sampleIdsCriterion     sampleIdsCriterion\"\n            \"typeCriterion          methodCriterion\"\n            \"fromDate               toDate\"\n          `,\n        }}\n      >\n        <BoxCriterionField gridArea=\"boxCriterion\" value={boxCriterion} onChange={setBoxCriteron} />\n        <OrganizationCriterionField\n          gridArea=\"organizationCriterion\"\n          value={organizationCriterion}\n          onChange={setOrganizationCriterion}\n        />\n        <ProjectCriterionField\n          gridArea=\"projectCriterion\"\n          value={projectCriterion}\n          onChange={setProjectCriterion}\n          thisProjectId={thisProjectId}\n        />\n        <TaxonomyCriterionField gridArea=\"taxonCriterion\" value={taxonCriteria} onChange={setTaxonCriteria} />\n        <UsStateCriterionField gridArea=\"usStateCriterion\" value={usStateCriterion} onChange={setUsStateCriterion} />\n        <SampleIdsCriterionField\n          gridArea=\"sampleIdsCriterion\"\n          value={sampleIdsCriterion}\n          onChange={setSampleIdsCriterion}\n        />\n        <TypeCriterionField gridArea=\"typeCriterion\" value={typeCriterion} onChange={setTypeCriterion} />\n        <MethodCriterionField gridArea=\"methodCriterion\" value={methodCriterion} onChange={setMethodCriterion} />\n        <DateField\n          gridArea=\"fromDate\"\n          value={fromDate}\n          onChange={setFromDate}\n          label=\"From Date\"\n          error={(toDate && !fromDate) || isBothDatesError}\n        />\n        <DateField\n          gridArea=\"toDate\"\n          value={toDate}\n          onChange={setToDate}\n          label=\"To Date\"\n          error={(fromDate && !toDate) || isBothDatesError}\n        />\n      </div>\n      <div\n        css={{\n          marginTop: '1rem',\n          display: 'grid',\n          gap: '1rem',\n        }}\n      >\n        <FilterChips filters={displayFilters} joinLabel=\"and\" noneNode={<Chip label=\"No criteria\" />} />\n        <div css={{ minHeight: '1.2rem', display: 'flex', alignItems: 'center' }}>{resultsMessage}</div>\n        <div css={{ display: 'flex' }}></div>\n        <MuiButton\n          variant=\"contained\"\n          disabled={candidateSamples.length === 0 || isOperating}\n          onClick={isAddMode ? handleAdd : handleRemove}\n          startIcon={isAddMode ? <AddCircleIcon /> : <RemoveCircleIcon />}\n        >\n          {(() => {\n            if (isAddMode) {\n              if (isOperating) return 'Adding samples to project...'\n              if (candidateSamples.length === 0) return 'Add samples to project'\n              return `Add ${candidateSamples.length} ${pluralize(candidateSamples.length, 'sample')} to project`\n            } else {\n              if (isOperating) return 'Removing samples from project...'\n              if (candidateSamples.length === 0) return 'Remove samples from project'\n              return `Remove ${candidateSamples.length} ${pluralize(candidateSamples.length, 'sample')} from project`\n            }\n          })()}\n        </MuiButton>\n      </div>\n    </div>\n  )\n}\n","import Excel from 'exceljs'\nimport saveAs from 'file-saver'\n\nexport const downloadWorkbook = async (workbook: Excel.Workbook, filename: string): Promise<void> => {\n  const buffer = await workbook.xlsx.writeBuffer()\n  const blob = new Blob([buffer], { type: 'application/vnd.openxmlformats-officedocument.spreadsheetml.sheet' })\n  saveAs(blob, filename)\n}\n","/** @jsxImportSource @emotion/react */\nimport React, { useState } from 'react'\nimport { useRecoilValue } from 'recoil'\nimport MuiSkeleton from '@mui/material/Skeleton'\nimport MuiButton from '@mui/material/Button'\nimport MuiDialog from '@mui/material/Dialog'\nimport MuiDialogActions from '@mui/material/DialogActions'\nimport MuiDialogContent from '@mui/material/DialogContent'\n\nimport { withSuspense } from '../withSuspense'\nimport { selectProjectSamplesByProjectId } from '../../data/selectors'\nimport { SamplesDataGrid, samplesDownloadColumns } from '../SamplesDataGrid'\nimport { DataGridRecordCount } from '../DataGrid'\nimport { ModifyProjectSamples, ModifyProjectSamplesProps } from './ModifyProjectSamples'\nimport { createSingleTableWorkbook } from '../../lib/excel/createSingleTableWorkbook'\nimport { downloadWorkbook } from '../../lib/excel/downloadWorkbook'\nimport { SourceSample } from '../../types'\n\ninterface ProjectDetailProps {\n  projectId: number\n  projectName: string\n  canModify: boolean\n}\n\nexport const ProjectSamples = withSuspense(\n  ({ projectId, projectName, canModify }: ProjectDetailProps): JSX.Element => {\n    const samples = useRecoilValue(selectProjectSamplesByProjectId(projectId))\n    const [isOperating, setIsOperating] = useState(false)\n    const [modifyMode, setModifyMode] = useState<ModifyProjectSamplesProps['initialMode']>(null)\n\n    const handleCloseModify = () => {\n      if (isOperating) return // do not close when operating (may have been invoked by escape key)\n      setModifyMode(null)\n    }\n\n    const handleDownload = () => {\n      const wb = createSingleTableWorkbook<SourceSample>({\n        wsName: 'Samples',\n        columns: samplesDownloadColumns,\n        rows: samples,\n      })\n      downloadWorkbook(wb, `Project ${projectName} Samples.xlsx`)\n    }\n\n    return (\n      <>\n        <div css={{ minHeight: '2em', display: 'flex', alignItems: 'center', gap: '0.5rem' }}>\n          <div css={{ fontWeight: '500', marginLeft: '1em', marginRight: 'auto' }}>Samples</div>\n          <MuiButton\n            css={{ width: '6em' }}\n            variant=\"outlined\"\n            disabled={!canModify}\n            onClick={() => {\n              setModifyMode('add')\n            }}\n          >\n            Add\n          </MuiButton>\n          <MuiButton\n            css={{ width: '6em' }}\n            variant=\"outlined\"\n            disabled={samples.length === 0 || !canModify}\n            onClick={() => {\n              setModifyMode('remove')\n            }}\n          >\n            Remove\n          </MuiButton>\n          <MuiButton variant=\"outlined\" disabled={samples.length === 0} onClick={handleDownload}>\n            Download\n          </MuiButton>\n          <DataGridRecordCount total={samples.length} visible={samples.length} descriptor=\"sample\" />\n        </div>\n        <div css={{ flex: 1, minHeight: '10em' }}>\n          <SamplesDataGrid\n            samples={samples}\n            sitesListingSource={{ type: 'project', id: projectId, name: projectName }}\n          />\n        </div>\n        <MuiDialog open={!!modifyMode} fullWidth maxWidth=\"md\" onClose={handleCloseModify}>\n          <MuiDialogContent>\n            <ModifyProjectSamples\n              initialMode={modifyMode}\n              projectId={projectId}\n              projectName={projectName}\n              samples={samples}\n              onOperatingChange={setIsOperating}\n            />\n          </MuiDialogContent>\n          <MuiDialogActions>\n            <MuiButton onClick={handleCloseModify} disabled={isOperating}>\n              Close\n            </MuiButton>\n          </MuiDialogActions>\n        </MuiDialog>\n      </>\n    )\n  },\n  () => <MuiSkeleton css={{ marginTop: '1rem' }} height=\"10rem\" variant=\"rectangular\" />\n)\n","import Excel, { Workbook } from 'exceljs'\n\ninterface CreateSingleTableWorkbookParams<T> {\n  wsName: string\n  columns: Partial<Excel.Column>[]\n  rows: T[]\n}\n\nexport const createSingleTableWorkbook = <T>({\n  wsName,\n  columns,\n  rows,\n}: CreateSingleTableWorkbookParams<T>): Workbook => {\n  const wb = new Excel.Workbook()\n  const ws = wb.addWorksheet(wsName)\n\n  // add data\n  ws.columns = columns as Partial<Excel.Column>[]\n  ws.addRows(rows)\n\n  // autofit columns\n  ws.columns.forEach((column) => {\n    const columnValues = column.values\n    if (!columnValues) return\n    const lengths = columnValues.slice(1).map((value) => (value || '').toString().length)\n    const maxLength = Math.max(...lengths.filter((v) => typeof v === 'number'))\n    column.width = maxLength + 2 // add some padding for filter button\n  })\n\n  // freeze rows\n  ws.views = [{ state: 'frozen', xSplit: undefined, ySplit: 1, activeCell: 'A1' }]\n\n  return wb\n}\n","/** @jsxImportSource @emotion/react */\nimport React from 'react'\nimport { selectSitesByProjectId } from '../../data/selectors'\nimport { SitesMapPreview } from '../SitesMap/SitesMapPreview'\n\nexport interface ProjectSitesMapPreviewProps {\n  projectId: number\n  projectName: string\n}\n\nexport const ProjectSitesMapPreview = ({ projectId, projectName }: ProjectSitesMapPreviewProps): JSX.Element => {\n  const sitesSelector = selectSitesByProjectId(projectId)\n  return (\n    <SitesMapPreview\n      sitesSelector={sitesSelector}\n      sitesListingSource={{ type: 'project', id: projectId, name: projectName }}\n    />\n  )\n}\n","/** @jsxImportSource @emotion/react */\nimport React from 'react'\nimport MuiButton from '@mui/material/Button'\nimport MuiDialog from '@mui/material/Dialog'\nimport MuiDialogActions from '@mui/material/DialogActions'\nimport MuiDialogContent from '@mui/material/DialogContent'\nimport MuiDialogTitle from '@mui/material/DialogTitle'\n\nexport interface ConfirmationDialogProps {\n  children?: React.ReactNode\n  cancelLabel?: React.ReactNode\n  confirmLabel?: React.ReactNode\n  isOpen: boolean\n  onClose: () => void\n  onConfirm: () => void\n  title: React.ReactNode\n}\n\nexport const ConfirmationDialog = ({\n  children,\n  cancelLabel = 'Cancel',\n  confirmLabel = 'Yes',\n  isOpen,\n  onClose,\n  onConfirm,\n  title,\n}: ConfirmationDialogProps): JSX.Element => {\n  const handleConfirm = () => {\n    onConfirm()\n    onClose()\n  }\n\n  return (\n    <MuiDialog open={isOpen} onClose={onClose}>\n      <MuiDialogTitle>{title}</MuiDialogTitle>\n      <MuiDialogContent>{children}</MuiDialogContent>\n      <MuiDialogActions>\n        <MuiButton onClick={onClose}>{cancelLabel}</MuiButton>\n        <MuiButton onClick={handleConfirm}>{confirmLabel}</MuiButton>\n      </MuiDialogActions>\n    </MuiDialog>\n  )\n}\n","/** @jsxImportSource @emotion/react */\nimport React, { useEffect, useState } from 'react'\nimport { atom, selector, useRecoilState, useRecoilValue } from 'recoil'\nimport { countBy } from 'lodash'\nimport MuiButton from '@mui/material/Button'\n\nimport { MyUser, Project } from '../../types'\nimport { AccordionPanel } from '../AccordionPanel'\nimport { Title } from '../Title'\nimport { ProjectSamples } from './ProjectSamples'\nimport { ProjectSitesMapPreview } from './ProjectSitesMapPreview'\nimport { ReadOnlyField } from '../ReadOnlyField'\nimport { formatUtcDateTimeToAppDate } from '../../lib/formats'\nimport { selectMyUser, selectUsers, useInvalidate } from '../../data/selectors'\nimport { useApi } from '../../data/api'\nimport { useNotifications } from '../AppNotifications'\nimport { useUpdatableState } from '../../lib/useUpdatableState'\nimport { TextField } from '../TextField'\nimport { AutocompleteField } from '../AutocompleteField'\nimport { createProject, deleteProject, updateProject } from '../../data/calls'\nimport { CheckboxField } from '../CheckboxField'\nimport { ConfirmNavigateAway, useNavigate } from '../AppRouter'\nimport { Menu } from '../Menu'\nimport { Divider } from '../Menu/Menu'\nimport { ConfirmationDialog } from '../ConfirmationDialog'\nimport { ModelsField } from '../ModelsField'\n\nexport interface ProjectDetailProps {\n  project: Project | null\n}\n\ninterface Fields {\n  name: string\n  contactId: number\n  isPrivate: boolean\n  description: string\n  modelIds: number[]\n}\n\ntype FieldErrors = Partial<Record<keyof Fields, boolean>> | undefined\n\ninterface State {\n  editMode: 'stopped' | 'started' | 'stopping' | 'deleting'\n  isDirty: boolean\n  values: Fields\n  lastValues?: Fields\n}\n\nconst isExpandedState = atom<boolean>({\n  key: 'ProjectDetail/isExpandedState',\n  default: true,\n})\n\nconst selectUserOptions = selector({\n  key: 'ProjectDetail/selectUserOptions',\n  get: async ({ get }) => {\n    const users = get(selectUsers)\n\n    const userOptions = users.map(({ id: value, fullName, organizationName }) => ({\n      value,\n      label: `${fullName} (${organizationName})`,\n    }))\n\n    const labelCount = countBy(userOptions, 'label')\n\n    return userOptions.map(({ value, label }) => ({\n      value,\n      label: labelCount[label] > 1 ? `${label} [${value}]` : label,\n    }))\n  },\n})\n\nconst getInitialState = ({ project, user }: Pick<ProjectDetailProps, 'project'> & { user: MyUser }): State => ({\n  editMode: project ? 'stopped' : 'started',\n  isDirty: false,\n  values: {\n    name: project?.name ?? '',\n    contactId: project?.contactId ?? user.id,\n    isPrivate: project?.isPrivate ?? true,\n    description: project?.description ?? '',\n    modelIds: project?.modelIds ?? [],\n  },\n})\n\nexport const ProjectDetail = ({ project }: ProjectDetailProps): JSX.Element => {\n  const api = useApi()\n  const invalidate = useInvalidate()\n  const notifications = useNotifications()\n  const navigate = useNavigate()\n  const user = useRecoilValue(selectMyUser)\n\n  const isNewProject = !project\n\n  // STATE\n\n  // eslint-disable-next-line @typescript-eslint/no-unused-vars\n  const [state, setState, updateState] = useUpdatableState<State>(getInitialState({ project, user }), [project])\n  const [isPanelExpanded, setIsPanelExpanded] = useRecoilState(isExpandedState)\n  const [isConfirmDeleteOpen, setIsConfirmDeleteOpen] = useState(false)\n\n  const { values, editMode, isDirty } = state\n\n  const errors: FieldErrors = (() => {\n    const result: FieldErrors = {\n      name: !values.name.trim(),\n    }\n    if (!Object.values(result).some((value) => value)) return undefined\n    return result\n  })()\n\n  const isStopped = editMode === 'stopped'\n  const isEditing = editMode === 'started'\n  const isSaving = editMode === 'stopping'\n  const isDeleting = editMode === 'deleting'\n\n  // EFFECTS\n\n  useEffect(() => {\n    if (isEditing) setIsPanelExpanded(true)\n  }, [isEditing])\n\n  // HANDLERS\n\n  const setFieldValue = (fieldName: keyof Fields, value: unknown) => {\n    updateState((draft) => {\n      Object.assign(draft.values, { [fieldName]: value })\n      draft.isDirty = true\n    })\n  }\n\n  const handleEdit = () => {\n    updateState((draft) => {\n      draft.editMode = 'started'\n      draft.lastValues = draft.values\n    })\n  }\n\n  const handleCancel = () => {\n    updateState((draft) => {\n      if (!draft.lastValues) throw new Error('no values to revert to')\n      draft.editMode = 'stopped'\n      draft.values = draft.lastValues\n      draft.isDirty = false\n    })\n  }\n\n  const handleSave = async () => {\n    try {\n      updateState((draft) => {\n        draft.editMode = 'stopping'\n      })\n      const projectInput = {\n        name: values.name.trim(),\n        isPrivate: values.isPrivate,\n        description: values.description.trim(),\n        contactId: values.contactId,\n        modelIds: values.modelIds,\n      }\n      if (isNewProject) {\n        // new project\n        const projectId = await createProject(api, invalidate)(projectInput)\n        updateState((draft) => {\n          draft.editMode = 'stopped'\n          draft.isDirty = false\n        })\n        window.setTimeout(() => {\n          navigate.projectDetail({ projectId }, true) // let state update\n        })\n      } else {\n        // existing project\n        await updateProject(\n          api,\n          invalidate\n        )({\n          ...projectInput,\n          id: project.id,\n        })\n        updateState((draft) => {\n          draft.editMode = 'stopped'\n          draft.isDirty = false\n        })\n      }\n    } catch (err) {\n      if ((err as Error).message === 'duplicate key value violates unique constraint \"projects_project_name_key\"') {\n        notifications.error(`Failed to save: name \"${values.name}\" already in use`)\n      } else {\n        notifications.error(`Failed to save: ${err}`)\n      }\n      updateState((draft) => {\n        draft.editMode = 'started'\n      })\n    }\n  }\n\n  const handleDelete = async () => {\n    try {\n      if (!project) throw new Error('No project.')\n      updateState((draft) => {\n        draft.editMode = 'deleting'\n      })\n      await deleteProject(api, invalidate)(project)\n      notifications.info(`Deleted project ${project.name}`)\n      navigate.projects()\n    } catch (err) {\n      notifications.error(`Failed to delete: ${err}`)\n      updateState((draft) => {\n        draft.editMode = 'stopped'\n      })\n    }\n  }\n\n  // RENDER\n\n  return (\n    <>\n      <div css={{ height: '100%', display: 'flex', flexDirection: 'column' }}>\n        <AccordionPanel\n          value={isPanelExpanded}\n          onChange={setIsPanelExpanded}\n          locked={isEditing}\n          summary={\n            !isEditing ? (\n              <Title>\n                Project {values.name} <Title.Subtitle>({project?.sampleCount ?? 0} samples)</Title.Subtitle>\n              </Title>\n            ) : (\n              <div css={{ display: 'flex', alignItems: 'baseline' }}>\n                <Title>Project&nbsp;</Title>\n                <TextField\n                  value={values.name}\n                  onChange={(value) => setFieldValue('name', value)}\n                  error={errors?.name}\n                  css={{ width: '30em' }}\n                  InputProps={{ sx: { fontWeight: '700' } }} // roughly match <Title>\n                />\n              </div>\n            )\n          }\n          actions={\n            <div css={{ display: 'flex', gap: '0.5em' }}>\n              {(isStopped || isDeleting) && (\n                <Menu\n                  label=\"Actions\"\n                  disabled={isDeleting}\n                  items={[\n                    {\n                      key: 'edit',\n                      label: 'Edit Project',\n                      onClick: handleEdit,\n                    },\n                    Divider,\n                    {\n                      key: 'delete',\n                      label: 'Delete Project',\n                      onClick: () => {\n                        setIsConfirmDeleteOpen(true)\n                      },\n                    },\n                  ]}\n                ></Menu>\n              )}\n              {(isEditing || isSaving) && (\n                <>\n                  {!isNewProject && (\n                    <MuiButton onClick={handleCancel} variant=\"outlined\" disabled={isSaving}>\n                      Cancel\n                    </MuiButton>\n                  )}\n                  <MuiButton onClick={handleSave} variant=\"contained\" disabled={!isDirty || isSaving || !!errors}>\n                    Save\n                  </MuiButton>\n                </>\n              )}\n            </div>\n          }\n        >\n          <div\n            css={{\n              flex: 1,\n              display: 'grid',\n              gap: '0.75em',\n              gridTemplateColumns: 'auto 1fr auto',\n              gridTemplateAreas: `\n              \"id              contactId          map\"\n              \"createdDate     isPrivate          map\"\n              \".               modelIds           map\"\n              \".               description        map\"\n              \".               .                  map\"\n            `,\n            }}\n          >\n            <ReadOnlyField gridArea=\"id\" value={project?.id ?? ''} label=\"Project ID\" />\n            <ReadOnlyField\n              gridArea=\"createdDate\"\n              value={formatUtcDateTimeToAppDate(project?.createdDate ?? null)}\n              label=\"Created On\"\n            />\n            <AutocompleteField\n              gridArea=\"contactId\"\n              value={values.contactId}\n              onChange={(value) => setFieldValue('contactId', value)}\n              valueLabel={project?.contactName ?? ''}\n              optionsSelector={selectUserOptions}\n              label=\"Contact Name\"\n              readOnly={!isEditing}\n            />\n            <CheckboxField\n              gridArea=\"isPrivate\"\n              value={!values.isPrivate}\n              onChange={(value) => setFieldValue('isPrivate', !value)}\n              label=\"Project samples appear in the public web map\"\n              readOnly={!isEditing}\n            />\n            <ModelsField\n              gridArea=\"modelIds\"\n              value={values.modelIds}\n              onChange={(value) => setFieldValue('modelIds', value)}\n              label=\"Models\"\n              readOnly={!isEditing}\n            />\n            <TextField\n              gridArea=\"description\"\n              value={values.description}\n              onChange={(value) => setFieldValue('description', value)}\n              label=\"Description\"\n              readOnly={!isEditing}\n              multiline\n              minRows={3}\n            />\n            <div css={{ gridArea: 'map', minHeight: '300px' }}>\n              {!isEditing && project && <ProjectSitesMapPreview projectId={project.id} projectName={values.name} />}\n            </div>\n          </div>\n        </AccordionPanel>\n        {project && <ProjectSamples projectId={project.id} projectName={values.name} canModify={isStopped} />}\n      </div>\n      <ConfirmationDialog\n        title=\"Confirm Delete Project\"\n        isOpen={isConfirmDeleteOpen}\n        onClose={() => {\n          setIsConfirmDeleteOpen(false)\n        }}\n        onConfirm={handleDelete}\n      >\n        Are you sure you want to delete this project?\n      </ConfirmationDialog>\n      {isDirty && <ConfirmNavigateAway message=\"Some changes are not saved. Are you sure you want to leave?\" />}\n    </>\n  )\n}\n","import React from 'react'\nimport { useRecoilValue } from 'recoil'\n\nimport { selectProjectById, selectNull } from '../../data/selectors'\nimport { withSuspense } from '../withSuspense'\nimport { ProjectDetail as Component } from './ProjectDetail'\nimport { Fallback } from './Fallback'\n\nexport type ProjectDetailProps =\n  | {\n      projectId: string | number\n      isNew?: never\n    }\n  | {\n      projectId?: never\n      isNew: true // unconsumed; used to positively differentiate modes\n    }\n\nexport const ProjectDetail = withSuspense(({ projectId }: ProjectDetailProps): JSX.Element => {\n  const project = useRecoilValue(projectId ? selectProjectById(Number(projectId)) : selectNull)\n\n  if (projectId && !project) return <h2>Project {projectId} not found.</h2>\n\n  return <Component project={project} />\n}, Fallback)\n","/** @jsxImportSource @emotion/react */\nimport React from 'react'\nimport Skeleton from '@mui/material/Skeleton'\n\nexport const Fallback = (): JSX.Element => (\n  <div css={{ height: '100%', display: 'flex', flexDirection: 'column', gap: '1em' }}>\n    <div css={{ width: '40em' }}>\n      <Skeleton height=\"3em\" variant=\"rectangular\" />\n    </div>\n    <div css={{ width: '10em' }}>\n      <Skeleton height=\"2em\" variant=\"rectangular\" />\n    </div>\n    <Skeleton height=\"20em\" variant=\"rectangular\" />\n  </div>\n)\n","import dayjs from 'dayjs'\nimport Excel from 'exceljs'\nimport { uniq } from 'lodash'\n\nimport { downloadWorkbook } from '../../lib/excel/downloadWorkbook'\nimport { Box, BoxTaxon } from '../../types'\n\nconst TAXONOMIST_COLUMNS = { header: '', key: '' } // placeholder which is replaced with taxonomist columns\n\nconst columnConfig = [\n  { header: 'Order', key: 'order' },\n  { header: 'Family', key: 'family' },\n  { header: 'Scientific Name', key: 'name' },\n  TAXONOMIST_COLUMNS,\n  { header: 'Total Sample Count', key: 'sampleCount' },\n  { header: 'Total Split Count', key: 'totalCount' },\n]\n\nexport const downloadBoxTaxaReport = async ({\n  box,\n  boxTaxa,\n  filename,\n}: {\n  box: Box\n  boxTaxa: BoxTaxon[]\n  filename: string\n}): Promise<boolean> => {\n  // create workbook, worksheet\n  const wb = new Excel.Workbook()\n  const ws = wb.addWorksheet('Box Taxonomy Report')\n\n  // add top rows data\n  ws.getRow(1).values = [`Taxonomic list and sample counts for ${box.sampleCount} samples, Box ID ${box.id}.`]\n  ws.getRow(2).values = [`List generated on ${dayjs().format('MMMM D, YYYY')}.`]\n  ws.getRow(3).values = [`Customer: ${box.customerName}.`]\n  const tableHeaderRowNumber = 4\n\n  // get taxonomist names/columns, build updated column config\n  const taxonomistNames = boxTaxa.reduce<string[]>((acc, record) => {\n    return uniq([...acc, ...Object.keys(record.taxonomistCounts)])\n  }, [])\n  const updatedColumnConfig = [...columnConfig] // careful not to mutate the original!\n  updatedColumnConfig.splice(\n    columnConfig.findIndex((col) => col === TAXONOMIST_COLUMNS),\n    1,\n    ...taxonomistNames.map((name) => ({ header: name, key: name }))\n  )\n\n  if (boxTaxa.length === 0) {\n    ws.getRow(tableHeaderRowNumber + 1).values = ['No taxonomy found for box.']\n  } else {\n    // create row data arrays (as addTable requires), including spread taxonomist names\n    const rows = boxTaxa\n      .map((record) => ({ ...record, ...record.taxonomistCounts }))\n      .map((record) => {\n        const fields: (string | number)[] = []\n        updatedColumnConfig.forEach(({ key }) => {\n          fields.push(record[key])\n        })\n        return fields\n      })\n\n    // add data table\n    ws.addTable({\n      name: 'BoxTaxonomy',\n      ref: `A${tableHeaderRowNumber}`,\n      headerRow: true,\n      style: {\n        theme: 'TableStyleLight1',\n        showRowStripes: true,\n      },\n      columns: updatedColumnConfig.map(({ header }) => ({ name: header, filterButton: true })),\n      rows,\n    })\n\n    // autofit columns\n    ws.columns.forEach((column) => {\n      const columnValues = column.values\n      if (!columnValues) return\n      const lengths = columnValues.slice(tableHeaderRowNumber).map((value) => (value || '').toString().length)\n      const maxLength = Math.max(...lengths.filter((v) => typeof v === 'number'))\n      column.width = maxLength + 2 // add some padding for filter button\n    })\n\n    // freeze rows\n    ws.views = [{ state: 'frozen', xSplit: undefined, ySplit: tableHeaderRowNumber, activeCell: 'A1' }]\n  }\n\n  // download file\n  downloadWorkbook(wb, filename)\n\n  return true\n}\n","/** @jsxImportSource @emotion/react */\nimport React from 'react'\nimport { TaxonomySelectField, TaxonomySelectFieldProps } from '../TaxonomyField/TaxonomySelectField'\nimport MuiSkeleton from '@mui/material/Skeleton'\n\nexport const BoxTaxonomySelectField = ({\n  skeleton,\n  ...props\n}: TaxonomySelectFieldProps & { skeleton?: boolean }): JSX.Element => {\n  if (skeleton) return <MuiSkeleton variant=\"rectangular\" height={40} />\n  return <TaxonomySelectField {...props} />\n}\n","/** @jsxImportSource @emotion/react */\nimport React, { useEffect, useState } from 'react'\nimport { atom, useRecoilState, useRecoilValueLoadable } from 'recoil'\nimport MuiButton from '@mui/material/Button'\n\nimport { useApi } from '../../data/api'\nimport { selectTaxa, useInvalidate, BOX_STATE_ID } from '../../data/selectors'\nimport { BoxTaxon, Box, Taxon } from '../../types'\nimport { Title } from '../Title'\nimport { reconcileBoxTaxonomy } from '../../data/calls'\nimport { useNotifications } from '../AppNotifications'\nimport { DataGrid, DataGridRecordCount } from '../DataGrid'\nimport { makeBoxTaxonomyColumnDefs } from './columnDefs'\nimport { AccordionPanel } from '../AccordionPanel'\nimport { downloadBoxTaxaReport } from './downloadBoxTaxaReport'\nimport { uniq } from 'lodash'\nimport { BoxTaxonomySelectField } from './BoxTaxonomySelectField'\nimport { ConfirmationDialog } from '../ConfirmationDialog'\n\nexport interface BoxTaxonomyProps {\n  box: Box\n  boxTaxa: BoxTaxon[]\n}\n\nconst isExpandedState = atom<boolean>({\n  key: 'BoxTaxonomy/isExpandedState',\n  default: false,\n})\n\nexport const BoxTaxonomy = ({ box, boxTaxa }: BoxTaxonomyProps): JSX.Element => {\n  const api = useApi()\n  const invalidate = useInvalidate()\n  const notifications = useNotifications()\n\n  const taxaLoadable = useRecoilValueLoadable(selectTaxa)\n\n  const [fromTaxonomyId, setFromTaxonomyId] = useState<number | null>(null)\n  const [toTaxonomyId, setToTaxonomyId] = useState<number | null>(null)\n  const [isWorking, setIsWorking] = useState(false)\n  const [isConfirmOpen, setIsConfirmOpen] = useState(false)\n  const [taxa, setTaxa] = useState<Taxon[]>([])\n  const hasTaxa = taxa.length > 0\n\n  useEffect(() => {\n    taxaLoadable.toPromise().then(setTaxa)\n  }, [])\n\n  const [isPanelExpanded, setIsPanelExpanded] = useRecoilState(isExpandedState)\n\n  const isSameIdError = !!fromTaxonomyId && !!toTaxonomyId && fromTaxonomyId === toTaxonomyId\n\n  const boxTaxonIds = boxTaxa.map(({ id }) => id)\n  const addedTaxonOptions = taxa\n    .filter((taxon) => boxTaxonIds.includes(taxon.id))\n    .map((taxon) => ({ ...taxon, status: 'in' as const }))\n  const availableTaxonOptions = taxa\n    .filter((taxon) => !boxTaxonIds.includes(taxon.id))\n    .map((taxon) => ({ ...taxon, status: 'notIn' as const }))\n\n  const fromBoxTaxon = boxTaxa.find(({ id }) => id === fromTaxonomyId)\n  const toTaxon = taxa.find(({ id }) => id === toTaxonomyId)\n  const toBoxTaxon = boxTaxa.find(({ id }) => id === toTaxonomyId)\n\n  const handleReconcile = async () => {\n    if (!fromTaxonomyId || !toTaxonomyId) throw new Error('Missing taxonomid IDs')\n    setIsWorking(true)\n    try {\n      await reconcileBoxTaxonomy(api, invalidate)({ boxId: box.id, fromTaxonomyId, toTaxonomyId })\n      setFromTaxonomyId(null)\n      setToTaxonomyId(null)\n      setIsWorking(false)\n    } catch (err) {\n      notifications.error(`Failed to reconcile taxonomy: ${err}`)\n    }\n  }\n\n  const taxonomistNames = boxTaxa.reduce<string[]>((acc, record) => {\n    return uniq([...acc, ...Object.keys(record.taxonomistCounts)])\n  }, [])\n  const rows = boxTaxa\n  const columnDefs = makeBoxTaxonomyColumnDefs(taxonomistNames)\n\n  const canReconcileTaxa = box.boxStateId === BOX_STATE_ID.active\n\n  return (\n    <>\n      <div css={{ height: '100%', display: 'flex', flexDirection: 'column' }}>\n        <div css={{ margin: '16px', display: 'flex', alignItems: 'center' }}>\n          <Title>\n            Box {box.id} Taxonomy{' '}\n            <Title.Subtitle>\n              ({box.boxState}, {box.sampleCount} samples)\n            </Title.Subtitle>\n          </Title>\n          <div css={{ marginLeft: 'auto' }}>\n            <MuiButton\n              variant=\"outlined\"\n              onClick={async () => {\n                try {\n                  const cancelNotification = notifications.info('Still creating report...', 1000)\n                  await downloadBoxTaxaReport({\n                    box,\n                    boxTaxa,\n                    filename: `Box Taxonomy Report for Box ID ${box.id}`,\n                  })\n                  cancelNotification()\n                } catch (err) {\n                  notifications.error(`Failed to create box taxonomy report: ${err}`)\n                }\n              }}\n            >\n              Download Report\n            </MuiButton>\n          </div>\n        </div>\n        <AccordionPanel value={isPanelExpanded} onChange={setIsPanelExpanded} summary={<span>Reconcile Taxa</span>}>\n          {canReconcileTaxa ? (\n            <div\n              css={{\n                display: 'grid',\n                gap: '1em',\n                paddingTop: '1em',\n                gridTemplateColumns: '1fr 1fr',\n                gridTemplateAreas: `\n            \"fromId      toId\"\n            \"fromMessage toMessage\"\n            \".           button\"\n            `,\n              }}\n            >\n              <div css={{ gridArea: 'fromId' }}>\n                <BoxTaxonomySelectField\n                  label=\"Reconcile From\"\n                  options={addedTaxonOptions}\n                  value={fromTaxonomyId}\n                  onChange={setFromTaxonomyId}\n                  disabled={isWorking}\n                  skeleton={!hasTaxa}\n                />\n              </div>\n              <div css={{ gridArea: 'fromMessage' }}>\n                {fromBoxTaxon ? (\n                  <span>\n                    Box currently contains {fromBoxTaxon.totalCount} <em>{fromBoxTaxon.name}</em> records in{' '}\n                    {fromBoxTaxon.sampleCount} samples.\n                  </span>\n                ) : (\n                  <span>\n                    <em>select a taxon</em>\n                  </span>\n                )}\n              </div>\n              <div css={{ gridArea: 'toId' }}>\n                <BoxTaxonomySelectField\n                  label=\"Reconcile To\"\n                  options={[...addedTaxonOptions, ...availableTaxonOptions]}\n                  value={toTaxonomyId}\n                  onChange={setToTaxonomyId}\n                  disabled={isWorking}\n                  skeleton={!hasTaxa}\n                />\n              </div>\n              <div css={{ gridArea: 'toMessage' }}>\n                {(() => {\n                  if (isSameIdError) return <span css={{ color: 'red' }}>Cannot reconcile to the same taxon.</span>\n                  if (toBoxTaxon)\n                    return (\n                      <span>\n                        Box currently contains {toBoxTaxon.totalCount} <em>{toBoxTaxon.name}</em> records in{' '}\n                        {toBoxTaxon.sampleCount} samples.\n                      </span>\n                    )\n                  if (toTaxon)\n                    return (\n                      <span>\n                        Box does not yet contain any <em>{toTaxon?.name}</em> records.\n                      </span>\n                    )\n                  return (\n                    <span>\n                      <em>select a taxon</em>\n                    </span>\n                  )\n                })()}\n              </div>\n              <div css={{ gridArea: 'button', display: 'flex', justifyContent: 'end' }}>\n                <MuiButton\n                  variant=\"contained\"\n                  disabled={!fromTaxonomyId || !toTaxonomyId || isSameIdError || isWorking}\n                  onClick={() => {\n                    setIsConfirmOpen(true)\n                  }}\n                >\n                  Reconcile Taxa\n                </MuiButton>\n              </div>\n            </div>\n          ) : (\n            <div>Box must be active to perform taxa reconciliation.</div>\n          )}\n        </AccordionPanel>\n        <div css={{ minHeight: '1rem', display: 'flex' }}>\n          <DataGridRecordCount\n            css={{ marginLeft: 'auto' }}\n            total={rows.length}\n            visible={rows.length}\n            descriptor=\"taxa\"\n          />\n        </div>\n        <div css={{ flex: 1 }}>\n          <DataGrid<BoxTaxon> columnDefs={columnDefs} rows={rows} />\n        </div>\n      </div>\n      <ConfirmationDialog\n        isOpen={isConfirmOpen}\n        title=\"Confirm Taxa Reconciliation\"\n        onClose={() => setIsConfirmOpen(false)}\n        onConfirm={handleReconcile}\n        confirmLabel=\"Reconcile\"\n      >\n        Are you sure you want to reconcile the selected taxa? Records will be irreversibly changed.\n      </ConfirmationDialog>\n    </>\n  )\n}\n","// const columnConfig = [\n//   { header: 'Order', key: 'order' },\n//   { header: 'Family', key: 'family' },\n//   { header: 'Scientific Name', key: 'scientificName' },\n//   TAXONOMIST_COLUMNS,\n//   { header: 'Total Sample Count', key: 'sampleCount' },\n//   { header: 'Total Split Count', key: 'totalCount' },\n// ]\n\nimport { ColDef } from 'ag-grid-community'\nimport { columnDef } from '../DataGrid'\n\nexport const makeBoxTaxonomyColumnDefs = (taxonomistNames: string[]): ColDef[] => [\n  columnDef.textColumn({\n    field: 'order',\n    minWidth: 160,\n    flex: 1,\n  }),\n  columnDef.textColumn({\n    field: 'family',\n    minWidth: 160,\n    flex: 1,\n  }),\n  columnDef.textColumn({\n    headerName: 'Scientific Name',\n    field: 'name',\n    minWidth: 160,\n    flex: 1,\n  }),\n  ...taxonomistNames.map((name) =>\n    columnDef.numberColumn({\n      headerName: name,\n      field: `taxonomistCounts.${name}`,\n      minWidth: 160,\n      flex: 1,\n    })\n  ),\n  columnDef.numberColumn({\n    headerName: 'Total Sample Count',\n    field: 'sampleCount',\n    minWidth: 160,\n  }),\n  columnDef.numberColumn({\n    headerName: 'Total Split Count',\n    field: 'totalCount',\n    minWidth: 160,\n  }),\n]\n","import React from 'react'\nimport { useRecoilValue } from 'recoil'\n\nimport { selectBoxById, selectBoxTaxaByBoxId } from '../../data/selectors'\nimport { withSuspense } from '../withSuspense'\nimport { BoxTaxonomy as Component } from './BoxTaxonomy'\nimport { Fallback } from './Fallback'\n\nexport interface BoxTaxonomyProps {\n  boxId: string | number\n}\n\nexport const BoxTaxonomy = withSuspense(({ boxId }: BoxTaxonomyProps): JSX.Element => {\n  const box = useRecoilValue(selectBoxById(Number(boxId)))\n  const boxTaxa = useRecoilValue(selectBoxTaxaByBoxId(Number(boxId)))\n\n  if (!box) return <h2>Box {boxId} not found.</h2>\n\n  return <Component box={box} boxTaxa={boxTaxa} />\n}, Fallback)\n","/** @jsxImportSource @emotion/react */\nimport React from 'react'\nimport Skeleton from '@mui/material/Skeleton'\n\nexport const Fallback = (): JSX.Element => (\n  <div css={{ height: '100%', display: 'flex', flexDirection: 'column', gap: '1em' }}>\n    <div css={{ width: '40em' }}>\n      <Skeleton height=\"3em\" variant=\"rectangular\" />\n    </div>\n    <Skeleton height=\"3em\" variant=\"rectangular\" />\n    <Skeleton height=\"20em\" variant=\"rectangular\" />\n  </div>\n)\n","/** @jsxImportSource @emotion/react */\nimport React, { useEffect, useState } from 'react'\nimport { Switch, Route, Redirect, useHistory } from 'react-router-dom'\nimport { atom, useSetRecoilState, useRecoilValue } from 'recoil'\nimport log from 'loglevel'\n\nimport { BoxesListing } from '../BoxesListing'\nimport { BoxDetail } from '../BoxDetail'\nimport { SampleOverview } from '../SampleOverview'\nimport { SampleSorting } from '../SampleSorting'\nimport { SampleTaxonomyIdentification } from '../SampleTaxonomyIdentification'\nimport { AppHeader } from '../AppHeader'\nimport { SideNavBar } from '../SideNavBar'\nimport { ErrorBoundary } from '../ErrorBoundary'\nimport { ModelsListing } from '../ModelsListing'\nimport { PredictorsListing } from '../PredictorsListing'\nimport { CustomerSubmission } from '../CustomerSubmission'\nimport { ProjectsListing } from '../ProjectsListing'\nimport { TranslationsListing } from '../TranslationsListing'\nimport { ChainOfCustody } from '../ChainOfCustody'\nimport { withSuspense } from '../withSuspense'\nimport { FullScreenWait } from '../FullScreenWait'\nimport { selectHasUser } from '../../data/selectors'\nimport { NewUserDetail, UserDetail, MyUserDetail } from '../UserDetail'\nimport { UsersListing } from '../UsersListing'\nimport { SitesListing } from '../SitesListing'\nimport { ProjectDetail } from '../ProjectDetail'\nimport { BoxTaxonomy } from '../BoxTaxonomy'\n\ninterface NavigateFn {\n  home: () => void\n  boxes: () => void\n  boxDetail: (params) => void\n  boxSubmission: () => void\n  boxTaxonomy: (params) => void\n  chainOfCustodyForm: (params) => void\n  sampleOverview: (params) => void\n  sampleSorting: (params) => void\n  sampleTaxonomyIdentification: (params) => void\n  models: () => void\n  predictors: () => void\n  projects: () => void\n  projectCreate: () => void\n  projectDetail: (params, replace?) => void\n  sites: (params?, replace?) => void\n  siteDetail: (params, replace?) => void\n  translations: () => void\n  users: () => void\n  userDetail: (params) => void\n  profile: () => void\n}\n\nconst makeNavigateFn = ({\n  history,\n  openNewWindowTo,\n}: {\n  history: { push: (url: string) => void; replace: (url: string) => void }\n  openNewWindowTo: (url: string) => void\n}): NavigateFn => ({\n  home: (): void => history.push('/'),\n  boxes: (): void => history.push('/boxes'),\n  boxDetail: ({ boxId }: { boxId: number }): void => history.push(`/boxes/${boxId}`),\n  boxSubmission: (): void => history.push(`/boxes/new`),\n  boxTaxonomy: ({ boxId }: { boxId: number }): void => history.push(`/boxes/${boxId}/taxonomy`),\n  chainOfCustodyForm: ({ boxId }) => openNewWindowTo(`/forms/custody/${boxId}`),\n  sampleOverview: ({ sampleId }: { sampleId: number }): void => history.push(`/samples/${sampleId}`),\n  sampleSorting: ({ sampleId }: { sampleId: number }): void => history.push(`/samples/${sampleId}/sorting`),\n  sampleTaxonomyIdentification: ({ sampleId }: { sampleId: number }): void =>\n    history.push(`/samples/${sampleId}/taxonomy`),\n  sites: (params?: undefined, replace?: boolean): void => history[replace ? 'replace' : 'push']('/sites'),\n  siteDetail: ({ siteId }: { siteId: number }, replace?: boolean): void =>\n    history[replace ? 'replace' : 'push'](`/sites/${siteId}`),\n  models: (): void => history.push('/models'),\n  predictors: (): void => history.push('/predictors'),\n  projects: (): void => history.push('/projects'),\n  projectCreate: (): void => history.push(`/projects/new`),\n  projectDetail: ({ projectId }: { projectId: number }, replace?: boolean): void =>\n    history[replace ? 'replace' : 'push'](`/projects/${projectId}`),\n  translations: (): void => history.push('/translations'),\n  users: (): void => history.push('/users'),\n  userDetail: ({ userId }: { userId: number }): void => history.push(`/users/${userId}`),\n  profile: (): void => history.push('/profile'),\n})\n\nexport const navigateState = atom({\n  key: 'AppRouter/navigate',\n  default: makeNavigateFn({\n    history: { push: (url) => log.debug('history.push:', url), replace: (url) => log.debug('history.replace:', url) },\n    openNewWindowTo: (url) => log.debug('new window:', url),\n  }),\n})\n\nexport const useNavigate = (): NavigateFn => useRecoilValue(navigateState)\n\nconst isFormPath = (pathname: string) => pathname.includes('/forms/')\n\nexport const AppRouter = withSuspense(\n  (): JSX.Element => {\n    const hasUser = useRecoilValue(selectHasUser)\n\n    const setNavigate = useSetRecoilState(navigateState)\n    const history = useHistory()\n\n    const [formLayout, setFormLayout] = useState(isFormPath(history.location.pathname))\n\n    useEffect(() => {\n      setNavigate(() =>\n        makeNavigateFn({\n          history,\n          openNewWindowTo: (url) => window.open(window.location.href.replace(/#.*/, `#${url}`)),\n        })\n      )\n    }, [])\n\n    useEffect(() => {\n      return history.listen(({ pathname }) => {\n        setFormLayout(isFormPath(pathname))\n      })\n    }, [])\n\n    if (formLayout)\n      return (\n        <Switch>\n          <Route\n            exact\n            path=\"/forms/custody/:boxId\"\n            render={({ match }) => <ChainOfCustody boxId={match.params.boxId} autoPrint />}\n          />\n          <Route path=\"*\">\n            <h2>Page not found.</h2>\n          </Route>\n        </Switch>\n      )\n\n    return (\n      <div css={{ height: '100vh', display: 'flex', flexDirection: 'column' }}>\n        <AppHeader />\n        <SideNavBar />\n        <div css={{ flex: 1, padding: '0.5em' }}>\n          <ErrorBoundary>\n            <Switch>\n              {!hasUser && (\n                <Route path=\"*\">\n                  <NewUserDetail />\n                </Route>\n              )}\n              <Route exact path=\"/\">\n                <Redirect to=\"/boxes\" />\n              </Route>\n              <Route exact path=\"/boxes\" render={() => <BoxesListing />} />\n              <Route exact path=\"/boxes/new\" render={() => <CustomerSubmission />} />\n              <Route exact path=\"/boxes/:boxId\" render={({ match }) => <BoxDetail boxId={match.params.boxId} />} />\n              <Route\n                exact\n                path=\"/boxes/:boxId/taxonomy\"\n                render={({ match }) => <BoxTaxonomy boxId={match.params.boxId} />}\n              />\n              <Route\n                exact\n                path=\"/samples/:sampleId\"\n                render={({ match }) => <SampleOverview sampleId={match.params.sampleId} />}\n              />\n              <Route\n                exact\n                path=\"/samples/:sampleId/sorting\"\n                render={({ match }) => <SampleSorting sampleId={match.params.sampleId} />}\n              />\n              <Route\n                exact\n                path=\"/samples/:sampleId/taxonomy\"\n                render={({ match }) => <SampleTaxonomyIdentification sampleId={match.params.sampleId} />}\n              />\n              <Route exact path=\"/models\" render={() => <ModelsListing />} />\n              <Route exact path=\"/predictors\" render={() => <PredictorsListing />} />\n              <Route exact path=\"/projects\" render={() => <ProjectsListing />} />\n              <Route exact path=\"/projects/new\" render={() => <ProjectDetail isNew />} />\n              <Route\n                exact\n                path=\"/projects/:projectId\"\n                render={({ match }) => <ProjectDetail projectId={match.params.projectId} />}\n              />\n              <Route\n                exact\n                path=\"/sites/:siteId?\"\n                render={({ match }) => <SitesListing siteId={match.params.siteId} />}\n              />\n              <Route exact path=\"/translations\" render={() => <TranslationsListing />} />\n              <Route exact path=\"/users\" render={() => <UsersListing />} />\n              <Route exact path=\"/users/:userId\" render={({ match }) => <UserDetail userId={match.params.userId} />} />\n              <Route exact path=\"/profile\" render={() => <MyUserDetail />} />\n              <Route path=\"*\">\n                <h2>Page not found.</h2>\n              </Route>\n            </Switch>\n          </ErrorBoundary>\n        </div>\n      </div>\n    )\n  },\n  () => <FullScreenWait>Retrieving profile...</FullScreenWait>\n)\n","import React, { useEffect } from 'react'\nimport { Prompt, useHistory } from 'react-router-dom'\n\n// TODO: Prompt is fairly janky (e.g. changes URL anyway: https://github.com/remix-run/react-router/issues/5405); use React Router v6 when this behaviour supported\n\nexport const ConfirmNavigateAway = ({ message }: { message: string }): JSX.Element | null => {\n  const history = useHistory()\n\n  useEffect(() => {\n    const listener = (e: BeforeUnloadEvent) => {\n      e.preventDefault()\n      e.returnValue = ''\n    }\n    window.addEventListener('beforeunload', listener)\n    return () => {\n      window.removeEventListener('beforeunload', listener)\n    }\n  }, [])\n\n  if (!history) return null // we are not in React Router and Prompt will fail\n\n  return <Prompt when={true} message={message} />\n}\n","/** @jsxImportSource @emotion/react */\nimport React, { useEffect } from 'react'\nimport { HashRouter as ReactRouter } from 'react-router-dom'\nimport { RecoilRoot, useRecoilState } from 'recoil'\nimport { UseHostedReturn } from '@namcbugdb/react-common'\nimport { SnackbarProvider } from 'notistack'\n\nimport { AppRouter } from './components/AppRouter'\nimport { GraphApi, apiState } from './data/api'\n\nimport './normalize.css'\nimport './App.css'\n\nexport interface AppProps {\n  signOut: () => void\n  auth: UseHostedReturn\n}\n\nconst Component = ({ signOut, auth }: AppProps): JSX.Element => {\n  const [api, setApi] = useRecoilState(apiState)\n\n  useEffect(() => {\n    const apiInstance = new GraphApi(auth, signOut)\n    setApi(apiInstance)\n  }, [])\n\n  if (!(api instanceof GraphApi)) return <div /> // wait until API is set\n\n  return (\n    <ReactRouter>\n      <AppRouter />\n    </ReactRouter>\n  )\n}\n\nexport const App = (props: AppProps): JSX.Element => {\n  return (\n    <RecoilRoot>\n      <SnackbarProvider>\n        <Component {...props} />\n      </SnackbarProvider>\n    </RecoilRoot>\n  )\n}\n","/** @jsxImportSource @emotion/react */\nimport React, { useState, useEffect } from 'react'\nimport { useHostedAuth, UseHostedReturn } from '@namcbugdb/react-common'\nimport { api } from '@namcbugdb/common'\n\nimport log from 'loglevel'\n\nimport { App } from './App'\nimport { appDefaults, endpoints, redirectUrl } from './config'\nimport { FullScreenWait } from './components/FullScreenWait'\n\nconst AppAuthConnect: React.FC = () => {\n  const [authInfo, setAuthInfo] = useState<Record<string, unknown>>()\n  const [isAppPreLoading, setIsAppPreLoading] = useState(true)\n  const auth: UseHostedReturn = useHostedAuth(authInfo as Record<string, unknown>, false, false) //config.isDev\n\n  // This is the pre-auth step to retrieve all the necessary cognito endpoint data\n  useEffect(() => {\n    api\n      .authCheck(endpoints.graphql as string, '', appDefaults.apiTimeout)\n      .then((authResp) => {\n        log.debug('authResp', authResp)\n        const authVals = authResp.data?.auth\n        if (authVals && authVals.region) {\n          setAuthInfo({\n            region: authVals.region,\n            userPoolId: authVals.userPool,\n            userPoolWebClientId: authVals.clientId,\n            mandatorySignIn: true,\n            oauth: {\n              domain: authVals.domain,\n              scope: ['email', 'profile', 'openid'],\n              redirectSignIn: redirectUrl.toString(),\n              redirectSignOut: redirectUrl.toString(),\n              responseType: 'code',\n            },\n          })\n          setIsAppPreLoading(false)\n        }\n      })\n      .catch((err) => {\n        log.error('api.authCheck error', err)\n      })\n  }, [])\n\n  useEffect(() => {\n    if (!auth.isAuthenticated && auth.isAuthComplete) auth.signIn()\n  }, [auth.isAuthenticated, auth.isAuthComplete])\n\n  if (!auth.isAuthenticated) {\n    if (isAppPreLoading) return <FullScreenWait>Loading...</FullScreenWait>\n    if (!auth.isAuthComplete) return <FullScreenWait>Authenticating...</FullScreenWait>\n    return <FullScreenWait>Redirecting...</FullScreenWait>\n  }\n\n  return <App signOut={auth.signOut} auth={auth} />\n}\nexport default AppAuthConnect\n","import { ReportHandler } from 'web-vitals'\n\nconst reportWebVitals = (onPerfEntry?: ReportHandler): void => {\n  if (onPerfEntry && onPerfEntry instanceof Function) {\n    import('web-vitals').then(({ getCLS, getFID, getFCP, getLCP, getTTFB }) => {\n      getCLS(onPerfEntry)\n      getFID(onPerfEntry)\n      getFCP(onPerfEntry)\n      getLCP(onPerfEntry)\n      getTTFB(onPerfEntry)\n    })\n  }\n}\n\nexport default reportWebVitals\n","import React from 'react'\nimport ReactDOM from 'react-dom'\nimport AppConnect from './App.connect'\nimport reportWebVitals from './reportWebVitals'\nimport log from 'loglevel'\n\n// THIS FIX IS NECESSARY FOR PRODUCTION AND WEBPACK!!!!\n// https://docs.mapbox.com/mapbox-gl-js/api/#transpiling-v2\n// https://github.com/mapbox/mapbox-gl-js/issues/10173\nimport mapboxgl from 'mapbox-gl/dist/mapbox-gl'\n// eslint-disable-next-line @typescript-eslint/no-var-requires\nmapboxgl.workerClass = require('worker-loader!mapbox-gl/dist/mapbox-gl-csp-worker').default\n\nconst requestedLogLevel = process.env.REACT_APP_LOGLEVEL\nswitch (requestedLogLevel) {\n  case 'trace':\n  case 'debug':\n  case 'info':\n  case 'warn':\n  case 'error':\n  case 'silent':\n    log.setLevel(requestedLogLevel)\n    break\n  default:\n    log.setLevel(process.env.NODE_ENV === 'production' ? 'warn' : 'trace')\n}\n\nReactDOM.render(\n  <React.StrictMode>\n    <AppConnect />\n  </React.StrictMode>,\n  document.getElementById('root')\n)\n\n// If you want to start measuring performance in your app, pass a function\n// to log results (for example: reportWebVitals(console.log))\n// or send to an analytics endpoint. Learn more: https://bit.ly/CRA-vitals\nreportWebVitals()\n"],"sourceRoot":""}